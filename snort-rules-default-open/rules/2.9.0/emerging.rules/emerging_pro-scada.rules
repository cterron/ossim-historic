# Emerging Threats Pro
#   http://www.emergingthreatspro.com
#
# This distribution may contain rules under three different licenses. 
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License 
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2015, Emerging Threats
#  All rights reserved.
#  
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the 
#  following conditions are met:
#  
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following 
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the 
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived 
#    from this software without specific prior written permission.
#  
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES, 
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE 
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
#
#*************************************************************
#
#
#  Rules with sids 2800000 through 2900000 are provided by Emerging Threats Pro and are covered by the license
#  provided in this distribution titled ETPRO-License.txt
#
#

# This Ruleset is EmergingThreats Pro optimized for suricata-1.3.

#by Dale Peterson of digitalbond.com
#
#alert tcp $EXTERNAL_NET any -> $HOME_NET 20222 (msg:"ET SCADA CitectSCADA ODBC Overflowflow Attempt"; flow:established,to_server; dsize:4; byte_test:4,>,399,0; reference:cve,2008-2639; reference:url,www.digitalbond.com/index.php/2008/09/08/ids-signature-for-citect-vuln/; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2008542; rev:7;)

#
#alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA DATAC Control RealWin SCADA System Crafted Packet Handling Buffer Overflow"; flow:to_server,established; isdataat:715; content:"|10 23 54 67|"; offset:0; byte_test:4,>,700,0,relative,little; content:"|0a 00 05 00|"; distance:6; within:4; reference:cve,CVE-2008-4322; reference:bugtraq,31418; reference:secunia,32055; classtype:attempted-user; sid:2800362; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 912 (msg:"ETPRO SCADA RealFlex RealWin SCADA SCPC_INITIALIZE and SCPC_INITIALIZE_RF Buffer Overflow 1"; flow:to_server,established; isdataat:215; content:"|64 12 54 6a 02 00 00 00|"; depth:8; byte_test:4,>,200,0,relative,little; reference:bugtraq,44150; reference:url,www.metasploit.com/redmine/projects/framework/repository/revisions/10734/entry/modules/exploits/windows/scada/realwin_scpc_initialize_rf.rb; reference:url,www.metasploit.com/redmine/projects/framework/repository/revisions/10734/entry/modules/exploits/windows/scada/realwin_scpc_initialize.rb; reference:url,www.exploit-db.com/exploits/15337/; reference:url,aluigi.altervista.org/adv/realwin_1-adv.txt; classtype:attempted-user; sid:2800863; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 912 (msg:"ETPRO SCADA RealFlex RealWin SCADA SCPC_INITIALIZE and SCPC_INITIALIZE_RF Buffer Overflow 2"; flow:to_server,established; isdataat:215; content:"|64 12 54 6a 20 00 00 00|"; depth:8; byte_test:4,>,200,0,relative,little; reference:url,www.metasploit.com/redmine/projects/framework/repository/revisions/10734/entry/modules/exploits/windows/scada/realwin_scpc_initialize_rf.rb; reference:url,www.metasploit.com/redmine/projects/framework/repository/revisions/10734/entry/modules/exploits/windows/scada/realwin_scpc_initialize.rb; reference:url,www.exploit-db.com/exploits/15337/; reference:url,aluigi.altervista.org/adv/realwin_1-adv.txt; reference:bugtraq,44150; classtype:attempted-user; sid:2800864; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 912 (msg:"ET SCADA RealWin SCADA System Buffer Overflow"; flow:established,to_server; content:"|64 12 54 6a|"; depth:4; content:"|00 00 00 f4 1f 00 00|"; distance:1; within:7; isdataat:220; content:!"|0a|"; distance:0; pcre:"/\x64\x12\x54\x6a[\x20\x10\x02]\x00\x00\x00\xf4\x1f\x00\x00/"; reference:url,www.exploit-db.com/exploits/15337/; classtype:attempted-dos; sid:2011976; rev:1;)

#dan clemens
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ETPRO SCADA SCADA NetBiter webScada Directory Transversal"; flow:to_server,established; content:"/cgi-bin/read.cgi?page="; http_uri; content:"|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/|2E 2E|/"; http_header; depth:100; reference:url,www.securityfocus.com/archive/1/514104; classtype:web-application-attack; sid:2800916; rev:2;)

#dan clemens
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ETPRO SCADA SCADA NetBiter webScada User Information Disclosure"; flow:to_server,established; content:"/cgi-bin/read.cgi?file=/home/config/users.cfg"; http_uri; reference:url,www.securityfocus.com/archive/1/514104; classtype:web-application-attack; sid:2800917; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 912 (msg:"ETPRO SCADA RealFlex RealWin SCADA SCPC_INITIALIZE and SCPC_INITIALIZE_RF Buffer Overflow header 1"; flow:to_server,established; content:"|64 12 54 6a 02 00 00 00|"; byte_test:4,>,200,0,relative,little; isdataat:215; reference:cve,2010-4142; reference:bugtraq,44150; classtype:attempted-user; sid:2800921; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 912 (msg:"ETPRO SCADA RealFlex RealWin SCADA SCPC_INITIALIZE and SCPC_INITIALIZE_RF Buffer Overflow header 2"; flow:to_server,established; content:"|64 12 54 6a 20 00 00 00|"; byte_test:4,>,200,0,relative,little; isdataat:215; reference:cve,CVE-2010-4142; reference:bugtraq,44150; classtype:attempted-user; sid:2800922; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 33) Change Date Attempt"; dsize:42; flow:established; content:"|01460741|"; offset:28; depth:4; classtype:misc-activity; sid:2801002; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 32) Change Time Attempt"; dsize:42; flow:established; content:"|01460741|"; offset:28; depth:4; classtype:misc-activity; sid:2801003; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 11) Unlock PLC Attempt"; dsize:44; flow:established; content:"|01460915|"; offset:28; depth:4; classtype:misc-activity; sid:2801006; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 10) Lock PLC Attempt"; dsize:45; flow:established; content:"|01460a1402|"; offset:28; depth:5; classtype:misc-activity; sid:2801007; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 10) Lock PLC Attempt"; dsize:45; flow:established; content:"|01460a1403|"; offset:28; depth:5; classtype:misc-activity; sid:2801008; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 10) Lock PLC Attempt"; dsize:45; flow:established; content:"|01460a1401|"; offset:28; depth:5; classtype:misc-activity; sid:2801009; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 12) Remote Mode Change Attempt"; dsize:37; flow:established; content:"|0145020100|"; offset:28; depth:5; classtype:misc-activity; sid:2801010; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 12) Remote Mode Change Attempt"; dsize:37; flow:established; content:"|0145020101|"; offset:28; depth:5; classtype:misc-activity; sid:2801011; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 12) Remote Mode Change Attempt"; dsize:37; flow:established; content:"|0145020102|"; offset:28; depth:5; classtype:misc-activity; sid:2801012; rev:1;)

#
alert tcp any any -> $HOME_NET 502 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 49) Request Controller ID"; dsize:10; flow:established; content:"|0401460117|"; classtype:misc-activity; sid:2801013; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 39)IP Address Change Attempt"; dsize:53; flow:established; content:"|01461036|"; offset:28; depth:4; classtype:misc-activity; sid:2801014; rev:1;)

#
alert tcp any 502 -> $HOME_NET any (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 20) Function Not Available Error"; dsize:9; flow:established,from_server; content:"|01|"; offset:8; depth:1; classtype:misc-activity; sid:2801015; rev:2;)

#
alert tcp any 502 -> $HOME_NET any (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 21) Point Not Available Error"; dsize:9; flow:established; content:"|02|"; offset:8; depth:1; classtype:misc-activity; sid:2801016; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 26) Flash Erase"; flow:established; content:"|01410a000000|"; offset:28; depth:6; classtype:misc-activity; sid:2801017; rev:1;)

#
alert tcp any any -> $HOME_NET 502 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 27) Firmware Change"; dsize:11; flow:established; content:"|41050000|"; offset:7; depth:4; classtype:misc-activity; sid:2801020; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 29)Software Upload"; flow:established; content:"|0146|"; offset:28; depth:2; content:"|22|"; distance:31; within:1; classtype:misc-activity; sid:2801021; rev:2;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 41)Config File Change"; flow:established; content:"|0146|"; offset:28; depth:2; content:"|14|"; distance:31; within:1; classtype:misc-activity; sid:2801022; rev:2;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS Potential SW Download Event"; flow:established; content:"|0146|"; offset:28; depth:2; content:"|03|"; distance:31; within:1; flowbits:set,spdown; flowbits:noalert; classtype:misc-activity; sid:2801023; rev:2;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 45)Software Download"; flowbits:isset,spdown; flow:established; content:"|0146|"; offset:28; depth:2; content:"|13|"; distance:31; within:1; classtype:misc-activity; sid:2801024; rev:2;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 22)Remote Diagnostic Self Test"; flow:established; content:"|01460173|"; offset:28; depth:4; classtype:misc-activity; sid:2801025; rev:2;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 38)Control Protocol Change Attempt"; flow:established; content:"|01460d4d01|"; offset:28; depth:5; classtype:misc-activity; sid:2801026; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 40)TCP UDP Port Change Attempt"; flow:established; content:"|01460d4d01|"; offset:28; depth:5; classtype:misc-activity; sid:2801027; rev:1;)

#
alert tcp any any -> $HOME_NET 20000 (msg:"ETPRO SCADA CONTROL MICROSYSTEMS (Event 36)Change Port Configuration Attempt"; flow:established; content:"|01461501|"; offset:28; depth:4; content:"|08|"; distance:33; within:1; classtype:misc-activity; sid:2801028; rev:2;)

#
alert udp any 20000 -> $HOME_NET 20000 (msg:"ETPRO SCADA GE (Event 24) View Device Status"; dsize:15; content:"|0564|"; depth:2; content:"|c4|"; distance:3; within:1; content:"|01|"; distance:12; within:1; classtype:misc-activity; sid:2801029; rev:2;)

#
alert udp any 20000 -> $HOME_NET 20000 (msg:"ETPRO SCADA GE (Event 32) Change Time Attempt"; dsize:25; content:"|0564|"; depth:2; content:"|c4|"; distance:3; within:1; content:"|02320107|"; distance:12; within:4; classtype:misc-activity; sid:2801030; rev:2;)

#
alert udp any 20000 -> $HOME_NET 20000 (msg:"ETPRO SCADA GE (Event 33) Change Date Attempt"; dsize:25; content:"|0564|"; depth:2; content:"|c4|"; distance:3; within:1; content:"|02320107|"; distance:12; within:4; classtype:misc-activity; sid:2801031; rev:2;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 31)Reboot or Restart"; flow:established,to_server; content:"boot|0d|"; nocase; classtype:misc-activity; sid:2801032; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 1)Failed Login"; flow:established,to_client; content:"ENTER USER NAME|3a|"; classtype:misc-activity; sid:2801033; rev:2;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 2)Successful Login"; flow:established,to_client; content:"Welcome"; classtype:misc-activity; sid:2801034; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 33)Change Date Attempt"; flow:established,to_client; content:"Update_time_or_date"; classtype:misc-activity; sid:2801035; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 32)Change Time Attempt"; flow:established,to_client; content:"Update_time_or_date"; classtype:misc-activity; sid:2801036; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 3)Logout"; flow:established,to_client; content:"logged off"; classtype:misc-activity; sid:2801037; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 20)Function Not Available"; flow:established,to_client; content:"Command not found"; classtype:misc-activity; sid:2801038; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 50)Feature Request"; flow:established,to_server; content:"ver|0d|"; nocase; classtype:misc-activity; sid:2801100; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 22)Remote Diagnostic Self Test"; flow:established,to_server; content:"rt /v|0d|"; nocase; classtype:misc-activity; sid:2801039; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 24)View Device Status"; flow:established,to_client; content:"Device Status Display"; content:"Use cursor keys to select a device and to scroll the display"; classtype:misc-activity; sid:2801040; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 44)Display Access Change Attempt"; flow:established,to_client; content:"User Log Display"; content:"Use cursor keys to select a point and to scroll the display"; classtype:misc-activity; sid:2801041; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE Event Log Display Detected"; flow:established,to_client; content:"Logger Buffer Display"; content:"Use cursor keys to select a point and to scroll the display"; flowbits:set,logdisp; flowbits:noalert; classtype:misc-activity; sid:2801042; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA GE (Event 51)Clear Audit Log Attempt"; flowbits:isset,logdisp; flow:established,to_server; content:"|01|"; classtype:misc-activity; sid:2801043; rev:1;)

#
alert udp any any -> $HOME_NET 69 (msg:"ETPRO SCADA GE (Event 41)Config File Change"; dsize:60; content:"|00 02 4e 56 52 41 4d 5c 46 41 43 5f 44 45 46 2e 5a 4c 42 00|"; depth:20; classtype:misc-activity; sid:2801048; rev:2;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA JOHNSON CONTROLS (Event 9)Password Change Attempt"; flow:established,to_client; content:"Password change accepted"; classtype:misc-activity; sid:2801049; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA JOHNSON CONTROLS (Event 1)Failed Login"; flow:established,to_client; content:"login|3a|"; classtype:misc-activity; sid:2801050; rev:2;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA JOHNSON CONTROLS (Event 33)Change Date Attempt"; flow:established,to_server; content:"|0d|"; pcre:"/(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])(\d{2})(0[0-9]|1[0-9]|2[0-3])([0-5][0-9])/i"; classtype:misc-activity; sid:2801051; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA JOHNSON CONTROLS (Event 32)Change Time Attempt"; flow:established,to_server; content:"|0d|"; pcre:"/(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])(\d{2})(0[0-9]|1[0-9]|2[0-3])([0-5][0-9])/i"; classtype:misc-activity; sid:2801052; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA JOHNSON CONTROLS (Event 2)Successful Login"; flow:established,to_client; content:"CK720 Version"; classtype:misc-activity; sid:2801053; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA JOHNSON CONTROLS (Event 31)Reboot or Restart"; flow:established,to_client; content:"You are about to shutdown and reboot"; classtype:misc-activity; sid:2801054; rev:1;)

#
#alert udp any any -> 255.255.255.255 any (msg:"ETPRO SCADA DIRECTLOGIC (Event 47)Device Poll All"; dsize:10; content:"|48 41 50|"; depth:3; content:"|05|"; distance:9; within:1; classtype:misc-activity; sid:2801056; rev:2;)

#
#alert tcp any 502 -> $HOME_NET any (msg:"ETPRO SCADA DIRECTLOGIC (Event 15) Station Number Error"; flow:established,from_server; dsize:9; content:"|03|"; offset:8; depth:1; classtype:misc-activity; sid:2801057; rev:5;)

#
#alert tcp any 502 -> $HOME_NET any (msg:"ETPRO SCADA DIRECTLOGIC (Event 20) Function Not Available"; flow:established,from_server; dsize:9; content:"|01|"; offset:8; depth:1; classtype:misc-activity; sid:2801058; rev:4;)

#
#alert tcp any 502 -> $HOME_NET any (msg:"ETPRO SCADA DIRECTLOGIC (Event 21) Point Not Available"; flow:established,from_server; dsize:9; content:"|03|"; offset:8; depth:1; classtype:misc-activity; sid:2801059; rev:3;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 50)Feature Request"; dsize:10; content:"|48 41 50|"; depth:3; content:"|02|"; distance:9; within:1; classtype:misc-activity; sid:2801060; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 33)Change Date Attempt"; dsize:29; content:"|48 41 50|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; classtype:misc-activity; sid:2801061; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 32)Change Time Attempt"; dsize:29; content:"|48 41 50|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; classtype:misc-activity; sid:2801062; rev:2;)

#
alert udp any any -> 255.255.255.255 any (msg:"ETPRO SCADA DIRECTLOGIC (Event 39)IP Address Change Attempt"; dsize:>16; content:"|48 41 50|"; depth:3; content:"|15|"; distance:9; within:1; content:"|0c 00 36|"; distance:16; within:3; content:!"|00 00 00 00|"; distance:24; within:4; classtype:misc-activity; sid:2801063; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 39)IP Address Change Attempt"; dsize:>16; content:"|48 41 50|"; depth:3; content:"|0c 00 36|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:16; within:4; classtype:misc-activity; sid:2801064; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 10)Lock PLC Attempt"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; classtype:misc-activity; sid:2801065; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 10)Lock PLC Attempt"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|ff ff ff ff 17 4f|"; distance:20; within:6; classtype:misc-activity; sid:2801066; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 11)Unlock PLC Attempt"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; classtype:misc-activity; sid:2801067; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 11)Unlock PLC Attempt"; dsize:26; content:"|48 41 50|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 3c|"; distance:24; within:2; classtype:misc-activity; sid:2801068; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 31)Reboot or Restart"; dsize:10; content:"|48 41 50|"; depth:3; content:"|fa|"; distance:9; within:1; classtype:misc-activity; sid:2801069; rev:2;)

#
alert udp any any -> 255.255.255.255 any (msg:"ETPRO SCADA DIRECTLOGIC (Event 47)Device Poll All"; dsize:10; content:"|48 41 41|"; depth:3; content:"|05|"; distance:9; within:1; classtype:misc-activity; sid:2801070; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 50)Feature Request"; dsize:10; content:"|48 41 41|"; depth:3; content:"|02|"; distance:9; within:1; classtype:misc-activity; sid:2801071; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 32)Change Time Attempt"; dsize:29; content:"|48 41 41|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; classtype:misc-activity; sid:2801072; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 33)Change Date Attempt"; dsize:29; content:"|48 41 41|"; depth:3; content:"|1a 00 10|"; distance:9; within:3; classtype:misc-activity; sid:2801073; rev:2;)

#
alert udp any any -> 255.255.255.255 any (msg:"ETPRO SCADA DIRECTLOGIC (Event 39)IP Address Change Attempt"; dsize:>16; content:"|48 41 41|"; depth:3; content:"|15|"; distance:9; within:1; content:"|0c 00 36|"; distance:16; within:3; content:!"|00 00 00 00|"; distance:24; within:4; classtype:misc-activity; sid:2801074; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 39)IP Address Change Attempt"; dsize:>16; content:"|48 41 41|"; depth:3; content:"|0c 00 36|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:16; within:4; classtype:misc-activity; sid:2801075; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 10)Lock PLC Attempt"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; classtype:misc-activity; sid:2801076; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 10)Lock PLC Attempt"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|ff ff ff ff 17 4f|"; distance:20; within:6; classtype:misc-activity; sid:2801077; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 11)Unlock PLC Attempt"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:"|00 00 00 00|"; distance:20; within:4; content:"|17 4f|"; distance:24; within:2; classtype:misc-activity; sid:2801078; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 11)Unlock PLC Attempt"; dsize:26; content:"|48 41 41|"; depth:3; content:"|1a 00 0d|"; distance:9; within:3; content:!"|00 00 00 00|"; distance:20; within:4; content:"|17 3c|"; distance:24; within:2; classtype:misc-activity; sid:2801079; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 31)Reboot or Restart"; dsize:10; content:"|48 41 41|"; depth:3; content:"|fa|"; distance:9; within:1; classtype:misc-activity; sid:2801080; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 12)Remote Mode Change Attempt"; dsize:23; content:"|48 41 50|"; depth:3; content:"|1a 00 0a 00 01 51 01 15 02 01 00|"; distance:9; within:11; classtype:misc-activity; sid:2801081; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 12)Remote Mode Change Attempt"; dsize:23; content:"|48 41 41|"; depth:3; content:"|1a 00 0a 00 01 51 01 15 02 01 00|"; distance:9; within:11; classtype:misc-activity; sid:2801082; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 26)Flash Erase"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|31 00 00 00 00 00|"; distance:16; within:6; classtype:misc-activity; sid:2801083; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 26)Flash Erase"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|31 00 00 00 00 00|"; distance:16; within:6; classtype:misc-activity; sid:2801084; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 27)Firmware Change"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f6|"; distance:16; within:1; classtype:misc-activity; sid:2801085; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 27)Firmware Change"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f2|"; distance:16; within:1; classtype:misc-activity; sid:2801086; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 27)Firmware Change"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f6|"; distance:16; within:1; classtype:misc-activity; sid:2801087; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 27)Firmware Change"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|15|"; distance:9; within:1; content:"|f2|"; distance:16; within:1; classtype:misc-activity; sid:2801088; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 29)Software Upload"; dsize:>100; content:"|48 41 50|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; classtype:misc-activity; sid:2801089; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 29)Software Upload"; dsize:>100; content:"|48 41 41|"; depth:3; content:"|19 00 01 20|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; classtype:misc-activity; sid:2801090; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 45)Software Download"; dsize:17; content:"|48 41 50|"; depth:3; content:"|19 00 01 1e|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; classtype:misc-activity; sid:2801091; rev:2;)

#
alert udp any any -> $HOME_NET 28784 (msg:"ETPRO SCADA DIRECTLOGIC (Event 45)Software Download"; dsize:17; content:"|48 41 41|"; depth:3; content:"|19 00 01 1e|"; distance:9; within:4; content:"|00 37|"; distance:15; within:2; classtype:misc-activity; sid:2801092; rev:2;)

#
#alert tcp any 502 -> $HOME_NET any (msg:"ETPRO SCADA PROSOFT (Event 15) Station Number Error"; flow:established,from_server; dsize:9; content:"|02|"; offset:8; depth:1; classtype:misc-activity; sid:2801105; rev:3;)

#
#alert tcp any 502 -> $HOME_NET any (msg:"ETPRO SCADA PROSOFT (Event 21) Point Not Available"; flow:established,from_server; dsize:9; content:"|00|"; offset:8; depth:1; classtype:misc-activity; sid:2801106; rev:3;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER Invalid Password Attempts"; flow:established,to_client; flowbits:set,invpw; flowbits:noalert; content:"Invalid Password"; classtype:misc-activity; sid:2801126; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER Access Denied detected after 3 login attempts"; flow:established; flowbits:isset,invpw; content:"Access Denied"; classtype:misc-activity; sid:2801127; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Date Command Detected"; flow:established,to_client; flowbits:set,chgdate; flowbits:noalert; content: "/"; pcre:"/(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](\d{2})/i"; classtype:misc-activity; sid:2801128; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Date Change was Successful"; flow:established,to_server; flowbits:isset,chgdate; content:"date"; nocase; pcre:"/date\x20(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](\d{2})/i"; classtype:misc-activity; sid:2801129; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Unsuccessful attempt to change date"; flow:established,to_client; flowbits:isset,chgdate; content:"Improper Parameters"; classtype:misc-activity; sid:2801130; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Potential Login Attempt"; flow:established,to_client; flowbits:set,login; flowbits:noalert; content: "COMMUNICATIONS PROCESSOR-S/N"; classtype:misc-activity; sid:2801131; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Level 1 Successful Login"; flow:established,to_client; flowbits:isset,login; content: "Level 1"; classtype:misc-activity; sid:2801132; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Level 2 Successful Login"; flow:established,to_client; flowbits:isset,login; content: "Level 2"; classtype:misc-activity; sid:2801133; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Modem Status Change Attempt"; flow:established,to_server; flowbits:set,toggle; flowbits:noalert; content:"Toggle"; nocase; classtype:misc-activity; sid:2801134; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Modem Status Changed"; flow:established,to_server; flowbits:isset,toggle; content:"bit toggled"; nocase; classtype:misc-activity; sid:2801135; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Password function detected"; flow:established,to_server; flowbits:set,pwdchg; flowbits:noalert; content:"pas"; nocase; pcre:"/pas{1,2}.{0,5}(\x20|1|2){0,1}/i"; classtype:misc-activity; sid:2801136; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Passwords were viewed"; flow:established,to_server; flowbits:isset,pwdchg; content:"1|3a|"; content:"2|3a|"; classtype:misc-activity; sid:2801137; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Access Level 1/2 Password Changed"; flow:established,to_client; flowbits:isset,pwdchg; content:"password"; nocase; pcre:"/Level [1|2] Password Changed/i"; classtype:misc-activity; sid:2801138; rev:1;)

#
#alert tcp any any <> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Access Level 1 or 2 Password Disabled"; flow:established,to_client; flowbits:isset,pwdchg; content:"DISABLED"; nocase; classtype:misc-activity; sid:2801139; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Time Command Detected"; flow:established,to_client; flowbits:set,chgtm; flowbits:noalert; content:"|3a|"; pcre:"/(0[0-9]|1[0-9]|2[0-3])[\x3a]([0-5][0-9])[\x3a]([0-5][0-9])/i"; classtype:misc-activity; sid:2801140; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Time Change was Successful"; flow:established,to_server; flowbits:isset,chgtm; content:"time"; nocase; pcre:"/time\x20(0[0-9]|1[0-9]|2[0-3])[\x3a]([0-5][0-9])[\x3a]([0-5][0-9])/i"; classtype:misc-activity; sid:2801141; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Unsuccessful attempt to change time"; flow:established,to_client; flowbits:isset,chgdate; content:"Improper Parameters"; classtype:misc-activity; sid:2801142; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Device poll detected"; flow:established,to_server; content:"who|0d|"; nocase; classtype:misc-activity; sid:2801143; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Point Not Available"; flow:established,to_client; content:"The database region data is invalid"; nocase; classtype:misc-activity; sid:2801144; rev:1;)

#
alert tcp any any -> $HOME_NET 21 (msg:"ETPRO SCADA SCHWEITZER SEL2032-File Does Not Exist"; flow:established,to_client; content:"550 RETR requested action not taken"; classtype:misc-activity; sid:2801145; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Config File Change Attempt Detected"; flow:established,to_client; flowbits:set,cfgfile; flowbits:noalert; content:"Port communications settings for Port"; classtype:misc-activity; sid:2801146; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Successful Config File Change"; flow:established,to_client; flowbits:isset,cfgfile; content:"Port"; content:"Settings Changed"; classtype:misc-activity; sid:2801147; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Failed Config File Change"; flow:established,to_client; flowbits:isset,cfgfile; content:"Settings aborted"; classtype:misc-activity; sid:2801148; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Access Level 1 Attempted"; flow:established,to_server; content:"acc"; depth:3; nocase; pcre:"/acce{0,1}s{0,2}/i"; classtype:misc-activity; sid:2801149; rev:2;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Access Level 2 Attempted"; flow:established,to_server; content:"2ac"; nocase; pcre:"/ac{0,2}e{0,1}s{0,2}/i"; classtype:misc-activity; sid:2801150; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-IP Address Change Attempt Detected"; flow:established,to_server; flowbits:set,chgip; flowbits:noalert; content:"set"; nocase; pcre:"/[p]\x20(17|18)|(17|18)\x20[p]/i"; classtype:misc-activity; sid:2801151; rev:1;)

#
#alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-IP Address Change Detected"; flow:established,to_server; flowbits:isset,chgip; pcre:"/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/i"; classtype:misc-activity; sid:2801152; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Control Protocol Change"; flow:established,to_client; flowbits:isset,cfgfile; flowbits:set,chgprot; flowbits:noalert; content:"Communications Type (S=SEL, L=LMD)"; classtype:misc-activity; sid:2801153; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Failed Config File Change"; flow:established,to_server; flowbits:isset,chgprot; content:"|0d|"; pcre:"/(l|s)\x0d/i"; classtype:misc-activity; sid:2801154; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER SEL2032-Software Upload Attempt Detected"; flow:established,to_client; content:"file read"; nocase; classtype:misc-activity; sid:2801155; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER (Event 03)Logout"; flow:established,to_server; content:"qui"; nocase; pcre:"/quit{0,1}\x0d/i"; classtype:misc-activity; sid:2801158; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER (Event 03)Logout"; flow:established,to_server; content:"sta"; nocase; pcre:"/stat{0,1}u{0,1}s{0,1}\x0d/i"; classtype:misc-activity; sid:2801159; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER (Event 36)Change Port Configuration Attempt"; flow:established,to_client; content:"Port"; content:"Settings Changed"; classtype:misc-activity; sid:2801160; rev:1;)

#
alert tcp any any -> $HOME_NET 23 (msg:"ETPRO SCADA SCHWEITZER (Event 41)Config File Change"; flow:established,to_client; content:"Port"; content:"Settings Changed"; classtype:misc-activity; sid:2801163; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ET SCADA DATAC RealWin SCADA Server Buffer Overflow"; flow:established,to_server; content:"|10 23 54 67 00 08 00 00|"; depth:8; content:"|e3 77 0a 00 05 00 04 00 00 00|"; distance:0; within:10; isdataat:744,relative; content:!"|0a|"; within:744; reference:url,www.securityfocus.com/bid/31418; reference:cve,2008-4322; reference:url,secunia.com/advisories/32055; classtype:attempted-user; sid:2012096; rev:1;)

#
#alert tcp any any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Disable Unsolicited Responses"; flow:from_client,established; content:"|15|"; offset:12; depth:1; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:attempted-dos; sid:2801680; rev:2;)

#
#alert tcp $DNP3_SERVER $DNP3_PORTS -> $DNP3_CLIENT any (msg:"ETPRO SCADA DNP3 Unsolicited Response Storm"; flow:established; content:"|82|"; offset:12; depth:1; threshold: type threshold, track by_src, count 5, seconds 10; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:attempted-dos; sid:2801682; rev:1;)

#
#alert tcp $DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Cold Restart From Authorized Client"; flow:from_client,established; content:"|0d|"; offset:12; depth:1; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:attempted-dos; sid:2801683; rev:2;)

#
#alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Cold Restart From Unauthorized Client"; flow:from_client,established; content:"|0d|"; offset:12; depth:1; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:denial-of-service; sid:2801684; rev:2;)

#
#alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Unauthorized Read Request to a PLC"; flow:from_client,established; content:"|01|"; offset:12; depth:1; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:bad-unknown; sid:2801685; rev:1;)

#
#alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Unauthorized Write Request to a PLC"; flow:from_client,established; content:"|05 64|"; depth:2; pcre:"/[\S\s]{10}(\x02|\x04|\x05|\x06|\x09|\x0A|\x0F|\x12)/R"; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:bad-unknown; sid:2801686; rev:3;)

#
#alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Unauthorized Miscellaneous Request to a PLC"; flow:from_client,established; content:"|05 64|"; depth:2; pcre:"/[\S\s]{10}(\x03|\x07|\x08|\x0B|\x0C|\x10|\x11|\x13|\x14|\x15|\x16|\x17|\x18|\x19|\x1A|\x1B|\x1C|\x1D|\x1E)/iR"; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:bad-unknown; sid:2801687; rev:2;)

#
#alert tcp any any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Stop Application"; flow:from_client,established; content:"|12|"; offset:12; depth:1; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:denial-of-service; sid:2801688; rev:2;)

#
#alert tcp any any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Warm Restart"; flow:from_client,established; content:"|0e|"; offset:12; depth:1; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:attempted-dos; sid:2801689; rev:3;)

#
#alert tcp $DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Broadcast Request from Authorized Client"; flow:from_client,established; content:"|ff ff|"; offset:4; depth:2; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:misc-attack; sid:2801690; rev:2;)

#
#alert tcp !$DNP3_CLIENT any -> $DNP3_SERVER $DNP3_PORTS (msg:"ETPRO SCADA DNP3 Broadcast Request from Unauthorized Client"; flow:from_client,established; content:"|ff ff|"; offset:4; depth:2; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:misc-attack; sid:2801691; rev:2;)

#
#alert tcp $DNP3_SERVER $DNP3_PORTS -> any any (msg:"ETPRO SCADA DNP3 Points List Scan"; flow:established; content:"|81|"; offset:12; depth:1; pcre:"/[\S\s]{1}(\x02|\x04|\x06|\x0a|\x0c|\x0e)/iR"; threshold: type threshold, track by_src, count 5, seconds 30; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:attempted-recon; sid:2801692; rev:3;)

#
#alert tcp $DNP3_SERVER $DNP3_PORTS -> any any (msg:"ETPRO SCADA DNP3 Function Code Scan"; flow:established; content:"|81|"; offset:12; depth:1; pcre:"/[\S\s]{1}(\x01)/iR"; threshold: type threshold, track by_src, count 3, seconds 60; reference:url,digitalbond.com/tools/quickdraw/dnp3-rules; classtype:attempted-recon; sid:2801693; rev:3;)

#
#alert tcp $MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Force Listen Only Mode"; flow:from_client,established; content:"|00 00|"; offset:2; depth:2; content:"|08 00 04|"; distance:7; within:3; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:attempted-dos; sid:2801710; rev:3;)

#
#alert tcp $MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Restart Communications Option"; flow:from_client,established; content:"|00 00|"; offset:2; depth:2; content:"|08 00 01|"; distance:7; within:3; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:attempted-dos; sid:2801711; rev:3;)

#
#alert tcp $MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Clear Counters and Diagnostic Registers"; flow:from_client,established; content:"|00 00|"; offset:2; depth:2; content:"|08 00 0A|"; distance:7; within:3; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:misc-attack; sid:2801712; rev:3;)

#
#alert tcp $MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Read Device Identification"; flow:from_client,established; content:"|00 00|"; offset:2; depth:2; content:"|2b|"; distance:7; within:1; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:attempted-recon; sid:2801713; rev:3;)

#
#alert tcp $MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Report Server Information"; flow:from_client,established; content:"|00 00|"; offset:2; depth:2; content:"|11|"; distance:7; within:1; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:attempted-recon; sid:2801714; rev:3;)

#
#alert tcp !$MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Unauthorized Read Request to a PLC"; flow:from_client,established; content:"|00 00|"; offset:2; depth:2; pcre:"/[\S\s]{3}(\x01|\x02|\x03|\x04|\x07|\x0B|\x0C|\x11|\x14|\x17|\x18|\x2B)/iR"; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:bad-unknown; sid:2801715; rev:2;)

#
#alert tcp !$MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Unauthorized Write Request to a PLC"; flow:from_client,established; content:"|00 00|"; offset:2; depth:2; pcre:"/[\S\s]{3}(\x05|\x06|\x0F|\x10|\x15|\x16)/iR"; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:bad-unknown; sid:2801716; rev:2;)

#
#alert tcp $MODBUS_CLIENT any <> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Illegal Packet Size, Possible DOS Attack"; flow:established; dsize:>300; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:non-standard-protocol; sid:2801717; rev:2;)

#
#alert tcp $MODBUS_CLIENT any -> $MODBUS_SERVER 502 (msg:"ETPRO SCADA Modbus TCP Non-Modbus Communication on TCP Port 502"; flow:established; pcre:"/[\S\s]{2}(?!\x00\x00)/i"; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:non-standard-protocol; sid:2801718; rev:3;)

#
#alert tcp $MODBUS_SERVER 502 -> $MODBUS_CLIENT any (msg:"ETPRO SCADA Modbus TCP Slave Device Busy Exception Code Delay"; flow:established; content:"|00 00|"; offset:2; depth:2; content:"|06|"; offset:8; depth:1; byte_test: 1, >=, 0x80, 7; threshold: type threshold, track by_src, count 3, seconds 60; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:successful-dos; sid:2801719; rev:2;)

#
#alert tcp $MODBUS_SERVER 502 -> $MODBUS_CLIENT any (msg:"ETPRO SCADA Modbus TCP Acknowledge Exception Code Delay"; flow:established; content:"|00 00|"; offset:2; depth:2; content:"|05|"; offset:8; depth:1; byte_test: 1, >=, 0x80, 7; threshold: type threshold, track by_src, count 3, seconds 60; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:successful-dos; sid:2801720; rev:2;)

#
#alert tcp $MODBUS_SERVER 502 <> $MODBUS_CLIENT any (msg:"ETPRO SCADA Modbus TCP Incorrect Packet Length, Possible DOS Attack"; flow:established; byte_jump:2,4; isdataat:0,relative; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:non-standard-protocol; sid:2801721; rev:1;)

#
#alert tcp $MODBUS_SERVER 502 -> $MODBUS_CLIENT any (msg:"ETPRO SCADA Modbus TCP Points List Scan"; flow:established; content:"|00 00|"; offset:2; depth:2; byte_test: 1, >=, 0x80, 7; content:"|02|"; offset:8; depth:1; threshold: type threshold, track by_src, count 5, seconds 60; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:attempted-recon; sid:2801722; rev:2;)

#
#alert tcp $MODBUS_SERVER 502 -> $MODBUS_CLIENT any (msg:"ETPRO SCADA Modbus TCP Function Code Scan"; flow:established; content:"|00 00|"; offset:2; depth:2; byte_test: 1, >=, 0x80, 7; content:"|01|"; offset:8; depth:1; threshold: type threshold, track by_src, count 3, seconds 60; reference:url,digitalbond.com/tools/quickdraw/modbus-tcp-rules; classtype:attempted-recon; sid:2801723; rev:2;)

#
#alert tcp any any -> $HOME_NET 5413 (msg:"ETPRO SCADA WonderWare SuiteLink DOS Attempt"; flow:established,to_server; byte_test:4,>,2742,56,little; reference:cve, CVE-2008-2005; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-dos; sid:2801724; rev:4;)

#
#alert tcp any any -> $HOME_NET 910 (msg:"ETPRO SCADA RealWin INFOTAG/SET_CONTROL Packet Processing Buffer Overflow"; content:"|10 23 54 67|"; depth:4; byte_test:4,>,739,0,little,relative; flow:established,to_server; reference:cve, CVE-2008-4322; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801725; rev:4;)

#
#alert tcp any any -> $HOME_NET 5481 (msg:"ETPRO SCADA ClearSCADA Heap Overflow Attempt"; flow:established,to_server; dsize:>500; content: "|a7 0d 44 06 10 00 00 00 08 00 00 00|"; depth: 12; isdataat: 1000; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801726; rev:3;)

#
#alert tcp any any -> $HOME_NET 9001 (msg:"ETPRO SCADA Wonderware InBatch Buffer Overflow Attempt"; flow:established,to_server; content:"|00 00 4b 14 00 00 00 00 00 00 00 01 00 00 00 00 00 01 00 00|"; depth:20; isdataat: 151; reference:cve, CVE-2010-4557; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801727; rev:3;)

#
#alert tcp any any -> any 46823 (msg:"ETPRO SCADA Sielco Sistemi WinLog Stack Overflow Attempt"; flow:established,to_server; content:"|02 01 01|"; depth:3; isdataat: 61; reference:cve, CVE-2011-0517; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801728; rev:2;)

#
#alert tcp any any -> $HOME_NET 912 (msg:"ETPRO SCADA RealWin HMI Service Buffer Overflow Attempt 1"; flow:established,to_server; content:"|64 12 54 6a 02 00 00 00|"; depth:8; byte_test:4,>,739,0,little,relative; reference:cve, CVE-2010-4142; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801730; rev:2;)

#
#alert tcp any any -> $HOME_NET 912 (msg:"ETPRO SCADA RealWin HMI Service Buffer Overflow Attempt 2"; flow:established,to_server; content:"|64 12 54 6a 20 00 00 00|"; depth:8; byte_test:4,>,739,0,little,relative; reference:cve, CVE-2010-4142; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801731; rev:2;)

#
#alert tcp any any -> $HOME_NET 912 (msg:"ETPRO SCADA RealWin HMI Service Buffer Overflow Attempt 3"; flow:established,to_server; content:"|64 12 54 6a 10 00 00 00|"; depth:8; byte_test:4,>,739,0,little,relative; reference:cve, CVE-2010-4142; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801732; rev:2;)

#
#alert udp any any -> $HOME_NET 3250 (msg:"ETPRO SCADA NetBiter Config HICP Hostname Buffer Overflow"; content:"hn|20 3d|"; content:!"|3b|"; within: 19; reference:cve, CVE-2009-4462; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801733; rev:2;)

#
#alert tcp any any -> $HOME_NET 777 (msg:"ETPRO SCADA WellinTech KingView Remote Heap Overflow Attempt"; flow:established,to_server; stream_size: client,>,32800; content:"|eb 14|"; content: "|ad bb c3 77 b4 73 ed 77|"; within: 15; reference:cve, CVE-2011-0406; reference:url,digitalbond.com/tools/quickdraw/vulnerability-rules; classtype:attempted-user; sid:2801734; rev:3;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA System Directory Traversal and Download"; flow:to_server,established; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; content:"|2e 2e|"; distance:0; content:"|2e 2e|"; distance:1; within:2; pcre:"/\x2e\x2e[\x2f\x5c]\x2e\x2e[\x2f\x5c]/"; reference:url,us-cert.gov/control_systems/pdf/ICSA-11-132-01A.pdf; reference:url,aluigi.altervista.org/adv/igss_1-adv.txt ; reference:url,aluigi.altervista.org/adv/igss_8-adv.txt; reference:osvdb,72354; reference:osvdb,72349; classtype:attempted-user; sid:2801787; rev:4;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA system Directory Traversal Upload and Overwrite"; flow:to_server,established; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; content:"|2e 2e|"; distance:0; content:"|2e 2e|"; distance:1; within:2; pcre:"/\x2e\x2e[\x2f\x5c]\x2e\x2e[\x2f\x5c]/"; reference:bugtraq,46936; reference:url,us-cert.gov/control_systems/pdf/ICSA-11-132-01A.pdf; reference:url,aluigi.altervista.org/adv/igss_1-adv.txt ; reference:url,aluigi.altervista.org/adv/igss_8-adv.txt; reference:osvdb,72354; reference:osvdb,72349; classtype:attempted-user; sid:2801788; rev:4;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA ListAll Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|01|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801789; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA Write File Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801790; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA ReadFile Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801791; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA Delete Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801792; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA RenameFile Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|05|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801793; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA FileInfo Function Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 0D|"; offset:2; depth:5; content:"|06|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801794; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Add Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801795; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template ReadFile Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|06|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801796; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template WriteFile Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|05|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801797; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template Add Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801798; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template Rename Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|02|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801799; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA RMS Report Template Delete Command Buffer Overflow"; flow:to_server,established; byte_test:2,>,534,0,little; content:"|01 00 34 12 07|"; offset:2; depth:5; content:"|03|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801800; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA IGSS SCADA STDREP Request Buffer Overflow"; flow:to_server,established; byte_test:2,>,278,0,little; content:"|01 00 34 12 08|"; offset:2; depth:5; content:"|04|"; distance:11; within:1; reference:bugtraq,46936; classtype:attempted-user; sid:2801801; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12397 (msg:"ETPRO SCADA IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0xa"; flow:to_server,established; content:"|0a|"; offset:12; depth:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; reference:bugtraq,46936; reference:cve,2011-1566; classtype:attempted-user; sid:2801802; rev:4;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12397 (msg:"ETPRO SCADA IGSS SCADA dc.exe Server Directory Traversal Arbitrary File Execution - 0x17"; flow:to_server,established; content:"|17|"; offset:12; depth:1; content:"|2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; distance:0; reference:bugtraq,46936; reference:cve,2011-1566; classtype:attempted-user; sid:2801803; rev:3;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 912 (msg:"ETPRO SCADA RealFlex RealWin SCADA SCPC_TXTEVENT strcpy() Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|64 12 54 6a 10 00 00 00|"; offset:0; byte_test:4,>,200,0,relative,little; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801804; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CONNECT_FCS_LOGIN Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|01 00 01 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801805; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CADDTAG Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 01 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801806; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_CDELTAG Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 02 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801807; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CTAGLIST_FCS_ADDTAGMS Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|05 00 05 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801808; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_RFUSER_FCS_LOGIN Buffer Overflow"; flow:to_server,established; isdataat:59; content:"|10 23 54 67|"; offset:0; byte_test:4,>,44,0,relative,little; content:"|11 00 01 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801809; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 1"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 01 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801810; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 2"; flow:to_server; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 03 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801811; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 3"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 08 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801812; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 4"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0A 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801813; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 5"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0B 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801814; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_BINFILE_FCS_*FILE Buffer Overflow 6"; flow:to_server,established; isdataat:270; content:"|10 23 54 67|"; offset:0; byte_test:4,>,256,0,relative,little; content:"|10 00 0D 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801815; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_MISC_FCS_MSGBROADCAST Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|0F 00 01 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801816; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_MISC_FCS_MSGSEND Buffer Overflow"; flow:to_server,established; isdataat:768; content:"|10 23 54 67|"; offset:0; byte_test:4,>,768,0,relative,little; content:"|0F 00 03 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801817; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|02 00 0F 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801818; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_GETCHANNELTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|02 00 10 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801819; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|04 00 12 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801820; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_CGETTAG_FCS_SETCHANNELTELEMETRY Buffer Overflow"; flow:to_server,established; isdataat:215; content:"|10 23 54 67|"; offset:0; byte_test:4,>,200,0,relative,little; content:"|04 00 13 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801821; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin SCADA On_FC_SCRIPT_FCS_STARTPROG Buffer Overflow"; flow:to_server,established; isdataat:1000; content:"|10 23 54 67|"; offset:0; byte_test:4,>,1000,0,relative,little; content:"|09 00 12 00|"; distance:6; within:4; reference:bugtraq,46937; reference:secunia,43848; classtype:attempted-user; sid:2801822; rev:2;)

#- First rev of this was a bit off..rev 2 is actually working - duc
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 1"; flow:to_server,established; dsize:62;content:"|b0 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00 ff 0f 00 00|"; reference:url,aluigi.org/adv/genesis_1-adv.txt; classtype:attempted-user; sid:2801834; rev:4;)

#- first rev was wrong, this is cleaned up and fixed. -duc
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 2"; flow:to_server,established; dsize:28;content:"|B2 04 00 00 FF 0F 00 00|"; reference:url,aluigi.org/adv/genesis_1-adv.txt; classtype:attempted-user; sid:2801835; rev:4;)

#- first rev was wrong, this is fixed now. 
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 3"; flow:to_server,established;dsize:38;content:"|b5 04 00 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00|"; reference:url,aluigi.org/adv/genesis_1-adv.txt; classtype:attempted-user; sid:2801836; rev:4;)

#- first rev was broken, this is fixed. - duc
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 4"; flow:to_server,established; dsize:28;content:"|AE 0D 00 00 FF 0F 00 00|"; reference:url,aluigi.org/adv/genesis_1-adv.txt; classtype:attempted-user; sid:2801837; rev:4;)

#- first version was wrong - this rev fixed. 
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Freeing of Unitialized Memory Trigger Option 5"; flow:to_server,established; dsize:37;content:"|bc 1b 00 00 00 00 00 00 00 00 00 00 00 ff 0f 00 00|"; reference:url,aluigi.org/adv/genesis_1-adv.txt; classtype:attempted-user; sid:2801838; rev:4;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x9a08"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|9A 08|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801848; rev:2;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x5304"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|53 04|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801849; rev:2;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x04b0"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B0 04|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801850; rev:1;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x04b2"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B2 04|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801851; rev:2;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x04b5"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|B5 04|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801852; rev:2;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x7d0"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|d0 07|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801853; rev:1;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0xdae"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|ae 0d|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801854; rev:1;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0xfa4"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|a4 0f|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801855; rev:1;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0xfa7"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|a7 0f|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801856; rev:1;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x1bbc"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|bc 1b|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801857; rev:1;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x1c84"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|84 1c|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801858; rev:1;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x26ac"; flow:to_server,established; content:"|01 00 00 15 00 00 00 01 00 00 1F F4 01 00 00 00|"; content:"|ac 26|"; distance:4; within:2; isdataat:1024; reference:url,eluigi.org/adv/genesis_2-adv.txt; classtype:attempted-user; sid:2801859; rev:1;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG path Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1028,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; distance:0; byte_test:4,>,1024,0,big; reference:bugtraq,46934; classtype:attempted-user; sid:2801868; rev:3;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG filter Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1024,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; distance:0; byte_test:4,<,1029,0,big; byte_jump:4,0,big,relative; content:"|06|"; distance:0; within:1; byte_test:4,>,1024,0,big; reference:bugtraq,46934; classtype:attempted-user; sid:2801869; rev:3;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFile path Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1028,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 08  00 00 00 02  06|"; distance:0; byte_test:4,>,1024,0,big; reference:bugtraq,46934; classtype:attempted-user; sid:2801870; rev:3;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFileInfo path Buffer Overflow"; flow:to_server,established; content:"LEN|00|"; depth:4; byte_test:4,>,1028,0,little; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 0a  00 00 00 01  06|"; distance:0; byte_test:4,>,1024,0,big; reference:bugtraq,46934; classtype:attempted-user; sid:2801871; rev:3;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG path possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; reference:bugtraq,46934; classtype:attempted-recon; sid:2801872; rev:2;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService CSMSG filter possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 06  00 00 00 03  06|"; byte_test:4,<,1029,0,big; byte_jump:4,0,big,relative; content:"|06|"; distance:0; within:1; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; reference:bugtraq,46934; classtype:attempted-user; sid:2801873; rev:2;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFile possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 08  00 00 00 02  06|"; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; reference:bugtraq,46934; classtype:attempted-user; sid:2801874; rev:2;)

#
alert tcp any any -> $HOME_NET 7580 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink CSService GetFileInfo possible file download"; flow:to_server,established; content:"LEN|00|"; depth:4; content:"|99|"; distance:8; within:1; content:"|99  00 00 00 0a  00 00 00 01  06|"; pcre:"/^.{8}([A-Z]\x00?\x3a\x00?\x5c\x00?\x5c\x00?|\x2e\x00?\x2e\x00?\x5c\x00?)/Ri"; reference:bugtraq,46934; classtype:attempted-user; sid:2801875; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink vrn.exe opcode 10 buffer overflow"; flow:to_server,established; content:"|ff 55 0a 00|"; offset:4; depth:4; byte_test:4,>,512,2,relative,little; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; reference:bugtraq,46934; classtype:attempted-user; sid:2801907; rev:3;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink vrn.exe opcode 10 buffer overflow 2"; flow:to_server,established; content:"|ff 55 0a 00|"; offset:4; depth:4; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; pcre:"/^..[^\s\x3b]{512}/Rs"; reference:bugtraq,46934; classtype:attempted-user; sid:2801908; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink vrn.exe opcode 9 buffer overflow"; flow:to_server,established; content:"|ff 55 09 00|"; offset:4; depth:4; byte_test:4,>,512,2,relative,little; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; reference:bugtraq,46934; classtype:attempted-user; sid:2801909; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink vrn.exe opcode 9 buffer overflow 2"; flow:to_server; content:"|ff 55 09 00|"; offset:4; depth:4; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; pcre:"/^..[^\s\x3b]{512}/Rs"; reference:bugtraq,46934; classtype:attempted-user; sid:2801910; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink vrn.exe opcode 8 arbitrary file download"; flow:to_server; content:"|ff 55 08 00|"; offset:4; depth:4; byte_test:4,>,512,2,relative,little; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; pcre:"/^..([A-Z]\x3a[\x5c\x2f]|\x2e\x2e[\x5c\x2f]|[\x5c\x2f]{2}(\x3f[\x5c\x2f])?([A-Z]\x3a[\x5c\x2f])?)/Rsi"; reference:bugtraq,46934; classtype:attempted-recon; sid:2801911; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 7579 (msg:"ETPRO SCADA Siemens Tecnomatix FactoryLink vrn.exe opcode 8 arbitrary file download 2"; flow:to_server; content:"|ff 55 08 00|"; offset:4; depth:4; content:"|01 00|"; distance:8; within:2; content:"|01 00 01 00|"; distance:16; within:4; pcre:"/^..([A-Z]\x3a[\x5c\x2f]|\x2e\x2e[\x5c\x2f]|[\x5c\x2f]{2}(\x3f[\x5c\x2f])?([A-Z]\x3a[\x5c\x2f])?)/Rsi"; reference:bugtraq,46934; classtype:attempted-recon; sid:2801912; rev:2;)

#
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Bacnet OPC Client Malicious .csv File Detected"; flow:from_server,established; content:"OPC_TAG_NAME,OBJECT_TYPE,INSTANCE,OBJECT_NAME|0a 5c|"; reference:cve,2010-4740; reference:bugtraq,43289; reference:secunia,41466; classtype:attempted-user; sid:2801928; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA ICONICS WebHMI ActiveX Stack Overflow"; flow:to_client,established; content:"D25FCAFC-F795-4609-89BB-5F78B4ACAF2C"; nocase; content:"SetActiveXGUID"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D25FCAFC-F795-4609-89BB-5F78B4ACAF2C/si"; reference:url,www.security-assessment.com/files/documents/advisory/ICONICS_WebHMI.pdf; reference:url,www.exploit-db.com/exploits/17240/; classtype:attempted-user; sid:2012787; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA ICONICS WebHMI ActiveX Stack Overflow 2"; flow:to_client,established; content:"CEFF5F48-BD2E-4D10-BAE5-AF729975E223"; nocase; content:"SetActiveXGUID"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*CEFF5F48-BD2E-4D10-BAE5-AF729975E223/si"; reference:url,www.us-cert.gov/control_systems/pdf/ICSA-11-131-01.pdf; reference:url,www.security-assessment.com/files/documents/advisory/ICONICS_WebHMI.pdf; reference:url,www.exploit-db.com/exploits/17240/; classtype:attempted-user; sid:2802179; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin FC_RFUSER_FCS_LOGIN Buffer Overflow"; flow:established, to_server; content:"|10 23 54 67|"; offset:0; depth:4; byte_test:4,>,0x190,0,relative,little; flowbits:set,ETPRO.real_win_rfuser.scada; flowbits:noalert; reference:url,aluigi.altervista.org/adv/realwin_4-adv.txt; classtype:attempted-user; sid:2802832; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ETPRO SCADA RealFlex RealWin FC_RFUSER_FCS_LOGIN Buffer Overflow"; flow:established,to_server; flowbits:isset,ETPRO.real_win_rfuser.scada; content:"|11 00 01 00|"; offset:10; depth:4; pcre:"/[^\x00]{400}/R"; reference:url,aluigi.altervista.org/adv/realwin_4-adv.txt; classtype:attempted-user; sid:2802833; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA 7T Interactive Graphical SCADA System File Operations Buffer Overflow 1"; flow:established, to_server; isdataat:512; content:"|01 00|"; depth:2; offset:2; content:"|0d 00 00 00|"; offset:6; depth:4; byte_test:4,<,0x00000007,18,little; content:!"|00|"; distance:12; within:512; reference:cve,CVE-2011-1567; reference:url,aluigi.org/adv/igss_2-adv.txt; classtype:attempted-admin; sid:2802837; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA 7T Interactive Graphical SCADA System File Operations Buffer Overflows 2"; flow:established, to_server; isdataat:512; content:"|01 00|"; depth:2; offset:2; content:"|0d 00 00 00|"; offset:6; depth:4; byte_test:4,=,0x00000005,18,little; content:"|00|"; within:512; distance:12; content:!"|00|"; within:512; distance:0; reference:cve,CVE-2011-1567; reference:url,aluigi.org/adv/igss_2-adv.txt; classtype:attempted-admin; sid:2802838; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 (msg:"ETPRO SCADA 7T Interactive Graphical SCADA System Arbitrary File Read And Overwrite"; flow:established,to_server; content:"|01 00|"; offset:2; depth:2; content:"|0d 00 00 00|"; offset:6; depth:4; byte_test:4,<,0x00000004,18,little; byte_test:4,>,0x00000001,18,little; content:".."; distance:0; reference:cve,CVE-2011-1565; reference:url,www.igss.com/company/news-and-press-center/11-03-25/IGSS_%E2%80%93_ongoing_focus_on_security.aspx; classtype:attempted-admin; sid:2802904; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 910 (msg:"ET SCADA DATAC RealWin SCADA Server 2 On_FC_CONNECT_FCS_a_FILE Buffer Overflow Vulnerability"; flow:established,to_server; content:"GetFlexMLangIResourceBrowser"; isdataat:1000,relative; content:!"|0A|"; within:1000; reference:url,exploit-db.com/exploits/17417/; classtype:denial-of-service; sid:2013074; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 7580 (msg:"ET SCADA Siemens FactoryLink 8 CSService Logging  Buffer Overflow Vulnerability"; flow:established,to_server; content:"CSService"; nocase; isdataat:1000,relative; content:!"|0A|"; within:1000; reference:url,packetstormsecurity.org/files/view/102579/factorylink_csservice.rb.txt; classtype:denial-of-service; sid:2013120; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 4444 (msg:"ET SCADA Golden FTP Server PASS Command Remote Buffer Overflow Attempt"; flow:established,to_server; content:"PASS"; nocase; isdataat:1000,relative; content:!"|0A|"; within:1000; reference:bugtraq,45957; classtype:denial-of-service; sid:2013235; rev:2;)

#
alert tcp any any -> $HOME_NET 38080 (msg:"ETPRO SCADA Iconics Genesis SCADA Integer Overflow 0x04b0 2"; flow:to_server,established; content:"|01 00 00 1e 00 00 00 01 00 00 1f f4 01 00 00 00|"; content:"|B0 04|"; distance:4; within:2; isdataat:1024; reference:url,www.aluigi.org/adv/genesis_4-adv.txt; reference:url,www.exploit-db.com/exploits/17543/; classtype:attempted-user; sid:2803195; rev:1;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA BroadWin WebAccess Client Bwocxrun ActiveX Format String"; flow:to_client,established; content:"5c2a52bd-2250-4f6b-a4d2-d1d00fcd748c"; nocase; content:"OcxSpool"; nocase; distance:0; pcre:"/OcxSpool\s*\(\s*\"([^"]|\\")*%/si"; reference:url,www.osvdb.org/74897; reference:url,aluigi.altervista.org/adv/bwocxrun_1-adv.txt; classtype:attempted-user; sid:2803600; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA BroadWin WebAccess Client Bwocxrun ActiveX arbitrary memory corruption 1"; flow:to_client,established; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; nocase; content:"|2e|WriteTextData"; distance:0; content:"|30|x"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C/si"; reference:url,aluigi.altervista.org/adv/bwocxrun_1-adv.txt; classtype:attempted-user; sid:2803601; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA BroadWin WebAccess Client Bwocxrun ActiveX arbitrary memory corruption 2"; flow:to_client,established; content:"5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C"; nocase; content:"|2e|CloseFile"; distance:0; content:"|30|x"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*5C2A52BD-2250-4F6B-A4D2-D1D00FCD748C/si"; reference:url,aluigi.altervista.org/adv/bwocxrun_1-adv.txt; classtype:attempted-user; sid:2803602; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA BroadWin WebAccess Client Bwocxrun ActiveX Format String 2"; flow:from_server,established; content:"BWOCXRUN.BwocxrunCtrl"; nocase; content:"OcxSpool"; nocase; distance:0; pcre:"/OcxSpool\s*\(\s*\"([^"]|\\")*%/si"; reference:url,www.osvdb.org/74897; reference:url,www.aluigi.altervista.org/adv/bwocxrun_1-adv.txt; classtype:attempted-user; sid:2803610; rev:3;)

#
alert tcp any any -> $HOME_NET 11234 (msg:"ETPRO SCADA Measuresoft ScadaPro (0day) Directory Transversal Arbitrary Reading of Files"; flow:to_server,established; content:"RF|25|SCADAPRO|5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; reference:url,aluigi.altervista.org/adv/scadapro_1-adv.txt; classtype:misc-attack; sid:2803665; rev:1;)

#
alert tcp any any -> $HOME_NET 11234 (msg:"ETPRO SCADA Measuresoft ScadaPro Directory (0day) Transversal Arbitrary Creation of Files"; flow:to_server,established; content:"wF|25|SCADAPRO|5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; reference:url,aluigi.altervista.org/adv/scadapro_1-adv.txt; classtype:misc-attack; sid:2803666; rev:1;)

#
alert tcp any any -> $HOME_NET 11234 (msg:"ETPRO SCADA Measuresoft ScadaPro Directory (0day) Transversal Arbitrary Deletion of Files"; flow:to_server,established; content:"uF|25|SCADAPRO|5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C 2E 2E 5C|"; reference:url,aluigi.altervista.org/adv/scadapro_1-adv.txt; classtype:misc-attack; sid:2803667; rev:1;)

#Changed things to make this a bit more robust for the vulnerability being exploited - dc. 
alert tcp any any -> $HOME_NET 11234 (msg:"ETPRO SCADA Measuresoft ScadaPro Directory (0day) Transversal Arbitrary Command Execution"; flow:to_server,established; content:"xf|25|"; content:"|5C|system32|5C|msvcrt.dll|2C|system|2C|start"; distance:0; reference:url,aluigi.altervista.org/adv/scadapro_1-adv.txt; classtype:attempted-admin; sid:2803668; rev:3;)

#
alert http any any -> $HOME_NET 808 (msg:"ETPRO SCADA Progea Movicon PowerHMI Memory Corruption Negative Content Length"; flow:to_server,established; content:"Content-Length|3a 20|-"; nocase; http_header; reference:url,aluigi.altervista.org/adv/movicon_1-adv.txt; reference:url,aluigi.altervista.org/poc/movicon_1.dat; classtype:attempted-admin; sid:2803669; rev:5;)

#
alert tcp any any -> $HOME_NET 808 (msg:"ETPRO SCADA Progea Movicon PowerHMI Potential EIDP (0day) Memory Write/Corruption Vulnerability"; flow:to_server,established; content:"Content-Type|3A| octet-stream"; content:"EIDP|B8 00 00|"; distance:0; content:"|3A|808|00 00|"; within:42; reference:url,aluigi.altervista.org/adv/movicon_3-adv.txt; reference:url,aluigi.altervista.org/poc/movicon_1.dat; classtype:misc-attack; sid:2803670; rev:2;)

#
alert tcp any any -> $HOME_NET 20034 (msg:"ETPRO SCADA DAQFactory NETB Stack Overflow"; flow:to_server,established; content:"NETB"; depth:4; isdataat:1025,relative; reference:url,aluigi.altervista.org/adv/daqfactory_1-adv.txt; reference:url,aluigi.org/poc/daqfactory_1.dat; classtype:attempted-admin; sid:2803671; rev:1;)

#
alert tcp any any -> $HOME_NET 4052 (msg:"ETPRO SCADA Cogent DataHub DH_OneSecondTick Utf8 Overflow Domain Trigger"; flow:to_server,established; content:"|28|domain|20 22|"; isdataat:247,relative; reference:url,aluigi.altervista.org/adv/cogent_1-adv.txt; reference:url,aluigi.org/poc/cogent_1.dat; classtype:attempted-admin; sid:2803672; rev:1;)

#
alert tcp any any -> $HOME_NET 4052 (msg:"ETPRO SCADA Cogent DataHub DH_OneSecondTick Utf8 Overflow Report_Domain Trigger"; flow:to_server,established; content:"|28|report_domain|20 22|"; isdataat:247,relative; reference:url,aluigi.altervista.org/adv/cogent_1-adv.txt; reference:url,aluigi.org/poc/cogent_1.dat; classtype:attempted-admin; sid:2803673; rev:1;)

#
alert tcp any any -> $HOME_NET 4052 (msg:"ETPRO SCADA Cogent DataHub DH_OneSecondTick Utf8 Overflow Register_Datahub  Trigger"; flow:to_server,established; content:"|28|register_datahub|20 22|"; isdataat:247,relative; reference:url,aluigi.altervista.org/adv/cogent_1-adv.txt; reference:url,aluigi.org/poc/cogent_1.dat; classtype:attempted-admin; sid:2803674; rev:1;)

#
alert tcp any any -> $HOME_NET 4052 (msg:"ETPRO SCADA Cogent DataHub DH_OneSecondTick Utf8 Overflow Slave Trigger"; flow:to_server,established; content:"|28|slave|20 22|"; isdataat:247,relative; content:"flags id1 id2 version secs nsecs"; distance:247; within:40; reference:url,aluigi.altervista.org/adv/cogent_1-adv.txt; reference:url,aluigi.org/poc/cogent_1.dat; classtype:attempted-admin; sid:2803675; rev:1;)

#
alert udp any any -> $HOME_NET 48899 (msg:"ETPRO SCADA Beckhoff TwinCAT Denial of Service Invalid Read Access"; dsize:>512; content:"|03 66 14 71|"; depth:4; content:"|ff ff ff ff|"; distance:16; within:4; reference:url,aluigi.altervista.org/adv/twincat_1-adv.txt; reference:cve,2011-3486; classtype:denial-of-service; sid:2803676; rev:4;)

#
alert tcp any any -> $HOME_NET 4446 (msg:"ETPRO SCADA Rockwell RSLogix Denial of Service Trigger 1"; flow:to_server,established; content:"rna|F2 FF FF FF FF|"; reference:url,aluigi.altervista.org/adv/rslogix_1-adv.txt; classtype:denial-of-service; sid:2803693; rev:1;)

#
alert tcp any any -> $HOME_NET 4446 (msg:"ETPRO SCADA Rockwell RSLogix Denial of Service Trigger 2"; flow:to_server,established; content:"rna|F2 FF FF FF 7F|"; reference:url,aluigi.altervista.org/adv/rslogix_1-adv.txt; classtype:denial-of-service; sid:2803694; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"ETPRO SCADA Sunway ForceControl SNMP NetDBServer Integer Signedness Buffer Overflow 1"; flow:to_server,established; content:"|eb 50 eb 50 57 00|"; depth:6; byte_test:1,>,0x20,12; reference:url,www.aluigi.altervista.org/adv/forcecontrol_1-adv.txt; classtype:attempted-user; sid:2803774; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"ETPRO SCADA Sunway ForceControl SNMP NetDBServer Integer Signedness Buffer Overflow 2"; flow:to_server,established; content:"|eb 50 eb 50 57 00|"; depth:6; byte_test:1,<,0x20,12; byte_jump:1,12; byte_test:1,>,0x20,0,relative; reference:url,www.aluigi.altervista.org/adv/forcecontrol_1-adv.txt; classtype:attempted-user; sid:2803775; rev:1;)

#
alert tcp any any -> $HOME_NET [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"ETPRO SCADA Rockwell RNA Message Large Header Length - 8Kb"; flow:to_server; content:"rna|f2|"; byte_test:4,>,0x2000,0,relative,little; classtype:attempted-dos; sid:2803783; rev:2;)

#
alert tcp any any -> $HOME_NET [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"ETPRO SCADA Rockwell RNA Message Negative Header Length"; flow:to_server; content:"rna|f2|"; byte_test:1,&,0x80,3,relative,little; classtype:attempted-dos; sid:2803784; rev:2;)

#
alert tcp any any -> $HOME_NET [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"ETPRO SCADA Rockwell RNA Message Large Body Length - 8Mb"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; byte_test:4,>,0x800000,0,relative,little; classtype:attempted-dos; sid:2803785; rev:2;)

#
alert tcp any any -> $HOME_NET [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"ETPRO SCADA Rockwell RNA Message Negative Body Length"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; byte_test:1,&,0x80,3,relative,little; classtype:attempted-dos; sid:2803786; rev:2;)

#
alert tcp any any -> $HOME_NET [1330,1331,1332,4241,4242,4445,4446,5241,6543,9111,60093,49281] (msg:"ETPRO SCADA Rockwell RNA Message Header Not Null Terminated"; flow:to_server; content:"rna|f2|"; byte_jump:4,0,relative,little; content:!"|00|"; distance:-1; within:1; classtype:attempted-dos; sid:2803787; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA PcVue Activex Control Insecure method (AddPage)"; flow:to_client,established; file_data; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"083B40D3-CCBA-11D2-AFE0-00C04F7993D6"; nocase; distance:0; content:".AddPage"; nocase; content:"<OBJECT"; nocase; pcre:"/^[^>]*?classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*?083B40D3-CCBA-11D2-AFE0-00C04F7993D6/Rsi"; reference:url,exploit-db.com/exploits/17896; classtype:attempted-user; sid:2013730; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA PcVue Activex Control Insecure method (DeletePage)"; flow:to_client,established; file_data; content:"083B40D3-CCBA-11D2-AFE0-00C04F7993D6"; nocase; distance:0; content:".DeletePage"; nocase; content:"<OBJECT"; pcre:"/^[^>]*?classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*083B40D3-CCBA-11D2-AFE0-00C04F7993D6/Rsi"; reference:url,exploit-db.com/exploits/17896; classtype:attempted-user; sid:2013731; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA PcVue Activex Control Insecure method (SaveObject)"; flow:to_client,established; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"2BBD45A5-28AE-11D1-ACAC-0800170967D9"; nocase; distance:0; content:".SaveObject"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2BBD45A5-28AE-11D1-ACAC-0800170967D9/si"; reference:url,exploit-db.com/exploits/17896; classtype:attempted-user; sid:2013732; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA PcVue Activex Control Insecure method (LoadObject)"; flow:to_client,established; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"2BBD45A5-28AE-11D1-ACAC-0800170967D9"; nocase; distance:0; content:".LoadObject"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2BBD45A5-28AE-11D1-ACAC-0800170967D9/si"; reference:url,exploit-db.com/exploits/17896; classtype:attempted-user; sid:2013733; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA PcVue Activex Control Insecure method (GetExtendedColor)"; flow:to_client,established; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"2BBD45A5-28AE-11D1-ACAC-0800170967D9"; nocase; distance:0; content:".GetExtendedColor"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2BBD45A5-28AE-11D1-ACAC-0800170967D9/si"; reference:url,exploit-db.com/exploits/17896; classtype:attempted-user; sid:2013734; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA Sunway ForceControl Activex Control Vulnerability"; flow:to_client,established; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"BD9E5104-2F20-4A9F-AB14-82D558FF374E"; nocase; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*BD9E5104-2F20-4A9F-AB14-82D558FF374E/si"; reference:bugtraq,49747; classtype:attempted-user; sid:2013735; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA Sunway ForceControl Activex Control Remote Code Execution Vulnerability 2"; flow:to_client,established; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"3310FA24-A027-47B3-8C49-1091077317E9"; nocase; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3310FA24-A027-47B3-8C49-1091077317E9/si"; reference:bugtraq,49747; classtype:attempted-user; sid:2013736; rev:4;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 20222 (msg:"ETPRO SCADA IGSS 8 ODBC Server Multiple Remote Uninitialized Pointer Free DoS - SET"; flow:established,to_server; content:"|00 00 00 34|"; depth:4; content:"IGSS32v8 ODBC Network DS"; distance:0; flowbits:set,ETPRO.IGSS.DoS; flowbits:noalert; reference:url,www.securiteam.com/exploits/5VP3H153PA.html; classtype:attempted-user; sid:2803964; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 20222 (msg:"ETPRO SCADA IGSS 8 ODBC Server Multiple Remote Uninitialized Pointer Free DoS"; flow:established,to_server; flowbits:isset,ETPRO.IGSS.DoS; content:"|16|"; offset:5; depth:1; byte_jump:4,0; byte_test:4,>,0x7ffdefff,1,relative; reference:url,www.securiteam.com/exploits/5VP3H153PA.html; classtype:attempted-user; sid:2803965; rev:1;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Microsys PROMOTIC 8.1.4 ActiveX GetPromoticSite Unitialized Pointer"; flow:established,to_client; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"clsid"; nocase; distance:0; content:"19BA6EE6-4BB4-11D1-8085-0020AFC8C4AF"; nocase; distance:0; content:".GetPromoticSite"; nocase; distance:0; reference:url,www.exploit-db.com/exploits/18049/; classtype:attempted-user; sid:2803966; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA PROMOTIC ActiveX Control Insecure method (SaveCfg)"; flow:to_client,established; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"02000002-9DFA-4B37-ABE9-1929F4BCDEA2"; nocase; distance:0; content:".SaveCfg"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*02000002-9DFA-4B37-ABE9-1929F4BCDEA2/si"; reference:url,aluigi.altervista.org/adv/promotic_1-adv.txt; classtype:attempted-user; sid:2013878; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCADA PROMOTIC ActiveX Control Insecure method (AddTrend)"; flow:to_client,established; content:"<OBJECT "; nocase; content:"classid"; nocase; distance:0; content:"CLSID"; nocase; distance:0; content:"02000002-9DFA-4B37-ABE9-1929F4BCDEA2"; nocase; distance:0; content:".AddTrend"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*02000002-9DFA-4B37-ABE9-1929F4BCDEA2/si"; reference:url,aluigi.altervista.org/adv/promotic_1-adv.txt; classtype:attempted-user; sid:2013879; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 4410 (msg:"ETPRO SCADA Siemens Automation License Manager Service Exception attempt 1"; flow:to_server,established; content:"<|00|?|00|x|00|m|00|l|00 20 00|"; content:"v|00|e|00|r|00|s|00|i|00|o|00|n|00 3d 00 22 00 31 00 2e 00 30 00 22 00 20 00|"; distance:0; content:"|22 00 20 00 3f 00 3e 00|o|00|p|00|e|00|n|00 5f 00|s|00|e|00|s|00|s|00|i|00|o|00|n|00 3f 00 3e 00|w|00|o|00|r|00|k|00|s|00|t|00|a|00|t|00|i|00|o|00|n|00 20 00|N|00|A|00|M|00|E|00 3d 00 22 00|"; isdataat:1024,relative; content:!"|00 22 00 2f 00 3e 00|"; within:1024; reference:url,www.aluigi.altervista.org/adv/almsrvx_1-adv.txt; classtype:attempted-user; sid:2804075; rev:7;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 4410 (msg:"ETPRO SCADA Siemens Automation License Manager Service *_licensekey serialid code execution"; flow:to_server,established; content:"<|00|?|00|x|00|m|00|l|00 20 00|"; content:"v|00|e|00|r|00|s|00|i|00|o|00|n|00 3d 00 22 00 31 00 2e 00 30 00 22 00 20 00|"; distance:0; content:"<|00|s|00|e|00|r|00|i|00|a|00|l|00|i|00|d|00|>"; distance:0; isdataat:1024,relative; content:!"<|00|/|00|s|00|e|00|r|00|i|00|a|00|l|00|i|00|d|00|>"; within:1024; reference:url,www.aluigi.altervista.org/adv/almsrvx_1-adv.txt; classtype:attempted-user; sid:2804076; rev:3;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 4410 (msg:"ETPRO SCADA Siemens Automation License Manager Service Exception attempt 2"; flow:to_server,established; content:"<|00|?|00|x|00|m|00|l|00 20 00|"; content:"v|00|e|00|r|00|s|00|i|00|o|00|n|00 3d 00 22 00 31 00 2e 00 30 00 22 00 20 00|"; distance:0; content:"|22 00 20 00 3f 00 3e 00|o|00|p|00|e|00|n|00 5f 00|s|00|e|00|s|00|s|00|i|00|o|00|n|00 3f 00 3e 00|w|00|o|00|r|00|k|00|s|00|t|00|a|00|t|00|i|00|o|00|n|00 20 00|V|00|E|00|R|00|S|00|I|00|O|00|N|00 3d 00 22 00|"; isdataat:1024,relative; content:!"|00 22 00 3e 00|"; within:1024; reference:url,www.aluigi.altervista.org/adv/almsrvx_1-adv.txt; classtype:attempted-user; sid:2804077; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Siemens Automation License Manager Service almaxcx.dll files overwriting via ActiveX component"; flow:to_client,established; content:"E57AF4A2-EF57-41D0-8512-FECDA78F1FE7"; content:".Save"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E57AF4A2-EF57-41D0-8512-FECDA78F1FE7/si"; reference:url,www.aluigi.altervista.org/adv/almsrvx_1-adv.txt; classtype:attempted-user; sid:2804078; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Siemens Automation License Manager Service almaxcx.dll files overwriting via ActiveX component 2"; flow:to_client,established; content:"ALMListView.ALMListCtrl"; nocase; content:"|2e|Save"; distance:0; pcre:"/(ActiveXObject|CreateObject)\s*\(\s*(\x22|\x27)ALMListView\.ALMListCtrl/i"; reference:url,www.www.aluigi.altervista.org/adv/almsrvx_1-adv.txt; classtype:attempted-user; sid:2804079; rev:4;)

#
alert tcp any any -> any 44818 (msg:"ETPRO SCADA Rockwell Automation ControlLogix Denial of Service (CPU Stop)"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 02 00 02 00 00 00 00 00 b2 00 1a 00 52 02 20 06 24 01 03 f0 0c 00 07 02 20 64 24 01 DE AD BE EF CA FE 01 00 01 00|"; distance:0; reference:url,threatpost.com/en_us/blogs/dhs-thinks-some-scada-problems-are-too-big-call-bug-092611; reference:url,reversemode.com/index.php?option=com_content&task=view&id=81&Itemid=2; reference:url,rockwellautomation.com/enabled/pdf/eipexp1_2.pdf; classtype:attempted-dos; sid:2804488; rev:5;)

#
alert tcp any any -> any 44818 (msg:"ETPRO SCADA Rockwell Automation ControlLogix Denial of Service (Crash CPU)"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 02 00 02 00 00 00 00 00 b2 00 1a 00 52 02 20 06 24 01 03 f0 0c 00 0a 02 20 02 24 01 f4 f0 09 09 88 04 01 00 01 00|"; distance:0; reference:url,threatpost.com/en_us/blogs/dhs-thinks-some-scada-problems-are-too-big-call-bug-092611; reference:url,reversemode.com/index.php?option=com_content&task=view&id=81&Itemid=2; reference:url,rockwellautomation.com/enabled/pdf/eipexp1_2.pdf; classtype:attempted-dos; sid:2804489; rev:4;)

#
alert tcp any any -> any 44818 (msg:"ETPRO SCADA Rockwell Automation ControlLogix EtherNET/IPmodules boot code dump"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 00 04 02 00 00 00 00 00 b2 00 08 00 97 02 20 c0 24 00 00 00|"; distance:0; reference:url,threatpost.com/en_us/blogs/dhs-thinks-some-scada-problems-are-too-big-call-bug-092611; reference:url,reversemode.com/index.php?option=com_content&task=view&id=81&Itemid=2; reference:url,rockwellautomation.com/enabled/pdf/eipexp1_2.pdf; classtype:attempted-recon; sid:2804490; rev:6;)

#
alert tcp any any -> any 44818 (msg:"ETPRO SCADA Rockwell Automation ControlLogix EtherNET/IPreset command Denial Of Service"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 00 04 02 00 00 00 00 00 b2 00 08 00 05 03 20 01 24 01 30 03|"; distance:0; reference:url,threatpost.com/en_us/blogs/dhs-thinks-some-scada-problems-are-too-big-call-bug-092611; reference:url,reversemode.com/index.php?option=com_content&task=view&id=81&Itemid=2; reference:url,rockwellautomation.com/enabled/pdf/eipexp1_2.pdf; classtype:attempted-dos; sid:2804491; rev:5;)

#
alert tcp any any -> any 44818 (msg:"ETPRO SCADA Rockwell Automation ControlLogix EtherNET/IPInitialize the device to update the firmware"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 05 00 02 00 00 00 00 00 b2 00 16 00 4b 02 20 a1 24 01 05 99 07 00 4f 02 20 37 24 c8 00 00 01 00 01 00|"; distance:0; reference:url,threatpost.com/en_us/blogs/dhs-thinks-some-scada-problems-are-too-big-call-bug-092611; reference:url,reversemode.com/index.php?option=com_content&task=view&id=81&Itemid=2; reference:url,rockwellautomation.com/enabled/pdf/eipexp1_2.pdf; classtype:attempted-admin; sid:2804492; rev:4;)

#
alert tcp any any -> any 44818 (msg:"ETPRO SCADA Rockwell Automation ControlLogix Crash 1756-ENBT module"; flow:established,to_server; content:"|6f 00|"; depth:2; content:"|00 00 00 00 20 00 02 00 00 00 00 00 b2 00 0c 00 0e 03 20 f5 24 01 10 43 24 01 10 43|"; distance:0; reference:url,threatpost.com/en_us/blogs/dhs-thinks-some-scada-problems-are-too-big-call-bug-092611; reference:url,reversemode.com/index.php?option=com_content&task=view&id=81&Itemid=2; reference:url,rockwellautomation.com/enabled/pdf/eipexp1_2.pdf; classtype:attempted-dos; sid:2804493; rev:5;)

#
alert tcp $HOME_NET 54321 -> any any (msg:"ETPRO SCADA MOXA Device Manager Tool 2.1 Buffer Overflow"; flow:from_server,established; content:"|28 10 00 29|"; depth:4; isdataat:475,relative; content:"|a7 bc 16 10|"; distance:475; reference:url,reversemode.com/index.php?option=com_content&task=view&id=70&Itemid=; reference:osvdb,69027; reference:url,us-cert.gov/control_systems/pdf/ICSA-10-301-01A.pdf; classtype:attempted-user; sid:2804641; rev:1;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA ScadaTEC ScadaPhone <= v5.3.11.1230 Stack Buffer Overflow"; flow:from_server,established; content:"|0D 0A 0D 0A 50 4B 03 04 14 00|"; byte_test:2,>,0xc8,20,relative,little; content:"|f4 14 40 00|"; distance:300; within:32; reference:url,exploit-db.com/exploits/17833/; reference:osvdb,75375; classtype:attempted-user; sid:2804645; rev:3;)

#
alert ftp any any -> $HOME_NET 21 (msg:"ETPRO SCADA Schneider Modicon Quantum PLC login names and passwords retrieval 1"; flow:established,to_server; content:"get /FLASH0/userlist.dat"; nocase; reference:url,digitalbond.com/2012/01/31/anatomy-of-a-vulnerability-modicon-quantum/; reference:url,reversemode.com/index.php?option=com_content&task=view&id=80&Itemid=2; classtype:attempted-recon; sid:2804646; rev:4;)

#
alert ftp any any -> $HOME_NET 21 (msg:"ETPRO SCADA Schneider Modicon Quantum PLC login names and passwords retrieval 2"; flow:established,to_server; content:"get /FLASH0/ftp/ftp.ini"; nocase; reference:url,digitalbond.com/2012/01/31/anatomy-of-a-vulnerability-modicon-quantum/; reference:url,reversemode.com/index.php?option=com_content&task=view&id=80&Itemid=2; classtype:attempted-recon; sid:2804647; rev:4;)

#
alert ftp any any -> $HOME_NET 21 (msg:"ETPRO SCADA Schneider Modicon Quantum PLC login names and passwords retrieval 3"; flow:established,to_server; content:"get /FLASH0/rdt/password.rde"; nocase; reference:url,digitalbond.com/2012/01/31/anatomy-of-a-vulnerability-modicon-quantum/; reference:url,reversemode.com/index.php?option=com_content&task=view&id=80&Itemid=2; classtype:attempted-recon; sid:2804648; rev:4;)

#
alert udp any any -> $HOME_NET 69 (msg:"ETPRO SCADA General Electric D20 Password Recovery via TFTP"; content:"|00 01|"; depth:2; content:"NVRAM"; nocase; distance:0; content:"D20.zlb"; within:9;  nocase; reference:url,digitalbond.com/tools/basecamp/general-electric-d20meii/; classtype:attempted-recon; sid:2804649; rev:4;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Winlog DbiSetToRecordNo code execution"; flow:to_server,established; content:"|15 e6 56 36 00 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805123; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Winlog Db TDataSet Close qqrv code execution"; flow:to_server,established; content:"|17 e6 56 36 00 ea 56 36 00 ce 55 36 00|"; offset:20; depth:13; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805124; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Winlog DbiSetToRecordNo code execution op 1e"; flow:to_server,established; content:"|1e 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805125; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Winlog DbiSetToRecordNo code execution op 28"; flow:to_server,established; content:"|28 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805126; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Winlog DbiSetToRecordNo code execution op 32"; flow:to_server,established; content:"|32 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805127; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Winlog DbiSetToRecordNo code execution op 3c"; flow:to_server,established; content:"|3c 11 11 11 11 e6 56 36 00|"; offset:20; depth:9; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805128; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Directory traversal opcode 78 "; flow:to_server,established; content:"|78 2e 2e 2f 2e 2e 2f 2e 2e 2f|"; offset:20; depth:10; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805129; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 46824 (msg:"ETPRO SCADA Sielco Sistemi Winlog TCP/IP server buffer overflow"; flow:to_server,established; content:"|15 e6 56 36 00 7a 55 36 00 f2 56 36 00 88 88 88 88|"; offset:20; depth:17; isdataat:119,relative; reference:url,www.exploit-db.com/exploits/19409/; classtype:attempted-user; sid:2805130; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Sinapsi eSolar Light Photovoltaic System Monitor SQL Injection 1"; flow:established,to_server; content:"/dettagliinverter.php?"; http_uri; content:"&inverterselect="; http_uri; pcre:"/\/dettagliinverter.php\?.+?&inverterselect=.+?(SELECT|UPDATE|DELETE).+?FROM/Ui"; reference:url,www.us-cert.gov/control_systems/pdf/ICS-ALERT-12-284-01.pdf; reference:url,exploit-db.com/exploits/21273/; reference:url,nakedsecurity.sophos.com/2012/10/12/hackers-exploit-code-photovoltaic-solar/; reference:url,thehackernews.com/2012/10/scada-hacking-exploit-released-to-hack.html; classtype:web-application-attack; sid:2805582; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Sinapsi eSolar Light Photovoltaic System Monitor SQL Injection 2"; flow:established,to_server; content:"POST"; http_method; content:"/changelanguagesession.php"; http_uri; content:"lingua="; http_client_body; pcre:"/lingua\x3d.+?(SELECT|UPDATE|DELETE).+?FROM/Pi"; reference:url,www.us-cert.gov/control_systems/pdf/ICS-ALERT-12-284-01.pdf; reference:url,exploit-db.com/exploits/21273/; reference:url,nakedsecurity.sophos.com/2012/10/12/hackers-exploit-code-photovoltaic-solar/; reference:url,thehackernews.com/2012/10/scada-hacking-exploit-released-to-hack.html; classtype:web-application-attack; sid:2805583; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Sinapsi eSolar Light Photovoltaic System Monitor Login with hard coded account"; flow:established,to_server; content:"POST"; http_method; content:"/login.php"; http_uri; content:"password=36e44c9b64"; http_client_body; reference:url,www.us-cert.gov/control_systems/pdf/ICS-ALERT-12-284-01.pdf; reference:url,exploit-db.com/exploits/21273/; reference:url,nakedsecurity.sophos.com/2012/10/12/hackers-exploit-code-photovoltaic-solar/; reference:url,thehackernews.com/2012/10/scada-hacking-exploit-released-to-hack.html; classtype:web-application-attack; sid:2805584; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Sinapsi eSolar Light Photovoltaic System Monitor arbitrary command execution"; flow:established,to_server; content:"POST"; http_method; content:"/ping.php"; http_uri; content:"ip_dominio="; http_client_body; pcre:"/ip_dominio\x3d.+?\s+?%(26|3b)/Pi"; reference:url,www.us-cert.gov/control_systems/pdf/ICS-ALERT-12-284-01.pdf; reference:url,exploit-db.com/exploits/21273/; reference:url,nakedsecurity.sophos.com/2012/10/12/hackers-exploit-code-photovoltaic-solar/; reference:url,thehackernews.com/2012/10/scada-hacking-exploit-released-to-hack.html; classtype:web-application-attack; sid:2805585; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Possible Siemens SIMATIC RF Manager ActiveX Control Buffer Overflow 1"; flow:to_client,established; file_data; content:"9EB8768B-CDFA-44DF-8F3E-857A8405E1DB"; distance:0; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*9EB8768B-CDFA-44DF-8F3E-857A8405E1DB"/si"; reference:url,us-cert.gov/control_systems/pdf/ICSA-13-014-01.pdf; reference:cve,2013-0656; classtype:attempted-user; sid:2805894; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO SCADA Possible Siemens SIMATIC RF Manager ActiveX Control Buffer Overflow 2"; flow:to_client,established; file_data; content:"8569D715-FF88-44BA-8D1D-AD3E59543DDE"; distance:0; content:"<OBJECT"; pcre:"/^[^>]*?classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8569D715-FF88-44BA-8D1D-AD3E59543DDE/Rsi"; reference:url,us-cert.gov/control_systems/pdf/ICSA-13-014-01.pdf; reference:cve,2013-0656; classtype:attempted-user; sid:2805895; rev:3;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 1121 (msg:"ETPRO SCADA 3S CoDeSys Gateway Server Directory Traversal (upload mof file)"; flow:to_server,established; content:"|dd dd|"; depth:2; content:"|06 00 00 00|"; distance:0; content:"|2e 2e 5c|"; depth:200; pcre:"/\x2e\x2e\x5c[^\x00]+?\x2emof\x00/"; reference:cve,2012-4705; reference:url,ics-cert.us-cert.gov/pdf/ICSA-13-050-01-a.pdf; classtype:attempted-user; sid:2806185; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET 1121 (msg:"ETPRO SCADA 3S CoDeSys Gateway Server Directory Traversal"; flow:to_server,established; content:"|dd dd|"; depth:2; content:"|2e 2e 5c|"; depth:200; reference:cve,2012-4705; reference:url,ics-cert.us-cert.gov/pdf/ICSA-13-050-01-a.pdf; classtype:attempted-user; sid:2806186; rev:2;)

#
alert tcp any any -> $HOME_NET 7131 (msg:"ETPRO SCADA IntegraXor Stack Buffer Overflow"; flow:to_server,established; content:"/res?"; fast_pattern; content:".dll/"; distance:0; isdataat:261,relative; pcre:"/\/res\?[^\n]+?\.dll\/[^\n]{261}/"; reference:url,revuln.com/files/Ferrante_Auriemma_Securing_ICS_Without_Vendors.pdf; classtype:attempted-user; sid:2807491; rev:1;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,23] (msg:"ETPRO SCADA Possible CVE-2015-0984 Honeywell Falcon XLWEB Login Attempt"; flow:established,to_server; content:"XWADMIN"; fast_pattern; depth:12; offset:4; reference:url,seclists.org/fulldisclosure/2015/Apr/79; classtype:attempted-admin; sid:2810776; rev:2;)

