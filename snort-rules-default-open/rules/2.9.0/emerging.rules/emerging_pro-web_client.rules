# Emerging Threats Pro
#   http://www.emergingthreatspro.com
#
# This distribution may contain rules under three different licenses. 
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License 
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2015, Emerging Threats
#  All rights reserved.
#  
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the 
#  following conditions are met:
#  
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following 
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the 
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived 
#    from this software without specific prior written permission.
#  
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES, 
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE 
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
#
#*************************************************************
#
#
#  Rules with sids 2800000 through 2900000 are provided by Emerging Threats Pro and are covered by the license
#  provided in this distribution titled ETPRO-License.txt
#
#

# This Ruleset is EmergingThreats Pro optimized for suricata-1.3.

#by kevin ross
#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Adobe Multimedia Doc.media.newPlayer Memory Corruption Attempt"; flow:to_client,established; content:"PDF-"; depth:300; content:"this.media.newPlayer|28|null"; nocase; distance:0; content:"util.printd"; nocase; within:150; reference:url,www.metasploit.com/redmine/projects/framework/repository/revisions/7881/entry/modules/exploits/windows/fileformat/adobe_media_newplayer.rb; reference:url,vrt-sourcefire.blogspot.com/2009/12/adobe-reader-medianewplayer-analysis.html; reference:bid,37331; reference:cve,2009-4324; classtype:attempted-user; sid:2010495; rev:13;)

#kevin ross
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Adobe Reader and Acrobat Forms Data Format Remote Security Bypass Attempt"; flow:established,to_client; content:"|0d 0a|%FDF-"; depth:600; content:"/F(JavaScript|3a|"; nocase; distance:0; reference:url,www.securityfocus.com/bid/37763; reference:cve,2009-3956; reference:url,doc.emergingthreats.net/2010664; reference:url,www.stratsec.net/files/SS-2010-001_Stratsec_Acrobat_Script_Injection_Security_Advisory_v1.0.pdf; classtype:attempted-user; sid:2010664; rev:5;)

#by kevin ross
#needs removed somewhere around the end of may 2010
#Modified Slightly to Improve Detection (Action seems to be able to come either side of Launch so removed it and left in launch and win and added in a content match for .exe
#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Foxit/Adobe PDF Reader Launch Action Remote Code Execution Attempt"; flow:to_client,established; content:"PDF-"; depth:300; content:"Launch"; distance:0; content:"Win"; distance:0; content:".exe"; nocase; distance:0; reference:url,www.kb.cert.org/vuls/id/570177; reference:url,www.h-online.com/security/news/item/Criminals-attempt-to-exploit-unpatched-hole-in-Adobe-Reader-979286.html; reference:url,www.sudosecure.net/archives/673; reference:url,www.h-online.com/security/news/item/Adobe-issues-official-workaround-for-PDF-vulnerability-971932.html; reference:url,blog.didierstevens.com/2010/03/31/escape-from-foxit-reader/; reference:url,www.m86security.com/labs/i/PDF-Launch-Feature-Used-to-Install-Zeus,trace.1301~.asp; reference:url,doc.emergingthreats.net/2010968; classtype:attempted-user; sid:2010968; rev:7;)

#by kevin ross
#A bit more basic detection for the Java Exploit
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Java Deployment Toolkit Launch Method Remote Code Execution Attempt"; flow:established,to_client; content:"-J-jar -J"; pcre:"/(launch\x28.+-J-jar -J|-J-jar -J.+launch\x28)/i"; reference:url,seclists.org/fulldisclosure/2010/Apr/119; reference:url,www.darknet.org.uk/2010/04/serious-java-bug-exposes-users-to-code-execution/; reference:url,doc.emergingthreats.net/2011053; classtype:attempted-user; sid:2011053; rev:3;)

#by mike cox
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Java Web Start Command Injection (.jar)"; flow:established,from_server; content:"http|3a| -J-jar -J|5C 5C 5C 5C|"; nocase; content:".launch("; nocase; pcre:"/http\x3a -J-jar -J\x5C\x5C\x5C\x5C\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\x5C\x5C[^\n]*\.jar/i"; reference:url,seclists.org/fulldisclosure/2010/Apr/119; reference:url,doc.emergingthreats.net/2011698; classtype:web-application-attack; sid:2011698; rev:6;)

#by kevin ross
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Microsoft Internet Explorer URI Validation Remote Code Execution Attempt"; flow:established,to_client; content:"#|3A|../../"; content:"C|3A 5C|"; nocase; within:50; pcre:"/\x2E\x2E\x2F\x2E\x2E\x2F.+C\x3A\x5C[a-z]/si"; reference:url,www.securityfocus.com/bid/37884; reference:cve,2010-0027; reference:url,doc.emergingthreats.net/2010798; classtype:attempted-user; sid:2010798; rev:4;)

#Modified to avoid the short content matches as these should be accurate enough. Revision number has been incremented and msg slightly modified and a few more references added (BID, Cisco & Microsoft)
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Internet Explorer srcElement Memory Corruption Attempt"; flow:established,to_client; content:"document.createEventObject"; nocase; content:".innerHTML"; within:100; nocase; content:"window.setInterval"; distance:0; nocase; content:"srcElement"; fast_pattern; nocase; distance:0; reference:url,www.microsoft.com/technet/security/bulletin/ms10-002.mspx; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=19726; reference:url,www.kb.cert.org/vuls/id/492515; reference:cve,2010-0249; reference:url,doc.emergingthreats.net/2010799; classtype:attempted-user; sid:2010799; rev:5;)

#kevin ross
#Additional references and slight modification to msg
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible IE iepeers.dll Use-after-free Code Execution Attempt"; flow:established,to_client; content:".addBehavior"; nocase; content:"|23|default|23|userdata"; nocase; within:100; content:"setAttribute"; nocase; distance:0; content:"onclick"; nocase; distance:0; reference:url,www.rec-sec.com/2010/03/10/internet-explorer-iepeers-use-after-free-exploit/; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20052; reference:url,www.microsoft.com/technet/security/bulletin/ms10-018.mspx; reference:url,www.kb.cert.org/vuls/id/744549; reference:cve,2010-0806; reference:url,doc.emergingthreats.net/2010931; classtype:attempted-user; sid:2010931; rev:7;)

#by Michael Sconzo of ERCOT
#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Iframe in Purported Image Download (jpeg) - Likely SQL Injection Attacks Related"; flow:established,from_server; content:"|0d 0a|content-type|3a| "; nocase; content:" image/jpeg"; nocase; distance:0; within:30; content:"<iframe"; nocase; distance:0; pcre:"/content-type\x3a\s+image\/jpeg/i"; pcre:"/<iframe.*?src.*?>.*?<\/iframe>/im"; reference:url,doc.emergingthreats.net/bin/view/Main/2008313; classtype:web-application-attack; sid:2008313; rev:7;)

#by Michael Sconzo of ERCOT
#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Iframe in Purported Image Download (gif) - Likely SQL Injection Attacks Related"; flow:established,from_server; content:"|0d 0a|content-type|3a| "; nocase; content:" image/gif"; nocase; distance:0; within:30; content:"<iframe"; nocase; distance:0; pcre:"/content-type\x3a\s+image\/gif/i"; pcre:"/<iframe.*?src.*?>.*?<\/iframe>/im"; reference:url,doc.emergingthreats.net/bin/view/Main/2008314; classtype:web-application-attack; sid:2008314; rev:7;)

#by eion miller
#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Containing Windows Commands Downloaded"; flow:established,to_client; content:"%PDF-"; content:"|3C 3C 0D 0A 20 2f|type|20 2F|action|0D 0A 20 2F|s|20 2F|launch|0D 0A 20 2F|win"; distance:0; nocase; reference:url,doc.emergingthreats.net/2011245; classtype:bad-unknown; sid:2011245; rev:3;)

#by evilghost
#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Likely Malicious PDF Containing StrReverse"; flow:established,to_client; content:"%PDF-"; content:"StrReverse|28|"; distance:0; nocase; reference:url,doc.emergingthreats.net/2011246; classtype:bad-unknown; sid:2011246; rev:4;)

#Blake Hartstein at Demarc
#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Apple Quicktime RTSP Overflow (1)"; flow:established,from_server; content:"|22|rtsp|3a|//"; nocase; isdataat:400,relative; content:!"|0a|"; distance:0; within:400; content:!"|22|"; distance:0; within:400; reference:cve,2007-0015; reference:bugtraq,21829; reference:url,doc.emergingthreats.net/2003326; classtype:attempted-admin; sid:2003326; rev:7;)

#Blake Hartstein at Demarc
#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Apple Quicktime RTSP Overflow (2)"; flow:established,from_server; content:"|27|rtsp|3a|//"; nocase; isdataat:400,relative; content:!"|0a|"; distance:0; within:400; content:!"|27|"; distance:0; within:400; reference:cve,2007-0015; reference:bugtraq,21829; reference:url,doc.emergingthreats.net/2003327; classtype:attempted-admin; sid:2003327; rev:7;)

#Joint contribution from Andre Ludwig, Blake Hartstein, and Chris Byrd at riosec.com
#
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Apple Quicktime RTSP Content-Type overflow attempt"; flow:established,from_server; content:"RTSP/"; nocase; depth:5; content:"|0a|Content-Type|3a|"; nocase; distance:0; isdataat:50,relative; content:!"|0a|"; within:50; reference:url,www.kb.cert.org/vuls/id/659761; reference:url,www.milw0rm.com/exploits/4657; reference:url,doc.emergingthreats.net/2007703; classtype:attempted-user; sid:2007703; rev:11;)

#Joint contribution from Andre Ludwig, Blake Hartstein, and Chris Byrd at riosec.com
#
#alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Apple Quicktime RTSP Content-Type overflow attempt"; content:"RTSP/"; nocase; depth:5; content:"|0a|Content-Type|3a|"; nocase; distance:0; isdataat:50,relative; content:!"|0a|"; within:50; reference:url,www.kb.cert.org/vuls/id/659761; reference:url,www.milw0rm.com/exploits/4657; reference:url,doc.emergingthreats.net/2007704; classtype:attempted-user; sid:2007704; rev:6;)

#by evilghost and kevin ross
#
##alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT DX Studio Player Firefox Plug-in Command Injection Attempt"; flow:established,to_client; content:"<dxstudio"; nocase; content:"shell.execute("; nocase; reference:cve,2009-2011; reference:url,doc.emergingthreats.net/2010841; classtype:attempted-user; sid:2010841; rev:4;)

#by mike cox
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 401 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 401 Unauthorized|0d 0a|"; depth:27; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010514; classtype:web-application-attack; sid:2010514; rev:4;)

#by mike cox
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 403 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 403 Forbidden|0d 0a|"; depth:24; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010516; classtype:web-application-attack; sid:2010516; rev:4;)

#by mike cox
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 404 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 404 Not Found|0d 0a|"; depth:24; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010518; classtype:web-application-attack; sid:2010518; rev:4;)

#by mike cox
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 405 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 405 Method Not Allowed|0d 0a|"; depth:33; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010520; classtype:web-application-attack; sid:2010520; rev:4;)

#by mike cox
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 406 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 406 Not Acceptable|0d 0a|"; depth:29; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010522; classtype:web-application-attack; sid:2010522; rev:4;)

#by mike cox
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 500 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 500 Internal Server Error|0d 0a|"; depth:36; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010525; classtype:web-application-attack; sid:2010525; rev:4;)

#by mike cox
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 503 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 503 Service Unavailable|0d 0a|"; depth:34; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010527; classtype:web-application-attack; sid:2010527; rev:4;)

#by kevin ross
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Mozilla Firefox Window.Open Document URI Spoofing Attempt"; flow:established,to_client; content:"window.open("; nocase; content:"setTimeout("; nocase; distance:0; content:"document.body.innerHTML"; nocase; distance:0; content:".stop"; nocase; distance:0; pcre:"/(window|w)\x2Estop/i"; reference:url,www.mozilla.org/security/announce/2010/mfsa2010-45.html; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=556957; reference:cve,2010-1206; reference:url,doc.emergingthreats.net/2011240; classtype:misc-attack; sid:2011240; rev:5;)

#by Jules Pagna Disso
#onUnload event - could be used by malicious users to execute a set of command when the user unload the page or click the back button
#
##alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onUnload http spliting attempt (body)"; flow:from_server,established; content:"body"; nocase; content:"onUnload"; distance:0; nocase; pcre:"/<body\s+[^>]*onUnload\s*=\s*[\x22\x27]?\(\)/"; reference:url,doc.emergingthreats.net/2009132; classtype:web-application-attack; sid:2009132; rev:6;)

#by Jules Pagna Disso
#onUnload event - could be used by malicious users to execute a set of command when the user unload the page or click the back button
#
##alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onUnload http spliting attempt (img)"; flow:from_server,established; content:"img"; nocase; content:"onUnload"; distance:0; nocase; pcre:"/<img\s+[^>]*onEnd\s*=\s*[\x22\x27]?\(\)/"; reference:url,doc.emergingthreats.net/2009133; classtype:web-application-attack; sid:2009133; rev:6;)

#onURLFlip() This event fires when an Advanced Streaming Format (ASF) file, played by a HTML+TIME (Timed Interactive Multimedia Extensions) media tag, processes script commands embedded in the ASF file
#
##alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onURLFlip http spliting attempt (body)"; flow:from_server,established; content:"body"; nocase; content:"onURLFlip"; distance:0; nocase; pcre:"/<body\s+[^>]*onURLFlip\s*=\s*[\x22\x27]?\(\)/"; reference:url,doc.emergingthreats.net/2009134; classtype:web-application-attack; sid:2009134; rev:6;)

#onURLFlip() This event fires when an Advanced Streaming Format (ASF) file, played by a HTML+TIME (Timed Interactive Multimedia Extensions) media tag, processes script commands embedded in the ASF file
#
##alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onURLFlip http spliting attempt"; flow:from_server,established; content:"img"; nocase; content:"onURLFlip"; distance:0; nocase; pcre:"/<img\s+[^>]*onURLFlip\s*=\s*[\x22\x27]?\(\)/"; reference:url,doc.emergingthreats.net/2009135; classtype:web-application-attack; sid:2009135; rev:6;)

#These sigs are high load and minimal utility.
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Attempt to execute VBScript code"; flow: from_server,established; content:"vbscript"; nocase; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*vbscript[\:]/i"; reference:url,doc.emergingthreats.net/bin/view/Main/2001099; classtype:misc-attack; sid:2001099; rev:10;)

#These sigs are high load and minimal utility.
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Stealth attempt to execute Javascript code"; flow: from_server,established; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*[\x09\x0a\x0b\x0c\x0d]*j[\x09\x0a\x0b\x0c\x0d]*a[\x09\x0a\x0b\x0c\x0d]*v[\x09\x0a\x0b\x0c\x0d]*a[\x09\x0a\x0b\x0c\x0d]*s[\x09\x0a\x0b\x0c\x0d]*c[\x09\x0a\x0b\x0c\x0d]*r[\x09\x0a\x0b\x0c\x0d]*i[\x09\x0a\x0b\x0c\x0d]*p[\x09\x0a\x0b\x0c\x0d]*t[\x09\x0a\x0b\x0c\x0d]*[\:]/i"; content:"="; content:!"javascript|3a|"; nocase; reference:url,doc.emergingthreats.net/bin/view/Main/2001101; classtype:misc-attack; sid:2001101; rev:13;)

#These sigs are high load and minimal utility.
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Stealth attempt to execute VBScript code"; flow: from_server,established; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*[\x09\x0a\x0b\x0c\x0d]*v[\x09\x0a\x0b\x0c\x0d]*b[\x09\x0a\x0b\x0c\x0d]*s[\x09\x0a\x0b\x0c\x0d]*c[\x09\x0a\x0b\x0c\x0d]*r[\x09\x0a\x0b\x0c\x0d]*i[\x09\x0a\x0b\x0c\x0d]*p[\x09\x0a\x0b\x0c\x0d]*t[\x09\x0a\x0b\x0c\x0d]*[\:]/i"; content:"="; content:!"vbscript|3a|"; nocase; reference:url,doc.emergingthreats.net/bin/view/Main/2001102; classtype:misc-attack; sid:2001102; rev:13;)

#These sigs are high load and minimal utility.
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Stealth attempt to access SHELL#=#="; flow: from_server,established; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*[\x09\x0a\x0b\x0c\x0d]*s[\x09\x0a\x0b\x0c\x0d]*h[\x09\x0a\x0b\x0c\x0d]*e[\x09\x0a\x0b\x0c\x0d]*l[\x09\x0a\x0b\x0c\x0d]*l[\x09\x0a\x0b\x0c\x0d]*[\:]/i"; content:"="; content:!"shell|3a|"; nocase; reference:url,doc.emergingthreats.net/bin/view/Main/2001103; classtype:misc-attack; sid:2001103; rev:13;)

#These sigs are high load and minimal utility.
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Javascript execution with expression eval"; flow: from_server,established; content:"string.fromcharcode"; nocase; pcre:"/expression[\s]*\([\s]*eval[\s]*\([\s]*String\.fromCharCode[\s]*\(([\s]*[\d]+[\s]*,){20}/i"; reference:url,www.securiteam.com/exploits/3D5Q4RFPPK.html; reference:url,doc.emergingthreats.net/bin/view/Main/2001105; classtype:misc-activity; sid:2001105; rev:11;)

#These sigs are high load and minimal utility.
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Javascript execution with expression eval hex"; flow: from_server,established; content:"String.FromCharCode"; nocase; pcre:"/expression[\s]*\([\s]*eval[\s]*\([\s]*String\.fromCharCode[\s]*\(([\s]*0x[\da-fA-F]+[\s]*,){20}/i"; reference:url,www.securiteam.com/exploits/3D5Q4RFPPK.html; reference:url,doc.emergingthreats.net/bin/view/Main/2001106; classtype:misc-activity; sid:2001106; rev:10;)

#These sigs are high load and minimal utility.
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT IE process injection iexplore.exe executable download"; flow: from_server,established; content:"|00|iexplore.exe|00|"; content:"|00|GetProcAddress|00|"; content:"|00|LoadLibraryA|00|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001048; classtype:misc-activity; sid:2001048; rev:9;)

#These sigs are high load and minimal utility.
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT IE trojan Ants3set 1.exe - process injection"; flow: from_server,established; content:"|00|KERNEL32.DLL|00|GDI32.dll|00|MSVCRT.dll|00|USER32.dll|00||00|LoadLibraryA|00||00|GetProcAddress|00||00|ExitProcess|00|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001182; classtype:misc-attack; sid:2001182; rev:11;)

#by Andre Ludwig from MOBB
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT IE StructuredGraphicsControl SourceURL Bug MoBB#6"; flow:from_server,established; content:"DirectAnimation.StructuredGraphicsControl"; reference:url,browserfun.blogspot.com/2006/07/mobb-6-structuredgraphicscontrol.html; reference:cve,2006-3427; reference:url,doc.emergingthreats.net/bin/view/Main/2003023; classtype:web-application-activity; sid:2003023; rev:9;)

#by Chris Byrd, updated by Christian Siefert 2/5/07
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT MSIE WebViewFolderIcon setSlice invalid memory copy"; flow:to_client,established; content:"WebViewFolderIcon"; nocase; content:".setSlice"; nocase; content:"0x7ffffff"; nocase; reference:url, riosec.com/msie-setslice-vuln; reference:url,osvdb.org/27110; reference:cve,2006-3730; reference:url,doc.emergingthreats.net/bin/view/Main/2003110; classtype:attempted-user; sid:2003110; rev:7;)

#by Chris Byrd, updated by Christian Siefert 2/5/07
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft IE FTP URL Arbitrary Command Injection"; flow:from_server,established; content:"ftp|3a|//"; nocase; pcre:"/ftp\://[^\' \"]*%0a/i"; reference:url,osvdb.org/12299; reference:cve,2004-1166; reference:url,doc.emergingthreats.net/bin/view/Main/2003230; classtype:attempted-user; sid:2003230; rev:7;)

#by Akash Mahajan at Stillsecure
#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_CLIENT Microsoft Internet Explorer ieframe.dll Script Injection Vulnerability"; flow:to_server; content:"GET"; http_method; content:"res|3a|"; http_uri; content:"ieframe.dll"; http_uri; content:"acr_error"; pcre:"/(\&lt\;).+(\&gt\;)/Ui"; reference:bugtraq,28581; reference:url,doc.emergingthreats.net/bin/view/Main/2008170; classtype:web-application-attack; sid:2008170; rev:8;)

#by kevin ross
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Wscript Shell Run Attempt - Likely Hostile"; flow:established,to_client; content:"WScript.Shell"; nocase; content:"shell.Run"; nocase; within:40; content:"|22|"; within:6; reference:url,msdn.microsoft.com/en-us/library/d5fk67ky(VS.85).aspx; reference:url,doc.emergingthreats.net/2010961; classtype:attempted-user; sid:2010961; rev:5;)

#by kevin ross
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Microsoft Internet Explorer Dynamic Object Tag/URLMON Sniffing Cross Domain Information Disclosure Attempt"; flow:established,to_client; content:"obj"; nocase; content:"data"; nocase; within:10; content:"file|3A|//127."; nocase; within:20; pcre:"/(obj.data|object.data).+file\x3A\x2F\x2F127\x2E[0-9]/si"; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=19873; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20610; reference:url,www.microsoft.com/technet/security/bulletin/ms10-035.mspx; reference:url,www.coresecurity.com/content/internet-explorer-dynamic-object-tag; reference:cve,2010-0255; reference:url,doc.emergingthreats.net/2011695; classtype:attempted-user; sid:2011695; rev:5;)

#From Joe Stewart, LURHQ
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Encoded javascriptdocument.write - usually hostile"; flow: established,to_client; content:"|313030|,111,99,117,109,101,110,116,46,119,114,105,116,101"; reference:url,doc.emergingthreats.net/2001811; classtype:misc-activity; sid:2001811; rev:8;)

#by kevin ross
#
##alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Microsoft Internet Explorer mshtml.dll Timer ID Memory Pointer Information Disclosure Attempt"; flow:established,to_client; content:"setInterval("; nocase; content:"document.getElementById"; nocase; distance:0; content:".innerHTML"; nocase; distance:0; content:".toString("; nocase; within:60; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20815; reference:url,reversemode.com/index.php?option=com_content&task=view&id=68&Itemid=1; reference:url,doc.emergingthreats.net/2011764; classtype:attempted-user; sid:2011764; rev:4;)

#By Blake Hartstein
#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT RealPlayer/Helix Player Format String Exploit"; flow:established,from_server; content:"<imfl>"; pcre:"/<[^>%]*%/R"; content:"</imfl>"; distance:0; reference:url,milw0rm.com/id.php?id=1232; reference:bugtraq,14945; reference:cve,2005-2710; reference:url,doc.emergingthreats.net/bin/view/Main/2002381; classtype:web-application-attack; sid:2002381; rev:10;)

#by kevin ross
#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ET WEB_CLIENT VLC Media Player Aegisub Advanced SubStation (.ass) File Request flowbit set"; flow:established,to_server; content:".ass"; http_uri; nocase; flowbits:set,ET.ass.request; flowbits:noalert; reference:url,doc.emergingthreats.net/2010757; classtype:not-suspicious; sid:2010757; rev:6;)

#by kevin ross
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT VLC Media Player .ass File Buffer Overflow Attempt"; flowbits:isset,ET.ass.request; flow:established,to_client; content:"Dialogue|3A|"; nocase; isdataat:60000,relative; content:!"|0A|"; within:60000; reference:url,www.securityfocus.com/bid/37832/info; reference:url,doc.emergingthreats.net/2010758; classtype:attempted-user; sid:2010758; rev:5;)

#by kevin ross
#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT VLC Media Player smb URI Handling Remote Buffer Overflow Attempt"; flow:established,to_client; content:"<location>"; nocase; content:"smb|3A|//"; within:20; nocase; content:!"|0A|"; within:1000; isdataat:1000,relative; pcre:"/\x3Clocation\x3D.+smb\x3A\x2F\x2F.{1000}.+\x3C\x2Flocation\x3E/smi"; reference:url,www.securityfocus.com/bid/35500/info; reference:url,doc.emergingthreats.net/2010813; classtype:attempted-user; sid:2010813; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of /Subtype"; flow:established,to_client; content:"|0d 0a 0d 0a|PDF-"; content:"/"; distance:0; content:!"Subtype"; within:7; content:"#"; within:19; pcre:"/\x2F(?!Subtype)(S|#53)(u|#75)(b|#62)(t|#74)(y|#79)(p|#70)(e|#65)/"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011528; rev:6;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"GPL WEB_CLIENT Internet Explorer URLMON.DLL Content-Encoding Overflow Attempt"; flow:to_client,established; content:"Content-Encoding|3A|"; nocase; pcre:"/Content-Encoding\x3A[^\r\n]{300,}/i"; reference:bugtraq,7419; reference:cve,2003-0113; reference:url,www.microsoft.com/technet/security/bulletin/MS03-015.mspx; classtype:attempted-admin; sid:100000119; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT web bug 0x0 gif attempt"; flow:from_server,established; content:"Content-type|3A| image/gif"; nocase; content:"GIF"; distance:0; nocase; content:"|01 00 01 00|"; within:4; distance:3; content:","; distance:0; content:"|01 00 01 00|"; within:4; distance:4; classtype:misc-activity; sid:2102925; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT Javascript document.domain attempt"; flow:to_client,established; content:"document.domain|28|"; nocase; reference:bugtraq,5346; reference:cve,2002-0815; classtype:attempted-user; sid:2101840; rev:9;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT Microsoft ANI file parsing overflow"; flow:established,from_server; content:"RIFF"; nocase; content:"anih"; nocase; byte_test:4,>,36,0,relative,little; reference:cve,2004-1049; classtype:attempted-user; sid:2103079; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT PNG large colour depth download attempt"; flow:from_server,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:1,>,16,8,relative; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:2103134; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT PNG large image height download attempt"; flow:from_server,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32768,4,relative; reference:bugtraq,11481; reference:bugtraq,11523; reference:cve,2004-0599; reference:cve,2004-0990; reference:cve,2004-1244; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:2103133; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT PNG large image width download attempt"; flow:from_server,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32768,0,relative; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:2103132; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT RealPlayer arbitrary javascript command attempt"; flow:to_client,established; content:"Content-Type|3A|"; nocase; pcre:"/^Content-Type\x3a\s*application\x2fsmi.*?<area[\s\n\r]+href=[\x22\x27]file\x3ajavascript\x3a/smi"; reference:bugtraq,8453; reference:bugtraq,9378; reference:cve,2003-0726; classtype:attempted-user; sid:2102437; rev:9;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT Windows Media Player directory traversal via Content-Disposition attempt"; flow:from_server,established; file_data; content:"Content-Disposition|3A|"; nocase; pcre:"/filename=[^\x3b\x3a\r\n]*(\x2e\x2e|\x25\x32\x65)/smi"; reference:bugtraq,7517; reference:cve,2003-0228; reference:url,www.microsoft.com/technet/security/bulletin/MS03-017.mspx; classtype:attempted-user; sid:2103192; rev:6;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"GPL WEB_CLIENT XMLHttpRequest attempt"; flow:to_client,established; content:"new XMLHttpRequest|28|"; content:"file|3A|//"; nocase; reference:bugtraq,4628; reference:cve,2002-0354; classtype:web-application-attack; sid:2101735; rev:8;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT bitmap BitmapOffset integer overflow attempt"; flow:to_client,established; content:"image/bmp"; nocase; pcre:"/^Content-type\x3a\s*image\x2fbmp/smi"; pcre:"/^BM/sm"; byte_test:4,>,2147480000,8,relative,little; reference:bugtraq,9663; reference:cve,2004-0566; classtype:attempted-user; sid:2102671; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT libpng tRNS overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; pcre:"/IHDR(?!.*?PLTE).*?tRNS/s"; reference:bugtraq,10872; reference:cve,2004-0597; classtype:attempted-user; sid:2102673; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT local resource redirection attempt"; flow:to_client,established; content:"Location|3A|"; nocase; pcre:"/^Location\x3a\s*URL\s*\x3a/smi"; reference:cve,2004-0549; reference:url,www.kb.cert.org/vuls/id/713878; classtype:attempted-user; sid:2102577; rev:7;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT object type overflow attempt"; flow:from_server,established; content:"<OBJECT"; nocase; pcre:"/<OBJECT\s+[^>]*type\s*=[\x22\x27]\x2f{32}/smi"; reference:cve,2003-0344; reference:url,www.microsoft.com/technet/security/bulletin/MS03-020.mspx; classtype:attempted-user; sid:2103149; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT winamp .cda file name overflow attempt"; flow:from_server,established; content:".cda"; nocase; pcre:"/(\x5c[^\x5c]{16,}|\x2f[^\x2f]{16,})\.cda$/smi"; reference:bugtraq,11730; classtype:attempted-user; sid:2103088; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"GPL WEB_CLIENT server negative Content-Length attempt"; flow:from_server,established; content:"Content-Length|3A| -"; nocase; http_header; reference:cve,2004-0492; reference:url,www.guninski.com/modproxy1.html; classtype:attempted-admin; sid:2102580; rev:12;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Apple QuickTime MOV File String Handling Integer Overflow"; flow:established,to_server; uricontent:".mov"; nocase; flowbits:set,http.request.mov; flowbits:noalert; reference:cve,CVE-2005-2753; reference:secunia,17428; classtype:attempted-user; sid:2800642; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime MOV File String Handling Integer Overflow"; flow:established,to_client; flowbits:isset,http.request.mov; content:"hdlr"; byte_test:1,>,251,24,relative; reference:cve,CVE-2005-2753; reference:secunia,17428; classtype:attempted-user; sid:2800643; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime MOV File String Handling Integer Overflow"; flow:established,to_client; flowbits:isset,http.request.mov; content:"tcmi"; byte_test:1,>,251,24,relative; reference:cve,CVE-2005-2753; reference:secunia,17428; classtype:attempted-user; sid:2800644; rev:6;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime MOV File String Handling Integer Overflow"; flow:established,to_client; flowbits:isset,http.request.mov; content:"text|00 00 00 00 00 00|"; byte_test:1,>,251,35,relative; reference:cve,CVE-2005-2753; reference:secunia,17428; classtype:attempted-user; sid:2800645; rev:6;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Mozilla Firefox IFRAME Cross Site Scripting"; flow:to_client,established; content:"<iframe "; nocase; pcre:"/^[^>]*src=\x22javascript\:/Rmi"; reference:cve,CVE-2005-1476; reference:bugtraq,13544; reference:secunia,15292; classtype:attempted-user; sid:2800052; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel File in HTTP"; flow:to_client,established; content:"|D0 CF 11 E0 A1 B1 1A E1|"; flowbits:set,ETPRO.excelinhttp.2800063; flowbits:noalert; reference:cve,CVE-2007-0215; reference:bugtraq,23760; reference:secunia,25150; classtype:misc-activity; sid:2800063; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel BIFF File Format Named Graph Record Parsing Stack Overflow"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|83 00 02 00|"; content:"|84 00 02 00|"; distance:2; within:4; content:"|95 00|"; distance:2; within:2; pcre:"/^.{3}(..(?!\0\0)){16}/mR"; flowbits:unset,ETPRO.excelinhttp.2800063; reference:cve,CVE-2007-0215; reference:bugtraq,23760; reference:secunia,25150; classtype:attempted-user; sid:2800064; rev:4;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Set Font Handling Code Execution"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|60 10 0a 00|"; byte_test:2,>,32767,8,relative,little; reference:cve,CVE-2007-1203; reference:bugtraq,23779; reference:secunia,25150; classtype:attempted-user; sid:2800065; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Set Font Handling Code Execution"; flow:to_client,established; flowbits:isset,ETPRO.excelinhttp.2800063; content:"|68 10 0a 00|"; byte_test:2,>,32767,8,relative,little; reference:cve,CVE-2007-1203; reference:bugtraq,23779; reference:secunia,25150; classtype:attempted-user; sid:2800066; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Visio Version Number Handling Code Execution Vulnerability"; flow:to_client,established; content:"Visio (TM) Drawing|0D 0A|"; byte_test:2,>,0,4,little,relative; byte_test:2,<,256,4,little,relative; reference:cve,CVE-2007-0934; reference:bugtraq,24349; reference:secunia,25619; classtype:attempted-user; sid:2800074; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CSS Tag Handling Memory Corruption"; flow:to_client,established; content:"csstext"; nocase; pcre:"/\x3c[^\x3e]+style\s*\x3d\s*[\x22\x27]csstext\s*\x3a[^\x3e]+\x3e/smi"; reference:cve,CVE-2007-1750; reference:bugtraq,24423; reference:secunia,25627; classtype:attempted-user; sid:2800089; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace xls download"; flow:to_server,established; content:".xls"; nocase; http_uri; flowbits:set,http.xls.download; flowbits:noalert; reference:cve,CVE-2007-3890; reference:bugtraq,25280; reference:secunia,26145; classtype:misc-activity; sid:2800108; rev:5;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET  $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace xlw download"; flow:to_server,established; uricontent:".xlw"; nocase; flowbits:set,http.xls.download; flowbits:noalert; reference:cve,CVE-2007-3890; reference:bugtraq,25280; reference:secunia,26145; classtype:not-suspicious; sid:2800109; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace Index Value Memory Corruption 1"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|09 00|"; content:"|00 01|"; distance:4; within:2; content:"|38 00 04 00|"; byte_test:2,>,0x7FFF,0,relative,little; reference:cve,CVE-2007-3890; reference:bugtraq,25280; reference:secunia,26145; classtype:attempted-admin; sid:2800110; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace Index Value Memory Corruption 2"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|09 02|"; content:"|00 01|"; distance:4; within:2; content:"|38 00 04 00|"; byte_test:2,>,0x7FFF,0,relative,little; reference:cve,CVE-2007-3890; reference:bugtraq,25280; reference:secunia,26145; classtype:attempted-admin; sid:2800111; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace Index Value Memory Corruption 3"; flow:from_server,established; flowbits:isset,http.xls.download; content:"|09 04|"; content:"|00 01|"; distance:4; within:2; content:"|38 00 04 00|"; byte_test:2,>,0x7FFF,0,relative,little; reference:cve,CVE-2007-3890; reference:bugtraq,25280; reference:secunia,26145; classtype:attempted-admin; sid:2800112; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace Index Value Memory Corruption 4"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|09 06|"; content:"|00 01|"; distance:4; within:2; content:"|38 00 04 00|"; byte_test:2,>,0x7FFF,0,relative,little; reference:cve,CVE-2007-3890; reference:bugtraq,25280; reference:secunia,26145; classtype:attempted-admin; sid:2800113; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace Index Value Memory Corruption"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|09 08|"; content:"|00 01|"; distance:4; within:2; content:"|38 00 04 00|"; byte_test:2,>,0x7FFF,0,relative,little; reference:cve,CVE-2007-3890; reference:bugtraq,25280; reference:secunia,26145; classtype:attempted-admin; sid:2800114; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft OLE Automation String Manipulation Heap Overflow"; flow:from_server,established; content:"<script"; nocase; content:"substringData"; distance:0; pcre:"/\.substringData\s*\x28[^,\)]+,\s*0x/Ri"; byte_test:8,>,0x7FFFFFF5,0,relative,string,hex; byte_test:8,<,0x80000000,0,relative,string,hex; reference:cve,CVE-2007-2224; reference:bugtraq,25282; reference:secunia,26449; classtype:attempted-user; sid:2800115; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft OLE Automation String Manipulation Heap Overflow"; flow:from_server,established; content:"<script"; nocase; content:"substringData"; distance:0; pcre:"/\.substringData\s*\x28[^,\)]+,\s*/Ri"; byte_test:10,>,0x7FFFFFF5,0,relative,string,dec; byte_test:10,<,0x80000000,0,relative,string,dec; reference:cve,CVE-2007-2224; reference:bugtraq,25282; reference:secunia,26449; classtype:attempted-user; sid:2800116; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Visual Basic 6.0 VBP Project File request (vbp)"; flow:to_server,established; uricontent:".vbp"; nocase; flowbits:set,http.vbp.download; flowbits:noalert; reference:cve,CVE-2007-4776; reference:bugtraq,25629; reference:secunia,26704; classtype:misc-activity; sid:2800146; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Visual Basic 6.0 VBP Project File Handling Buffer Overflow Attempt"; flow:from_server,established; flowbits:isset,http.vbp.download; content:"Reference"; nocase; isdataat:519,relative; content:!"|0d 0a|"; within:521; pcre:"/^[\x20\x09]*Reference[\x20\x09]*=[^\x0D\x0A]{521}/mi"; reference:cve,CVE-2007-4776; reference:bugtraq,25629; reference:secunia,26704; classtype:attempted-user; sid:2800147; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Visual Studio Crystal Reports RPT File Download HTTP"; flow:to_client,established; content:"|D0 CF 11 E0 A1 B1 1A E1|"; offset:0; depth:8; flowbits:set,http.crystalreports.download; flowbits:noalert; reference:cve,CVE-2006-6133; reference:bugtraq,21261; reference:secunia,26754; classtype:misc-activity; sid:2800150; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Visual Studio Crystal Reports RPT File Handling Code Execution"; flowbits:isset,http.crystalreports.download; flow:to_client,established; content:"|05 00 53 00 75 00 6d 00 6d 00 61 00 72 00 79 00|"; content:"|FE FF|"; distance:0; byte_test:4,!=,1,22,relative,little; content:"|E0 85 9F F2 F9 4F 68 10 AB 91 08 00 2B 27 B3 D9|"; distance:26; within:16; reference:cve,CVE-2006-6133; reference:bugtraq,21261; reference:secunia,26754; classtype:attempted-user; sid:2800151; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer MP3 Files Processing Buffer Overflow"; flow:from_server,established; content:"LYRICSBEGIN"; nocase; pcre:"/(EAL)|(EAR)|(ETT)/Ri"; byte_test:5,=,-1,0,relative,dec,string; content:"LYRICS200"; nocase; reference:cve,CVE-2007-5080; reference:bugtraq,26214; reference:secunia,27361; classtype:attempted-user; sid:2800192; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealPlayer RA file processing overflow attempt"; flow:to_client,established; content:".ra|FD 00 04 00 00|.ra4|00 00 00 89 00 04 0F FF FF FF|"; reference:cve,2007-2264; reference:bugtraq,26214; classtype:attempted-user; sid:2800193; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealPlayer RealMedia file format heap corruption attempt"; flow:to_client,established; content:"DATA|00 00|A'|00 00 00 00 00|'|00 00 00 00 00 00 01|<|FF FF|"; reference:cve,2007-5081; reference:bugtraq,26214; classtype:attempted-user; sid:2800194; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime mov Download"; flow:to_server,established; uricontent:".mov"; nocase; flowbits:set,ETPRO.quicktime.http; flowbits:noalert; reference:cve,CVE-2007-3750; reference:bugtraq,26341; reference:secunia,27523; classtype:misc-activity; sid:2800196; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Apple QuickTime moov Download"; flow:to_server,established; uricontent:".moov"; nocase; flowbits:set,ETPRO.quicktime.http; flowbits:noalert; reference:cve,CVE-2007-3750; reference:bugtraq,26341; reference:secunia,27523; classtype:misc-activity; sid:2800197; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime STSD Atoms Handling Heap Overflow"; flowbits:isset,ETPRO.quicktime.http; flow:from_server,established; content:"stsd"; nocase; content:"|00 00 00|"; distance:1; within:3; byte_test:4,<,8,4,relative; content:"|00 00 00 00 00 00|"; distance:12; within:6; reference:cve,CVE-2007-3750; reference:bugtraq,26341; reference:secunia,27523; classtype:attempted-user; sid:2800198; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Apple QuickTime pic Download Request"; flow:to_server,established; uricontent:".pic"; nocase; flowbits:set,ETPRO.pic.download; flowbits:noalert; reference:cve,CVE-2007-4672; reference:bugtraq,26344; reference:secunia,27523; classtype:misc-activity; sid:2800199; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Apple QuickTime pct Download Request"; flow:to_server,established; uricontent:".pct"; nocase; flowbits:set,ETPRO.pic.download; flowbits:noalert; reference:cve,CVE-2007-4672; reference:bugtraq,26344; reference:secunia,27523; classtype:misc-activity; sid:2800200; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PICT Image Processing Uncompressedfile Stack Overflow"; flowbits:isset,ETPRO.pic.download; flow:from_server,established; content:"|82 01|"; byte_test:4,<,50,0,relative; reference:cve,CVE-2007-4672; reference:bugtraq,26344; reference:secunia,27523; classtype:attempted-user; sid:2800201; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PICT Image Poly Structure Memory Corruption 1"; flowbits:isset,ETPRO.pic.download; flow:from_server,established; content:"|00 11 02 FF 0C 00|"; content:"|00 70|"; distance:68; byte_test:2,<,10,0,relative; reference:cve,CVE-2007-4676; reference:bugtraq,26345; reference:secunia,27523; classtype:attempted-user; sid:2800202; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PICT Image Poly Structure Memory Corruption 2"; flowbits:isset,ETPRO.pic.download; flow:from_server,established; content:"|00 11 02 FF 0C 00|"; content:"|00 71|"; distance:68; byte_test:2,<,10,0,relative; reference:cve,CVE-2007-4676; reference:bugtraq,26345; reference:secunia,27523; classtype:attempted-user; sid:2800203; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PICT Image Poly Structure Memory Corruption 3"; flowbits:isset,ETPRO.pic.download; flow:from_server,established; content:"|00 11 02 FF 0C 00|"; content:"|00 72|"; distance:68; byte_test:2,<,10,0,relative; reference:cve,CVE-2007-4676; reference:bugtraq,26345; reference:secunia,27523; classtype:attempted-user; sid:2800204; rev:6;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PICT Image Poly Structure Memory Corruption 4"; flowbits:isset,ETPRO.pic.download; flow:from_server,established; content:"|00 11 02 FF 0C 00|"; content:"|00 73|"; distance:68; byte_test:2,<,10,0,relative; reference:cve,CVE-2007-4676; reference:bugtraq,26345; reference:secunia,27523; classtype:attempted-user; sid:2800205; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PICT Image Poly Structure Memory Corruption 5"; flow:from_server,established; flowbits:isset,ETPRO.pic.download; content:"|00 11 02 FF 0C 00|"; content:"|00 74|"; distance:68; byte_test:2,<,10,0,relative; reference:cve,CVE-2007-4676; reference:bugtraq,26345; reference:secunia,27523; classtype:attempted-user; sid:2800206; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime qt Download"; flow:to_server,established; content:".qt"; http_uri; nocase; flowbits:set,ETPRO.quicktime.http; flowbits:noalert; reference:cve,CVE-2007-4675; reference:bugtraq,26342; reference:secunia,27523; classtype:attempted-user; sid:2800207; rev:6;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime Panorama Sample Atoms Movie File Handling Buffer Overflow"; flow:from_server; flowbits:isset,ETPRO.quicktime.http; content:"pdat|00 00 00 01 00 00 00 00 00 00 00 00|"; nocase; byte_test:4,>,0x68,-20,relative; reference:cve,CVE-2007-4675; reference:bugtraq,26342; reference:secunia,27523; classtype:attempted-user; sid:2800208; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC VORBIS Comment String Size Buffer Overflow 1"; flow:to_client,established; content:"fLaC"; byte_test:1,<,0x7f,0,relative; byte_jump:2,2,relative; byte_test:1,=,0x04,0,relative; byte_test:4,=,0xffffffff,4,relative; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800210; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC VORBIS Comment String Size Buffer Overflow 2"; flow:to_client,established; content:"fLaC"; byte_test:1,<,0x7f,0,relative; byte_jump:2,2,relative; byte_test:1,=,0x84,0,relative; byte_test:4,=,0xffffffff,4,relative; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800211; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC VORBIS Comment String Size Buffer Overflow 3"; flow:to_client,established; content:"fLaC"; byte_test:1,<,0x7f,0,relative; byte_jump:2,2,relative; byte_test:1,!=,0x04,0,relative; byte_test:1,!=,0x84,0,relative; byte_jump:2,2,relative; byte_test:1,=,0x04,0,relative; byte_test:4,=,0xffffffff,4,relative; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800212; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC VORBIS Comment String Size Buffer Overflow 4"; flow:to_client,established; content:"fLaC"; byte_test:1,<,0x7f,0,relative; byte_jump:2,2,relative; byte_test:1,!=,0x04,0,relative; byte_test:1,!=,0x84,0,relative; byte_jump:2,2,relative; byte_test:1,=,0x84,0,relative; byte_test:4,=,0xffffffff,4,relative; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800213; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC VORBIS Comment String Size Buffer Overflow 5"; flow:to_client,established; content:"fLaC|04|"; byte_test:4,=,0xffffffff,4,relative; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800214; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC VORBIS Comment String Size Buffer Overflow 6"; flow:to_client,established; content:"fLaC|84|"; byte_test:4,=,0xffffffff,4,relative; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800215; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata MIME-Type Size Buffer Overflow 1"; flow:from_server,established; content:"fLaC|06|"; content:"|FF FF FF FF|"; distance:7; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800222; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata MIME-Type Size Buffer Overflow 2"; flow:from_server,established; content:"fLaC|86|"; content:"|FF FF FF FF|"; distance:7; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800223; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata MIME-Type Size Buffer Overflow 3 "; flow:from_server,established; content:"fLaC"; byte_test:1,<,0x80,0,relative; byte_jump:2,2,relative; content:"|06|"; content:"|FF FF FF FF|"; distance:7; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800224; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata MIME-Type Size Buffer Overflow 4"; flow:from_server,established; content:"fLaC"; byte_test:1,<,0x80,0,relative; byte_jump:2,2,relative; content:"|86|"; content:"|FF FF FF FF|"; distance:7; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800225; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata Picture Description Size Buffer Overflow 1"; flow:from_server,established; content:"fLaC|06|"; byte_jump:4,7,relative; content:"|ff ff ff ff|"; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800226; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata Picture Description Size Buffer Overflow 2"; flow:from_server,established; content:"fLaC|86|"; byte_jump:4,7,relative; content:"|ff ff ff ff|"; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800227; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata Picture Description Size Buffer Overflow 3"; flow:from_server,established; content:"fLaC"; byte_test:1,<,0x80,0,relative; byte_jump:2,2,relative; content:"|06|"; within:1; byte_jump:4,7,relative; content:"|ff ff ff ff|"; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800228; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FLAC Project libFLAC Picture Metadata Picture Description Size Buffer Overflow 4"; flow:from_server,established; content:"fLaC"; byte_test:1,<,0x80,0,relative; byte_jump:2,2,relative; content:"|86|"; within:1; byte_jump:4,7,relative; content:"|ff ff ff ff|"; within:4; reference:cve,CVE-2007-4619; reference:bugtraq,26042; reference:secunia,27210; classtype:attempted-user; sid:2800229; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT ACD Systems ACDSee Products XPM Values Section Buffer Overflow"; flow:to_server,established; content:".xpm"; nocase; http_uri; flowbits:set,ETPRO.xpm.http; flowbits:noalert; reference:cve,2007-6009; reference:bugtraq,26554; classtype:misc-activity; sid:2800232; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT ACD Systems ACDSee Products XPM Values Section Buffer Overflow"; flowbits:isset,ETPRO.xpm.http; flow:from_server,established; content:"static"; nocase; isdataat:1024,relative; pcre:"/^\s+char\s*\x2a\s*\S*\x5b\x5d\s*=\s*\x7b[^"}]*\x22[^"]{1024}/Ri"; reference:cve,CVE-2007-6009; reference:bugtraq,26554; classtype:attempted-user; sid:2800233; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Skype skype4com URI Handler Remote Heap Corruption"; flow:from_server,established; content:"skype4com|3A|"; nocase; pcre:"/skype4com\x3A[^\s\x22\x27\x3E]{0,6}[\s\x22\x27\x3E]/i"; reference:cve,CVE-2007-5989; reference:bugtraq,26748; reference:secunia,27934; classtype:attempted-user; sid:2800235; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Format ASF Parsing Code Execution 1"; flow:from_server,established; content:"|30 26 b2 75 8e 66 cf 11 a6 d9 00 aa 00 62 ce 6c|"; depth:16; content:"|91 07 dc b7 b7 a9 cf 11 8e e6 00 c0 0c 20 53 65|"; distance:0; content:"|e0 7d 90 35 15 e4 cf 11 a9 17 00 80 5f 5c 44 2b|"; distance:8; within:16; byte_test:2,>,0xffc5,52,relative,little; reference:cve,CVE-2007-0064; reference:bugtraq,26776; reference:secunia,28034; classtype:attempted-user; sid:2800237; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Format ASF Parsing Code Execution 2"; flow:from_server,established; content:"|30 26 b2 75 8e 66 cf 11 a6 d9 00 aa 00 62 ce 6c|"; offset:0; depth:16; content:"|91 07 dc b7 b7 a9 cf 11 8e e6 00 c0 0c 20 53 65|"; distance:0; content:"|50 cd c3 bf 8f 61 cf 11 8b b2 00 aa 00 b4 e2 20|"; distance:24; within:16; byte_test:4,>,0xFFF2,12,relative,little; reference:cve,CVE-2007-0064; reference:bugtraq,26776; reference:secunia,28034; classtype:attempted-user; sid:2800238; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Format ASF Parsing Code Execution 3"; flow:from_server,established; content:"|30 26 b2 75 8e 66 cf 11 a6 d9 00 aa 00 62 ce 6c|"; offset:0; depth:16; content:"|91 07 dc b7 b7 a9 cf 11 8e e6 00 c0 0c 20 53 65|"; distance:0; content:"|40 a4 f1 49 ce 4e d0 11 a3 ac 00 a0 c9 03 48 f6|"; distance:24; within:16; byte_jump:4,8,relative,little; byte_test:2,>,0xFFF7,16,relative,little; reference:cve,CVE-2007-0064; reference:bugtraq,26776; reference:secunia,28034; classtype:attempted-user; sid:2800239; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DirectX SAMI File Parsing Code Execution"; flow:from_server,established; content:"</SAMI>"; nocase; isdataat:1400,relative; content:!"|3e|"; within:1400; content:!"|20|"; within:1400; content:!"|09|"; within:1400; pcre:"/[^\x09\x20\x3e]{1400}/"; reference:cve,CVE-2007-3901; reference:bugtraq,26789; reference:secunia,28010; classtype:attempted-user; sid:2800240; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer DHTML Objects Memory Corruption"; flow:from_server,established; content:"<script"; nocase; content:"open"; nocase; distance:0; content:"setTimeout("; distance:0; nocase; content:"location.replace"; distance:0; nocase; content:"location.replace"; distance:0; nocase; reference:cve,CVE-2007-5347; reference:bugtraq,26427; reference:secunia,28036; classtype:attempted-user; sid:2800241; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DirectX WAV and AVI File Parsing Code Execution"; flow:to_client,established; content:"RIFF"; pcre:"/^.{4}(WAVE|AVI)/Ris"; pcre:"/(idx1|LIST|fmt\x20|data|fact|cue\x20|plst|labl|ltxt|note|smpl|inst)/i"; byte_test:4,>,0xfffffff7,0,relative,little; reference:cve,CVE-2007-3895; reference:bugtraq,26804; reference:secunia,28010; classtype:attempted-user; sid:2800242; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer DOM Object Cache Management Memory Corruption"; flow:from_server,established; content:".removeNode("; nocase; content:".removeNode("; nocase; distance:0; content:"<script"; nocase; distance:0; pcre:"/\s*(\S+)\.removeNode\(.*\1\.removeNode\(.*\1\.tags\(/is"; reference:cve,CVE-2007-5344; reference:bugtraq,26817; reference:secunia,28036; classtype:attempted-user; sid:2800243; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Macrovision InstallShield Update Service isusweb.dll Remote Buffer Overflow (DownloadAndExecute)"; flow:from_server,established; flowbits:isset,ETPRO.Macrovision.UpdateService; content:"DownloadAndExecute"; nocase; pcre:"/\.DownloadAndExecute\([^,\)]*,\s*([\x22\x27][^\x22\x27]{512}|[^\x22\x27]+\s*,)/iG"; reference:cve,CVE-2007-6654; reference:bugtraq,27013; reference:secunia,27475; classtype:attempted-user; sid:2800263; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Macrovision InstallShield Update Service isusweb.dll Remote Buffer Overflow 2"; flow:from_server,established; flowbits:isset,ETPRO.Macrovision.UpdateService2; content:"DownloadAndExecute"; nocase; pcre:"/\.DownloadAndExecute\([^,\)]*,\s*([\x22\x27][^\x22\x27]{512}|[^\x22\x27]+\s*,)/iG"; reference:cve,CVE-2007-6654; reference:bugtraq,27013; reference:secunia,27475; classtype:attempted-user; sid:2800265; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime Image Descriptor Atom Parsing Memory Corruption"; flow:from_server,established; content:"idsc"; byte_test:4,<,0x5e,-8,relative; reference:cve,CVE-2008-0033; reference:bugtraq,27299; reference:secunia,28502; classtype:attempted-user; sid:2800279; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer HTML Rendering Memory Corruption"; flow:from_server,established; content:"<isindex"; nocase; content:"style>"; distance:0; pcre:"/</style>.*<isindex[^>]*>.*<style/is"; reference:cve,CVE-2008-0076; reference:bugtraq,27668; reference:secunia,28903; classtype:attempted-user; sid:2800285; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer ANIMATEMOTION Properties Assignment Memory Corruption 1"; flow:to_client,established; content:"urn|3a|schemas-microsoft-com|3a|time"; nocase; pcre:"/<[^\x3a>]+\x3aAnimateMotion[^>]*id\s*=\s*[\x22\x27]([^\x22\x27]+).*<script.*\1\.by\s*=.*\1\.by\s*=/si"; reference:cve,CVE-2008-0077; reference:bugtraq,27666; reference:secunia,28903; classtype:attempted-user; sid:2800289; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer ANIMATEMOTION Properties Assignment Memory Corruption 2"; flow:to_client,established; content:"urn|3a|schemas-microsoft-com|3a|time"; nocase; pcre:"/<[^\x3a>]+\x3aAnimateMotion[^>]*id\s*=\s*[\x22\x27]([^\x22\x27]+).*<script.*\1\.to\s*=.*\1\.to\s*=/si"; reference:cve,CVE-2008-0077; reference:bugtraq,27666; reference:secunia,28903; classtype:attempted-user; sid:2800290; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer ANIMATEMOTION Properties Assignment Memory Corruption 3"; flow:to_client,established; content:"urn|3a|schemas-microsoft-com|3a|time"; nocase; pcre:"/<[^\x3z>]+\x3aAnimateMotion[^>]*id\s*=\s*[\x22\x27]([^\x22\x27]+).*<script.*\1\.from\s*=.*\1\.from\s*=/si"; reference:cve,CVE-2008-0077; reference:bugtraq,27666; reference:secunia,28903; classtype:attempted-user; sid:2800291; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Sun Java Web Start Request"; flow:from_client,established; content:"GET "; nocase; depth:4; uricontent:".jnlp"; nocase; flowbits:set,ETPRO.JNLP.request; flowbits:noalert; reference:cve,CVE-2008-1188; reference:bugtraq,28083; reference:secunia,29239; classtype:misc-activity; sid:2800302; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Sun Java Web Start Charset Encoding Stack Buffer Overflow"; flowbits:isset,ETPRO.JNLP.request; flow:from_server,established; content:"<?xml"; nocase; content:"<jnlp"; nocase; distance:0; pcre:"/<\?xml((?!\?>).)*encoding\s*=\s*(\x22[^\x22]{28}|\x27[^\x27]{28})/is"; reference:cve,CVE-2008-1188; reference:bugtraq,28083; reference:secunia,29239; classtype:attempted-user; sid:2800303; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Excel File Importing Code Execution"; flow:to_server,established; content:"GET"; http_method; content:".slk"; nocase; http_uri; flowbits:set,ETPRO.slk; flowbits:noalert; reference:cve,CVE-2008-0112; reference:bugtraq,28095; reference:secunia,28506; classtype:misc-activity; sid:2800306; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel File Importing Code Execution"; flowbits:isset,ETPRO.slk; flow:from_server,established; pcre:"/(ID\;[^PNEUVWXYZ]|\r\n(B\;[^UVWXYZ]|C\;[^UVWXYZEKCRGDSNPHMI]|P\;[^PFUVWXYZ]|F\;[^UVWXYZCRFDEKNPSHG]|O\;[^ACPLMEUVWXYZ]|NU\;[^LFUVWXYZ]|NE\;[^EFSUVWXYZ]|NN\;[^NEGKFUVWXYZ]))/"; reference:cve,CVE-2008-0112; reference:bugtraq,28095; reference:secunia,28506; classtype:attempted-user; sid:2800308; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Print Preview Handling Command Execution 1"; flow:from_server,established; content:"ExecWB"; content:"IDM_PRINTPREVIEW"; distance:0; nocase; pcre:"/ExecWB\s*\(\s*IDM_PRINTPREVIEW\s*,[^,]+,\s*[\x22\x27]http(s)?\x3a\x2f\x2f/si"; reference:cve,CVE-2008-2259; reference:bugtraq,30612; classtype:attempted-user; sid:2800340; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Print Preview Handling Command Execution 2"; flow:from_server,established; content:"ExecWB"; content:"7"; distance:0; pcre:"/ExecWB\s*\(\s*7\s*,[^,]+,\s*[\x22\x27]http(s)?\x3a\x2f\x2f/si"; reference:cve,CVE-2008-2259; reference:bugtraq,30612; classtype:attempted-user; sid:2800341; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Graphics Rendering Engine VML Gradient Buffer Overflow 1"; flow:from_server,established; content:"urn|3a|schemas-microsoft-com|3a|vml"; nocase; content:"fill "; nocase; content:"type"; distance:0; nocase; content:"focussize"; nocase; pcre:"/<([^\x3a]*\x3a)?fill[^>]+type\s*=\s*[\x22\x27]gradient(Center|Radial)[\x22\x27][^>]+focussize\s*=\s*[\x22\x27]\s*-[\d\.]+\s*,\s*-[\d\.]/i"; reference:cve,CVE-2007-5348; reference:bugtraq,31018; reference:secunia,31675; classtype:attempted-user; sid:2800350; rev:6;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Graphics Rendering Engine VML Gradient Buffer Overflow 2"; flow:from_server,established; content:"urn|3a|schemas-microsoft-com|3a|vml"; nocase; content:"fill "; nocase; content:"type"; distance:0; nocase; content:"focussize"; nocase; pcre:"/<([^\x3a]*\x3a)?fill[^>]+focussize\s*=\s*[\x22\x27]\s*-[\d\.]+\s*,\s*-[\d\.]+[^>]+type\s*=\s*[\x22\x27]gradient(Center|Radial)[\x22\x27]/i"; reference:cve,CVE-2007-5348; reference:bugtraq,31018; reference:secunia,31675; classtype:attempted-user; sid:2800351; rev:3;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Graphics Rendering Engine WMF Parsing Buffer Overflow"; flow:established,to_client; content:"|D7 CD C6 9A 00 00|"; content:"|38 05|"; byte_test:2,>,0x0fff,0,relative,little; reference:cve,CVE-2008-3014; reference:bugtraq,31021; reference:secunia,31675; classtype:attempted-user; sid:2800352; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Multiple Products libxml2 XML File Processing Long Entity Name Buffer Overflow"; flow:from_server,established; content:"ENTITY "; isdataat:200,relative; content:!">"; within:200; pcre:"/<\!ENTITY\s+[^\s>]{200}/"; reference:cve,CVE-2008-3529; reference:bugtraq,31126; classtype:attempted-user; sid:2800355; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Mozilla Firefox Animated PNG Processing Integer Overflow"; flow:from_server; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"|49 48 44 52|"; distance:0; byte_test:4,>,32767,0,relative; byte_test:4,>,32767,4,relative; byte_test:1,=,1,12,relative; content:"acTL"; distance:0 ; reference:cve,CVE-2008-4064; reference:bugtraq,31346; reference:secunia,32011; classtype:attempted-user; sid:2800366; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader and Acrobat util.printf Stack Buffer Overflow 1"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"/S/JavaScript"; content:"util.printf"; fast_pattern; distance:0; pcre:"/^ *\d{3}f/Ri"; byte_test:3,>,264,-4,relative,string,dec; reference:cve,CVE-2008-2992; reference:bugtraq,30035; reference:secunia,29773; classtype:attempted-user; sid:2800385; rev:8;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader and Acrobat util.printf Stack Buffer Overflow 2"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"/S/JavaScript"; content:"util.printf"; fast_pattern; distance:0; pcre:"/^ *[1-9]\d{3,}f/Ri"; reference:cve,CVE-2008-2992; reference:bugtraq,30035; reference:secunia,29773; classtype:attempted-user; sid:2800386; rev:8;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT VideoLAN VLC Media Player RealText File Buffer Overflow 1"; flow:from_server,established; content:"<window"; nocase; content:"<time "; nocase; distance:0; content:"begin=|22|"; nocase; distance:0; content:!"|22|"; within:22; reference:cve,CVE-2008-5036; reference:bugtraq,32125; reference:secunia,32569; classtype:attempted-user; sid:2800390; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT VideoLAN VLC Media Player RealText File Buffer Overflow 2"; flow:from_server,established; content:"<window"; nocase; content:"<time "; nocase; distance:0; content:"begin=|22|"; nocase; distance:0; content:"end=|22|"; nocase; distance:0; content:!"|22|"; within:16; reference:cve,CVE-2008-5036; reference:bugtraq,32125; reference:secunia,32569; classtype:attempted-user; sid:2800789; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Flash Player for Linux ActionScript ASnative Command Execution"; flow:from_server,established; content:"FWS"; content:"airappinstaller|00|ASnative|00|"; distance:0; pcre:"/[\x3a\x3b\x7c\x26\x28\x29\x60\x24][^\x00]+\x00airappinstaller\x00ASnative\x00.*\x99\x08/"; reference:cve,CVE-2008-5499; reference:bugtraq,32896; reference:secunia,33221; classtype:attempted-user; sid:2800400; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Nullsoft Winamp AIFF Parsing Heap Buffer Overflow"; flow:from_server,established; content:"FORM"; content:"AIF"; distance:4; within:3; content:"COMM"; distance:1; within:4; byte_test:4,>,0xD9CF,0,relative,big; reference:bugtraq,33226; reference:secunia,33478; classtype:attempted-user; sid:2800409; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FFmpeg 4xm Request"; flow:from_server,established; content:"RIFF"; content:"4XMV"; within:4; distance:4; flowbits:set,ETPRO.4xm.http; flowbits:noalert; reference:cve,CVE-2009-0385; reference:bugtraq,33502; reference:secunia,33711; classtype:misc-activity; sid:2800416; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FFmpeg 4xm Processing Memory Corruption"; flowbits:isset,ETPRO.4xm.http; flow:from_server,established; content:"strk|28 00 00 00|"; byte_test:1,&,0x80,3,relative; reference:cve,CVE-2009-0385; reference:bugtraq,33502; reference:secunia,33711; classtype:attempted-user; sid:2800417; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Multiple Products Embedded JBIG2 Stream Buffer Overflow"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"/JBIG2Decode"; pcre:"/^[^><]*(<<[^>]*>>[^>]*)?>>[\r\n]*stream[\r\n]*/R"; byte_test:1,&,0x40,4,relative; byte_test:1,=,0x0,5,relative; byte_test:4,>,0x1000,6,relative; reference:cve,CVE-2009-0658; reference:bugtraq,33751; reference:secunia,33901; classtype:attempted-user; sid:2800429; rev:7;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Mozilla Firefox SVG Data Processing Memory Corruption"; flow:from_server,established; content:"<svg"; nocase; content:"<path"; nocase; distance:0; content:"pathSegList"; distance:0; content:"createSVGPathSegMoveto"; distance:0; pcre:"/([^.=\r\n\s])\.pathSegList.*\1\.createSVGPathSegMoveto(Abs|Rel).*([^.=\r\n\s])\.appendItem\s*\(\s*([^.=\r\n\s])\s*,\s*0(?<!\.appendItem).*\3\.replaceItem\s*\(\s*\4\s*,\s*0/siR"; reference:cve,CVE-2009-0771; reference:bugtraq,33990; reference:secunia,34145; classtype:attempted-user; sid:2800432; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader JavaScript getAnnots Method Memory Corruption"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"JavaScript"; nocase; content:"getAnnots"; nocase; distance:0; pcre:"/^\x20*\x5C\x28\x20*\x2D/R"; reference:bugtraq,34736; reference:secunia,34924; classtype:attempted-user; sid:2800461; rev:6;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple iTunes Protocol Handler Stack Buffer Overflow 1"; flow:from_server,established; content:"itpc|3A 2F 2F|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/^[^\x2F\x3A]*\x3A[^\x00\x3c\x3e\x22\x26\x27\x2f]{257}/R"; reference:cve,CVE-2009-0950; reference:bugtraq,35157; classtype:attempted-user; sid:2800473; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple iTunes Protocol Handler Stack Buffer Overflow 2"; flow:from_server,established; content:"itms|3A 2F 2F|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/^[^\x2F\x3A]*\x3A[^\x00\x3c\x3e\x22\x26\x27\x2f]{257}/R"; reference:cve,CVE-2009-0950; reference:bugtraq,35157; classtype:attempted-user; sid:2800474; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple iTunes Protocol Handler Stack Buffer Overflow 3"; flow:from_server,established; content:"itmss|3A 2F 2F|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/^[^\x2F\x3A]*\x3A[^\x00\x3c\x3e\x22\x26\x27\x2f]{257}/R"; reference:cve,CVE-2009-0950; reference:bugtraq,35157; classtype:attempted-user; sid:2800475; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple iTunes Protocol Handler Stack Buffer Overflow 4"; flow:from_server,established; content:"daap|3A 2F 2F|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/^[^\x2F\x3A]*\x3A[^\x00\x3c\x3e\x22\x26\x27\x2f]{257}/R"; reference:cve,CVE-2009-0950; reference:bugtraq,35157; classtype:attempted-user; sid:2800476; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple iTunes Protocol Handler Stack Buffer Overflow 5"; flow:from_server,established; content:"pcast|3A 2F 2F|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/^[^\x2F\x3A]*\x3A[^\x00\x3c\x3e\x22\x26\x27\x2f]{257}/R"; reference:cve,CVE-2009-0950; reference:bugtraq,35157; classtype:attempted-user; sid:2800477; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Adobe Reader FlateDecode Integer Overflow 1"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"FlateDecode"; nocase; pcre:"/(DecodeParms|DP)\x3c\x3c/i"; pcre:"/^[^\x3e]*\x2f(Column|Color)s\x20+([1-9]\d{5}|[6][6-9]\d{4})/iR"; content:"|2f|FlateDecode"; nocase; distance:0; within:50; reference:cve,CVE-2009-1856; reference:bugtraq,35294; classtype:attempted-user; sid:2800478; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Adobe Reader FlateDecode Integer Overflow 2"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"FlateDecode"; nocase; pcre:"/^.{,50}(DecodeParms|DP)\x3c\x3c/iR"; pcre:"/^[^\x3e]*\x2f(Column|Color)s\x20+([1-9]\d{5}|[6][6-9]\d{4})/iR"; reference:cve,CVE-2009-1856; reference:bugtraq,35294; classtype:attempted-user; sid:2800479; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows AVI File Header Processing Memory Corruption"; flow:from_server,established; content:"RIFF"; content:"AVI LIST"; distance:4; within:8; byte_test:4,<,2046820351,40,relative,little; byte_test:4,>,67,40,relative,little; content:!"MOVI"; distance:0; reference:cve,CVE-2009-1545; reference:bugtraq,35967; classtype:attempted-admin; sid:2800492; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FFmpeg OGV File Format Memory Corruption"; flow:from_server,established; content:"|82|theora"; byte_test:1,<,0x20,0,relative; reference:bugtraq,36465; classtype:web-application-attack; sid:2800501; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IBM Informix Client SDK NFX File Processing Stack Buffer Overflow"; flow:from_server,established; content:"|5B|Setnet32|5D|"; nocase; content:"HostSize"; nocase; distance:0; content:"HostList"; nocase; distance:0; pcre:"/HostSize[\x20\x09]*\x3D[\x20\x09]*([3-9][0-9][0-9]\r?\n|29[7-9]\r?\n|[1-9]\d{3})/i"; pcre:"/HostList[^\r\n]*[\x3D\x3B][^\r\n\x3B]{297}/Gi"; classtype:web-application-attack; sid:2800514; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IBM Informix Client SDK NFX File Processing Stack Buffer Overflow"; flow:from_server,established; content:"|5B|Setnet32|5D|"; nocase; content:"ServerSize"; nocase; distance:0; content:"INFORMIXSERVERLIST"; nocase; distance:0; pcre:"/ServerSize[\x20\x09]*\x3D[\x20\x09]*([3-9][0-9][0-9]\r?\n|29[4-9]\r?\n|[1-9]\d{3})/i"; pcre:"/INFORMIXSERVERLIST[^\r\n]*[\x3D\x3B][^\r\n\x3B]{294}/Gi"; classtype:web-application-attack; sid:2800515; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Adobe Reader Deflate Parameter Integer Overflow 1"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"FlateDecode"; nocase; content:"Predictor"; distance:0; nocase; pcre:"/\x2F\s*(DecodeParms|DP)/i"; pcre:"/\x2F\s*Columns\s*1/i"; pcre:"/\x2F\s*BitsPerComponent\s*1/i"; pcre:"/\x2F\s*Colors\s*/i"; byte_test:10,>,1073741805,0,relative,string; pcre:"/\x2F\s*Predictor\s*2/i"; reference:cve,CVE-2009-3459; reference:bugtraq,36600; classtype:web-application-attack; sid:2800516; rev:9;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Adobe Reader Deflate Parameter Integer Overflow 2"; flow:from_server,established; file_data; content:"%PDF"; within:4; content:"FlateDecode"; nocase; content:"Predictor"; distance:0; nocase; pcre:"/\x2F\s*(DecodeParms|DP)/i"; pcre:"/\x2F\s*Columns\s*1/i"; pcre:"/\x2F\s*BitsPerComponent\s*1/i"; pcre:"/\x2F\s*Colors\s*[1-9][0-9]{10}/i"; pcre:"/\x2F\s*Predictor\s*2/i"; reference:cve,CVE-2009-3459; reference:bugtraq,36600; classtype:web-application-attack; sid:2800517; rev:11;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows GDIplus PNG Processing Integer Overflow 1"; flow:from_server,established; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"|49 48 44 52|"; distance:4; within:4; byte_test:4,>,0x7ffd,0,relative,big; content:"|01|"; distance:12; within:1; reference:cve,CVE-2009-3126; reference:bugtraq,36649; classtype:web-application-attack; sid:2800520; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows GDIplus PNG Processing Integer Overflow 2"; flow:from_server,established; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"|49 48 44 52|"; distance:4; within:4; byte_test:4,>,0x7ffd,4,relative,big; content:"|01|"; distance:12; within:1; reference:cve,CVE-2009-3126; reference:bugtraq,36649; classtype:web-application-attack; sid:2800522; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Xpdf Splash DrawImage Integer Overflow"; flow:from_server,established; file_data; content:"%PDF"; within:4; content:"FlateDecode"; nocase; content:"Width"; distance:0; pcre:"/\x2F\s*FlateDecode/i"; pcre:"/\x2F\s*Width\s*[1-9][0-9]{6}/i"; reference:cve,CVE-2009-3604; reference:bugtraq,36703; classtype:attempted-admin; sid:2800523; rev:7;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Xpdf Splash DrawImage Integer Overflow"; flow:from_server,established; file_data; content:"%PDF"; within:4; content:"FlateDecode"; nocase; pcre:"/\x2F\s*FlateDecode/i"; pcre:"/\x2F\s*Height\s*[1-9][0-9]{6}/i"; reference:cve,CVE-2009-3604; reference:bugtraq,36703; classtype:web-application-attack; sid:2800524; rev:8;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows DirectShow Heap Buffer Overflow"; flow:from_server,established; content:"RIFF"; content:"AVI LIST"; distance:4; within:8; content:"strlstrh"; distance:0; content:"strf"; distance:0; byte_test:4,>,256,36,relative,little; reference:cve,CVE-2010-0250; reference:bugtraq,38112; classtype:attempted-admin; sid:2800547; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime FlashPix Movie File Integer Overflow"; flow:from_server,established; content:"|00 00 01 00 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00|"; offset:0; byte_test:4,>,0xFFFFFFF,12,relative,little; reference:cve,CVE-2010-0519; reference:bugtraq,39020; classtype:attempted-admin; sid:2800597; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IBM Lotus Expeditor cai URI Handler Command Execution"; flow:from_server,established; content:"cai|3A|"; nocase; content:"-launcher"; distance:0; nocase; pcre:"/<(a href|iframe src)=((\x22cai\x3A[^\x22]*%22)|(\'cai\x3A[^\']*(%22|\x22))|(cai\x3A\S*(%22|\x22)))/i"; reference:cve,2008-1965; classtype:attempted-admin; sid:2800663; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT VideoLAN VLC Media Player WAV Processing Integer Overflow"; flow:established,to_client; content:"RIFF"; content:"WAVE"; distance:4; within:8; content:"fmt "; distance:0; byte_test:4,>,0xfffffffc,0,little,relative; reference:cve,2008-2430; reference:bugtraq,30058; reference:secunia,30601; classtype:attempted-user; sid:2800664; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer Invalid Chunk Size Heap Overflow"; flow:established,to_server; content:"User-Agent|3a|"; nocase; content:"realmedia"; fast_pattern; distance:0; nocase; flowbits:set,REALMEDIA1060323080; flowbits:noalert; reference:cve,CVE-2005-2922; reference:bugtraq,17202; reference:secunia,19358; classtype:attempted-user; sid:2800703; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer Invalid Chunk Size Heap Overflow"; flow:established,from_server; flowbits:isset,REALMEDIA1060323080; content:"transfer-encoding|3a| chunked"; nocase; content:"real"; nocase; pcre:"/(?<!\r\n\r\n)\r\n\r\n[0-9A-F]{9}/GRis"; reference:cve,CVE-2005-2922; reference:bugtraq,17202; reference:secunia,19358; classtype:attempted-user; sid:2800704; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime RTSP URL Buffer Overflow"; flow:to_client; content:"application/x-quicktime-media-link"; nocase; content:"rtsp|3a 2f 2f|"; nocase; content:!"|0a 0d 3c 3e 22 26 27 2f|"; distance:257; reference:cve,CVE-2007-0015; reference:bugtraq,21829; reference:secunia,23540; classtype:attempted-user; sid:2800709; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime RTSP URL Buffer Overflow"; flow:to_client; content:"application/x-quicktime-media-link"; nocase; flowbits:set,ETPRO.QuickTime.Response; flowbits:noalert; classtype:attempted-user; sid:2800710; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime RTSP URL Buffer Overflow"; flow:to_client; flowbits:isset,ETPRO.QuickTime.Response; content:"rtsp|3a 2f 2f|";  fast_pattern; nocase; content:!"|0a 0d 3c 3e 22 26 27 2f|"; distance:257; reference:cve,CVE-2007-0015; reference:bugtraq,21829; reference:secunia,23540; classtype:attempted-user; sid:2800711; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Drawing Record msofbtOPT Code Execution"; flow:to_client,established; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|0b f0|"; content:"|00 00 a0 03|"; within:10; reference:cve,CVE-2007-0671; reference:bugtraq,22383; reference:secunia,24008; classtype:attempted-user; sid:2800736; rev:5;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer 7 Navigation Canceled Page Cross-Site Scripting"; flow:to_client,established; content:"res|3a|//ieframe.dll/navcancl.htm#http"; nocase; reference:bugtraq,22966; reference:secunia,24535; classtype:attempted-user; sid:2800739; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer JPEG Rendering Buffer Overflow"; flow:to_client,established; content:"image/jpeg"; nocase; content:"|0D 0A 0D 0A FF D8 FF|"; content:"|FF DA 00 0C 03|"; distance:0; pcre:!"/^..(\x02.\x03|\x04.\x05)/sR"; reference:cve,CVE-2005-1988; reference:bugtraq,14282; classtype:attempted-user; sid:2800778; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PictureViewer Buffer Overflow (Published Exploit)"; flow:established,to_client; content:"|ff d8 FF E0 00 10 4A 46 49 46|"; content:"|b8 EC 12 00 90 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 42 42 42 42|"; offset:269; depth:350; reference:cve,CVE-2005-2340; reference:bugtraq,16202; reference:secunia,18370; classtype:attempted-user; sid:2800783; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Shockwave Director tSAC Chunk memory corruption Attempt"; flowbits:isset,ET.flash.pdf; flow:established,to_client; content:"|74 53 41 43 1D 02 00 00 00 00 00 0F 00 00 00 AE 00 00 01 63 00 00 00 14 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 00 00 14 00 00 01 00 FF FF 11 11 00 00|"; reference:url,exploit-db.com/download_pdf/15077; classtype:attempted-user; sid:2011543; rev:5;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Firefox Plugin Parameter EnsureCachedAttrParamArrays Remote Code Execution Attempt"; flow:established,to_client; content:"appletComponentArch.DynamicTreeApplet"; nocase; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; content:"PARAM"; nocase; distance:0; reference:url,www.exploit-db.com/moaub-17-firefox-plugin-parameter-ensurecachedattrparamarrays-remote-code-execution/; reference:url,www.mozilla.org/security/announce/2010/mfsa2010-37.html; reference:bugtraq,41842; reference:cve,2010-1214; classtype:attempted-user; sid:2011538; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of Action"; flow:established,to_client; content:"|0d 0a 0d 0a|PDF-"; content:"/"; distance:0; content:!"Action"; within:6; content:"#"; within:16; pcre:"/\x2F(?!Action)(A|#41)(c|#63)(t|#74)(i|#69)(o|#6F)(n|#6E)/"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011529; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of EmbeddedFile"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/"; within:50; content:!"EmbeddedFile"; within:12; content:"#"; within:34; pcre:"/\x3C\x3C(\x0D\x0A|\x0A)[^>]*\x2F[^EmbeddedFile](E|#45)(m|#6D)(b|#62)(e|#65)(d|#64)(d|#64)(e|#65)(d#64)(F|#46)(i|#69)(l|#6C)(e|#65)/smi"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011530; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of Type"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/"; within:50; content:!"Type"; within:4; content:"#"; within:11; pcre:"/\x3C\x3C[^>]*\x2F[^Type](T|#54)(y|#79)(p|#70)(e|#65)/smi"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011531; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of Javascript"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/"; within:50; content:!"Javascript"; within:10; content:"#"; within:28; pcre:"/\x3C\x3C[^\n]*\x2F[^Javascript](J|#4A)(a|#61)(v|#76)(a|#61)(S|#73|#53)(c|#63)(r|#72)(i|#69)(p|#70)(t|#74)/smi"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011532; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of URL"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/"; within:50; content:!"URL"; within:3; content:"#"; within:7; pcre:"/\x3C\x3C[^>]*\x2F[^URL](U|#55)(R|#52)(L|#4C)/smi"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011533; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of JS"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/"; within:50; content:!"JS"; within:2; content:"#"; within:4; pcre:"/\x3C\x3C(\x0D\x0A|\x0A)[^>]*\x2F[^JS](J|#4A)(S|#53)/smi"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011535; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of Pages"; flow:established,to_client; content:"|0d 0a 0d 0a|PDF-"; content:"/"; distance:0; content:!"Pages"; within:5; content:"#"; within:13; pcre:"/\x2F(?!Pages)(P|#40)(a|#61)(g|#67)(e|#65)(s|#73)/"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011536; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF Name Representation Obfuscation of OpenAction"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/"; within:50; content:!"OpenAction"; within:10; content:"#"; within:28; pcre:"/\x3C\x3C(\x0D\x0A|\x0A)[^>]*\x2F[^OpenAction](O|#4F)(p|#70)(e|#65)(n|#6E)(A|#41)(c|#63)(t|#74)(i|#69)(o|#6F)(n|#6E)/smi"; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011537; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Embedded Adobe Shockwave Flash, Possibly Related to Remote Code Execution Attempt"; flow:established,to_client; content:"PDF-"; depth:300; content:".swf"; fast_pattern; nocase; distance:0; flowbits:set,ET.flash.pdf; flowbits:noalert; reference:url,feliam.wordpress.com/2010/02/11/flash-on-a-pdf-with-minipdf-py/; reference:cve,2010-1297; reference:cve,2010-2201; classtype:bad-unknown; sid:2011499; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Adobe Acrobat and Reader Pushstring Memory Corruption Attempt"; flow:established,to_client; flowbits:isset,ET.flash.pdf; content:"|2C E8 88 F0 FF 33|"; reference:url,www.exploit-db.com/moaub12-adobe-acrobat-and-reader-pushstring-memory-corruption/; reference:bugtraq,41237; reference:cve,2010-2201; classtype:attempted-user; sid:2011500; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Adobe CoolType Smart INdependent Glyplets - SING - Table uniqueName Stack Buffer Overflow Attempt"; flow:established,to_client; content:"PDF-"; depth:300; content:"SING"; distance:0; content:"|01 00 01 0E|"; within:100; content:"|00 3A|"; within:100; isdataat:100,relative; content:!"|0A|"; within:100; reference:url,contagiodump.blogspot.com/2010/09/cve-david-leadbetters-one-point-lesson.html; reference:cve,2010-2883; classtype:attempted-user; sid:2011501; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT String Replace in PDF File, Likely Hostile"; flow:established,to_client; content:"PDF-"; depth:300; content:".replace|28|"; nocase; reference:url,www.w3schools.com/jsref/jsref_replace.asp; classtype:bad-unknown; sid:2011504; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Embedded Flash, Possible Remote Code Execution Attempt"; flow:established,to_client; content:"PDF-"; depth:300; content:"/SubType"; distance:0; content:"flash"; nocase; within:100; reference:url,feliam.wordpress.com/2010/02/11/flash-on-a-pdf-with-minipdf-py/; reference:cve,2010-1297; classtype:bad-unknown; sid:2011505; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With eval Function - Possibly Hostile"; flow:established,to_client; content:"PDF-"; depth:300; content:"eval|28|"; nocase; distance:0; reference:url,www.w3schools.com/jsref/jsref_eval.asp; classtype:bad-unknown; sid:2011506; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Embedded File"; flow:established,to_client; file_data; content:"obj"; content:"<<"; within:4; content:"/EmbeddedFile"; distance:0; pcre:"/\x3C\x3C[^>]*\x2FEmbeddedFile/sm"; reference:url,blog.didierstevens.com/2009/07/01/embedding-and-hiding-files-in-pdf-documents/; classtype:bad-unknown; sid:2011507; rev:7;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT RealPlayer FLV Parsing Integer Overflow Attempt"; flow:established,to_client; content:"FLV"; nocase; depth:300; content:"onMetaData"; nocase; distance:0; content:"|07 50 75 08|"; within:100; reference:url,service.real.com/realplayer/security/08262010_player/en/; reference:url,www.exploit-db.com/moaub-13-realplayer-flv-parsing-multiple-integer-overflow/; reference:bugtraq,42775; reference:cve,2010-3000; classtype:attempted-user; sid:2011485; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT phoenix exploit kit - admin login page detected"; flow:established,to_client; content:"<title>Phoenix Exploit's Kit - Log In</title>"; classtype:bad-unknown; sid:2011281; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible PDF Launch Function Remote Code Execution Attempt with Name Representation Obfuscation"; flow:to_client,established; content:"|0d 0a 0d 0a|PDF-"; content:"/"; distance:0; content:!"Launch"; within:6; content:"#"; within:16; content:".exe"; nocase; distance:0; pcre:"/\x2F(?!Launch)(L|#4C)(a|#61)(u|#75)(n#6E)(c|#63)(h|#68).+\x2F(W|#57)(i|#69)(n|#6E).+\x2Eexe/sm"; reference:url,www.kb.cert.org/vuls/id/570177; reference:url,www.h-online.com/security/news/item/Criminals-attempt-to-exploit-unpatched-hole-in-Adobe-Reader-979286.html; reference:url,www.sudosecure.net/archives/673; reference:url,www.h-online.com/security/news/item/Adobe-issues-official-workaround-for-PDF-vulnerability-971932.html; reference:url,blog.didierstevens.com/2010/03/31/escape-from-foxit-reader/; reference:url,www.m86security.com/labs/i/PDF-Launch-Feature-Used-to-Install-Zeus,trace.1301~.asp; reference:url,blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/; classtype:bad-unknown; sid:2011329; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT FakeAV scanner page encountered Initializing Virus Protection System"; flow:to_client,established; content:"<span id=|22|loadspan|22|>Initializing Virus Protection System...</span>"; classtype:bad-unknown; sid:2011343; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible String.FromCharCode Javascript Obfuscation Attempt"; flow:established,to_client; content:"String.FromCharCode("; nocase; pcre:"/String\x2EFromCharCode\x28[0-9]{1,3}/i"; reference:url,www.w3schools.com/jsref/jsref_fromCharCode.asp; reference:url,www.roseindia.net/javascript/method-fromcharcode.shtml; reference:url,isc.sans.org/diary.html?storyid=7906; reference:url,isc.sans.org/diary.html?storyid=7903; classtype:bad-unknown; sid:2011347; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Apple Quicktime Invalid SMIL URI Buffer Overflow Attempt"; flow:established,to_client; content:"|3C|smil"; nocase; content:"|3C|img src="; nocase; distance:0; content:!"http"; nocase; within:20; content:"|3A|//"; within:20; isdataat:700,relative; content:!"|3C 2F|smil|3E|"; nocase; within:700; content:!"|0A|"; within:700; reference:url,securitytracker.com/alerts/2010/Aug/1024336.html; reference:bugtraq,41962; reference:cve,2010-1799; classtype:attempted-user; sid:2011366; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ET WEB_CLIENT PROPFIND Flowbit Set"; flow:established,to_server; content:"PROPFIND"; http_method; nocase; flowbits:set,ET_PROPFIND; flowbits:noalert; classtype:misc-activity; sid:2011456; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT DLL or EXE File From Possible WebDAV Share, Possible DLL Preloading Exploit Attempt"; flowbits:isset,ET_PROPFIND; flow:established,to_client; content:"|0d 0a 0d 0a|MZ"; byte_jump:4,58,relative,little; content:"PE|00 00|"; distance:-64; within:4; reference:url,blog.metasploit.com/2010/08/exploiting-dll-hijacking-flaws.html; reference:url,www.us-cert.gov/cas/techalerts/TA10-238A.html; reference:url,www.microsoft.com/technet/security/advisory/2269637.mspx; reference:url,blogs.technet.com/b/srd/archive/2010/08/23/more-information-about-dll-preloading-remote-attack-vector.aspx; reference:url,blog.metasploit.com/2010/08/better-faster-stronger.html; reference:url,blog.rapid7.com/?p=5325; classtype:attempted-user; sid:2011457; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Unescape Method Defined Possible Hostile Obfuscation Attempt"; flow:established,to_client; content:"PDF-"; depth:300; content:"unescape|28|"; nocase; distance:0; reference:url,isc.sans.org/diary.html?storyid=7903; reference:url,isc.sans.org/diary.html?storyid=7906; reference:url,doc.emergingthreats.net/2010881; classtype:bad-unknown; sid:2010881; rev:6;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Adobe Acrobat Reader Newclass Invalid Pointer Remote Code Execution Attempt"; flowbits:isset,ET.flash.pdf; flow:established,to_client; content:"|F2 3D 8D 23|"; reference:url,www.exploit-db.com/adobe-acrobat-newclass-invalid-pointer-vulnerability/; reference:cve,2010-1297; classtype:attempted-user; sid:2011519; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Acrobat newfunction Remote Code Execution Attempt"; flowbits:isset,ET.flash.pdf; flow:established,to_client; content:"|40 E8 D4 F1 FF 33|"; reference:url,www.adobe.com/support/security/bulletins/apsb10-15.html; reference:url,www.exploit-db.com/moaub-23-adobe-acrobat-and-reader-newfunction-remote-code-execution-vulnerability/; reference:bid,41236; reference:cve,2010-2168; classtype:attempted-user; sid:2011575; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Microsoft Internet Explorer CSS Cross-Origin Theft Attempt"; flow:established,to_client; content:"document.body.currentStyle.fontFamily"; nocase; content:".indexOf(|22|authenticity_token"; nocase; distance:0; reference:url,www.theregister.co.uk/2010/09/06/mystery_ie_bug/; reference:url,www.darknet.org.uk/2010/09/microsoft-investigate-ie-css-cross-origin-theft-vulnerability/; reference:url,seclists.org/fulldisclosure/2010/Sep/64; classtype:bad-unknown; sid:2011472; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer FLV Parsing Two Integer Overflow Vulnerability 1"; flow:from_server,established; content:"FLV|01|"; content:"|00 00 00 09 00 00 00 00 12|"; distance:1; content:"|00 00 00 00 00 00 00|"; distance:3; within:7; content:"|02|"; distance:0; byte_jump:2,0,relative; content:"|08|"; distance:0; within:1; byte_test:4,>,0x07507507,0,relative,big; reference:cve,CVE-2010-3000; reference:bugtraq,42775; classtype:attempted-user; sid:2800800; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer FLV Parsing Two Integer Overflow Vulnerability 2"; flow:from_server,established; content:"FLV|01|"; content:"|00 00 00 09 00 00 00 00 12|"; distance:1; content:"|00 00 00 00 00 00 00|"; distance:3; within:7; content:"|02|"; distance:0; byte_jump:2,0,relative; content:"|0A|"; distance:0; within:1; byte_test:4,>,0x07507507,0,relative,big; reference:cve,CVE-2010-3000; reference:bugtraq,42775; classtype:attempted-user; sid:2800803; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Reader CoolType.dll Stack Buffer Overflow 1"; flow:from_server,established; content:"%PDF-"; content:"OpenType"; distance:0; nocase; content:"SING"; distance:0; byte_test:4,>,0,8,relative; content:"name"; distance:0; byte_test:4,=,0,8,relative; reference:cve,CVE-2010-2883; classtype:attempted-user; sid:2800826; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Reader CoolType.dll Stack Buffer Overflow 2"; flow:from_server,established; content:"%PDF-"; content:"OpenType"; distance:0; nocase; content:"name"; distance:0; byte_test:4,=,0,8,relative; content:"SING"; distance:0; byte_test:4,>,0,8,relative; reference:cve,CVE-2010-2883; classtype:attempted-user; sid:2800827; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Reader CoolType.dll Stack Buffer Overflow 3"; flow:from_server,established; content:"%PDF-"; content:"TrueType"; distance:0; nocase; content:"SING"; distance:0; byte_test:4,>,0,8,relative; content:"name"; distance:0; byte_test:4,=,0,8,relative; reference:cve,CVE-2010-2883; classtype:attempted-user; sid:2800828; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat and Reader CoolType.dll Stack Buffer Overflow 4"; flow:from_server,established; content:"%PDF-"; content:"TrueType"; distance:0; nocase; content:"name"; distance:0; byte_test:4,=,0,8,relative; content:"SING"; distance:0; byte_test:4,>,0,8,relative; reference:cve,CVE-2010-2883; classtype:attempted-user; sid:2800829; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Oracle Java APPLET Tag Children Property Memory Corruption Attempt"; flow:established,to_client; content:"APPLET"; nocase; content:"children"; nocase; distance:0; content:"location.reload"; nocase; within:100; reference:url,code.google.com/p/skylined/issues/detail?id=18; reference:url,www.oracle.com/technetwork/topics/security/javacpuoct2010-176258.html; classtype:attempted-user; sid:2011864; rev:2;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Embedded Executable File in PDF - This Program Cannot Be Run in DOS Mode"; flow:established,to_client; content:"PDF-"; depth:300; content:"This program cannot be run in DOS mode"; nocase; distance:0; classtype:bad-unknown; sid:2011865; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Suspicious Embedded Shockwave Flash In PDF"; flow:established,to_client; content:"PDF-"; depth:300; content:"x-shockwave-flash"; nocase; distance:0; pcre:"/(a|#61)(p|#70)(p|#70)(l|#6C)(i|#69)(c|#63)(a|#61)(t|#74)(i|#69)(o|#6F)(n|#6E)(\x2F|#2F)x-shockwave-flash/i"; classtype:bad-unknown; sid:2011866; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Javascript obfuscation using app.setTimeOut in PDF in Order to Run Code"; flow:established,to_client; content:"PDF-"; depth:300; content:"app.setTimeOut("; nocase; distance:0; reference:url,www.h-online.com/security/features/CSI-Internet-PDF-timebomb-1038864.html?page=4; reference:url,www.vicheck.ca/md5query.php?hash=6932d141916cd95e3acaa3952c7596e4; classtype:bad-unknown; sid:2011868; rev:3;)

#dan clemens
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Adobe Shockwave Director tSAC Chunk Parsing Memory Corruption"; flow:established,to_server; content:".dir"; http_uri; nocase; flowbits:set,ETPRO.shockwave_dir; flowbits:noalert; reference:cve,2010-2866; reference:bugtraq,42665; classtype:attempted-user; sid:2800837; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Shockwave Director tSAC Chunk Parsing Memory Corruption"; flow:established,from_server; flowbits:isset,ETPRO.shockwave_dir; content:"tSAC"; nocase; byte_test:2,>,0x7FFF,36,relative; reference:cve,2010-2866; reference:bugtraq,42665; classtype:attempted-user; sid:2800838; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Adobe Shockwave Director dcr access"; flow:to_server,established; content:".dcr"; http_uri; nocase; flowbits:set,ETPRO.shockwave_dir; flowbits:noalert; reference:cve,2010-4084; classtype:attempted-user; sid:2800840; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Shockwave Director pamm Chunk Memory Corruption"; flow:from_server,established; flowbits:isset,ETPRO.shockwave_dir; content:"XFIR"; nocase; content:"pami"; distance:0; within:12; content:"pamm"; distance:0; within:40; byte_test:2,!=,0x1400,6,relative; reference:cve,2010-4084; classtype:attempted-user; sid:2800841; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer CDDA Access"; flow:from_server; content:"<object"; nocase; content:"CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA"; fast_pattern; nocase; distance:0; flowbits:set,ETPRO.RealPlayer.2010-3747; flowbits:noalert; reference:cve,2010-3747; reference:bugtraq,44144; classtype:not-suspicious; sid:2800843; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer CDDA Access 2"; flow:from_server; content:"<script"; nocase; content:"ActiveXObject"; nocase; distance:0; content:"rmocx.RealPlayer G2 Control.1"; nocase; distance:0; flowbits:set,ETPRO.RealPlayer.2010-3747; flowbits:noalert; reference:cve,CVE-2010-3747; reference:bugtraq,44144; classtype:not-suspicious; sid:2800844; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer CDDA URI Uninitialized Pointer Code Execution"; flow:from_server,established; flowbits:isset,ETPRO.RealPlayer.2010-3747; content:"<script"; content:"cdda|3a|//"; pcre:"/(?<!\<\/script)cdda\x3a\/\//iR"; reference:cve,CVE-2010-3747; reference:bugtraq,44144; classtype:attempted-user; sid:2800845; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Microsoft Internet Explorer CSS Tags Remote Code Execution Attempt"; flow:established,to_client; content:"table"; nocase; content:"position|3A|absolute"; nocase; within:30; content:"clip|3A|rect"; fast_pattern; nocase; within:15; reference:bid,44536; reference:cve,2010-3962; classtype:attempted-user; sid:2011891; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft IE CSS Clip Attribute Memory Corruption (POC SPECIFIC)"; flow:from_server,established; file_data; content:"position|3A|absolute|3B|"; content:"clip|3A|"; within:20; content:"rect|28|0|29|"; fast_pattern; within:20; reference:url,extraexploit.blogspot.com/2010/11/cve-2010-3962-yet-another-internet.html; reference:url,www.symantec.com/connect/blogs/new-ie-0-day-used-targeted-attacks; reference:url,blog.fireeye.com/research/2010/11/ie-0-day-hupigon-joins-the-party.html; reference:url,www.offensive-security.com/0day/ie-0day.txt; reference:url,www.metasploit.com/redmine/projects/framework/repository/entry/modules/exploits/windows/browser/ms10_xxx_ie_css_clip.rb; classtype:attempted-user; sid:2011892; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Firefox Interleaving document.write and appendChild Overflow (POC SPECIFIC)"; flow:from_server,established; content:"document.body.appendChild(cobj)"; content:"document.getElementById|28 22|suv|22 29|.innerHTML"; content:"new|20|Array|28|"; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=607222; reference:url,blog.mozilla.com/security/2010/10/26/critical-vulnerability-in-firefox-3-5-and-firefox-3-6/; classtype:attempted-user; sid:2011893; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Adobe Reader 9.4 this.printSeps Memory Corruption Attempt"; flow:established,to_client; content:".printSeps"; nocase; pcre:"/(this|doc)\x2EprintSeps/i"; reference:bid,44638; reference:cve,2010-4091; classtype:attempted-user; sid:2011910; rev:6;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office RTF Stack Buffer Overflow Trigger"; flow:from_server,established; flowbits:isset,ETPRO.RTF; content:"|7B 5C|sn|20|pFragments|7D|"; content:"|7B 5C|sv|20|"; within:20; byte_test:4,>,0x4,8,relative,little,hex,string; reference:cve,2010-3333; classtype:attempted-admin; sid:2800872; rev:2;)

#
#alert tcp $EXTERNAL_NET any -> $HOME_NET 554 (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Player Network Sharing Service RTSP Code Execution"; flow:to_server,established; content:"SETUP"; depth:5; nocase; content:"|0d 0a 0d 0a|"; distance:0; isdataat:8,relative; reference:cve,2010-3225; reference:bugtraq,43776; classtype:attempted-user; sid:2800878; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader printSeps Memory Corruption"; flow:from_server,established; content:"|0d 0a 0d 0a|%PDF"; content:"JavaScript"; nocase; content:".printSeps"; nocase; distance:0; reference:cve,CVE-2010-4091; reference:bugtraq,44638; classtype:attempted-user; sid:2800909; rev:6;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT ADOBE ActionScript SetTarget Denial of Service"; flow:established,from_server; content:"FWS"; content:"|8B 02 00 72 00|"; content:"|52|"; distance:16; within:15; content:"flash|00|display|00|BitmapData|00|loadBitmap"; distance:-75; within:45; reference:cve,CVE-2010-3648; reference:url,www.opaque.net/~dave/swf5action.html; reference:url,www.adobe.com/support/security/bulletins/apsb10-26.html; classtype:attempted-user; sid:2800913; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of String.fromCharCode % Encoding"; flow:established,to_client; content:"%53%74%72%69%6e%67%2e%66%72%6f%6d%43%68%61%72%43%6f%64%65"; nocase; fast_pattern; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012041; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of String.fromCharCode %u UTF-8 Encoding"; flow:established,to_client; content:"%u53%u74%u72%u69%u6e%u67%u2e%u66%u72%u6f%u6d%u43%u68%u61%u72%u43%u6f%u64%u65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012042; rev:4;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of charCodeAt % Encoding"; flow:established,to_client; content:"%63%68%61%72%43%6f%64%65%41%74"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012043; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of charCodeAt %u UTF-8 Encoding"; flow:established,to_client; content:"%u63%u68%u61%u72%u43%u6f%u64%u65%u41%u74"; nocase; fast_pattern; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012044; rev:2;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Office Insecure Library Loading WebDAV PROPFIND pptimpconv.dll"; flow:to_server; content:"PROPFIND"; http_method;  content:"pptimpconv.dll"; http_uri; reference:cve,2010-3337; reference:cve,2010-3141; reference:bugtraq,42628; reference:secunia,41063; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-087.mspx; classtype:attempted-user; sid:2800966; rev:4;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Office Insecure Library Loading WebDAV GET pptimpconv.dll"; flow:to_server; content:"GET"; http_method; content:"pptimpconv.dll"; http_uri; reference:cve,2010-3337; reference:cve,2010-3141; reference:bugtraq,42628; reference:secunia,41063; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-087.mspx; classtype:attempted-user; sid:2800967; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Office Powerpoint Insecure Library Loading WebDAV PROPFIND pp7x32.dll"; flow:to_server; content:"PROPFIND"; http_method; content:"pp7x32.dll"; http_uri; reference:cve,2010-3337; reference:secunia,41063; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-087.mspx; reference:cve,2011-3396; classtype:attempted-user; sid:2800968; rev:5;)

#nitro security
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Office Powerpoint Insecure Library Loading WebDAV PROPFIND xlimpconv.dll"; flow:to_server; content:"PROPFIND"; http_method; content:"xlimpconv.dll"; http_uri; reference:cve,2010-3142; reference:secunia,41063; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-087.mspx; classtype:attempted-user; sid:2800970; rev:5;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Office Powerpoint Insecure Library Loading WebDAV GET xlimpconv.dll"; flow:to_server,established; content:"GET"; http_method; content:"xlimpconv.dll"; http_uri; reference:cve,2010-3142; reference:secunia,41063; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-087.mspx; classtype:attempted-user; sid:2800971; rev:5;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Potential Internet_Explorer IE6 animation behavior Vulnerability"; flow:from_server,established; content:"|23|default|23|anim"; reference:cve,2010-3343; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-090.mspx; classtype:attempted-user; sid:2800972; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Sharepoint service remote code execution convertTo"; flow:from_server,established; content:"IDocumentConversionsLauncher"; nocase; content:".ConvertFile"; nocase; distance:0; content:"convertTo"; nocase; pcre:"/<\s*convertTo[^>]*>\w*[^\w<]/i"; reference:cve,2010-3964; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-104.mspx; classtype:attempted-user; sid:2800973; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Sharepoint service remote code execution - convertFrom"; flow:from_server,established; content:"IDocumentConversionsLauncher"; nocase; content:".ConvertFile"; nocase; distance:0; content:"convertFrom"; nocase; pcre:"/<\s*convertFrom[^>]*>\w*[^\w<]/i"; reference:cve,2010-3964; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-104.mspx; classtype:attempted-user; sid:2800974; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Winzip 15.0 WZFLDVW.OCX IconIndex Property Denial of Service"; flow:established,to_client; content:"clsid"; nocase; content:"4E3770F4-1937-4F05-B9A2-959BE7321909"; nocase; content:"|22|IconIndex|22|"; distance:0; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(\x22|\x27)\s*clsid\s*\x3a\s*{?\s*4E3770F4-1937-4F05-B9A2-959BE7321909\s*}?(.*)\>/si"; reference:url,www.exploit-db.com/exploits/15695/; classtype:misc-attack; sid:2012052; rev:1;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Winzip 15.0 WZFLDVW.OCX Text Property Denial of Service"; flow:established,to_client; content:"clsid"; nocase; content:"4E3770F4-1937-4F05-B9A2-959BE7321909"; nocase; content:"|22|Text|22|"; distance:0; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(\x22|\x27)\s*clsid\s*\x3a\s*{?\s*4E3770F4-1937-4F05-B9A2-959BE7321909\s*}?(.*)\>/si"; reference:url,www.exploit-db.com/exploits/15694/; classtype:misc-attack; sid:2012053; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft OLE Compound File Magic Bytes Flowbit Set"; flow:to_client,established; file_data; content:"|d0 cf 11 e0 a1 b1 1a e1|"; within:8; content:!".msi"; flowbits:set,OLE.CompoundFile; flowbits:noalert; classtype:protocol-command-decode; sid:2012520; rev:7;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Windows Movie Maker Insecure Library Loading WebDAV PROPFIND hhctrl.ocx"; flow:to_server,established; content:"System32|5c|hhctrl.ocx"; http_uri; nocase; content:"PROPFIND"; http_method; reference:cve,2010-3967; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-093.mspx; classtype:attempted-user; sid:2801000; rev:4;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft Windows Movie Maker Insecure Library Loading WebDAV GET hhctrl.ocx"; flow:to_server,established; content:"System32|5c|hhctrl.ocx"; http_uri; content:"GET"; http_method; nocase; reference:cve,2010-3967; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-093.mspx; classtype:attempted-user; sid:2801001; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Flash Player Flash6.ocx AllowScriptAccess Denial of Service"; flow:established,to_client; content:"clsid"; nocase; content:"D27CDB6E-AE6D-11cf-96B8-444553540000"; nocase; content:"AllowScriptAccess"; distance:0; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(\x22|\x27)\s*clsid\s*\x3a\s*{?\s*D27CDB6E-AE6D-11cf-96B8-444553540000\s*}?(.*)\>/si"; reference:url,www.exploit-db.com/exploits/15698/; classtype:attempted-dos; sid:2012056; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of document.write % Encoding"; flow:established,to_client; content:"%64%6f%63%75%6d%65%6e%74%2e%77%72%69%74%65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012059; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of document.write %u UTF-8 Encoding"; flow:established,to_client; content:"%u64%u6f%u63%u75%u6d%u65%u6e%u74%u2e%u77%u72%u69%u74%u65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012060; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of arguments.callee % Encoding"; flow:established,to_client; content:"%61%72%67%75%6d%65%6e%74%73%2e%63%61%6c%6c%65%65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012061; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of arguments.callee %u UTF-8 Encoding"; flow:established,to_client; content:"%u61%u72%u67%u75%u6d%u65%u6e%u74%u73%u2e%u63%u61%u6c%u6c%u65%u65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012062; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Foxit PDF Reader Title Stack Overflow"; flow:established,to_client; content:"|0d 0a 0d 0a|PDF-"; content:"|2f|Title"; nocase; distance:0; isdataat:540,relative; content:!"|0A|"; within:540; reference:url,www.exploit-db.com/exploits/15532/; classtype:attempted-user; sid:2012064; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Internet Explorer CSS Parser Remote Code Execution Attempt"; flow:established,to_client; content:"@import url(|22|"; nocase; content:"css|22|)|3B|"; nocase; within:40; content:"@import url(|22|"; nocase; distance:0; content:"css|22|)|3B|"; nocase; within:40; content:"@import url(|22|"; nocase; distance:0; content:"css|22|)|3B|"; nocase; within:40; content:"@import url(|22|"; nocase; distance:0; content:"css|22|)|3B|"; nocase; within:40; reference:url,seclists.org/fulldisclosure/2010/Dec/110; reference:url,www.breakingpointsystems.com/community/blog/ie-vulnerability/; reference:url,seclists.org/fulldisclosure/2010/Dec/110; reference:url,www.breakingpointsystems.com/community/blog/ie-vulnerability/; reference:url,www.microsoft.com/technet/security/advisory/2488013.mspx; reference:bid,45246; reference:cve,2010-3971; classtype:attempted-user; sid:2012075; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Oracle Java 6 Object Tag launchjnlp docbase Parameters Flowbits Set"; flow:to_client,established; content:"NtDllImageBase|22|"; nocase; content:"getModuleInfos|28|"; distance:0; content:"|27|ntdll.dll|27|"; nocase; within:50; flowbits:set,NtDll.ImageBase.Module.Called; flowbits:noalert; classtype:not-suspicious; sid:2012085; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Oracle Java 6 Object Tag launchjnlp docbase Parameters Buffer Overflow"; flow:to_client,established; flowbits:isset,NtDll.ImageBase.Module.Called; content:"ZwProtectVirtualMemory|22|"; content:"strDup|28|"; distance:0; content:"<object|20|"; distance:0; content:"application|2f|x|2d|java|2d|applet"; within:35; content:"|3c|param|20|name"; distance:0; content:"|22|launchjnlp|22|"; within:20; content:"|3c|param|20|name"; distance:0; content:"|22|docbase|22|"; within:20; content:"|3c|fieldset|3e 3c|legend|3e|"; distance:0; content:"object"; within:10; content:"|2e|innerHTML"; distance:0; reference:url,www.exploit-db.com/exploits/15241/; reference:cve,2010-3552; reference:bid,44023; classtype:attempted-user; sid:2012100; rev:6;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer IE CSS Multiple Dereference Exploit"; flow:from_server,established; content:"|40|import url|28 22|"; content:"|40|import url|28 22|"; distance:0; within:30; content:"|40|import url|28 22|"; distance:0; within:30; content:"|40|import url|28 22|"; distance:0; within:30; content:"|40|import url|28 22|"; distance:0; within:30; pcre:"/\x40import url\x28\x22(.*)\x22\x29\x3b.*\x40import url\x28\x22(\1)\x22\x29\x3b.*\x40import url\x28\x22(\1)\x22\x29\x3b.*\x40import url\x28\x22(\1)\x22\x29\x3b.*\x40import url\x28\x22(\1)\x22\x29\x3b/mi"; reference:url,seclists.org/fulldisclosure/2010/Dec/110; reference:url,www.metasploit.com/redmine/projects/framework/repository/entry/modules/exploits/windows/browser/ms11_xxx_ie_css_import.rb; reference:url,www.breakingpointsystems.com/community/blog/ie-vulnerability/; reference:url,www.microsoft.com/technet/security/advisory/2488013.mspx; reference:bid,45246; reference:cve,2010-3971; classtype:attempted-admin; sid:2801176; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer IE CSS Multiple Dereference Signature unicode"; flow:from_server,established; content:"|40 00|i|00|m|00|p|00|o|00|r|00|t|00| |00|u|00|r|00|l|00 28 00 22|"; content:"|40 00|i|00|m|00|p|00|o|00|r|00|t|00| |00|u|00|r|00|l|00 28 00 22|"; distance:0; within:50; content:"|40 00|i|00|m|00|p|00|o|00|r|00|t|00| |00|u|00|r|00|l|00 28 00 22|"; distance:0; within:50; content:"|40 00|i|00|m|00|p|00|o|00|r|00|t|00| |00|u|00|r|00|l|00 28 00 22|"; distance:0; within:50; reference:url,seclists.org/fulldisclosure/2010/Dec/110; reference:url,www.metasploit.com/redmine/projects/framework/repository/entry/modules/exploits/windows/browser/ms11_xxx_ie_css_import.rb; reference:url,www.breakingpointsystems.com/community/blog/ie-vulnerability/; reference:url,www.microsoft.com/technet/security/advisory/2488013.mspx; reference:bid,45246; reference:cve,2010-3971; classtype:attempted-admin; sid:2801177; rev:6;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari WebKit Menu OnChange Memory Corruption"; flow:from_server,established; content:".onchange|20 3D|"; content:"<select id|3D|"; content:"element.size|20 3D|"; reference:url,trac.webkit.org/browser/trunk/LayoutTests/fast/events/select-onchange-crash.html; reference:cve,CVE-2010-1814; classtype:attempted-user; sid:2801204; rev:1;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of arguments.callee %u UTF-16 Encoding"; flow:established,to_client; content:"%u6172%u6775%u6d65%u6e74%u732e%u6361%u6c6c%u6565"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012106; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of document.write %u UTF-16 Encoding"; flow:established,to_client; content:"%u646f%u6375%u6d65%u6e74%u2e77%u7269%u7465"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012107; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of charCodeAt %u UTF-16 Encoding"; flow:established,to_client; content:"%u6368%u6172%u436f%u6465%u4174"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012108; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of String.fromCharCode %u UTF-16 Encoding"; flow:established,to_client; content:"%u5374%u7269%u6e67%u2e66%u726f%u6d43%u6861%u7243%u6f64%u65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012109; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Hex Obfuscation Usage On Webpage"; flow:established,to_client; content:"|5C|x"; nocase; content:"|5C|x"; nocase; distance:2; within:2; content:"|5C|x"; nocase; distance:2; within:2; content:"|5C|x"; nocase; distance:2; within:2; content:"|5C|x"; nocase; distance:2; within:2; pcre:"/\x5Cx[a-f,0-9]{2}\x5Cx[a-f,0-9]{2}\x5Cx[a-f,0-9]{2}\x5Cx[a-f,0-9]{2}\x5Cx[a-f,0-9]{2}/i"; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; classtype:bad-unknown; sid:2012119; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Fax Services Cover Page Editor Flowbit Set"; flow:from_server,established; content:"FAXCOVER-VER"; flowbits:set,ETPRO.MSCOV; flowbits:noalert; reference:bugtraq,45583; reference:cve,2010-3974; reference:url,www.microsoft.com/technet/security/bulletin/MS11-024.mspx; classtype:attempted-user; sid:2801216; rev:1;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Fax Services Cover Page Editor Heap Buffer Overflow (Published Exploit)"; flow:from_server,established; flowbits:isset,ETPRO.MSCOV; content:"CDrawPoly"; content:"|8f 41 41 41|"; distance:52; within:4; reference:bugtraq,45583; reference:cve,2010-3974; reference:url,www.microsoft.com/technet/security/bulletin/MS11-024.mspx; classtype:attempted-admin; sid:2801217; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT AVI RIFF Chunk Access Flowbit Set"; flow:established,to_client; flowbits:set,ET.AVI.RIFF.Chunk; content:"|52 49 46 46|"; content:"|41 56 49 20|"; distance:4; within:4; flowbits:noalert; classtype:not-suspicious; sid:2012142; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Windows MPEG Layer-3 Audio Decoder Buffer Overflow"; flow:established,to_client; flowbits:isset,ET.AVI.RIFF.Chunk; content:"|73 74 72 66|"; content:"|93 00 00 00|"; distance:8; within:4; reference:cve,2010-0480; reference:url,www.exploit-db.com/moaub-5-microsoft-mpeg-layer-3-audio-stack-based-overflow/; reference:url,www.exploit-db.com/exploits/14895/; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-026.mspx; classtype:attempted-user; sid:2012143; rev:3;)

#by evejou
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT MS10-090 IE CSS Exploit Metasploit POC Specific Unicoded"; flow:to_client,established; content:"|40 00 69 00 6d 00 70 00 6f 00 72 00 74 00|"; content:"|40 00 69 00 6d 00 70 00 6f 00 72 00 74 00|"; distance:0; content:"|40 00 69 00 6d 00 70 00 6f 00 72 00 74 00|"; distance:0; pcre:"/@\x00i\x00m\x00p\x00o\x00r\x00t\x00\x20.{4,20}[^\x00\w\s.]/sG"; reference:cve,CVE-2010-3971; reference:url,breakingpointsystems.com/community/blog/ie-vulnerability/; reference:bid,45246; classtype:attempted-admin; sid:2012149; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT DXF Extension File Detection Access Flowbit Set"; flow:established,to_client; flowbits:set,DXF.Ext.Access; content:"|20 20 30|"; content:"|0A 53 45 43 54 49 4F 4E|"; within:10; content:"|20 20 32|"; within:5; content:"|48 45 41 44 45 52|"; distance:0; content:"|0a|"; within:2; flowbits:noalert; classtype:not-suspicious; sid:2012152; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Office Visio DXF File Processing Remote Code Execution"; flow:established,to_client; flowbits:isset,DXF.Ext.Access; content:"|0A 45 4E 44 53 45 43|"; content:!"|0a|"; within:2; byte_test:1,>,81,2,relative; reference:url,www.exploit-db.com/moaub-8-microsoft-office-visio-dxf-file-stack-overflow; reference:url,www.exploit-db.com/exploits/14944/; reference:cve,2010-1681; reference:url,www.microsoft.com/technet/security/bulletin/ms10-028.mspx; reference:bid,39836; classtype:attempted-user; sid:2012153; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Graphics Rendering Engine Thumbnail Image Stack Buffer Overflow"; flow:from_server; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|E0 85 9F F2 F9 4F 68 10 AB 91 08 00 2B 27 B3 D9|"; content:"|47 00|"; distance:0; content:"|08 00 00 00|"; distance:10; within:4; byte_test:4,>,0x7fffffff,32,relative,little; reference:cve,2010-3970; reference:bugtraq,45662; classtype:attempted-user; sid:2801229; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Graphics Rendering Engine Thumbnail Image Stack Buffer Overflow Public Exploit"; flow:from_server,established; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|E0 85 9F F2 F9 4F 68 10 AB 91 08 00 2B 27 B3 D9|"; content:"|47 00|"; distance:0; content:"|08 00 00 00|"; distance:10; within:4; byte_test:4,>,0x7fffffff,32,relative,little; reference:cve,CVE-2010-3970; reference:bugtraq,45662; classtype:attempted-user; sid:2801230; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer IE CSS Multiple Dereference Vulnerability Exploit Specific Trigger"; flow:from_server,established; content:"jmpecx"; flowbits:set,ETPRO.IE.CSS.EXPLOIT; flowbits:noalert; reference:url,www.metasploit.com/modules/exploit/windows/browser/ms11_xxx_ie_css_import; classtype:attempted-user; sid:2801232; rev:1;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer IE CSS Multiple Dereference Vulnerability Exploit Specific IE 6.2"; flow:from_server,established; flowbits:isset,ETPRO.IE.CSS.EXPLOIT; content:"document|2E|getElementsByTagName|28 22|head|22 29 5B 30 5D 2E|appendChild|28|vlink|29|"; content:"shref|3D 22 5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|xC0|5C|"; distance:-170; within:75; reference:url,www.metasploit.com/modules/exploit/windows/browser/ms11_xxx_ie_css_import; classtype:attempted-user; sid:2801233; rev:1;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer IE CSS Multiple Dereference Vulnerability Exploit Specific IE 7.x"; flow:from_server,established; flowbits:isset,ETPRO.IE.CSS.EXPLOIT; content:"document|2E|getElementsByTagName|28 22|head|22 29 5B 30 5D 2E|appendChild|28|vlink|29|"; content:"shref|3D 22 5C 78|20|5C 78|E0|5C 78|5A|5C 78|10|5C 78|20|5C 78|E0|5C 78|5A|5C 78|10|5C 78|20|5C 78|E0|5C 78|5A|5C 78|10|5C 78|20|5C 78|E0|5C 78|5A|5C 78|10"; distance:-170; within:75; reference:url,www.metasploit.com/modules/exploit/windows/browser/ms11_xxx_ie_css_import; classtype:attempted-user; sid:2801234; rev:1;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption in Microsoft Data Access Object"; flow:from_server,established; content:"document.getElementById"; nocase; content:".recordset"; nocase; distance:0; within:256; content:"CacheSize = 0x"; byte_test:8,>,0x3ffffffe,0,relative,hex,string; reference:cve,CVE-2011-0027; classtype:attempted-user; sid:2801240; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT eval String.fromCharCode String Which May Be Malicious"; flow:established,to_client; content:"eval|28|"; fast_pattern; nocase; content:"String.fromCharCode|28|"; nocase; within:40; pcre:"/eval\x28(String\x2EfromCharCode\x28|[a-z,0-9]{1,20}\x28String\x2EfromCharCode\x28)/i"; classtype:bad-unknown; sid:2012173; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Reader and Acrobat U3D File Invalid Array Index Remote Code Execution Attempt"; flow:established,to_client; content:"/U3D/Length 172"; pcre:"/<<[^>]*\x2FU3D\x2FLength\x20172[0-5][0-9]{2}/sm"; reference:url,labs.idefense.com/intelligence/vulnerabilities/display.php?id=827; reference:url,www.adobe.com/support/security/bulletins/apsb09-15.html; reference:bid,36638; reference:cve,2009-2990; classtype:attempted-user; sid:2012179; rev:6;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Kodak Image Viewer Flowbit Set Big Endian"; flow:from_server,established; content:"|4D 4D 00 2A|"; flowbits:set,ETPRO.TIFF; flowbits:noalert; reference:cve,CVE-2007-2217; reference:url,www.microsoft.com/technet/security/bulletin/MS07-055.mspx; classtype:attempted-user; sid:2801269; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Kodak Image Viewer Flowbit Set Little Endian"; flow:from_server,established; content:"|49 49 2A 00|"; flowbits:set,ETPRO.TIFF; flowbits:noalert; reference:CVE,CVE-2007-2217; reference:url,www.microsoft.com/technet/security/bulletin/MS07-055.mspx; classtype:attempted-user; sid:2801270; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Malicious String.fromCharCode with charCodeAt String"; flow:established,to_client; content:"String.fromCharCode|28|"; nocase; content:"|2E|charCodeAt|28|"; nocase; within:32; pcre:"/String.fromCharCode|28|[a-z,0-9]{1,20}\x2EcharCodeAt\x28/i"; classtype:misc-activity; sid:2012205; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Cover Sheet Double Deference Vulnerability 0-day"; flow:from_server,established; flowbits:isset,ETPRO.MSCOV; content:"CDrawTexta"; byte_test:2,>,0x7000,0,relative,little; reference:url,www.exploit-db.com/exploits/16024/; reference:url,aluigi.org/poc/fxscover_1.cov; reference:url,www.exploit-db.com/sploits/16024_fxscover_1.cov; classtype:attempted-user; sid:2801282; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Google Chrome Uninitialized bug_report Pointer Code Execution (Published Exploit)"; flow:from_server,established; content:"|0B FD E6 6A 77 64 88 61 65 80 29 38 4C 3E 3D E4|"; reference:bugtraq,45788; classtype:attempted-user; sid:2801280; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible % Encoded Iframe Tag"; flow:established,to_client; content:"%69%66%72%61%6d%65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,www.guardian.co.uk/technology/2008/apr/03/security.google; classtype:bad-unknown; sid:2012241; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible %u UTF-8 Encoded Iframe Tag"; flow:established,to_client; content:"%u69%u66%u72%u61%u6d%u65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,www.guardian.co.uk/technology/2008/apr/03/security.google; classtype:bad-unknown; sid:2012242; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible %u UTF-16 Encoded Iframe Tag"; flow:established,to_client; content:"%u6966%u7261%u6d65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,www.guardian.co.uk/technology/2008/apr/03/security.google; classtype:bad-unknown; sid:2012243; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible # Encoded Iframe Tag"; flow:established,to_client; content:"#69#66#72#61#6d#65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,www.guardian.co.uk/technology/2008/apr/03/security.google; classtype:bad-unknown; sid:2012244; rev:2;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of document.write # Encoding"; flow:established,to_client; content:"#64#6f#63#75#6d#65#6e#74#2e#77#72#69#74#65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012245; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of parseInt % Encoding"; flow:established,to_client; content:"%70%61%72%73%65%49%6e%74"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,www.w3schools.com/jsref/jsref_parseInt.asp; classtype:bad-unknown; sid:2012260; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of parseInt %u UTF-8 Encoding"; flow:established,to_client; content:"%u70%u61%u72%u73%u65%u49%u6e%u74"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,www.w3schools.com/jsref/jsref_parseInt.asp; classtype:bad-unknown; sid:2012261; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of parseInt %u UTF-16 Encoding"; flow:established,to_client; content:"%u7061%u7273%u6549%u6e74"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; reference:url,www.w3schools.com/jsref/jsref_parseInt.asp; classtype:bad-unknown; sid:2012262; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of Script Tag % Encoding"; flow:established,to_client; content:"%3c%73%63%72%69%70%74"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012263; rev:4;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of Script Tag %u UTF-8 Encoding"; flow:established,to_client; content:"%u3c%u73%u63%u72%u69%u70%u74"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012264; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of Script Tag %u UTF-16 Encoding"; flow:established,to_client; content:"%u3c73%u6372%u6970%u74"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012265; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer MHTML Cross Site Scripting"; flow:from_server,established; content:"ref|3D 22|mhtml"; nocase; content:"|3a 2f 2f|"; within:10;  reference:cve,CVE-2011-0096; reference:bugtraq,46055; classtype:attempted-user; sid:2801313; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer MHTML Cross Site Scripting src"; flow:from_server,established; content:"src|3D 22|mhtml"; nocase; content:"|3a 2f 2f|"; within:10; reference:cve,CVE-2011-0096; reference:bugtraq,46055; classtype:attempted-user; sid:2801314; rev:2;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of unescape % Encoding"; flow:established,to_client; content:"%75%6e%65%73%63%61%70%65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012266; rev:4;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of unescape %u UTF-8 Encoding"; flow:established,to_client; content:"%u75%u6e%u65%u73%u63%u61%u70%u65"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012267; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of unescape %u UTF-16 Encoding"; flow:established,to_client; content:"%u756e%u6573%u6361%u7065"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012268; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of substr % Encoding"; flow:established,to_client; content:"%73%75%62%73%74%72"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012269; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of substr %u UTF-8 Encoding"; flow:established,to_client; content:"%u73%u75%u62%u73%u74%u72"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012270; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of substr %u UTF-16 Encoding"; flow:established,to_client; content:"%u7375%u6273%u7472"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012271; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of eval % Encoding"; flow:established,to_client; content:"%65%76%61%6c"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012272; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of eval %u UTF-8 Encoding"; flow:established,to_client; content:"%u65%u76%u61%u6c"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012273; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of eval %u UTF-16 Encoding"; flow:established,to_client; content:"%u6576%u616c"; nocase; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012274; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MHTML Attempted Script Execution"; flow:to_client,established; content:"mhtml|3A|http|3A 2F 2F|"; reference:url,www.wooyun.org/bugs/wooyun-2010-01199; reference:cve,CVE-2011-0096; classtype:attempted-user; sid:2801321; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer insertBefore Document Memory Corruption"; flow:from_server,established; content:"document.insertBefore|28|document"; content:"document.open"; distance:0; reference:cve,CVE-2011-0036; classtype:attempted-user; sid:2801324; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer getElementByID onCellChange Memory Corruption"; flow:from_server,established; content:"document.getElementById("; content:").innerHTML=|22 22|"; distance:0; within:20; content:"onCellChange="; distance:0; content:"()|3B 22|"; distance:0; within:15; reference:cve,CVE-2011-0035; classtype:attempted-user; sid:2801325; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Jscript Decoding Information Disclosure Attempt"; flow:established,from_server; content:"Start Encode**#@~^"; nocase; content:!"=="; distance:6; within:8; reference:cve,2011-0031; classtype:attempted-user; sid:2801327; rev:2;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF Memory Corruption /Ff Dictionary Key Corruption"; flow:from_server,established; content:"|25|PDF"; content:"|2F|Ff|20|"; distance:0; byte_test:8,>,0x03,0,relative,little,string,hex; reference:cve,2011-0589; reference:url,www.cesg.gov.uk; classtype:attempted-user; sid:2801334; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Obfuscated Javascript // ptth"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"//|3a|ptth"; classtype:bad-unknown; sid:2012325; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Obfuscated Javascript // ptth (escaped)"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"%2F%2F%3A%70%74%74%68"; classtype:bad-unknown; sid:2012326; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Shell Graphics Thumbnail Image Integer Overflow 1"; flow:from_server,established; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|C0 9C 83 4A FF F8 CE 11 A0 6B 00 AA 00 A7 11 91|"; content:"T|00|h|00|u|00|m|00|b|00|n|00|a|00|i|00|l"; distance:0; nocase; content:"|41 00|"; distance:0; byte_test:4,>,0x55555554,10,relative,little; reference:cve,2010-3970; reference:bugtraq,45662; classtype:attempted-user; sid:2801387; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Shell Graphics Thumbnail Image Integer Overflow 2"; flow:from_server,established; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|C0 9C 83 4A FF F8 CE 11 A0 6B 00 AA 00 A7 11 91|"; content:"Thumbnail"; distance:0; nocase; content:"|41 00|"; distance:0; byte_test:4,>,0x55555554,10,relative,little; reference:cve,2010-3970; reference:bugtraq,45662; classtype:attempted-user; sid:2801388; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of replace Javascript Function % Encoding"; flow:established,to_client; content:"%72%65%70%6c%61%63%65%28"; nocase; fast_pattern; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012398; rev:4;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of replace Javascript Function %u UTF-8 Encoding"; flow:established,to_client; content:"%u72%u65%u70%u6c%u61%u63%u65%u28"; nocase; fast_pattern; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012399; rev:4;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Hex Obfuscation of replace Javascript Function %u UTF-16 Encoding"; flow:established,to_client; content:"%u7265%u706c%u6163%u6528"; nocase; fast_pattern; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.sophos.com/security/technical-papers/malware_with_your_mocha.html; classtype:bad-unknown; sid:2012400; rev:4;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Likely Hostile Eval CRYPT.obfuscate Usage"; flow:established,to_client; content:"eval|28|CRYPT.obfuscate|28|"; nocase; fast_pattern; reference:url,research.zscaler.com/2010/05/malicious-hidden-iframes-using-publicly.html; classtype:bad-unknown; sid:2012404; rev:2;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer 8 IESHIMS.DLL Insecure Library Loading"; flow:to_server; content:"GET"; http_method; content:"/IESHIMS.DLL"; http_uri; nocase; reference:cve,2011-0038; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-003.mspx; classtype:attempted-user; sid:2801446; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Windows Media Player ehtrace.dll Insecure Library Loading"; flow:to_server,established; content:"/ehtrace.dll"; http_uri; nocase; content:"GET"; http_method; reference:cve,2011-0038; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-015.mspx; classtype:attempted-user; sid:2801454; rev:5;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Groove 2007 Insecure Library Loading Code Execution"; flow:to_server,established; content:"/mso.dll"; http_uri; nocase; content:"GET"; http_method; reference:cve,2011-0108; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-016.mspx; classtype:attempted-user; sid:2801460; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Windows Media ASF File Download SET"; flow:established,from_server; flowbits:set,ETPRO.MS_ASF; flowbits:noalert; file_data; content:"|30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|"; reference:cve,2011-0042; reference:url,www.microsoft.com/technet/security/bulletin/MS11-015.mspx; classtype:attempted-user; sid:2801466; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Windows Media Remote Code Execution"; flow:established,from_server; flowbits:isset,ETPRO.MS_ASF; file_data; content:"|B7 BE 35 11 39 3A 8A 47 98 D9 15 C7 6B 00 EB 69|"; reference:url,www.microsoft.com/technet/security/bulletin/MS11-015.mspx; reference:cve,2011-0042; classtype:attempted-user; sid:2801467; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Insecure Library Loading Request (.dll)"; flow:to_server,established; content:"/.dll"; nocase; http_uri; content:"GET"; http_method; pcre:"/\/\.dll$/Ui"; reference:cve,2011-0029; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-017.mspx; classtype:attempted-user; sid:2801468; rev:8;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Address Book Insecure msoeres32.dll Library Loading"; flow:to_server,established; content:"/msoeres32.dll"; http_uri; reference:cve,2010-3147; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-096.mspx; classtype:attempted-user; sid:2801478; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Address Book wab32res.dll Insecure Library Loading"; flow:to_server,established; content:"/wab32res.dll"; http_uri; reference:cve,2010-3147; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-096.mspx; classtype:attempted-user; sid:2801484; rev:6;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Backup Manager fveapi.dll Insecure Library Loading fveapi.dll"; flow:to_server,established; content:"/fveapi.dll"; http_uri; reference:cve,2010-3145; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-001.mspx; classtype:attempted-user; sid:2801490; rev:5;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Connection Signup Wizard smmscrpt.dll Insecure Library Loading"; flow:to_server,established; content:"/smmscrpt.dll"; http_uri; reference:cve,2010-3144; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-097.mspx; reference:url,www.exploit-db.com/exploits/14754/; classtype:attempted-user; sid:2801496; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Encoder PRX File msxml.dll Insecure Library Loading"; flow:to_server,established; content:"/msxml.dll"; http_uri; reference:cve,2010-3965; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-094.mspx; classtype:attempted-user; sid:2801502; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Multiple Load Library Vulns wintab32.dll Insecure Library Loading"; flow:to_server,established; content:"/Wintab32.dll"; http_uri; nocase; reference:url,www.exploit-db.com/exploits/14750/; reference:cve,2010-3127; reference:url,www.adobe.com/support/security/bulletins/apsb10-30.html; reference:cve,2012-0016; classtype:attempted-user; sid:2801508; rev:5;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Multiple Load Library Vulns dwmapi.dll Insecure Library Loading"; flow:to_server,established; content:"GET"; http_method; content:"/dwmapi.dll"; nocase; http_uri; reference:cve,2010-3131; reference:url,www.secunia.com/advisories/41110; reference:url,www.secunia.com/advisories/41233; reference:url,www.secunia.com/advisories/41095; reference:url,www.exploit-db.com/exploits/14728/; reference:url,www.exploit-db.com/exploits/14730/; classtype:attempted-user; sid:2801514; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Adobe Illustrator aires.dll Insecure Library Loading"; flow:to_server,established; content:"GET"; http_method; content:"/aires.dll"; http_uri; reference:cve,2010-3152; reference:url,www.adobe.com/support/security/bulletins/apsb10-29.html; classtype:attempted-user; sid:2801520; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint pp7x32.dll Insecure Library Loading"; flow:to_server,established; content:"/pp7x32.dll"; nocase; http_uri; content:"GET"; http_method; reference:cve,2011-3396; reference:cve,2010-3337; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:2801526; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint pp4x322.dll Insecure Library Loading"; flow:to_server,established; content:"/pp4x322.dll"; nocase; http_uri; content:"GET"; http_method;  reference:cve,2010-3337; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:2801532; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint msapsspc.dll Insecure Library Loading"; flow:to_server,established; content:"/msapsspc.dll"; http_uri; reference:cve,2010-3337; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:2801538; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint schannel.dll Insecure Library Loading"; flow:to_server,established; content:"/schannel.dll"; nocase; http_uri; content:"GET"; http_method;  reference:cve,2010-3337; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:2801544; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint digest.dll Insecure Library Loading"; flow:to_server,established; content:"/digest.dll"; http_uri; reference:cve,2010-3337; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:2801550; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint msnsspc.dll Insecure Library"; flow:to_server,established; content:"/msnsspc.dll"; http_uri; reference:cve,2010-3337; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:2801556; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows SDK for Windows 7 and NET Framework 4 GraphEdit measure.dll Insecure Library Loading"; flow:to_server,established; content:"/measure.dll"; nocase; http_uri; content:"GET"; http_method; reference:url,www.secunia.com/advisories/41202; reference:url,www.microsoft.com/technet/security/advisory/2269637.mspx; classtype:attempted-user; sid:2801568; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT IBM Lotus Notes nnoteswc.dll Insecure Library Loading"; flow:to_server,established; content:"/nnoteswc.dll"; http_uri; reference:url,www.secunia.com/advisories/41223; classtype:attempted-user; sid:2801574; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT IBM Lotus Notes nlsxbe.dll Insecure Library Loading"; flow:to_server,established; content:"/nlsxbe.dll"; nocase; http_uri; content:"GET"; http_method; reference:url,www.secunia.com/advisories/41223; classtype:attempted-user; sid:2801580; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Multiple Load Library Vulns ibfs32.dll"; flow:to_server,established; content:"/ibfs32.dll"; nocase; http_uri; content:"GET"; http_method;  reference:cve,2010-3150; reference:url,www.secunia.com/advisories/41130; classtype:attempted-user; sid:2801586; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime PictureViewer CoreGraphics.dll Insecure Library Loading"; flow:to_server,established; content:"/CoreGraphics.dll"; http_uri; reference:url,www.secunia.com/advisories/41123; classtype:attempted-user; sid:2801592; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Indeo Filter iacenc.dll Insecure Library Loading"; flow:to_server,established; content:"/iacenc.dll"; http_uri; reference:url,www.secunia.com/advisories/41114; reference:cve,2010-3138; classtype:attempted-user; sid:2801604; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Realplayer AVI Header Flowbit Set"; flow:to_server,established; content:"GET"; http_method; content:".avi"; http_header; nocase; flowbits:set,ETPRO.AVI.HEADER; flowbits:noalert; reference:cve,2010-4393; reference:bugtraq,46047; classtype:not-suspicious; sid:2801625; rev:5;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Realplayer AVI Header Parsing Code Execution"; flow:from_server,established; flowbits:isset,ETPRO.AVI.HEADER; content:"RIFF"; content:"AVI LIST"; distance:4; within:8; content:"strlstrh"; distance:0; byte_jump:4,0,little,relative; content:!"strf"; within:8; reference:cve,2010-4393; reference:bugtraq,46047; classtype:attempted-user; sid:2801626; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Android Webkit removeChild Use-After-Free Remote Code Execution Attempt"; flow:established,to_client; content:"document.getElementById|28|"; nocase; content:"id.getAttributeNode|28|"; nocase; distance:0; content:"attribute.childNodes"; nocase; distance:0; content:"document.body.removeChild|28|"; nocase; distance:0; content:"attribute.removeChild|28|"; fast_pattern; nocase; distance:0; reference:bid,40642; reference:cve,2010-1119; classtype:attempted-user; sid:2012509; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Opera Window.Open document.cloneNode Null Pointer Deference Attempt"; flow:established,to_client; content:"window.open|28|"; nocase; content:"document.createElement|28|"; nocase; distance:0; content:"document.body.appendChild|28|"; nocase; distance:0; content:"close|28|"; nocase; distance:0; content:"document.cloneNode|28|"; nocase; distance:0; reference:url,www.exploit-db.com/exploits/16979/; classtype:attempted-user; sid:2012511; rev:2;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for addons.mozilla.org"; flow:established,from_server; content:"|00 92 39 d5 34 8f 40 d1 69 5a 74 54 70 e1 f2 3f|"; content:"addons.mozilla.org"; within:250; classtype:misc-activity; sid:2012546; rev:5;)

#
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for Global Trustee"; flow:established,from_server; content:"|00 d8 f3 5f 4e b7 87 2b 2d ab 06 92 e3 15 38 2f b0|"; classtype:misc-activity; sid:2012547; rev:5;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for login.live.com"; flow:established,from_server; content:"|00 b0 b7 13 3e d0 96 f9 b5 6f ae 91 c8 74 bd 3a c0|"; content:"login.live.com"; within:250; classtype:misc-activity; sid:2012548; rev:5;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for login.skype.com"; flow:established,from_server; content:"|00 e9 02 8b 95 78 e4 15 dc 1a 71 0a 2b 88 15 44 47|"; content:"login.skype.com"; within:250; classtype:misc-activity; sid:2012549; rev:5;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for login.yahoo.com 1"; flow:established,from_server; content:"|00 d7 55 8f da f5 f1 10 5b b2 13 28 2b 70 77 29 a3|"; content:"login.yahoo.com"; within:250; classtype:misc-activity; sid:2012550; rev:5;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for login.yahoo.com 2"; flow:established,from_server; content:"|39 2a 43 4f 0e 07 df 1f 8a a3 05 de 34 e0 c2 29|"; content:"login.yahoo.com"; within:250; classtype:misc-activity; sid:2012551; rev:6;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for login.yahoo.com 3"; flow:established,from_server; content:"|3e 75 ce d4 6b 69 30 21 21 88 30 ae 86 a8 2a 71|"; content:"login.yahoo.com"; within:250; classtype:misc-activity; sid:2012552; rev:5;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for mail.google.com"; flow:established,from_server; content:"|04 7e cb e9 fc a5 5f 7b d0 9e ae 36 e1 0c ae 1e|"; content:"mail.google.com"; within:250; classtype:misc-activity; sid:2012553; rev:6;)

#
#alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known Fraudulent SSL Certificate for www.google.com"; flow:established,from_server; content:"|00 f5 c8 6a f3 61 62 f1 3a 64 f5 4f 6d c9 58 7c 06|"; content:"www.google.com"; within:250; classtype:misc-activity; sid:2012554; rev:7;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Oracle Java Applet2ClassLoader Remote Code Execution 1"; flow:from_server; content:"|3c|applet"; nocase; content:"codebase"; nocase; distance:0; content:"file|3a|"; nocase; within:15; pcre:"/[^\x3E]lib(\x2f|\x5c)ext/Ri"; reference:cve,2010-4452; reference:bugtraq,46388; reference:url,www.exploit-db.com/exploits/16990/; classtype:attempted-user; sid:2801861; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Oracle Java Applet2ClassLoader Remote Code Execution 2"; flow:from_server; content:"|3c|embed"; nocase; content:"codebase"; nocase; distance:0; content:"file|3a|"; nocase; within:15; pcre:"/[^\x3E]lib(\x2f|\x5c)ext/Ri"; reference:cve,2010-4452; reference:bugtraq,46388; reference:url,www.exploit-db.com/exploits/16990/; classtype:attempted-user; sid:2801862; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer IVR RealPlayer video file MAGIC BYTES 1 Flowbit set"; flow:from_server,established; file_data; content:"|2E 52 45 43|"; within:4; flowbits:set,ETPRO.IVR; reference:bugtraq,46946; reference:url,www.aluigi.org/adv/real_5-adv.txt; classtype:attempted-user; sid:2801883; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer IVR RealPlayer video file MAGIC BYTES 2 Flowbit set"; flow:from_server,established; content:"|0d 0a 0d 0a 2e 52 31 4d|"; flowbits:set,ETPRO.IVR; reference:bugtraq,46946; reference:url,www.aluigi.org/adv/real_5-adv.txt; classtype:attempted-user; sid:2801884; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealNetworks RealPlayer IVR Handling Heap Buffer Overflow (Published Exploit)"; flow:from_server,established; flowbits:isset,ETPRO.IVR; content:"|08 00 00 00 00 00 00 00 00 02 00 00 04 4E 00 01 03 00 00 00 00 00 03 CA 00 00 03 E6 E0 00 00 05 00|"; pcre:"/\x41{160}/R"; reference:bugtraq,46946; reference:url,www.aluigi.org/adv/real_5-adv.txt; reference:url,www.aluigi.org/adv/real_5-adv.txt; classtype:attempted-user; sid:2801885; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 1"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"cmap"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801888; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 2"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"cmap"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801889; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 3"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"head"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801890; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 4"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"head"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801891; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 5"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hhea"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801892; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 6"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hhea"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801893; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 7"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hmtx"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801894; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 8"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"hmtx"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801895; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 9"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"maxp"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801896; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 10"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"maxp"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801897; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 11"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"name"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801898; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 12"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"name"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801899; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 13"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"OS/2"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801900; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 14"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"OS/2"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801901; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 15"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"post"; byte_test:4,>,0x7fffffff,4,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801902; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows OpenType Font Validation Integer Overflow 16"; flow:from_server,established; content:"|0d 0a 0d 0a 4F 54 54 4F|"; content:"post"; byte_test:4,>,0x7fffffff,8,relative; reference:cve,2010-2741; reference:url,www.microsoft.com/technet/security/bulletin/MS10-078.mspx; classtype:attempted-admin; sid:2801903; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Excel ADO Object Parsing Code Execution - SET"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|DC 00 0C 00|"; byte_test:1,&,4,0,relative; byte_test:1,!&,8,0,relative; byte_test:1,!&,2,0,relative; byte_test:1,!&,1,0,relative; flowbits:set,ETPRO.Excel_ADO_Object; flowbits:noalert;  reference:cve,2010-1253; reference:bugtraq,40531; classtype:attempted-user; sid:2801906; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Excel ADO Object Parsing Code Execution"; flow:from_server,established; flowbits:isset,ETPRO.Excel_ADO_Object; content:"|03 08 1C 00 03 08|"; byte_test:1,!,4,2,relative; reference:cve,2010-1253; reference:bugtraq,40531; classtype:attempted-user; sid:2801913; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Excel Pivot Item Index Boundary Error Memory Corruption 1"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|B0 00|"; byte_test:2,=,1,24,relative,little; content:"|B2 00|"; distance:0; byte_test:2,>,1,6,relative,little; byte_test:2,!,0xFFFF,6,relative,little; reference:cve,2010-2562; reference:bugtraq,42199; classtype:attempted-user; sid:2801929; rev:7;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Excel Pivot Item Index Boundary Error Memory Corruption 2"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|B0 00|"; byte_test:2,=,2,24,relative,little; content:"|B2 00|"; distance:0; byte_test:2,>,2,6,relative,little; byte_test:2,!,0xFFFF,6,relative,little; reference:cve,2010-2562; reference:bugtraq,42199; classtype:attempted-user; sid:2801930; rev:7;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Excel Pivot Item Index Boundary Error Memory Corruption 3"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|B0 00|"; byte_test:2,=,3,24,relative,little; content:"|B2 00|"; distance:0; byte_test:2,>,3,6,relative,little; byte_test:2,!,0xFFFF,6,relative,little; reference:cve,2010-2562; reference:bugtraq,42199; classtype:attempted-user; sid:2801931; rev:7;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Office Word RTF Document Control Word Parsing Memory Corruption"; flow:from_server,established; flowbits:isset,ETPRO.RTF; content:"|7B 5C|rt"; content:"|5C|datafield"; pcre:"/\x5Cdatafield[^\x7B]*\x5C(emfblip|jpegblip|pngblip)/"; reference:cve,2010-1901; classtype:attempted-user; sid:2801933; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT AOL Desktop .rtx File Parsing Buffer Overflow"; flow:to_client,established; content:"text|2f|richtext"; fast_pattern; content:"|3c 41 20 48 52 45 46 3d 22 68 74 74 70 3a 2f 2f|"; content:!"|3E|"; within:4096; classtype:attempted-user; sid:2801967; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari Right-to-Left Text Rendering Use After Free Vulnerability (Published Exploit) - SET"; flow:from_server,established; content:"previousSibling.dir=|22|rtl|22|"; content:"setTimeout("; distance:0; content:"unescape(|22 25|u9090|25|"; distance:0; flowbits:set,ETPRO.SAFARI.RTL; flowbits:noalert; reference:cve,2010-0049; reference:bugtraq,38689; classtype:attempted-user; sid:2801968; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari Right-to-Left Text Rendering Use After Free Vulnerability (Published Exploit)"; flow:from_server,established; flowbits:isset,ETPRO.SAFARI.RTL; content:".innerHTML="; content:".normalize"; distance:0; reference:cve,2010-0049; reference:bugtraq,38689; classtype:attempted-user; sid:2801969; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Player ASF Heap Overflow 1"; flow:to_client,established; flowbits:isset,ETPRO.MS_ASF; file_data; content:"|90 08 00 33 B1 E5 CF 11 89 F4 00 A0 C9 03 49 CB|"; byte_test:4,>,0x2AAAAAAA,36,relative,little; reference:cve,2009-2527; reference:bugtraq,36644; classtype:attempted-user; sid:2801972; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Player ASF Heap Overflow 2"; flow:to_client; flowbits:isset,ETPRO.MS_ASF; file_data; content:"|01 CD 87 F4 51 A9 CF 11 8E E6 00 C0 0C 20 53 65|"; byte_test:4,>,0x7FFFFFF,24,relative,little; reference:cve,2009-2527; reference:bugtraq,36644; classtype:attempted-user; sid:2801973; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Player ASF Heap Overflow 3"; flow:to_client; flowbits:isset,ETPRO.MS_ASF; file_data; content:"|34 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|"; byte_test:4,>,0x7FFFFFF,24,relative,little; reference:cve,2009-2527; reference:bugtraq,36644; classtype:attempted-user; sid:2801974; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft DirectX DirectShow quartz.dll QuickTime NULL Byte Overwrite Arbitrary Code Execution - SET"; flow:from_server,established; content:"|66 74 79 70|"; content:"|6D 6F 6F 76|"; within:32; flowbits:set,ETPRO.quicktime.NULL; flowbits:noalert; classtype:attempted-user; sid:2801975; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DirectX DirectShow quartz.dll QuickTime NULL Byte Overwrite Arbitrary Code Execution"; flow:from_server,established; flowbits:isset,ETPRO.quicktime.NULL; content:"mhlrvide"; content:!"mdia"; distance:0; content:"stsd"; distance:0; byte_test:1,>,0x1f,58,relative; reference:cve,2009-1537; reference:bugtraq,35139; classtype:attempted-user; sid:2801976; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Office File With Embedded Executable"; flow:established,to_client; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; within:8; content:"MZ"; distance:0; byte_jump:4,58,relative,little; content:"PE|00 00|"; distance:-64; within:4; classtype:trojan-activity; sid:2012684; rev:8;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Excel File Containing Integer Overrun Vulnerability BIFF v6 Record ToolBarDef"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|00 06|"; content:"|A7 00 FF 00 00|"; distance:6; within:5; byte_test:2,>,8224,0,relative; reference:url,go.microsoft.com/fwlink/?LinkId=210121; reference:cve,2011-0097; classtype:attempted-admin; sid:2802020; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Excel File Containing Integer Overrun Vulnerability BIFF v5 Record ToolBarDef"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|00 05|"; content:"|A7 00 FF 00 00|"; distance:6; within:5; byte_test:2,>,2080,0,relative; reference:url,go.microsoft.com/fwlink/?LinkId=210121; reference:cve,2011-0097; classtype:attempted-admin; sid:2802021; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Excel File Malformed Label recType BIFF5 record"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|00 05|"; content:"|04 02|"; distance:0; byte_test:2,>,0x7FFF,8,relative; reference:cve,2011-0098; reference:url,go.microsoft.com/fwlink/?LinkId=210121; classtype:attempted-user; sid:2802022; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Malformed CatSerRange Record Vulnerability"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|20 10 08 00|"; byte_test:2,>,0,0,relative,little; byte_test:2,<,42000,-2,relative,little; byte_test:1,&,0x80,3,relative,little; reference:cve,2011-0978; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-021.mspx; classtype:attempted-user; sid:2802033; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Malformed SupBook Record Vulnerability"; flow:from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|AE 01 04 00|"; byte_test:2,>,300,2,relative,little; byte_test:2,<,400,2,relative,little; reference:cve,2011-0979; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-021.mspx; classtype:attempted-user; sid:2802034; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel OBJ Records Vulnerability"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|5d 00|"; content:"|15 00 12 00|"; distance:2; within:4; byte_test:2,>,0x20,0,relative,little; reference:cve,2011-0980; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-021.mspx; classtype:attempted-user; sid:2802035; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft CSS swapnode Memory Corruption Vulnerability"; flow:from_server,established; content:"function"; nocase; content:".swapnode"; nocase; distance:0; pcre:"/([^\s]*)\.swapnode\s*\(\s*\1/i"; reference:cve,2011-0094; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-018.mspx; classtype:attempted-user; sid:2802036; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Flash Compressed File Embedded in Microsoft Document ASCII"; flow:established,from_server; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"CWS"; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; reference:cve,2011-0611; classtype:attempted-user; sid:2802043; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Flash Compressed File Embedded in Microsoft Document - Unicode"; flow:established,from_server; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:"C|00|W|00|S|00|"; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; reference:cve,2011-0611; classtype:attempted-user; sid:2802044; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Object Management Memory Corruption"; flow:from_server,established; content:"|2e|onpropertychange"; content:"|2e|childNodes"; content:"CollectGarbage"; content:"onpropertychange"; distance:0; content:"null"; nocase; distance:0; content:"CollectGarbage"; distance:0; reference:cve,2011-1345; reference:bugtraq,46821; classtype:attempted-user; sid:2802069; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Object Management Memory Corruption 2"; flow:from_server,established; content:"|2e|onpropertychange"; content:"|2e|attributes"; content:"CollectGarbage"; content:"onpropertychange"; distance:0; content:"null"; nocase; distance:0; content:"CollectGarbage"; distance:0; reference:cve,2011-1345; reference:bugtraq,46821; classtype:attempted-user; sid:2802068; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Office Drawing Layer Remote Code Execution"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|EC 00|"; content:"|00 0F 00 04 F0|"; within:38; content:"|02|"; distance:28; within:1; content:"|0A F0|"; within:3; byte_test:4,=,0x00000008,0,relative,little; content:"|00 0F 00 04 F0|"; distance:0; content:!"|0A F0|"; within:33; content:"|11 F0|"; distance:0; byte_test:4,=,0x00000000,0,relative,little; reference:cve,2011-0977; reference:bugtraq,46227; classtype:attempted-user; sid:2802067; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Windows Help and Support Center XSS Attempt"; flow:established,to_client; content:"hcp|3A|//"; fast_pattern; nocase; content:"script"; nocase; distance:0; content:"defer"; nocase; reference:cve,2010-1885; classtype:attempted-user; sid:2012756; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption (Published Exploit) Flowbit Set"; flow:from_server,established; flowbits:isset,ETPRO.MSCOV; content:"DrawText"; content:"|42 00 55 00 47 00 04 00 EA FE FF FF|"; nocase; reference:url,www.microsoft.com/technet/security/bulletin/MS11-024.mspx; classtype:attempted-user; sid:2802107; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Potential Use-After-Free Heap Overflow attempt (Exploit Specific)"; flow:from_server,established; content:"heapLib.ie|28|"; content:"|2e|push|28|document|2e|createElement|28 27|div|27 29 29|"; distance:0; content:"unescape|28|"; distance:0; reference:cve,2010-3328; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; reference:url,www.vreugdenhilresearch.nl/pocs/ms10-071.txt; classtype:attempted-user; sid:2802122; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace docx download"; flow:to_server,established; content:".docx"; http_uri; nocase; flowbits:set,http.docx.download; flowbits:noalert; classtype:misc-activity; sid:2802123; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace rtf download"; flow:to_server,established; content:".rtf"; http_uri; nocase; flowbits:noalert; flowbits:set,http.rtf.download; classtype:misc-activity; sid:2802124; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace xlt download"; flow:to_server,established; content:".xlt"; http_uri; nocase; flowbits:noalert; flowbits:set,http.xlt.download; classtype:misc-activity; sid:2802125; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Workspace xlsx download"; flow:to_server,established; content:".xlsx"; http_uri; nocase; flowbits:noalert; flowbits:set,http.xlsx.download; classtype:misc-activity; sid:2802126; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption"; flow:from_server,established; flowbits:isset,http.doc.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802128; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via docx"; flow:from_server,established; flowbits:isset,http.docx.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802129; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xls"; flow:from_server,established; flowbits:isset,http.xls.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802130; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlsx"; flow:from_server,established; flowbits:isset,http.xlsx.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802131; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via rtf"; flow:from_server,established; flowbits:isset,http.rtf.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802132; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlt"; flow:from_server,established; flowbits:isset,http.xlt.download; content:"<object"; nocase; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; nocase; distance:0; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802133; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via doc 2"; flow:from_server,established; flowbits:isset,http.doc.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge\x2eScriptBridge/i"; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802134; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via docx 2"; flow:from_server,established; flowbits:isset,http.docx.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge\x2eScriptBridge/i"; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802135; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xls 2"; flow:from_server,established; flowbits:isset,http.xls.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge\x2eScriptBridge/i"; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802136; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlsx 2"; flow:from_server,established; flowbits:isset,http.xlsx.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge.ScriptBridge/i"; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802137; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via xlt 2"; flow:from_server,established; flowbits:isset,http.xlt.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge.ScriptBridge/i"; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802138; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Word Document Uninitialized Memory Corruption via rtf 2"; flow:from_server,established; flowbits:isset,http.rtf.download; content:"ScriptBridge.ScriptBridge"; pcre:"/(ActiveXObject|CreateObject)\s*\([\x22\x27]ScriptBridge.ScriptBridge/i"; reference:cve,2010-3331; reference:bugtraq,43707; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802139; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via doc"; flow:from_server,established; flowbits:isset,http.doc.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; reference:cve,CVE-2010-3329; reference:bugtraq,43706; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802140; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via docx"; flow:from_server,established; flowbits:isset,http.docx.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; reference:cve,CVE-2010-3329; reference:bugtraq,43706; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802141; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via xls"; flow:from_server,established; flowbits:isset,http.xls.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; reference:cve,CVE-2010-3329; reference:bugtraq,43706; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802142; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via xlsx"; flow:from_server,established; flowbits:isset,http.xlsx.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; reference:cve,CVE-2010-3329; reference:bugtraq,43706; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802143; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via rtf"; flow:from_server,established; flowbits:isset,http.rtf.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; reference:cve,CVE-2010-3329; reference:bugtraq,43706; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802144; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer HtmlDlgHelper Memory Corruption via xlt"; flow:from_server,established; flowbits:isset,http.xlt.download; content:"<object"; nocase; content:"3050f4e1-98b5-11cf-bb82-00aa00bdce0b"; nocase; distance:0; reference:cve,CVE-2010-3329; reference:bugtraq,43706; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:2802145; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Oracle Java Applet2ClassLoader Remote Code Execution 3"; flow:from_server,established; content:"<object"; nocase; content:"8AD9C840-044E-11D1-B3E9-00805F499D93"; nocase; distance:0; content:"codebase"; nocase; distance:1; content:"file|3A|"; nocase; distance:1; content:"lib"; nocase; distance:0; content:"ext"; nocase; distance:1; pcre:"/lib[\x2f\x5c]+ext/i"; reference:cve,CVE-2010-4452; reference:bugtraq,46388; reference:url,www.exploit-db.com/exploits/16990/; classtype:attempted-user; sid:2802147; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Oracle Java Applet2ClassLoader Remote Code Execution 4"; flow:from_server,established; content:"<object"; nocase; content:"CAFEEFAC-0014-0000-0000-ABCDEFFEDCBA"; nocase; distance:0; content:"codebase"; nocase; distance:1; content:"file|3A|"; nocase; distance:1; content:"lib"; nocase; distance:0; content:"ext"; nocase; distance:1; pcre:"/lib[\x2f\x5c]+ext/i"; reference:cve,CVE-2010-4452; reference:bugtraq,46388; reference:url,www.exploit-db.com/exploits/16990/; classtype:attempted-user; sid:2802148; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Oracle Java Applet2ClassLoader Remote Code Execution 5"; flow:from_server,established; content:"<object"; nocase; content:"application/x-java-applet"; nocase; distance:0; content:"codebase"; nocase; distance:1; content:"file|3A|"; nocase; distance:1; content:"lib"; nocase; distance:0; content:"ext"; nocase; distance:1; pcre:"/lib[\x2f\x5c]+ext/i"; reference:cve,CVE-2010-4452; reference:bugtraq,46388; reference:url,www.exploit-db.com/exploits/16990/; classtype:attempted-user; sid:2802149; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint TextHeaderAtom Record Attempt"; flow:from_server,established; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|0f 00 0d f0|"; content:"|00 00 9f 0f 04 00 00 00|"; distance:0; byte_test:4,>,8,0,relative,little; reference:cve,2011-1269; reference:url,www.microsoft.com/technet/security/bulletin/MS11-036.mspx; classtype:attempted-user; sid:2802177; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT QuickTime Remote Exploit (exploit specific)"; flow:established,to_client; content:"|2f 2f|mshtml|2e|dll"; nocase; content:"unescape|28|"; nocase; distance:0; content:"onload"; nocase; distance:0; content:"ObjectLoad|28|"; within:32; pcre:"/src\s*\x3d\s*\x22res\x3a\x2f\x2fmshtml\x2edll/"; reference:url,www.1337day.com/exploits/16077; classtype:attempted-user; sid:2012806; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Adobe Audition Session File Handling Buffer Overflow Flowbit Set"; flow:established,to_client; content:"PDF-"; depth:300; content:".ses"; fast_pattern; nocase; distance:0; flowbits:set,ET_Assassin.ses; flowbits:noalert; reference:url,exploit-db.com/exploits/17278/; reference:url,securitytracker.com/id/1025530; classtype:bad-unknown; sid:2012813; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Adobe Audition Session File Handling Memory Corruption Attempt"; flow:established,to_client; flowbits:isset,ET_Assassin.ses; content:"|43 4F 4F 4C 4E 45 53 53 50 F2 08 00|"; reference:url,exploit-db.com/exploits/17278/; reference:url,securitytracker.com/id/1025530; classtype:attempted-user; sid:2012814; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Audition Session File Stack Buffer Overflow 1"; flow:from_server,established; content:"COOLNESS"; byte_test:4,<,0x13e,8,relative,little; byte_test:4,!,0x0,52,relative; content:!"|00|"; distance:44; within:306; reference:cve,2011-0614; reference:url,www.zeroscience.mk/en/vulnerabilities/ZSL-2011-5012.php; classtype:attempted-user; sid:2802820; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Audition Session File Stack Buffer Overflow 2"; flow:from_server,established; content:"COOLNESS"; byte_test:4,>,0x349,8,relative,little; byte_test:4,!,0x0,52,relative; content:!"|00 00|"; distance:361; within:885; reference:cve,2011-0614; reference:url,www.zeroscience.mk/en/vulnerabilities/ZSL-2011-5012.php; classtype:attempted-user; sid:2802821; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Audition Session File TRKM Stack Buffer Overflow"; flow:from_server; content:"|0d 0a 0d 0a|COOLNESS"; content:"TRKM"; byte_jump:4,16,relative,multiplier 2,little; byte_jump:4,8,relative,multiplier 2,little; byte_jump:4,48,relative,multiplier 2,little; byte_jump:4,4,relative,multiplier 2,little; byte_jump:4,0,relative,multiplier 2,little; byte_jump:4,4,relative,multiplier 2,little; byte_test:4,>,12,20,relative,little; content:!"|00 00|"; distance:24; within:24; reference:cve,2011-0615; reference:url,www.adobe.com/support/security/bulletins/apsb11-10.html; reference:url,www.coresecurity.com/content/Adobe-Audition-malformed-SES-file; classtype:attempted-user; sid:2802586; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Flash SWF File version 10 Flowbit Set"; flow:established,from_server; content:"|0d 0a 0d 0a 46 57 53 0a|"; flowbits:set,ETPRO.SWF.10; flowbits:noalert; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802873; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 1"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"OS|2f|2"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802874; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 2"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"cmap"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802875; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 3"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"head"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802876; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 4"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"hmtx"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802877; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 5"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"hhea"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802878; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 6"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"maxp"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802879; rev:3;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 7"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"name"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802880; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe flash malformed Table Record offset field exploit attempt 8"; flow:established,from_server; flowbits:isset,ETPRO.SWF.10; content:"|4f 54 54 4f|"; content:"|43 46 46|"; within:20; content:"post"; within:320; byte_test:4,>,0xffff,4,relative,big; reference:url,www.adobe.com/support/security/bulletins/apsb11-12.html; reference:cve,2011-0619; classtype:attempted-user; sid:2802881; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Download of PDF With Uncompressed Flash Content flowbit set"; flowbits:noalert; flow:established,to_client; content:"stream"; content:"|0A|FWS"; within:5; fast_pattern; pcre:"/stream(\x0D\x0A|\x0A)FWS/"; flowbits:set,ET.flash.pdf; reference:url,www.symantec.com/connect/blogs/analysis-zero-day-exploit-adobe-flash-and-reader; reference:url,blog.zynamics.com/2010/06/09/analyzing-the-currently-exploited-0-day-for-adobe-reader-and-adobe-flash/; classtype:misc-activity; sid:2012906; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Download of PDF With Compressed Flash Content"; flowbits:noalert; flow:established,to_client; content:"stream"; content:"|0A|CWS"; within:5; fast_pattern; pcre:"/stream(\x0D\x0A|\x0A)CWS/"; flowbits:set,ET.flash.pdf; reference:url,www.symantec.com/connect/blogs/analysis-zero-day-exploit-adobe-flash-and-reader; reference:url,blog.zynamics.com/2010/06/09/analyzing-the-currently-exploited-0-day-for-adobe-reader-and-adobe-flash/; classtype:misc-activity; sid:2012907; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Audition Session File Stack Buffer Overflow 1"; flow:established,from_server; content:"COOLNESS"; content:"|68 64 72 20|"; distance:0; byte_test:4,<,0x13e,0,relative,little; byte_test:4,!,0x0,44,relative; content:!"|00|"; distance:48; within:306; reference:cve,2011-0614; reference:url,www.zeroscience.mk/en/vulnerabilities/ZSL-2011-5012.php; classtype:attempted-user; sid:2802921; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Audition Session File Stack Buffer Overflow 2"; flow:established,from_server; content:"COOLNESS"; content:"|68 64 72 20|"; distance:0; byte_test:4,>,0x349,0,relative,little; byte_test:4,!,0x0,48,relative; content:!"|00 00|"; distance:365; within:885; reference:cve,2011-0614; reference:url,www.zeroscience.mk/en/vulnerabilities/ZSL-2011-5012.php; classtype:attempted-user; sid:2802922; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Audition Malformed Session File Buffer Overflow Attempt"; flow:established,to_client; content:"COOLNESS"; content:"TRKM"; distance:0; content:"A|00|u|00|d|00|i|00|t|00|i|00|o|00|n|00|"; nocase; distance:0; content:"A|00|u|00|d|00|i|00|o|00 20 00|O|00|u|00|t|00|p|00|u|00|t|00|"; nocase; distance:0; isdataat:100,relative; content:!"|0A|"; within:100; reference:url,www.coresecurity.com/content/Adobe-Audition-malformed-SES-file; reference:bid,47838; reference:cve,2011-0615; classtype:attempted-user; sid:2012978; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Insufficient Record Validation"; flow:established,to_client; flowbits:isset,ETPRO.Microsoft.Excel; content:"|5d 00|"; content:"|14 00|"; distance:6; within:2; content:"|13 00|"; distance:40; within:2; byte_jump:2,2,relative,little; byte_test:2,>,0,2,relative,little; byte_test:1,&,1,4,relative,little; content:"|06|"; distance:5; within:1; byte_test:2,!=,2,2,relative,little; reference:cve,2011-1272; classtype:attempted-user; sid:2802987; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MSIE Layout Memory Corruption Attack"; flow:established,to_client; content:"layout-grid-char"; pcre:"/layout-grid-char\s*\x3a\s*\d\d\d\d\d/i"; reference:cve,2011-1260; reference:bugtraq,48208; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:2802989; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MSIE cdl Protocol HTTP Redirect Attack"; flow:established,to_client; content:" 30"; depth:3; offset:9; content:"Location|3a|"; content:"cdl|3a|//"; within:8; reference:cve,2011-1262; classtype:attempted-user; sid:2802990; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted SerAuxTrend BIFF Record"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|4b 10|"; content:"|00|"; distance:2; within:1; byte_test:1,<,2,0,relative; reference:cve,2011-1274; classtype:attempted-user; sid:2802991; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Corrupted SerAuxTrend BIFF Record Attack 1"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|4b 10 1c 00 00|"; byte_test:1,>,6,0,relative; reference:cve,2011-1274; classtype:attempted-user; sid:2802992; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Excel Improper Record Parsing Vulnerability Flowbit SET"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|85 00 0d 00|"; byte_test:1,>,1,5,relative; flowbits:set,ETPRO.cve2011-1273; flowbits:noalert; reference:cve,2011-1273; classtype:attempted-user; sid:2802993; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Improper Record Parsing Vulnerability Attack"; flowbits:isset,ETPRO.cve2011-1273; flow:to_client,established; content:"|5d 00|"; content:"|14 00|"; distance:6; within:2; reference:cve,2011-1273; classtype:attempted-user; sid:2802994; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel WriteAV Vulnerability Attack"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|03 10 0c 00|"; content:"|01 00|"; distance:2; within:2; byte_test:2,>,32767,0,relative,little; reference:cve,2011-1278; classtype:attempted-user; sid:2802995; rev:5;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader language.engtesselate.ln flowbit set"; flow:to_server,established; content:"language.engtesselate.ln"; nocase; http_uri; flowbits:set,ETPRO.CVE-2011-2095; flowbits:noalert; reference:cve,CVE-2011-2095; classtype:not-suspicious; sid:2802999; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader language.engtesselate.ln overflow"; flow:from_server,established; content:"|32 3d 22|"; content:!"|22|"; within:255; flowbits:isset,ETPRO.CVE-2011-2095; reference:cve,CVE-2011-2095; classtype:web-application-attack; sid:2803000; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel File Importing Code Execution SYLK Download Flowbit Set"; flow:to_server,established; content:"GET"; http_method; content:".slk"; http_uri; nocase; flowbits:set,ETPRO.http.sylk.download; flowbits:noalert; classtype:attempted-user; sid:2803005; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Excel .slk Parsing Buffer Overrun Vulnerability Attack"; flowbits:isset,ETPRO.http.sylk.download; flow:established,to_client; content:"ID|3b|"; content:"|0a|P|3b|"; pcre:"/^ID\x3b/im"; pcre:"/^(.*?\x0aP\x3b){100}/Ri"; reference:cve,2011-1276; classtype:attempted-user; sid:2803006; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Shockwave rcsL Chunk Remote Code Execution Attempt"; flow:established,to_client; content:"rcsL"; content:"|FF F0 02 67|"; fast_pattern; distance:0; reference:url,www.abysssec.com/blog/2010/10/adobe-shockwave-player-rcsl-chunk-memory-corruption-0day/; reference:bid,42682; reference:cve,2010-2873; classtype:attempted-user; sid:2013069; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Shockwave Director tSAC Chunk memory corruption Attempt"; flowbits:isset,ET.flash.pdf; flow:established,to_client; content:"tSAC|1D 02|"; fast_pattern; content:"|01 00 FF FF 11 11|"; distance:0; reference:url,www.exploit-db.com/moaub-22-adobe-shockwave-director-tsac-chunk-memory-corruption/; classtype:attempted-user; sid:2013070; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe pdf file with Universal3D exploit"; flow:from_server,established; content:"%PDF-"; depth:300; content:"|2f|JavaScript|20 2f|JS|20|"; distance:0; content:"|2e|getAnnots3D"; within:300; content:"|2e|scene|2e|"; distance:0; content:"|2e|removeItem"; within:64; pcre:"/\x2escene\x2e(animations|cameras| lights|materials|meshes|nodes)\x2eremoveItem\x28/"; content:"|2f|Type|20 2f|3D"; content:"|20 2f|Subtype|20 2f|U3D|20 2f|"; within:16; reference:cve,2011-2099; classtype:attempted-user; sid:2803011; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer selection.empty Use After Free"; flow:from_server,established; content:"expression"; nocase; content:"|28|document.selection.empty|28 29 29|"; within:28; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; reference:cve,2011-1261; classtype:attempted-user; sid:2803014; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe pdf file containing remote go-to actions"; flow:from_server,established; content:"%PDF-"; depth:300; content:"|2f|S|20 2f|JavaScript"; distance:0; content:"|2f|JS|20 28 29|"; within:64; content:"|2f|S|20 2f|GoToR"; within:300; content:"|2f 46 20 28|javascript|3a|"; within:128; reference:cve,2011-2101; classtype:attempted-user; sid:2803022; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel malformed Selection (type 0x1D) BIFF record"; flow:from_server,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|1D 00|"; byte_test:1,>=,0,2,relative,little; byte_test:1,<=,3,-1,relative,little; byte_test:2,>,0x559,6,relative,little; flowbits:unset,OLE.CompoundFile; reference:cve,2011-1277; reference:url,www.microsoft.com/technet/security/bulletin/MS11-045.mspx; classtype:attempted-user; sid:2803027; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft HTML Time Entity Memory Corruption Exploit Attempt"; flow:to_client,established; content:"schemas-microsoft-com|3A|time"; content:"contenteditable|3D 22|true|22|"; distance:0; content:"document.getElementById|28 22|"; content:"|22 29|.innerHTML = |22 22 3B|"; distance:0; within:50; content:"|2F|script"; distance:0; within:20; reference:cve,2011-1255; classtype:attempted-user; sid:2803028; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF with Malformed ProfileDescriptionTag"; flow:from_server,established; content:"%PDF-"; depth:300; content:"|64 65 73 63 00 00 00 00|"; distance:0; byte_jump:4,0,relative,big; content:"|00 00 00 00|"; within:4; byte_test:4,>,0x7FFFFFFF,0,relative,big; content:"|2f|ICCBased|20|"; distance:0; reference:cve,2011-2097; classtype:attempted-user; sid:2803030; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer VML vgx.dll Use After Free 1"; flow:from_server,established; content:"urn"; nocase; content:"schemas|2d|microsoft|2d|com"; within:23; content:"vml"; nocase; within:5; content:"|23|default|23|VML"; nocase; content:"|3c|v|3a|image"; nocase; content:"|2e|src"; nocase; reference:cve,CVE-2011-1266; classtype:web-application-attack; sid:2803035; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer VML vgx.dll Use After Free 2"; flow:from_server,established; content:"urn"; nocase; content:"schemas|2d|microsoft|2d|com"; within:23; content:"vml"; nocase; within:5; content:"|23|default|23|VML"; nocase; content:"|3c|v|3a|shape"; nocase; content:"|2e|fill|2e|src"; nocase; reference:cve,CVE-2011-1266; classtype:web-application-attack; sid:2803036; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer VML vgx.dll Use After Free 3"; flow:from_server,established; content:"urn"; nocase; content:"schemas|2d|microsoft|2d|com"; within:23; content:"vml"; nocase; within:5; content:"|23|default|23|VML"; nocase; content:"|3c|v|3a|shape"; nocase; content:"|2e|imagedata|2e|src"; nocase; reference:cve,CVE-2011-1266; classtype:web-application-attack; sid:2803037; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer VML vgx.dll Use After Free 4"; flow:from_server,established; content:"urn"; nocase; content:"schemas|2d|microsoft|2d|com"; within:23; content:"vml"; nocase; within:5; content:"|23|default|23|VML"; nocase; content:"|3c|v|3a|shape"; nocase; content:"|2e|stroke|2e|src"; nocase; reference:cve,CVE-2011-1266; classtype:web-application-attack; sid:2803038; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MSIE Layout Memory Corruption Attack 2"; flow:from_server,established; file_data; content:"|2e|layoutgridchar"; nocase; pcre:"/\s*\x3d\s*\x22[1-9][0-9]{4}/Ri"; reference:cve,2011-1260; reference:bugtraq,48208; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:2803056; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Shockwave Director File KEY Chunk Parsing Buffer Overflow"; flow:from_server,established; flowbits:isset,ETPRO.shockwave_dir; content:"|52 49 46 58|"; content:"|4B 45 59 2A|"; distance:0; byte_test:4,<,5,0,relative,little; reference:cve,2011-2111; reference:bugtraq,48300; classtype:attempted-user; sid:2803067; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Mozilla Firefox nsTreeSelection Element invalidateSelection Remote Code Execution Attempt"; flow:established,to_client; content:"document.getElementById(|27|treeset|27|)"; nocase; content:"view.selection"; nocase; distance:0; content:"invalidateRange"; nocase; distance:0; reference:bid,41853; reference:cve,2010-2753; classtype:attempted-user; sid:2013144; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Acrobat Util.printf Buffer Overflow Attempt"; flow:established,to_client; content:"util.printf|28 22 25|"; nocase; fast_pattern:only; pcre:"/util.printf\x28\x22\x25[^\x2C\x29]*f\x22\x2C/i"; reference:url,www.coresecurity.com/content/adobe-reader-buffer-overflow; reference:bid,30035; reference:cve,2008-2992; classtype:attempted-user; sid:2013152; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Acrobat Reader FlateDecode Stream Predictor Exploit Attempt"; flow:established,to_client; content:"Colors 1073741838"; fast_pattern:only; pcre:"/<<[^>]*\x2FPredictor[^>]*\x2FColors\x201073741838/smi"; reference:url,www.fortiguard.com/analysis/pdfanalysis.html; reference:bid,36600; reference:cve,2009-3459; classtype:attempted-user; sid:2013153; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Time Element Memory Corruption 2"; flow:from_server,established; content:"schemas|2d|microsoft|2d|com"; content:"time"; distance:0; content:"|23|default|23|time2"; nocase; distance:0; content:"contenteditable"; distance:0; content:"true"; distance:0; pcre:"/\x3a\s*(animate|animateColor|animateMotion|set|switch|transitionFilter)/iR"; reference:cve,2011-1255; reference:url,labs.m86security.com/2011/06/0-day-exploit-used-in-a-targeted-attack-cve-2011-1255/; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:2803139; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Visio mfc71loc.dll Insecure Library Loading"; flow:to_server,established; content:"GET"; http_method; content:"mfc"; nocase; http_uri; content:"|2e|dll"; nocase; fast_pattern; http_uri; pcre:"/\x2fmfc\d+[a-z]{2,3}\x2edll/Ui"; reference:url,www.exploit-db.com/exploits/14744/; reference:url,www.secunia.com/advisories/45077; reference:cve,2010-3148; classtype:attempted-user; sid:2803137; rev:8;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Word RTF pFragments Stack Buffer Overflow Attempt"; flow:established,to_client; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|5C|sp"; nocase; content:"|5C|sn"; nocase; within:80; content:"pFragments"; nocase; within:80; content:"|5C|sv"; nocase; within:80; isdataat:100,relative; content:!"|0A|"; distance:1; within:100; reference:url,labs.m86security.com/2011/07/resurrection-of-cve-2010-3333-in-the-wild/; reference:bid,44652; reference:cve,2010-3333; classtype:attempted-user; sid:2013250; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Known in Wild Microsoft Internet Explorer Time Element Uninitialized Memory Remote Code Execution Attempt"; flow:established,to_client; content:"TTu0d0fu0d0eKKJJu0d0du0d0dLL1043416UU"; reference:url,labs.m86security.com/2011/06/0-day-exploit-used-in-a-targeted-attack-cve-2011-1255/; reference:bid,48206; reference:cve,2011-1255; classtype:attempted-user; sid:2013251; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Internet Explorer Time Element Uninitialized Memory Remote Code Execution Attempt"; flow:established,to_client; content:"|2e|location|2e|reload|28 29|"; content:"implementation=|22 23|default|23|time"; nocase; content:"contenteditable=|22|true|22|"; nocase; distance:0; reference:url,labs.m86security.com/2011/06/0-day-exploit-used-in-a-targeted-attack-cve-2011-1255/; reference:bid,48206; reference:cve,2011-1255; classtype:attempted-user; sid:2013252; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Word RTF pFragments Stack Overflow Attempt"; flowbits:isset,OLE.CompoundFile; flow:established,to_client; content:"rtf"; nocase; content:"|7B 5C|sp|7B 5C|sn pFragments|7D 7B 5C|sv"; nocase; within:100; reference:url,labs.m86security.com/2011/07/resurrection-of-cve-2010-3333-in-the-wild/; reference:bid,44652; reference:cve,2010-3333; classtype:attempted-user; sid:2013280; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Authplay.dll NewClass Memory Corruption Attempt"; flowbits:isset,ET.flash.pdf; flow:established,to_client; content:"|D2 60 38 40 BA 03 14 0E|"; reference:url,www.exploit-db.com/adobe-acrobat-newclass-invalid-pointer-vulnerability/; reference:bid,40586; reference:cve,2010-1297; classtype:attempted-user; sid:2013281; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Player Button Remote Code Execution Attempt"; flowbits:isset,ET.flash.pdf; flow:established,to_client; content:"|07 07 02 17 07 06 1A 07 1B 1B 07 02 1C 07 07 1E|"; reference:bid,44504; reference:cve,2010-3654; classtype:attempted-user; sid:2013282; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Mozilla Firefox nsTreeRange Use After Free"; flow:from_server,established; content:".select"; content:".tree"; distance:0; content:"invalidateRange"; distance:0; pcre:"/(\x2etree\s*\x3d\s*NULL|\x2etree\s*\x3d\s*\x22\s*\x22)/Ri"; content:".clearSelection"; distance:0; reference:bugtraq,47663; reference:cve,2011-0073; reference:url,www.exploit-db.com/exploits/17520/; reference:url,www.exploit-db.com/exploits/17419/; reference:url,www.mozilla.org/security/announce/2011/mfsa2011-13.html; classtype:attempted-user; sid:2803203; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows LNK File Code Execution"; flow:from_server,established; content:"|0a 4C 00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00 46|"; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; distance:0; reference:cve,CVE-2010-2568; reference:bugtraq,41732; reference:url,www.microsoft.com/technet/security/bulletin/MS10-046.mspx; reference:url,www.blogs.technet.com/b/mmpc/archive/2010/07/30/stuxnet-malicious-lnks-and-then-there-was-sality.aspx; classtype:attempted-user; sid:2803253; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Oracle Java Runtime Environment Insecure File Loading (hotspotrc) - SET"; flow:to_server,established; content:"GET"; http_method; content:".hotspotrc"; nocase; http_uri; flowbits:set,ETPRO.hotspotrc; flowbits:noalert; reference:url,blog.acrossecurity.com/2011/07/binary-planting-goes-any-file-type.html; classtype:attempted-user; sid:2803289; rev:4;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Oracle Java Runtime Environment Insecure File Loading (hotspotrc)"; flowbits:isset,ETPRO.hotspotrc; flow:from_server; content:"200"; http_stat_code; content:"OK"; nocase; http_stat_msg; reference:url,blog.acrossecurity.com/2011/07/binary-planting-goes-any-file-type.html; classtype:attempted-user; sid:2803290; rev:1;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible Oracle Java Runtime Environment Insecure File Loading (hotspot_compiler)"; flow:to_server; content:"GET"; http_method; content:".hotspot_compiler"; nocase; http_uri; reference:url,blog.acrossecurity.com/2011/07/binary-planting-goes-any-file-type.html; classtype:attempted-user; sid:2803291; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer toStaticHTML HTML Sanitizing Information Disclosure Attempt"; flow:established,to_client; content:"toStaticHTML|28|"; fast_pattern; nocase; content:"expression|28|"; nocase; within:150; reference:bid,48199; reference:cve,2011-1252; classtype:attempted-user; sid:2013321; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_CLIENT Microsoft Visio 2003 mfc71enu.dll DLL Loading Arbitrary Code Execution Attempt"; flow:established,to_server; content:"/mfc71"; http_uri; nocase; pcre:"/mfc71[a-z]{2,3}\x2Edll/Ui"; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=23601; reference:url,www.microsoft.com/technet/security/bulletin/MS11-055.mspx; reference:bid,42681; reference:cve,2010-3148; classtype:attempted-user; sid:2013322; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari WebKit innerHTML Double Free Memory Corruption"; flow:from_server,established; content:"setTimeout|28|function|28 29|"; content:"document|2e|body|2e|innerHTML"; distance:0; content:"body onload|3d 27|document|2e|getElementById|28 22|"; content:"|22 29 2e|innerHTML|20 3d|"; within:32; content:"|3c|iframe src|3d 22|"; distance:0; pcre:"/(document\x2egetElementById\x28\x22.+\x22\x29\x2einnerHTML\s*\x3d\s*\x22\s*\x22)/i"; reference:cve,CVE-2011-0221; reference:url,www.osvdb.org/73998; reference:bugtraq,48844; classtype:attempted-user; sid:2803341; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari WebKit innerHTML Double Free Memory Corruption (Published Exploit)"; flow:from_server,established; content:"setTimeout|28|function|28 29|"; content:"document|2e|body|2e|innerHTML = |22 3c|b|3e|PASS|3a 3c 2f|b|3e|"; distance:0; content:"body onload|3d 27|document|2e|getElementById|28 22|x|22 29 2e|innerHTML |3d| 1"; distance:0; content:"|3c|iframe src|3d 22|does|2d|not|2d|exist|22 3e|"; distance:0; reference:cve,CVE-2011-0221; reference:url,www.osvdb.org/73998; reference:bugtraq,48844; classtype:attempted-user; sid:2803342; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari WebKit SVG Memory Corruption"; flow:from_server,established; content:".svg"; fast_pattern; nocase; content:"|2e|documentElement|2e|"; distance:0; pcre:"/documentElement\x2e(height|preserveAspectRatio|viewBox|width|x|y)\x2e/i"; reference:cve,CVE-2011-0222; reference:bugtraq,48844; reference:url,www.exploit-db.com/sploits/CVE-2011-0222.zip; classtype:attempted-user; sid:2803348; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari WebKit SVG Memory Corruption (Published Exploit)"; flow:from_server,established; content:".svg"; content:"arrey_name26.push"; distance:0; content:"tweak_properties"; distance:0; reference:cve,CVE-2011-0222; reference:bugtraq,48844; reference:url,www.exploit-db.com/sploits/CVE-2011-0222.zip; classtype:attempted-user; sid:2803349; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Safari WebKit SVG Markers Use-After-Free Memory Corruption (Published Exploit)"; flow:from_server,established; content:"<marker id=|22|marker|22|"; pcre:"/marker\x2d(end|mid|start)\x3d\x22url\x28/Ri"; content:"removeChild(document.getElementById('marker')"; distance:0; reference:cve,CVE-2011-1453; reference:url,www.osvdb.org/74013; reference:url,www.zerodayinitiative.com/advisories/ZDI-11-240/; reference:url,www.osvdb.org/74013; classtype:attempted-user; sid:2803351; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer cross domain attempt"; flow:from_server,established; content:"window.open"; nocase; content:"redirect.aspx"; nocase; distance:0; content:"Thread.Sleep"; nocase; content:"Response|2e|"; distance:0; content:"302 Object Moved"; nocase; distance:0; content:"Response|2e|"; content:"http|3a 2f 2f|"; distance:0; reference:cve,CVE-2011-1960; classtype:attempted-user; sid:2803372; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Telnet Handler Code Execution Vulnerability Attempt WEBDAV PROPFIND telnet.exe"; flow:to_server; content:"PROPFIND"; http_method; content:"telnet.exe"; http_uri; reference:cve,2011-1961; reference:url,www.microsoft.com/technet/security/bulletin/MS11-057.mspx; reference:bugtraq,49027; classtype:attempted-user; sid:2803373; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Uncompressed Adobe Flash Regular Expression Group Exceeds Boundary Conditions"; flow:established,to_client; content:"FWS"; content:"|10 00 2E 00|"; distance:0; content:"RegExp|26 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 2E 2A|"; distance:0; reference:cve,2011-2134; classtype:attempted-user; sid:2803378; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer XSLT Memory Corruption - SET"; flow:from_server,established;content:"text/html"; nocase; content:"<iframe src"; nocase; content:".xml"; distance:0; pcre:"/\x3ciframe\s+src\s*\x3d\s*(\x22|\x27)[^\x2e]*\x2exml(\x22|\x27)\s*\x3e/i"; flowbits:set,ETPRO.XSLT; flowbits:noalert; reference:cve,CVE-2011-1963; reference:url,www.microsoft.com/technet/security/bulletin/MS11-057.mspx; classtype:attempted-user; sid:2803405; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Data Access Components Insecure Library Loading Attempt"; flow:to_server,established; content:"GET"; http_method; content:"BIDLAB.DLL"; nocase; http_uri; reference:cve,2011-1975; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-059.mspx; classtype:attempted-user; sid:2803412; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Mozilla Firefox OBJECT mChannel Use After Free Attempt"; flow:from_server,established; content:"|2e|onChannelRedirect"; content:"NULL"; nocase; within:10; pcre:"/\x2eonChannelRedirect\s*\x28\s*NULL/i"; reference:cve,2011-0065; reference:url,www.www.exploit-db.com/exploits/17612/; reference:bugtraq,47659; classtype:attempted-user; sid:2803434; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Mozilla Firefox mChannel Object Dangling Pointer Use-After-Free Memory Corruption Attempt"; flow:established,to_client; content:"QueryInterface|28|Components.interfaces.nsIChannelEventSink|29|"; nocase; content:"onChannelRedirect|28|null"; nocase; distance:0; reference:url,www.mozilla.org/security/announce/2011/mfsa2011-13.html; reference:bid,47635; reference:cve,2011-0065; classtype:attempted-user; sid:2013417; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Mozilla Firefox and Thunderbird sensor.dll Insecure Library Loading"; flow:to_server,established; content:"GET"; http_method; content:"|2F|sensor|2E|dll"; nocase; http_uri;  reference:cve,2011-2980; reference:bugtraq,49217; classtype:attempted-user; sid:2803529; rev:6;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT FreeType PostScript Type1 Font Parsing Code Execution (Published Exploit)"; flow:from_server,established; content:"|a1 6f ab 92 9b 8e ac ea 36 7e d9 51 f9 b2 af 8e 23 3d ee 7a c2 7d 85 95 89 d4 07 f8 32 d8 f8 ef 6c 54 ef d5 68 b1 d4 d2 ba ab 4d 20 7a ca f9 55 54 f5 e6 91 c0 38 77 86 e0 f7 23 2e 19 5f 2c 94|"; reference:cve,2011-0226; reference:bugtraq,48619; reference:url,www.osvdb.org/73661; reference:url,www.jailbreakme.com/saffron/_/iPhone_4.3.3_8J2.pdf; classtype:attempted-user; sid:2803565; rev:1;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Sharepoint CalendarDate XSS Attempt"; flow:established,to_server; content:"CalendarDate"; http_uri; nocase; content:"script"; nocase; http_uri; pcre:"/CalendarDate=.*script/Ui"; classtype:attempted-user; sid:2803637; rev:3;)

#
#alert http $HOME_NET any -> any any (msg:"ETPRO WEB_CLIENT Sharepoint query.iqy XSS Attempt"; flow:established,to_server; content:"query.iqy"; http_uri; content:"View="; http_uri; content:"RootFolder="; http_uri; content:"script"; nocase; http_uri; pcre:"/(View|RootFolder)=.*script/Ui"; classtype:attempted-user; sid:2803638; rev:3;)

#
#alert http $HOME_NET any -> any any (msg:"ETPRO WEB_CLIENT Sharepoint query.bqy XSS Attempt"; flow:established,to_server; content:"query.bqy"; http_uri; content:"View="; http_uri; content:"RootFolder="; http_uri; content:"script"; nocase; http_uri; pcre:"/(View|RootFolder)=.*script/Ui"; classtype:attempted-user; sid:2803639; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Components deskpan.dll Insecure Library Loading Code Execution Webdav"; flow:to_server,established; content:"GET"; http_method; content:"|2f|deskpan.dll"; http_uri; nocase; classtype:attempted-user; sid:2803640; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel DataFormat Record Parsing Vulnerability"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|06 10 08 00|"; byte_test:2,>,4096,4,relative,little; byte_test:2,!&,0x7FFF,6,relative,little; reference:cve,2011-1990; classtype:attempted-user; sid:2803653; rev:5;)

#
#alert http any any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Sharepoint Picker.aspx ct100 Parameter XSS Injection Flowbit Set"; flow:established,to_server; content:"/_layouts/Picker.aspx?"; http_uri; flowbits:noalert; flowbits:set,ETPRO.sharepoint.picker; reference:cve,2011-1891; classtype:not-suspicious; sid:2803655; rev:4;)

#
#alert http any any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Sharepoint Picker.aspx ct100 Parameter XSS Injection Attempt"; flow:established,to_server; flowbits:isset,ETPRO.sharepoint.picker; content:"&ctl00%24PlaceHolderDialogBodySection%24ctl04%24hiddenSpanData=%27%22%3E"; reference:cve,2011-1891; classtype:attempted-user; sid:2803656; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel SHRFMLA Biff Record Vulnerability Attempt"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|BC 04|"; byte_test:2,>,2020,0,relative,little; byte_test:1,=,0,8,relative; reference:cve,2011-1986; classtype:attempted-user; sid:2803657; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF JavaScript Function getCosObj Attempt"; flow:established,from_server; content:"PDF-"; depth:300; content:".getCosObj"; distance:0; reference:cve,2011-2442; classtype:attempted-user; sid:2803658; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Possible AXISPARENT Biff Record Vulnerability Attempt"; flow:to_client,established; flowbits:isset,ETPRO.Microsoft.Excel; content:"|41 10 12 00|"; byte_test:1,&,0x80,1,relative; content:"|33 10|"; distance:18; within:2; reference:cve,2011-1987; classtype:attempted-user; sid:2803659; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel Biff Record Vulnerability Attempt"; flow:established,to_client; flowbits:isset,ETPRO.Microsoft.Excel; content:"|41 10 12 00|"; byte_test:1,&,0x80,1,relative; content:"|33 10|"; distance:18; within:2; byte_jump:2,0,relative,little; byte_test:2,>,0x874,0,relative,little; byte_test:2,<,0x900,0,relative,little; reference:cve,2011-1987; classtype:attempted-user; sid:2803660; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF PICT Image Stream Memory Corruption Attempt"; flow:established,from_server; content:"PDF-"; depth:300; content:"stream|0a|"; distance:0; content:"PICT"; distance:88; within:4; byte_test:1,=,1,12,relative; byte_test:1,=,1,16,relative; byte_test:1,=,1,20,relative; byte_test:1,=,1,24,relative; byte_test:1,=,1,28,relative; byte_test:1,=,1,32,relative; byte_test:1,=,1,36,relative; byte_test:1,=,1,40,relative; byte_test:1,=,1,44,relative; reference:cve,2011-2435; classtype:attempted-user; sid:2803661; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF Multiple APPO Marker Vulnerability Flowbit Set"; flow:from_server,established; content:"PDF-"; content:"|FF D8 FF E0 00 01|"; flowbits:set,pdf.appo.found; flowbits:noalert; reference:cve,2011-2440; classtype:attempted-user; sid:2803662; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF Multiple APPO Marker Vulnerability Attempt"; flowbits:isset,pdf.appo.found; flow:from_server,established; content:"|FF D8 FF E0 00 01|"; flowbits:unset,pdf.appo.found; reference:cve,2011-2440; classtype:attempted-user; sid:2803663; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MPlayer for Windows Calloc Integer Overflow 1"; flow:from_server,established; flowbits:isset,http.request.mov; content:"stsc"; byte_test:4,>,0x10000000,4,relative,big; reference:url,www.aluigi.altervista.org/adv/mplayerwin_1-adv.txt; classtype:attempted-user; sid:2803683; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MPlayer for Windows Calloc Integer Overflow - SET .qt"; flow:to_server,established; content:".qt"; nocase; http_uri; content:"|2e|qt|20|HTTP"; nocase; flowbits:set,ETPRO.QT_Mplayer; flowbits:noalert; reference:url,www.aluigi.altervista.org/adv/mplayerwin_1-adv.txt; classtype:attempted-user; sid:2803684; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MPlayer for Windows Calloc Integer Overflow 2"; flow:from_server,established; flowbits:isset,ETPRO.QT_Mplayer; content:"stsc"; byte_test:4,>,0x10000000,4,relative,big; reference:url,www.aluigi.altervista.org/adv/mplayerwin_1-adv.txt; classtype:attempted-user; sid:2803685; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Google Chrome Multiple Iframe PDF File Handling Memory Corruption Attempt"; flow:established,to_client; content:".pdf|22|><|2F|iframe>"; nocase; content:".pdf|22|><|2F|iframe>"; nocase; distance:0; content:".pdf|22|><|2F|iframe>"; nocase; distance:0; content:".pdf|22|><|2F|iframe>"; nocase; distance:0; content:".pdf|22|><|2F|iframe>"; nocase; distance:0; content:".pdf|22|><|2F|iframe>"; nocase; distance:0; reference:bid,49933; reference:cve,2011-2841; classtype:attempted-user; sid:2013742; rev:3;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Active Accessibility oleacc.dll Insecure Library Loading Code Execution - WebDAV"; flow:to_server; content:"|2f|oleacc.dll"; nocase; http_uri; content:"GET"; http_method; content:"HTTP"; nocase; reference:cve,2011-1247; reference:url,www.microsoft.com/technet/security/bulletin/MS11-075.mspx; classtype:attempted-user; sid:2803840; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer remote code execution via option element"; flow:established,to_client; file_data; content:"unescape"; nocase; content:" Array"; nocase; content:".innerText"; nocase; content:".createElement("; nocase; distance:0; pcre:"/^\s*?[\x27\x22]option[\x27\x22]\s*?\x29/Rsi"; content:".reset("; distance:0; fast_pattern; reference:cve,CVE-2011-1996; classtype:attempted-user; sid:2803851; rev:9;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer use-after-free memory corruption"; flow:established,to_client; file_data; content:"document.createElement"; nocase; distance:0; content:"CollectGarbage("; fast_pattern; nocase; distance:0; content:"null"; nocase; distance:0; pcre:"/var[\r\s\n]+?(?P<var1>[^\x20]+)[\r\n\s]*?\x3d[\r\n\s]*?document.createElement\(.+?CollectGarbage\(.+?(?P=var1)(\x2e\w+?)?[\r\n\s]*?\x3d[\r\n\s]*?null/i"; reference:cve,CVE-2011-1997; classtype:attempted-user; sid:2803852; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer remote code execution via option element 2"; flow:established,to_client; file_data; content:"document.createElement"; nocase; content:"|22|select|22|"; nocase; distance:0; content:"|22|option|22|"; nocase; distance:0; content:".options.add"; nocase; distance:0; content:"-0x"; nocase; distance:0; pcre:"/\x2eoptions\x2eadd\s*\x28\s*[^\x29]+\x2c\s*\x2d\x30x\d+\s*\x29/i"; reference:cve,CVE-2011-1999; classtype:attempted-user; sid:2803853; rev:7;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer remote code execution via marquee element"; flow:established,to_client; content:" marquee.removeNode("; nocase; content:"document.execCommand"; distance:0; content:"selectAll"; distance:0; content:"<marquee id="; nocase; distance:0; pcre:"/marquee\x2eremoveNode\s*\x28\s*\x27true\s*\x27\s*\x29/i"; reference:cve,CVE-2011-2001; classtype:attempted-user; sid:2803854; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT ADOBE PDF reader stack overflow via embedded TIFF file"; flow:established,from_server; content:"%PDF-"; depth:300; content:"/Subtype/image#2ftiff/"; distance:0; content:"|49 49 2A 00|"; distance:0; byte_jump:1,0,relative; content:"|50 01 03 00 00 20 00 00|"; within:100; reference:cve,2011-2432; classtype:attempted-user; sid:2804008; rev:6;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Flash authoring tool Flex XSS attempt"; flow:established,to_server; content:"&resourceModuleURLS="; http_uri; content:"http|3a 2f 2f|"; http_uri; content:".swf HTTP/1."; reference:cve,2011-2461; classtype:attempted-user; sid:2804083; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Embedded U3D"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/U3D"; within:64; reference:url,www.adobe.com/support/security/advisories/apsa11-04.html; classtype:bad-unknown; sid:2013995; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF Universal 3D file corrupted download"; flow:established,from_server; content:"/Type /3D /Subtype /U3D"; content:"|55 33 44|"; distance:0; content:"|45 ff ff ff|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,>,0,8,relative,little; content:"|00 00 00 00|"; within:8; reference:cve,2011-2462; classtype:attempted-user; sid:2804105; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Powerpoint pp4x322.dll Insecure Library Loading"; flow:to_server,established; content:"pp4x322.dll"; nocase; http_uri; content:"GET"; http_method;  reference:cve,2011-3396; classtype:attempted-user; sid:2804133; rev:4;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT peerdist.dll Insecure Library Loading"; flow:to_server,established; content:"/peerdist.dll"; http_uri; reference:cve,2011-2019; classtype:attempted-user; sid:2804139; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excell corrupted file download invalid Lel BIFF records"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|06 00|"; content:"|06 00 18 01|"; within:64; byte_test:2,>=,0x800,0,relative,little; reference:cve,2011-3403; classtype:attempted-user; sid:2804141; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer 6.0 defaultTime remote code execution attempt"; flow:established,to_client; content:"|2e|addBehavior"; content:"#default#time"; distance:0; pcre:"/\x2eaddBehavior\s*\x28\s*\x22\s*\x23default\x23time\s*\x22\s*\x29/"; reference:cve,2011-3397; classtype:attempted-user; sid:2804144; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft PowerPoint file with unexpected record header OfficeArtBlipDIB inside an OfficeArtSpContainer"; flow:established,from_server; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|0f 00 04 f0|"; byte_extract:4,0,OfficeArtSpContainer.length,relative,little; content:"|00 00 1f f0|"; within:OfficeArtSpContainer.length; reference:cve,2011-3413; classtype:attempted-user; sid:2804157; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Publisher corrupted file download invalid OfficeArtClientAnchorOPD object"; flow:established,from_server; content:"|0D 0A 0D 0A D0 CF 11 E0 A1 B1 1A E1|"; content:"|0f 00 04 f0|"; content:"|3a 01 10 f0|"; within:164; byte_extract:4,4,OPD.lcb,relative,little; content:"|01 20|"; within:2; content:"|02 20|"; distance:4; within:2; content:"|03 20|"; distance:4; within:2; byte_test:4,>,OPD.lcb,0,relative,little; reference:cve,2011-3411; classtype:attempted-user; sid:2804158; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Media Player DVR-MS Overflow Attempt"; flow:to_client,established; content:"|0d 0a 0d 0a 30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|"; content:"|44 00 56 00 52|"; within:60; content:"Vali"; distance:0; byte_test:4,>,0x40,28,relative,little; reference:cve,2011-3401; classtype:attempted-user; sid:2804161; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible Microsoft Windows Object Packager Packager.exe Insecure Library Loading Code Execution - WebDAV"; flow:to_server,established; content:"|2f|Packager.exe"; http_uri; nocase; content:"GET"; http_method; reference:cve,2012-0009; classtype:attempted-user; sid:2804295; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF File Containing Javascript call to .submitForm method with invalid URL"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/JavaScript"; nocase; distance:0; content:"|2e|submitForm"; distance:0; content:"cURL|3a|"; distance:0; pcre:!"/cURL\x3a\s*\x22\s*(http|https|ftp|file)\x3a\x2f\x2f[-a-z0-9_.\x3a]+/[-a-z0-9_\x3a@&?=+,.!/~*%$]*\x23/smi"; reference:cve,CVE-2011-4371; classtype:attempted-user; sid:2804300; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF File Containing Embedded BMP with invalid number of colors 1"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/Subtype/image"; nocase; distance:0; content:"bmp/"; distance:0; content:"|42 4d|"; distance:0; content:"|28 00 00 00|"; distance:12; within:4; content:"|01 00 01 00|"; distance:8; within:4; byte_test:4,>,2,16,relative,little; reference:cve,CVE-2011-4373; classtype:attempted-user; sid:2804305; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF File Containing Embedded BMP with invalid number of colors 2"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/Subtype/image"; nocase; distance:0; content:"bmp/"; distance:0; content:"|42 4d|"; distance:0; content:"|28 00 00 00|"; distance:12; within:4; content:"|01 00 04 00|"; distance:8; within:4; byte_test:4,>,16,16,relative,little; reference:cve,CVE-2011-4373; classtype:attempted-user; sid:2804306; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF File Containing Embedded BMP with invalid number of colors 3"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/Subtype/image"; nocase; distance:0; content:"bmp/"; distance:0; content:"|42 4d|"; distance:0; content:"|28 00 00 00|"; distance:12; within:4; content:"|01 00 08 00|"; distance:8; within:4; byte_test:1,>,256,16,relative,little; reference:cve,CVE-2011-4373; classtype:attempted-user; sid:2804307; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF File Containing Embedded BMP with invalid number of colors 4"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/Subtype/image"; nocase; distance:0; content:"bmp/"; distance:0; content:"|42 4d|"; distance:0; content:"|28 00 00 00|"; distance:12; within:4; content:"|01 00 0f 00|"; distance:8; within:4; byte_test:4,>,0x8000,16,relative,little; reference:cve,CVE-2011-4373; classtype:attempted-user; sid:2804308; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF File Containing Embedded BMP with invalid number of colors 5"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/Subtype/image"; nocase; distance:0; content:"bmp/"; distance:0; content:"|42 4d|"; distance:0; content:"|28 00 00 00|"; distance:12; within:4; content:"|01 00 10 00|"; distance:8; within:4; byte_test:4,>,0x10000,16,relative,little; reference:cve,CVE-2011-4373; classtype:attempted-user; sid:2804309; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF File Containing Embedded BMP with invalid number of colors 6"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"/Subtype/image"; nocase; distance:0; content:"bmp/"; distance:0; content:"|42 4d|"; distance:0; content:"|28 00 00 00|"; distance:12; within:4; content:"|01 00 18 00|"; distance:8; within:4; byte_test:4,>,0x1000000,16,relative,little; reference:cve,CVE-2011-4373; classtype:attempted-user; sid:2804310; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Anti-Cross Site Scripting Library Vulnerability 1"; flow:from_server,established; content:"style"; nocase; content:"|5c 2c 22|"; distance:0; fast_pattern; pcre:"/style\s*=[^>]*\x5c\x2c\x22/i"; reference:cve,2012-0007; reference:bugtraq,51291; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-007; classtype:attempted-user; sid:2804387; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Anti-Cross Site Scripting Library Vulnerability 2"; flow:from_server,established; content:"style"; nocase; content:"|5c 2c 27|"; distance:0; pcre:"/style\s*=[^>]*\x5c\x2c\x27/i"; reference:cve,2012-0007; reference:bugtraq,51291; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-007; classtype:attempted-user; sid:2804388; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Windows Media component specific exploit"; flow:established,to_client; content:"bang()"; content:"cloned"; distance:0; content:"unescape(|22|%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c|22|)"; distance:0; reference:cve,2012-0003; classtype:attempted-user; sid:2014156; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows midiOutPlayNextPolyEvent Heap Overflow 1"; flow:to_client,established; file_data; content:"MThd|00 00 00 06|"; byte_test:2,<=,0x02,0,relative,big; content:"|4d 54 72 6b|"; distance:0; byte_extract:4,0,Chunk_Track_length,relative; content:"|2f 00 4d 54 72 6b|"; distance:0; byte_jump:1,7,relative; content:"|00|"; within:1; content:"|00|"; within:Chunk_Track_length; byte_test:1,&,0x80,0,relative; byte_test:1,>,0x7f,0,relative; byte_test:1,<,0x90,1,relative; byte_test:1,>,0x7f,1,relative; reference:cve,2012-0003; reference:url,exploit-db.com/exploits/18426/; reference:bugtraq,51292; reference:osvdb,78210; classtype:attempted-user; sid:2804426; rev:11;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows midiOutPlayNextPolyEvent Heap Overflow 2"; flow:to_client,established; file_data; content:"MThd|00 00 00 06|"; byte_test:2,<=,0x02,0,relative,big; content:"|4d 54 72 6b|"; distance:0; byte_extract:4,0,Chunk_Track_length,relative; content:"|2f 00 4d 54 72 6b|"; distance:0; byte_jump:1,7,relative; content:"|00|"; within:1; content:"|00|"; within:Chunk_Track_length; byte_test:1,&,0x90,0,relative; byte_test:1,>,0x8f,0,relative; byte_test:1,<,0xa0,0,relative; byte_test:1,>,0x7f,1,relative; reference:cve,2012-0003; reference:url,exploit-db.com/exploits/18426/; reference:bugtraq,51292; reference:osvdb,78210; classtype:attempted-user; sid:2804427; rev:8;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows midiOutPlayNextPolyEvent Heap Overflow 3"; flow:to_client,established; file_data; content:"MThd|00 00 00 06|"; byte_test:2,<=,0x02,0,relative,big; content:"|4d 54 72 6b|"; distance:0; byte_extract:4,0,Chunk_Track_length,relative; content:"|2f 00 4d 54 72 6b|"; distance:0; byte_jump:1,7,relative; content:"|00|"; within:1; content:"|00|"; within:Chunk_Track_length; byte_test:1,&,0xa0,0,relative; byte_test:1,>,0x9f,0,relative; byte_test:1,<,0xb0,0,relative; byte_test:1,>,0x7f,1,relative; reference:cve,2012-0003; reference:url,exploit-db.com/exploits/18426/; reference:bugtraq,51292; reference:osvdb,78210; classtype:attempted-user; sid:2804428; rev:10;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_CLIENT Likely MS12-004 midiOutPlayNextPolyEvent Heap Overflow Midi Filename Requested baby.mid"; flow:established,to_server; content:"/baby.mid"; http_uri; reference:cve,2012-0003; classtype:trojan-activity; sid:2014207; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft .NET Framework and the Silverlight Framework remote code execution"; flow:established,from_server; content:"MZ"; content:"This program cannot be run in DOS mode"; distance:0; content:"|53 79 73 74 65 6D 00 53 79 73 74 65 6D 2E 4E 65 74 2E 53 6F 63 6B 65 74 73 00 53 6F 63 6B 65 74 41 73 79 6E 63 45 76 65 6E 74 41 72 67 73 00 6D 73 63 6F 72 6C 69 62 00 4F 62 6A 65 63 74 00 43 6C 6F 6E 65 00|"; distance:0; content:"|4D 65 6D 62 65 72 77 69 73 65 43 6C 6F 6E 65 00|"; distance:0; reference:cve,2012-0014; classtype:attempted-user; sid:2804507; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft .NET Framework System.Uri.ReCreateParts method remote code execution - SET"; flow:established,from_server; content:"MZ"; content:"This program cannot be run in DOS mode"; distance:0; content:"http|3a 2f 2f|"; pcre:"/[\x2e\2fa-z0-9]+/Ri"; byte_test:1,>,0xe0,0,relative; flowbits:set,ETPRO.2012-0015; flowbits:noalert; reference:cve,2012-0015; classtype:attempted-user; sid:2804508; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft .NET Framework System.Uri.ReCreateParts method remote code execution"; flow:established,from_server; flowbits:isset,ETPRO.2012-0015; content:"|54 65 78 74 00 45 6E 63 6F 64 69 6E 67 00 67 65 74 5F 55 54 46 38 00 47 65 74 53 74 72 69 6E 67 00 55 72 69 00 67 65 74 5F 50 61 74 68 41 6E 64 51 75 65 72 79|";  reference:cve,2012-0015; classtype:attempted-user; sid:2804509; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows 7 Professional 64-bit arbitrary code via a large height attribute in an IFRAME"; flow:established,from_server; content:"<iframe"; content:"height="; distance:0; content:"|27|18082563|27|"; distance:0; pcre:"/<iframe\s+height\s*\x3d\s*\x2718085263\x27\s*>/"; reference:cve,2011-5046; classtype:attempted-user; sid:2804510; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer style.position use-after-free"; flow:established,from_server; content:"document|2e|createElement|28| |27|div|27| |29 3b|"; content:"document|2e|createElement|28| |27|div|27| |29 3b|"; distance:0; content:".body.appendChild"; distance:0; content:".body.appendChild"; distance:0; content:".contentEditable = true"; distance:0; content:".style.position = |27|fixed|27 3b|"; fast_pattern; distance:0; content:".cloneNode|28| true |29 3b|"; distance:0; content:".style.position ="; distance:0; pcre:"/\x2estyle\x2eposition\s*=\s*\x27\s*\x27\s*\x3b/"; reference:cve,2012-0011; classtype:attempted-user; sid:2804511; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT C Run-Time Library of Windows (mscvrt.dll) memory corruption"; flow:established,from_server; file_data; content:"<ASX"; content:"VERSION=|22|"; distance:0; pcre:"/^\d\x2e/R"; isdataat:700,relative; content:!"|22|"; within:700; reference:cve,2012-0150; classtype:attempted-user; sid:2804515; rev:7;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Color Control Panel STI.dll Insecure Library Loading"; flow:to_server,established; content:"GET"; http_method; content:"/sti.dll"; nocase; http_uri; reference:cve,2010-5082; classtype:attempted-user; sid:2804520; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer 9 Null Byte Information Disclosure"; flow:established,from_server; content:"<meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=9|22| >"; content:"|5c|u0000"; distance:0; fast_pattern; pcre:"/var\s+[_a-z0-9]+\s*\x3d\s*\x22[^\x22\x5c]+\x5cu0000[0-9a-z]+\x22/"; reference:cve,2012-0012; classtype:attempted-user; sid:2804521; rev:3;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Flash Player file with Stage3D Object beeing instantiated at ActionScript 3 "; flow:established,from_server; content:"|0D 0A 0D 0A 46 57 53 0E|"; content:"|BF 14|"; distance:0; content:"|10 00 2E 00|"; distance:0; content:"|0D|flash|2E|display|06|Sprite|07|Stage3D|01|"; content:"|0A|flash.geom|14|flash.display|3a|Sprite$flash.display|3a|"; distance:30; within:60; reference:url,help.adobe.com/en_US/FlashPlatform/beta/reference/actionscript/3/flash/display/Stage3D.html; reference:cve,2012-0768; classtype:attempted-user; sid:2804657; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Flash Player file with Matrix3D.copyRawDataFrom() function"; flow:established,from_server; content:"|0D 0A 0D 0A 46 57 53 0E|"; content:"|BF 14|"; distance:0; content:"|10 00 2E 00|"; distance:0; content:"|0D|flash|2E|display|06|Sprite|0A|flash.geom|08|Matrix3D|06|Vector"; content:"EventDispatcher|06|Number|0F|copyRawDataFrom"; distance:0; reference:url,help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/geom/Matrix3D.html; reference:cve,2012-0768; classtype:attempted-user; sid:2804662; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Player Malformed MP4 Remote Code Execution Attempt"; flow:established,to_client; content:"|66 74 79 70 6D 70 34|"; content:"|01 6D 70 34 32 69 73 6F 6D|"; distance:0; content:"|63 70 72 74 00 FF FF FF|"; distance:0; reference:url,contagiodump.blogspot.com/2012/03/mar-2-cve-2012-0754-irans-oil-and.html; reference:bid,52034; reference:cve,2012-0754; classtype:attempted-user; sid:2014335; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer CTableRowCellsCollectionCacheItem.GetNext Memory Use-After-Free Attempt"; flow:established,to_client; content:"document.getElementById|28 27|tableid|27 29|.cloneNode"; nocase; content:"cells.urns"; nocase; distance:0; content:"cells.item"; nocase; distance:0; reference:url,dvlabs.tippingpoint.com/blog/2012/03/15/pwn2own-2012-challenge-writeup; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-002; reference:bid,37894; reference:cve,2010-0248; classtype:attempted-user; sid:2014463; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF Add Button Dereference Vulnerability Exploit Attempt"; flow:from_server,established; content:"|25|PDF-"; content:"app.addToolButton|28|"; distance:0; content:"cName|3A|"; distance:0; content:"cEnable|3A|"; distance:0; content:"app.removeToolButton|28|"; distance:0; pcre:"/app\.addToolButton\s*\(\s*\{\s*cName\x3a\s*\"?\s*(?P<cName>[^\s\"]+)\s*\"?.+cEnable\x3a\s*\"\s*[^\"]*app\.removeToolButton\(\"?(?P=cName)/s"; reference:cve,2012-0775; classtype:attempted-user; sid:2804791; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Potential Microsoft Internet Explorer Vector Graphics Rendering user-after-free"; flow:from_server,established; content:"|3c|HTML xmlns|3a|v=|22|urn|3a|schemas-microsoft-com|3a|vml|22|>"; nocase; content:"#default#VML"; distance:0; content:"document.write"; distance:0; content:"expression("; distance:0; pcre:"/\x3cbody\s*style\s*\x3d\s*\x22[a-z]+\s*\x3a\s*expression\x28[^>]+/smi"; reference:cve,2012-0172; classtype:attempted-user; sid:2804795; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File download with vulnerable ActiveX control flowbit set 1"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"4BF0D1BD8B85D111B16A00C0F0283628"; distance:0; flowbits:set,ETPRO.RTF.OBJ; flowbits:noalert; reference:cve,2012-0158; classtype:attempted-user; sid:2804796; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File download with vulnerable ActiveX control flowbit set 2"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"E0F56B9944805046ADEB0B013914E99C"; distance:0; flowbits:set,ETPRO.RTF.OBJ; flowbits:noalert; reference:cve,2012-0158; classtype:attempted-user; sid:2804797; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File download with vulnerable ActiveX control flowbit set 3"; flow:from_server,established; flowbits:isset,ETPRO.RTF; content:"|5c|object"; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"5FDC81917DE08A41ACA68EEA1ECB8E9E"; distance:0; flowbits:set,ETPRO.RTF.OBJ; flowbits:noalert; reference:cve,2012-0158; classtype:attempted-user; sid:2804798; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File download with vulnerable ListView ActiveX control"; flow:from_server,established; flowbits:isset,ETPRO.RTF.OBJ; content:"12000200FFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000000000000000000000000000000000000000000000000000000020000007E0500000000"; content:"21433412"; distance:0; content:"4E087DEB"; distance:0; content:"01EFCDAB"; distance:0; content:"1FDEECBD"; distance:0; content:"436F626A"; distance:0; byte_test:4,>,8,8,string,dec,relative; reference:cve,2012-0158; classtype:attempted-user; sid:2804799; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File download with vulnerable TreeView ActiveX control 2"; flow:from_server,established; flowbits:isset,ETPRO.RTF.OBJ; content:"12000200FFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000000000000000000000000000000000000000000000000000000020000007E0500000000"; content:"21433412"; distance:0; content:"B13CC16A"; distance:0; content:"01EFCDAB"; distance:0; content:"1FDEECBD"; distance:0; content:"436F626A"; distance:0; byte_test:4,>,8,8,string,dec,relative; reference:cve,2012-0158; classtype:attempted-user; sid:2804800; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DOC File download CVE-2012-0158 ListView Overflow 1 -SET"; flow:from_server,established; file_data; content:"|4b f0 d1 bd 8b 85 d1 11 b1 6a 00 c0 f0 28 36 28|"; distance:0; flowbits:set,ETPRO.DOC.ListView.1; flowbits:noalert; reference:cve,2012-0158; classtype:attempted-user; sid:2804856; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DOC File download CVE-2012-0158 ListView Overflow 2 -SET"; flow:from_server,established; file_data; content:"|E0 F5 6B 99 44 80 50 46 EB AD 0B 01 39 14 E9 9C|"; distance:0; flowbits:set,ETPRO.DOC.ListView.1; flowbits:noalert; reference:cve,2012-0158; classtype:attempted-user; sid:2804857; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DOC File download CVE-2012-0158 ListView Overflow"; flow:from_server,established; flowbits:isset,ETPRO.DOC.ListView.1; content:"|4c 00 69 00 73 00 74 00 56 00 69 00 65 00 77 00|"; content:"|21 43 34 12|"; distance:0; content:"|4E 08 7D EB|"; distance:12; within:4; content:"|01 EF CD AB|"; distance:8; content:"|1F DE EC BD|"; distance:8; content:"|43 6F 62 6A|"; distance:8; byte_test:4,>,8,4,relative,little; reference:cve,2012-0158; classtype:attempted-user; sid:2804858; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DOC File download CVE-2012-0158 TreeView Overflow 1 -SET"; flow:from_server,established; file_data; content:"|B6 90 41 C7 89 85 D1 11 6A B1 00 C0 F0 28 36 28|"; distance:0; flowbits:set,ETPRO.DOC.TreeView.1; flowbits:noalert; reference:cve,2012-0158; classtype:attempted-user; sid:2804859; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DOC File download CVE-2012-0158 TreeView Overflow 2 -SET"; flow:from_server,established; file_data; content:"|5F DC 81 91 7D 30 41 8A A6 AC 8E EA 1E CB 8E 9E|"; distance:0; flowbits:set,ETPRO.DOC.TreeView.1; flowbits:noalert; reference:cve,2012-0158; classtype:attempted-user; sid:2804860; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft DOC File download CVE-2012-0158 TreeView Overflow"; flow:from_server,established; flowbits:isset,ETPRO.DOC.TreeView.1; content:"|54 00 72 00 65 00 65 00 56 00 69 00 65 00 77 00|"; content:"|21 43 34 12|"; distance:0; content:"|B1 3C C1 6A|"; distance:12; within:4; content:"|01 EF CD AB|"; distance:8; content:"|1F DE EC BD|"; distance:8; content:"|43 6F 62 6A|"; distance:8; byte_test:4,>,8,4,relative,little; reference:cve,2012-0158; classtype:attempted-user; sid:2804861; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted/hostile file with invalid ObjectLink BIFF record"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|27 10|"; content:"|04 00|"; distance:2; within:2; byte_test:2,<,65535,2,relative,little; byte_test:2,>,31999,2,relative,little; reference:cve,2012-0142; classtype:attempted-user; sid:2804906; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted/hostile file download invalid Window2 BIFF record"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|3e 02|"; byte_test:1,<,16,3,relative,little; byte_test:1,!&,2,3,relative,little; pcre:"/(?<!\x3e\x02.{3}[\x15\x14\x11\x10\x07\x06\x03\x02])(\x3e\x02.{3}[\x13\x12\x09\x08\x05\x04\x01])+(?!\x3e\x02.{3}[\x15\x14\x11\x10\x07\x06\x03\x02])/s"; reference:cve,2012-0143; classtype:attempted-user; sid:2804907; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT TrueType Font Parsing Attack"; flow:from_server,established; content:"|0d 0a 0d 0a 00 01 00 00 00|"; content:"maxp"; fast_pattern; distance:0; byte_jump:4,4,relative,from_beginning; content:"|00 01 00 00|"; within:4; byte_test:2,>,0x7fff,6,relative; reference:cve,2012-0159; classtype:bad-unknown; sid:2804908; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Hostile Microsoft Rich Text File (RTF) with corrupted listoverride"; flow:from_server,established; flowbits:set,ETPRO.RTF; content:"|7b 5c 2a 5c|listoverridetable"; content:"|5c|listoverride|5c|"; fast_pattern:only; pcre:"/\x5clistoverride\x5c((?!\x5cls\d{1,4}\s*\}).)+?\x5clistoverride\x5c/s"; reference:cve,2012-0183; classtype:attempted-user; sid:2804909; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted/hostile file invalid SXLI BIFF record"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|B5 00|"; byte_test:2,&,0x8000,2,relative,little; reference:cve,2012-0184; classtype:attempted-user; sid:2804910; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted/hostile file invalid MergeCells.rgref.ref8.colLast value"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|E5 00|"; byte_test:2,<,1027,2,relative,little; byte_test:2,>,0x3fff,10,relative,little; reference:cve,2012-0185; classtype:attempted-user; sid:2804911; rev:3;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,1935] (msg:"ETPRO WEB_CLIENT RTMPmsg Traffic"; flow:to_server,established; byte_test:1,!&,128,0; content:"|14|"; offset:7; depth:1; content:"|02 00 10|systemMemoryCall|00|"; within:25; flowbits:set,RTMPmsgCall; flowbits:noalert; classtype:web-application-attack; sid:2804912; rev:2;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,1935] (msg:"ETPRO WEB_CLIENT RTMPmsg Traffic 2"; flow:to_server,established; byte_test:1,!&,128,0; content:"|11|"; offset:7; depth:1; content:"|02 00 10|systemMemoryCall|00|"; within:25; flowbits:set,RTMPmsgCall; flowbits:noalert; classtype:web-application-attack; sid:2804913; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel file download - SET 1"; flow:established,from_server; flowbits:isset,OLE.CompoundFile; file_data; content:"|09 08 10 00 00 06 05 00|"; distance:512; content:"|57006F0072006B0062006F006F006B00|"; fast_pattern:only; flowbits:set,ETPRO.Microsoft.Excel; flowbits:noalert; reference:cve,2012-0185; classtype:attempted-user; sid:2804921; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel file download - SET 2"; flow:established,from_server; content:"|0d 0a 0d 0a D0 CF 11 E0 A1 B1 1A E1|"; content:"|09 08 10 00 00 06 05 00|"; distance:504; within:8; pcre:"/^[\x10\x1F\x22\x23\x28\x29][\x00\x02]/R"; flowbits:set,ETPRO.Microsoft.Excel; flowbits:noalert; reference:cve,2012-0185; classtype:attempted-user; sid:2804922; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excell with Regular SERIES Record with a malformed stdy value"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|03 10|"; content:"|03 00|"; distance:4; within:2; byte_test:2,<,32767,0,relative,little; byte_test:2,<,32767,2,relative,little; content:"|01 00|"; distance:4; within:2; byte_test:2,<,32767,0,relative,little; reference:cve,2012-1847; classtype:attempted-user; sid:2804927; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT MP4 Embedded in PDF File - Potential Flash Exploit"; flow:established,to_client; content:"obj"; content:"<<"; within:4; content:"stream"; distance:0; content:"|00 00 00 18 66 74 79 70|mp4"; within:13; reference:cve,2012-0754; reference:url,blog.9bplus.com/observing-the-enemy-cve-2012-0754-pdf-interac; classtype:bad-unknown; sid:2014865; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Flash Player initialization via onkeypress event"; flow:established,from_server; content:"<script>"; content:".onkeypress"; distance:0; content:"d27cdb6e-ae6d-11cf-96b8-444553540000"; distance:0; pcre:"/\x2eonkeypress\s*\x3d\s*function\(.+\)[\s\r\n]*\x7b\s*([a-zA-Z0-9]+)\(.+\)\s*\x3b\s*\x7d.+function\s*([a-zA-Z0-9]+)\(.+\)[\s\r\n]*\x7b\s*[^\x7d]+\s*\x3d\s*\x27document.body.innerHTML\s*\x3d\s*\x5c\x27<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*d27cdb6e-ae6d-11cf-96b8-444553540000.+\s+value\s*\x3d\s*\x22([a-zA-Z0-9]+)\.swf\x22/si"; reference:cve,2012-2035; classtype:trojan-activity; sid:2805034; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free via getBoundingClientRect()"; flow:established,from_server; content:".insertAdjacentElement(|22|afterEnd|22|"; nocase; content:".createCaption("; distance:0; content:".getBoundingClientRect("; nocase; distance:0; content:".insertRow("; distance:0; content:".deleteCaption("; distance:0; pcre:"/for\s*\x28\s*(?P<forIndex>[^\x3d\x20]+)[^\x29]+\x29[\s\r\n]*\x7b[^\x7d]+\x2ecreateElement\(\x22[^\x22]+\x22\s*\)\s*\x3b[^\x3b]+\x2esetAttribute\x28\x22id\x22\s*\x2c\s*\x22(?P<tblName>[^\x22]+)\x22\+(?P=forIndex).+\x2egetElementById\x28\x22(?P=tblName)\d+\x22\x29\x2egetBoundingClientRect/si"; reference:cve,2012-1880; classtype:attempted-user; sid:2805056; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Internet Explorer SameID Use-After-Free "; flow:established,from_server; content:"<DIV id="; nocase; content:"<img id="; nocase; distance:0; content:".innerHTML"; distance:0; pcre:"/<DIV\s*?id[\s\r\n]*?\x3d[\s\r\n]*?(?P<divid>[^>]+).+?<img\s*id=\s*?\x22(?P<imgid>[^\x22]+).+?\<a\s*?href=\x22javascript\x3a(?P<firstfunction>[^\x28]+)\(\).+?\>.*?\<div[^\>]+?id=\x22(?P=imgid)\x22[^>]+?on[A-Za-z]+?\s*?=\s*?\x22(?P<secondfunction>[^\x28]+)\(\)\x3b\s*?\x22.+?function[\s\r\n]*?(?P=firstfunction)[\s\r\n]*?\(.*?\).*?\x7b.*?(?P=divid)\x2einnerHTML\s*?\x3d\s*?(?P=divid)\x2einnerHTML[\s\r\n]*?\x3b.*?\x7d.*?function[\s\r\n]*?(?P=secondfunction)[\s\r\n]*?\(.*?\).*?\x7b.*?\x28\x22(?P=imgid)\x22\x29\x2esrc\s*?\x3d/si"; reference:cve,CVE-2012-1875; classtype:attempted-user; sid:2014911; rev:10;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer 8 Center Element Memory Courruption Attempt"; flow:established,to_client; content:"|2e|getElementsByTagName"; content:"|22|center|22|"; distance:0; content:"|2e|appendChild"; distance:0; pcre:"/var\s*(?P<varname>[^\s]+)\s*=\s*[^\x3b]+\x2egetElementsByTagName\s*\(\s*\"center\"\s*\).+(?P=varname)(\[[^\]]+?\])?\x2eappendChild/s"; reference:cve,2012-1523; classtype:attempted-user; sid:2805058; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer DYNAMIC SPAN COL Corruption"; flow:from_server,established; content:"|2e|getElementById"; content:"|2e|span"; distance:0; content:"table-layout|3A|fixed"; content:"col"; distance:0; content:"id"; distance:0; content:"span"; pcre:"/var\s+(?P<varname>[^\s\x3d]+)\s*\x3d[^\x3b]+?\.getElementById\(\s*\"(?P<colid>[^\"]+)\"\s*\).+(?P=varname)\.span\s*\x3d\s*(?P<span_val>[^\s\x3b]+).+\<table[^\>]+\>.+\<col[^\>]+(id\s*=\s*\"(?P=colid).+?span\s*=\s*\"(?!(?P=span_val))|span\s*=\s*\"(?!(?P=span_val)).+?id\s*=\s*\"(?P=colid)).+?\<\/table\>/s"; reference:cve,2012-1876; classtype:attempted-user; sid:2805059; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Memory Leak (Internet Explorer 9 or 9+)"; flow:established,from_server; content:"X-UA-Compatible"; content:"=|22|IE=9"; nocase; distance:0; content:"<input id=|22|"; distance:0; content:"value=|22|"; distance:0; content:"onchange=|22|"; distance:0; content:"|27 5c|0|27 3b|"; distance:0; content:"window.postMessage("; distance:0; pcre:"/<input\s*id\s*\x3d\s*\x22(?P<INid>[^\x22]+)\x22\s*value\x3d\x22\d+\x22\s*onchange\x3d\x22[^\x22]+\x28\x29\x3b\x22.+var\s*(?P<varpayload>[^\x20]+)\s*\x3d\s*\x27\x5c0\x27\x3b.+function (?P<refreshPayload>[^\x28]+)\(\)[\s\r\n]*\x7b[\s\r\n]*var\s*(?P<varCount>[^\x20]+)\s*\x3d\s*parseInt\(document\.getElementById\(\s*\x27(?P=INid)\x27\s*\x29\.value\x2c\s*\d+\)\s*\x3b.+for\s*\x28\s*(var)?\s*(?P<forIndex>[^\x3d\x20]+)\s*\x3d\s*0\x3b\s*(?P=forIndex)\s*\x3c\s*(?P=varCount)\s*\x3b\s*(?P=forIndex)\+\+\s*\x29[\s\r\n]*\x7b[^\x7d]+(?P=varpayload)\s*\+=\s*\x27\x20\x27\s*\x3b.+window\.postMessage\((?P=varpayload)\x2c/si"; reference:cve,2012-1873; classtype:attempted-user; sid:2805060; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free via console object"; flow:established,from_server; content:"setTimeout"; nocase; content:"console.error"; nocase; distance:0; content:"console"; distance:0; content:"CollectGarbage()|3b|"; distance:0; pcre:"/setTimeout\s*\(\s*function\s*.+\x7b.+(?P<obj>[^\x20]+)\s*\x3d\s*console.error.+CollectGarbage\(\)\;.+((?P=obj)\x2e[a-z]+|\(\s*[\x22\x27]?(?P=obj)[\x22\x27]?\s*\))/si"; reference:cve,2012-1874; classtype:attempted-user; sid:2805061; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Potential MSXML2.DOM Document.3.0 Uninitialized Memory Corruption Attempt"; flow:to_client,established; file_data; content:"f5078f3"; content:"-c551-11d3-89b9-0000f81fe221"; nocase; distance:1; within:28; content:".definition|28|"; nocase;  pcre:"/clsid\s*\x3a\s*\x7B?\s*f5078f3(2|3)-c551-11d3-89b9-0000f81fe221/si"; reference:cve,CVE-2012-1889; classtype:attempted-admin; sid:2015554; rev:19;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Potential MSXML2.DOMDocument.4-6.0 Uninitialized Memory Corruption CVE-2012-1889"; flow:to_client,established; file_data; content:"88d96"; nocase; content:"-f192-11d4-a65f-0040963251e5"; distance:3; within:28; nocase; content:"definition"; nocase; pcre:"/clsid\s*\x3a\s*\x7B?\s*88d96(9c(0|1)|9e(5|6)|a0(5|6))-f192-11d4-a65f-0040963251e5/si"; pcre:"/(?:\[\s*[\x22\x27]definition[\x22\x27]\s*\]|\.definition)\(/"; reference:cve,CVE-2012-1889; classtype:attempted-admin; sid:2015555; rev:18;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Potential MSXML2.DOMDocument ActiveXObject Uninitialized Memory Corruption Attempt"; flow:to_client,established; file_data; content:"ActiveXObject"; nocase; content:"MSXML2."; fast_pattern; content:"DOMDocument"; within:23; content:"definition"; nocase; pcre:"/MSXML2\.(FreeThreaded)?DOMDocument(\.[3-6]\.0)?/si"; pcre:"/(?:\[\s*[\x22\x27]definition[\x22\x27]\s*\]|\.definition)\(/"; reference:cve,CVE-2012-1889; classtype:attempted-user; sid:2015556; rev:21;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Potential MSXML2.DOMDocument Uninitialized Memory Corruption CVE-2012-1889"; flow:to_client,established; file_data; content:"f6d90f11-9c73-11d3-b32e-00c04f990bb4"; nocase; content:"definition"; nocase; pcre:"/clsid\s*\x3a\s*\x7B?\s*f6d90f11-9c73-11d3-b32e-00c04f990bb4/si"; pcre:"/(?:\[\s*[\x22\x27]definition[\x22\x27]\s*\]|\.definition)\(/"; reference:cve,CVE-2012-1889; classtype:attempted-admin; sid:2014938; rev:13;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple iTunes 10.6.1.7 M3U Playlist File Walking Heap Buffer Overflow"; flow:established,from_server; flowbits:isset,ET.iTunes.vuln; content:"#EXTINF|3a|"; isdataat:553,relative; content:!"|0d|"; within:553; reference:cve,2012-0677; reference:url,exploit-db.com/exploits/19098/; reference:url,packetstormsecurity.org/files/113555; reference:url,zeroscience.mk/en/vulnerabilities/ZSL-2012-5093.php; classtype:attempted-user; sid:2805099; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple Quicktime TeXML Remote Code Execution"; flow:from_server,established; content:"<?xml version="; content:"<?quicktime type=|22|application/x-quicktime-texml|22|?>"; distance:0; content:"transform=|22|matrix|28|"; distance:0; content:"color|3a| "; pcre:"/[^\x2c\x00\x23\x25\x3c\x3e\x7d]{643}/R"; reference:cve,2012-0663; classtype:attempted-user; sid:2805122; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Microsoft Word Insecure Library Loading (imeshare.dll)"; flow:to_server,established; content:"|2f|imeshare.dll"; nocase; http_uri; content:"GET"; http_method; reference:cve,2012-1854; classtype:attempted-user; sid:2805144; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Potential MSXML2.FreeThreadedDOMDocument Uninitialized Memory Corruption Attempt"; flow:to_client,established; content:"f6d90f12-9c73-11d3-b32e-00c04f990bb4"; nocase; content:"definition"; nocase; pcre:"/clsid\s*\x3a\s*\x7B?\s*f6d90f12-9c73-11d3-b32e-00c04f990bb4/si"; pcre:"/(?:\[\s*[\x22\x27]definition[\x22\x27]\s*\]|\.definition)\(/"; reference:cve,2012-1889; classtype:attempted-user; sid:2015557; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer ul html tag uninitialized memory access"; flow:established,from_server; content:"<ul"; content:"<li"; distance:0; content:"<table"; distance:0; content:"<script>"; content:"body.innerHTML"; nocase; fast_pattern; distance:0; content:"</script>"; distance:0; content:"</table>"; content:"</li>"; distance:0; pcre:"/<ul.+?(?<!\x3c\x2ful\x3e)<li.+?(?<!\x3c\x2ful\x3e)<span>.+?(<ul.+?(?<!\x3c\x2ful\x3e)){5,}.+?<table(?<!\x3c\x2ftable\x3e).+?<script>.*?document\.body\.innerHTML(?<!\x3c\x2fscript\x3e).+?\x3c\x2fscript\x3e(?<!\x3c\x2ftable\x3e).+?\x3c\x2fli\x3e[\r\n\s]*\x3c\x2ftable\x3e[\r\n\s]*(\x3c\x2ful\x3e[\r\n\s]*){5,}/si"; reference:cve,2012-1522; classtype:attempted-user; sid:2805161; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer MSADO allocation negative cache size to a recordset"; flow:established,from_server; content:".recordset"; nocase; content:".cacheSize"; nocase; distance:0; pcre:"/(\.cacheSize[\s\r\n]*?=[\s\r\n]*?-[\s\r\n]*?(0x[a-f0-9]|\d)|(?P<var_name>[^\s\r\n]+)[\s\r\n]*?=[\s\r\n]*?-[\s\r\n]*?(0x[a-f0-9]|\d).+?\.cacheSize[\s\r\n]*?=[\s\r\n]*?(?P=var_name))/si"; reference:cve,2012-1891; classtype:attempted-user; sid:2805162; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer toStaticHTML Cross-Site Scripting 2"; flow:from_server,established; content:"toStaticHTML"; nocase; content:"|3c|style"; distance:0; nocase; content:"|27 27 27|"; distance:0; pcre:"/<style.+?\x7b[^\x7d]+?\x28[^\x29]*?(?<!\x27)((\x27)(\x27))*(\x27)[^\x27]*?\x29[^\x7d]*?(?<!\x27)((\x27)(\x27))*(\x27)[^\x27\x7d]*?\x7d.*?(?<!\x27)((\x27)(\x27))*(\x27)[^\x27\x3b]*?\x3b/si"; reference:cve,2012-1558; classtype:attempted-user; sid:2805165; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer 7 Layout Memory Use-After-Free Exploit Attempt"; flow:from_server,established; content:"margin"; pcre:"/style=\x27.+?margin(\x3a|\x2d(top|bottom|right|left)\x3a)[^\x3b]+?\x2d\d{3,}[^\x22\x27]+?\x3b\x27/msi"; reference:cve,2012-1526; classtype:attempted-user; sid:2805314; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Asynchronous NULL Object Access Remote Code Execution"; flow:from_server,established; content:"mailto"; content:"@font-face"; pcre:"/^[\r\n\s]*?{[^}]*?src[\r\n\s]*?\x3a[\r\n\s]*?url[\r\n\s]*?\x28[\r\n\s\x22\x27]*?mailto\x3a/Rsi"; reference:cve,2012-2521; classtype:attempted-user; sid:2805315; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Virtual Function Table Corruption Remote Code Execution Vulnerability"; flow:from_server,established; content:"<form"; nocase; pcre:"/((?!<\/form>).)*?<(marquee.+?<select|select.+?<marquee)((?!<\/form>).)*?<\/form>/Rsi"; content:".execCommand("; fast_pattern:only; nocase; content:".removeNode("; nocase; content:".focus("; nocase; content:".innerHTML"; nocase; content:"<script"; nocase; pcre:"/^((?!<\/script>).)*?\.focus\x28((?!<\/script>).)+?\.innerHTML[\s\r\n]*?=[\s\r\n]*?(\x22\x22|\x27\x27)((?!<\/script>).)+?\.removeNode\x28\s*?true\s*?\x29((?!<\/script>).)+?\.execCommand\x28[\x22\x27\s]*?selectAll[\x22\x27\s]*?\x29((?!<\/script>).)*?<\/script>/Rsi"; reference:cve,2012-2522; classtype:attempted-user; sid:2805317; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader PDF Widget RichMedia Memory Corruption"; flow:established,from_server; content:"/Subtype"; nocase; content:"/RichMedia"; nocase; distance:0; content:"/Type"; nocase; content:"/Annot"; nocase; distance:0; content:"getAnnotsRichMedia("; distance:0; fast_pattern; content:"obj"; pcre:"/^[\r\n\s]*?<<((?!endobj).)*?\/JavaScript((?!endobj).)*?var[\s\r\n]+?(?P<RMediaArrayVar>[^\r\n\s]+)[\s\r\n]*?=[\s\r\n]*?getAnnotsRichMedia\([^\)]*?\)((?!endobj).)*?(?P=RMediaArrayVar)\.(s(hift|plice)|pop)\(/Rsi"; reference:cve,2012-4147; classtype:attempted-admin; sid:2805320; rev:3;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF Widget Annotation NULL Pointer Deref (SubObject)"; flow:established,from_server; content:"/Subtype"; nocase; content:"/Widget"; nocase; distance:0; content:"/FT"; distance:0; content:"Annots["; fast_pattern; pcre:"/^(?P<oredirect>(\s*\d+)+)[^\]]*?\]((?!endobj).)*?endobj.*?(?P=oredirect)\s*?obj[\r\n\s]*<<((?!endobj).)*?\/Subtype\s*?\/Widget((?!endobj).)+?\/FT\s*\/(?!(Btn|Tx|Ch|Sig))((?!endobj).)*?endobj/Rsi"; reference:cve,2012-4148; classtype:attempted-admin; sid:2805321; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF Widget Annotation NULL Pointer Deref Attempt"; flow:established,from_server; file_data; flowbits:isset,ET.pdf.in.http; content:"/Subtype"; nocase; content:"/Widget"; nocase; distance:0; content:"/FT"; content:"/Type"; content:"/Annot"; fast_pattern; distance:0; content:"obj"; pcre:"/^[\r\n\s]*?<<((?!endobj).)+?\/(Type\s*?\/Annot((?!endobj).)+?\/(FT\s*\/(?!(Btn|Tx|Ch|Sig))((?!endobj).)+?\/Subtype\s*?\/Widget|Subtype\s*?\/Widget((?!endobj).)+?\/FT\s*\/(?!(Btn|Tx|Ch|Sig)))|Subtype\s*?\/Widget((?!endobj).)+?\/(FT\s*\/(?!(Btn|Tx|Ch|Sig))((?!endobj).)+?\/Type\s*?\/Annot|Type\s*?\/Annot((?!endobj).)+?\/FT\s*\/(?!(Btn|Tx|Ch|Sig)))|FT\s*\/(?!(Btn|Tx|Ch|Sig))((?!endobj).)+?\/(Subtype\s*?\/Widget((?!endobj).)+?\/Type\s*?\/Anno|Type\s*?\/Annot((?!endobj).)+?\/Subtype\s*?\/Widge)t)((?!endobj).)*?endobj/Rsi"; reference:cve,2012-4148; classtype:attempted-admin; sid:2805322; rev:5;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Visio Viewer DFW Buffer Overflow Attempt"; flow:established,from_server; content:"9|0d 0a|$ACADVER|0d 0a|"; fast_pattern:only; content:"ENDSEC|0d 0a|"; content:"0|0d 0a|SECTION|0d 0a|"; distance:0; content:"|0d 0a|ENTITIES|0d 0a|"; distance:0; content:"|0d 0a|MTEXT|0d 0a|"; distance:0; content:"1|0d 0a 5c|L"; distance:0; pcre:"/^[^\x3b\x00\\]{250}/Rs"; reference:cve,2012-1888; classtype:attempted-user; sid:2805324; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file with an overly long Well-Known Text string in a coordinate system dictionary download"; flow:established,from_server; content:"|0d 0a 0d 0a|%PDF-"; content:"|2f|GCS"; distance:0; content:"|2f|GEOGCS"; content:"|2f|EPSG"; distance:0; content:"|2f|WKT"; distance:0; pcre:"/<<[\r\n\s]*(?!\x3e\x3e)\x2fType[\r\n\s]*\x2fGEOGCS[\r\n\s]*\x2fEPSG[\r\n\s]*\d+[\r\n\s]*\x2fWKT[\r\n\s]*\x28[^\x00]{1024}/s"; reference:cve,2012-2050; classtype:attempted-user; sid:2805390; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file with Inline Image corrupted download"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; content:"stream|0a|q"; pcre:"/[\r\n\s]BI[\r\n\s]((?![\r\n\s]ID).)*?/C(S|olorSpace)[\r\n\s]+\d+[\r\n\s]((?![\r\n\s]ID).)*?[\r\n\s]ID/Rs"; reference:cve,2012-4151; classtype:attempted-user; sid:2805393; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Free Text Annotation With Invalid Intent 1"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; content:"<<"; content:"/Type"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/Annot"; within:6; content:"/Subtype"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/FreeText"; fast_pattern; within:9; content:"/IT"; distance:0; pcre:"/^[\r\n\s]*/R"; content:!"/FreeText"; within:9; pcre:"/\/Type[\r\n\s]*\/Annot((?!endobj).)*?\/Subtype[\r\n\s]*\/FreeText((?!endobj).)*?\/IT[\s\r\n]*?\/((?!FreeText(Typewriter|Callout)?).)+?[\r\n\s\>]/"; reference:cve,CVE-2012-4149; classtype:attempted-user; sid:2805425; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Free Text Annotation With Invalid Intent 2"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; content:"<<"; content:"/Type"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/Annot"; within:6; content:"/IT"; distance:0; pcre:"/^[\r\n\s]*/R"; content:!"/FreeText"; within:9; content:"/Subtype"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/FreeText"; fast_pattern; within:9; pcre:"/\/Type[\r\n\s]*\/Annot((?!endobj).)*?\/IT[\s\r\n]*?\/((?!FreeText(Typewriter|Callout)?).)+?[\r\n\s\>]((?!endobj).)*?\/Subtype[\r\n\s]*\/FreeText/"; reference:cve,CVE-2012-4149; classtype:attempted-user; sid:2805426; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Free Text Annotation With Invalid Intent 3"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; file_data; content:"<<"; content:"/Subtype"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/FreeText"; fast_pattern; within:9; content:"/Type"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/Annot"; within:6; content:"/IT"; distance:0; pcre:"/^[\r\n\s]*/R"; content:!"/FreeText"; within:9; pcre:"/\/Subtype[\r\n\s]*\/FreeText((?!endobj).)*?\/Type[\r\n\s]*\/Annot((?!endobj).)*?\/IT[\s\r\n]*?\/((?!FreeText(Typewriter|Callout)?).)+?[\r\n\s\>]/"; reference:cve,CVE-2012-4149; classtype:attempted-user; sid:2805427; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Free Text Annotation With Invalid Intent 4"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; file_data; content:"<<"; content:"/Subtype"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/FreeText"; fast_pattern; within:9; content:"/IT"; distance:0; pcre:"/^[\r\n\s]*/R"; content:!"/FreeText"; within:9; content:"/Type"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/Annot"; within:6; pcre:"/\/Subtype[\r\n\s]*\/FreeText((?!endobj).)*?\/IT[\s\r\n]*?\/((?!FreeText(Typewriter|Callout)?).)+?[\r\n\s\>]((?!endobj).)*?\/Type[\r\n\s]*\/Annot/"; reference:cve,CVE-2012-4149; classtype:attempted-user; sid:2805428; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Free Text Annotation With Invalid Intent 5"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; file_data; content:"<<"; content:"/IT"; distance:0; pcre:"/^[\r\n\s]*/R"; content:!"/FreeText"; within:9; content:"/Type"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/Annot"; within:6; content:"/Subtype"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/FreeText"; fast_pattern; within:9; pcre:"/\/IT[\s\r\n]*?\/((?!FreeText(Typewriter|Callout)?).)+?[\r\n\s\>]((?!endobj).)*?\/Type[\r\n\s]*\/Annot((?!endobj).)*?\/Subtype[\r\n\s]*\/FreeText/"; reference:cve,CVE-2012-4149; classtype:attempted-user; sid:2805429; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Free Text Annotation With Invalid Intent 6"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; file_data; content:"<<"; content:"/IT"; distance:0; pcre:"/^[\r\n\s]*/R"; content:!"/FreeText"; within:9; content:"/Subtype"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/FreeText"; fast_pattern; within:9; content:"/Type"; distance:0; pcre:"/^[\r\n\s]*/R"; content:"/Annot"; within:6; pcre:"/\/IT[\s\r\n]*?\/((?!FreeText(Typewriter|Callout)?).)+?[\r\n\s\>]((?!endobj).)*?\/Subtype[\r\n\s]*\/FreeText((?!endobj).)*?\/Type[\r\n\s]*\/Annot/"; reference:cve,CVE-2012-4149; classtype:attempted-user; sid:2805430; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer execCommand function Use after free Vulnerability 0day"; flow:established,to_client; file_data; content:".execCommand|28|"; nocase; fast_pattern; pcre:"/^[\r\n\s]*[\x22\x27](s|\\(x|u00)[57]3)(e|\\(x|u00)[46]5)(l|\\(x|u00)[46]c)(e|\\(x|u00)[46]5)(c|\\(x|u00)[46]3)(t|\\(x|u00)[57]4)(A|\\(x|u00)[46]1)(l|\\(x|u00)[46]c){2}/Ri"; content:".write("; nocase; content:"parent|2e|"; nocase; distance:0; pcre:"/^\w+?\[[^\]]+?\]\.src[\r\n\s]*=/Ri"; content:"onselect"; nocase; reference:url,eromang.zataz.com/2012/09/16/zero-day-season-is-really-not-over-yet/; reference:cve,CVE-2012-4969; classtype:attempted-user; sid:2015711; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer execCommand function Use after free Vulnerability 0day Metasploit"; flow:established,to_client; file_data; content:".execCommand|28|"; nocase; pcre:"/^[\r\n\s]*[\x22\x27]selectAll/Ri"; content:"YMjf\\u0c08\\u0c0cKDog"; fast_pattern:only; reference:url,eromang.zataz.com/2012/09/16/zero-day-season-is-really-not-over-yet/; reference:cve,CVE-2012-4969; classtype:attempted-user; sid:2015712; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-after-free attempt"; flow:established,to_client; file_data; content:"<meta"; nocase; content:".addEventListener("; nocase; fast_pattern:only; content:".createRange("; nocase; content:".deleteRange("; nocase; distance:0; content:".createRange("; nocase; distance:0; content:"deleteRange("; nocase; distance:0; content:"onload"; reference:cve,2012-2546; classtype:attempted-user; sid:2805478; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-after-free attempt"; flow:established,to_client; file_data; content:".write("; distance:0; content:"onmove"; distance:0; pcre:"/function[\r\n\s]+?(?P<functionA>[^\x20]+).+?\x2ewrite\x28[\r\n\s]*[\x22\x27]{2}[\r\n\s]*\x29.+?<DIV((?!>).)+?onmove[\r\n\s]*\x3d[\r\n\s]*[\x27\x22](?P=functionA)/si"; reference:cve,2012-1529; classtype:attempted-user; sid:2805479; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer 9 memory corruption"; flow:established,to_client; file_data; content:"meter"; distance:0; content:".cloneNode"; content:".appendChild"; distance:0; content:"offsetHeight"; fast_pattern:only; pcre:"/var[\r\n\s]+(?P<metervar>[^\x20]+)[\r\n\s]*\x3d[\r\n\s]*document\.createElement\x28[\r\n\s]*[\x22\x27]meter[\x22\x27][\r\n\s]*\x29.+?(?P=metervar)\.cloneNode\x28[\r\n\s]*true[\r\n\s]*\x29.+?(?P=metervar)\.appendChild\x28.+?offsetHeight/si"; reference:cve,2012-2548; classtype:attempted-user; sid:2805480; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Rich Text File download - SET"; flow:from_server,established; file_data; content:"|7B 5C 72 74 66 31|"; within:6; flowbits:set,ET.http.rtf.download; flowbits:noalert; reference:cve,2012-0183; classtype:attempted-user; sid:2015790; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File Invalid List ID"; flow:from_server,established; flowbits:isset,ET.http.rtf.download; file_data; content:"|5c|listid2147483647"; reference:cve,2012-2528; classtype:attempted-user; sid:2805540; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT HP Application Lifecycle Management ActiveX Access to Vulnerable Function"; flow:from_server,established; file_data; content:"C3B92104-B5A7-11D0-A37F-00A0248F0AF1"; distance:0; content:"SetShapeNodeType("; distance:0; reference:bugtraq,55272; reference:url,zerodayinitiative.com/advisories/ZDI-12-170/; classtype:attempted-user; sid:2805549; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Vuln (CVE-2012-1535 Uncompressed) Exploit Specific"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"FWS"; content:"kern"; distance:0; flowbits:set,Ole.Flash.kernpresent; flowbits:noalert; classtype:trojan-activity; sid:2015809; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Vuln (CVE-2012-1535 Uncompressed) Exploit Specific"; flow:from_server,established; flowbits:isset,Ole.Flash.kernpresent; file_data; content:"heapSpray"; classtype:trojan-activity; sid:2015810; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CTreePos Use After Free"; flow:established,to_client; file_data; content:"javascript|3a|window.location.reload("; distance:0; content:"<style"; nocase; distance:0; content:"first-line"; distance:0; content:"-ms-block-progression"; distance:0; pcre:"/<body[\r\s\n]+?on(mouse[a-z]|key[a-z]|load|unload|dragdrop|blur|focus|click|dblclick|submit|reset|select|change)[\r\s\n]*?\x3d[\r\s\n]*?[\x27\x22]javascript\x3awindow\.location\.reload\x28\x29.+?<(?P<styledef>[a-z0-9]+?)>.+?<(map|applet|cite|label|pre|keygen)>[\r\n\s]*?<\/(map|applet|cite|label|pre|keygen)>.+?<div[\r\s\n]+?style[\r\s\n]*?=[\r\s\n]*?[\x22\x27]-ms-filter\x3a.+?<(?P=styledef)>.+?<style.+?(?P=styledef)(\x3a\x3afirst-line{-ms-background-|{-ms-block-progression\x3a).+?<\/style.+?<\/(?P=styledef).+?<\/(?P=styledef)/si"; reference:cve,CVE-2012-1539; classtype:attempted-user; sid:2805680; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,to_client; file_data; content:"<fieldset"; nocase; distance:0; content:"<button"; nocase; distance:0; content:".innerHTML"; distance:0; content:"CollectGarbage("; fast_pattern:only; pcre:"/<fieldset[\r\s\n]+?([^>]+[\r\n\s]+?)*id[\r\s\n]*?\x3d[\r\s\n]*?[\x27\x22](?P<fieldsetid>[^\x22\x27]+)[\x27\x22]((?!<\/fieldset).+?<button[\r\s\n]+?([^>]+[\r\n\s]+?)*id[\r\s\n]*?\x3d[\r\s\n]*?[\x27\x22](?P<buttonid>[^\x22\x27]+)[\x27\x22]).+?<script.+?document\.getElementById\x28\s*[\x27\x22](?P=buttonid)[\x27\x22]\s*\x29\.((?!<\/script).+?(?P=fieldsetid)\.innerHTML[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27].+?CollectGarbage\x28)((?!<\/fieldset).+?)<button[\r\s\n]+?([^>]+[\r\n\s]+?)*id[\r\s\n]*?\x3d[\r\s\n]*?[\x27\x22].+?<\/fieldset>/si"; reference:cve,CVE-2012-1538; classtype:attempted-user; sid:2805679; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Explorer Briefcase Database File Integer Underflow"; flow:established,to_client; file_data; content:"|44 44 53 48 02 05 01 14|"; within:8; content:"|01 00 00 00|"; distance:12; within:4; byte_test:4,<,4,8,relative,little; reference:cve,CVE-2012-1527; classtype:attempted-user; sid:2805681; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Windows Explorer Briefcase Integer Overflow"; flow:established,to_client; file_data; content:"|44 44 53 48 02 05 01 14|"; within:8; content:"|01 00 00 00|"; distance:12; within:4; byte_test:4,>,4,8,relative,little; byte_jump:4,8,relative,little,post_offset -4; byte_test:4,<,536870911,4,relative,little; reference:cve,CVE-2012-1528; classtype:attempted-user; sid:2805683; rev:3;)

#
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ETPRO WEB_CLIENT Microsoft .NET Framework Insecure Library Loading"; flow:to_server; content:"|2f|System.Data.dll, System.Data,"; http_uri; nocase; content:"Version="; http_uri; content:"PublicKeyToken="; http_uri; content:"GET"; nocase; http_method; reference:cve,2012-2519; classtype:attempted-user; sid:2805685; rev:1;)

#
#alert http $HOME_NET any -> any any (msg:"ETPRO WEB_CLIENT Microsoft .NET Proxy.pac file request"; flow:established,to_server; content:".pac"; http_uri; fast_pattern:only; pcre:"/\.pac$/U"; content:"System.Net.NetWebProxyFinder"; http_user_agent; flowbits:set,ETPRO.DotNet.PAC; flowbits:noalert; reference:cve,2012-4776; classtype:attempted-user; sid:2805690; rev:3;)

#
#alert http any any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft .NET framework sandboxes bypass via proxy auto configuration javascript file"; flow:established,from_server; flowbits:isset,ETPRO.DotNet.PAC; file_data; content:"function FindProxyForURL("; fast_pattern:only; pcre:"/(\/\/.+?\r\n|\/\*.+?\*\/)*?[\r\n\s]*?import\s+?[A-Z][.a-z]+?\s*?\x3b.+?[\r\n]+?function FindProxyForURL\x28url,\s*?host\s*?\x29/si"; reference:cve,2012-4776; classtype:attempted-user; sid:2805691; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Win32k TrueType Counter Overflow"; flow:from_server,established; file_data; content:"|00 01 00 00|"; depth:4; content:"cmap"; distance:8; byte_jump:4,4,relative,from_beginning; content:"|00 01|"; distance:2; within:2; content:"|00 04|"; distance:8; within:2; content:"|00 02|"; distance:4; within:2; content:"|FF FF|"; distance:6; within:2; content:"|00 00|"; distance:2; within:2; classtype:bad-unknown; sid:2805692; rev:7;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Win32k TrueType Counter Overflow"; flow:from_server,established; file_data; content:"OTTO"; depth:4; content:"cmap"; distance:8; byte_jump:4,4,relative,from_beginning; content:"|00 01|"; distance:2; within:2; content:"|00 04|"; distance:8; within:2; content:"|00 02|"; distance:4; within:2; content:"|FF FF|"; distance:6; within:2; content:"|00 00|"; distance:2; within:2; classtype:bad-unknown; sid:2805693; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible exploitation of CVE-2012-5076 by an exploit kit Nov 13 2012"; flow:from_server,established; file_data; content:"<object"; content:"0b0909041f"; distance:0; fast_pattern; content:"3131"; distance:0; classtype:trojan-activity; sid:2015887; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted file download invalid SerAuxErrBar BIFF record"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; content:"|5b 10|"; byte_test:1,<,0x05,2,relative,little; byte_test:1,<,0x06,3,relative,little; content:"|04|"; distance:3; within:1; content:"|01|"; distance:1; within:1; byte_test:1,&,0x80,9,relative,little; reference:cve,2012-1885; classtype:attempted-user; sid:2805703; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CTreeNode Use After Free"; flow:established,to_client; file_data; content:".innerHTML"; content:"<table"; content:"<th"; pcre:"/var[\r\n\s]+(?P<var1>[^\r\n\s\x3d]+)[\r\n\s]*\x3d\s*?document\.getElementById\x28\s*?[\x22\x27](?P<tableid>[^\x22\x27]+)[\x27\x22]\s*?\x29.+?(?P=var1)\.(?:b(?:(?:gcolo|orde)r|ackground)|cell(?:padd|spac)ing|summary|height|align|frame|rules|width)[\r\n\s]*=.+?(?P=var1)\s*?\x3d\s*?null\s*?\x3b/si"; pcre:"/(?P<thid>[^\x2e]+)\.innerHTML[\r\s\n]*?\x3d[\r\s\n]*?[\x27\x22][\x27\x22].+?<table[\r\s\n]+?([^>]+[\r\n\s]+?)*id[\r\s\n]*?\x3d[\r\s\n]*?[\x27\x22](?P<tableid>[^\x22\x27]+)[\x27\x22]((?!<\/table).+?<th[\r\s\n]+?([^>]+[\r\n\s]+?)*id[\r\s\n]*?\x3d[\r\s\n]*?[\x27\x22](?P=thid)[\x27\x22])((?!<\/th).+?)<(?:s(?:trong>.*?<\/strong|amp>.*?<\/samp)|code>.*?<\/code|dfn>.*?<\/dfn|kbd>.*?<\/kbd|var>.*?<\/var|em>.*?<\/em)>.+?<\/th>.+?<\/table>/si"; reference:cve,CVE-2012-4775; classtype:attempted-user; sid:2805717; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Apple QuickTime 7.7.2 TeXML Style Element font-table Field Stack Buffer Overflow"; flow:from_server,established; content:"application/x-quicktime-texml"; http_header; file_data; content:"<?quicktime type=|22|application/x-quicktime-texml|22|?>"; distance:0; pcre:"/\x7bfont\x2d[^\x3a]+?\x3a\x20(.)\1{300}/"; reference:cve,2012-3752; reference:bugtraq,56557; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:2805835; rev:2;)

#
#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Win32k TrueType Font Parsing Vulnerability SearchRange"; flow:from_server,established; file_data; content:"|00 01 00 00|"; depth:4; content:"cmap"; distance:8; byte_jump:4,4,relative,from_beginning; byte_test:2,>,1,2,relative; byte_extract:2,4,platformID1,relative; byte_extract:2,6,encodingID1,relative; byte_test:2,=,platformID1,10,relative; byte_test:2,=,platformID1,10,relative; byte_jump:4,4,relative; content:"|00 04|"; within:2; content:"|00 00|"; distance:6; within:2; classtype:bad-unknown; sid:2805783; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Win32k TrueType Font Parsing Vulnerability EntrySelector"; flow:from_server,established; file_data; content:"|00 01 00 00|"; depth:4; content:"cmap"; fast_pattern; distance:8; byte_jump:4,4,relative,from_beginning; byte_test:2,>,1,2,relative; byte_extract:2,4,platformID1,relative; byte_extract:2,6,encodingID1,relative; byte_test:2,=,platformID1,10,relative; byte_test:2,=,platformID1,10,relative; byte_jump:4,4,relative; content:"|00 04|"; within:2; content:"|00 00|"; distance:8; within:2; classtype:bad-unknown; sid:2805784; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Win32k TrueType Font Parsing Vulnerability RangeShift"; flow:from_server,established; file_data; content:"|00 01 00 00|"; depth:4; content:"cmap"; fast_pattern; distance:8; byte_jump:4,4,relative,from_beginning; byte_test:2,>,1,2,relative; byte_extract:2,4,platformID1,relative; byte_extract:2,6,encodingID1,relative; byte_test:2,=,platformID1,10,relative; byte_test:2,=,platformID1,10,relative; byte_jump:4,4,relative; content:"|00 04|"; within:2; content:"|00 00|"; distance:10; within:2; classtype:bad-unknown; sid:2805785; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer style object Use After Free"; flow:established,to_client; file_data; content:".lastChild.style."; distance:0; content:"CollectGarbage("; nocase; distance:0; pcre:"/id\s*\x3d\s*[\x27\x22](?P<var>[^\x27\x22]+?)[\x27\x22].+?[\r\n\s]+<script.+?[\r\n\s]+var\s*(?P<var1>[a-z0-9]+?)\s*\x3d\s*document\.getElementById\x28\s*[\x27\x22](?P=var)[\x27\x22]\s*\).+?(?P=var1)\.lastChild\.style\.((?!((?:b(?:o(?:rder(?:Bottom(?:(?:Righ|Lef)tRadius|Color|Style|Width)?|Top(?:(?:Righ|Lef)tRadius|Color|Style|Width)?|R(?:ight(?:Color|Style|Width)?|adius)|Left(?:Color|Style|Width)?|S(?:pacing|tyle)|Col(?:lapse|or)|Width)?|xS(?:hadow|izing)|ttom)|a(?:ck(?:ground(?:(?:Attachmen|Repea)t|(?:Imag|Siz)e|C(?:olor|lip)|Position[XY]?|Origin)?|faceVisibility)|selineShift)|reak(?:(?:Befor|Insid)e|After)|ehavior)|t(?:ext(?:Decoration(?:(?:(?:Und|Ov)erli|No)ne|LineThrough|Blink)?|A(?:lign(?:Last)?|utospace)|UnderlinePosition|KashidaSpace|Transform|Overflow|Justify|Indent)|rans(?:ition(?:D(?:uration|elay)|TimingFunction|Property)?|form(?:Origin|Style)?)|ableLayout|op)|m(?:s(?:Grid(?:Column(?:(?:Alig|Spa)n|s)?|Row(?:(?:Alig|Spa)n|s)?)|(?:ProgressAppearanc|InterpolationMod)e|BlockProgression)|a(?:r(?:gin(?:(?:Righ|Lef)t|Bottom|Top)?|ker(?:(?:En|Mi)d|Start)?)|x(?:Height|Width)|sk)|in(?:Height|Width))|p(?:a(?:dding(?:(?:Righ|Lef)t|Bottom|Top)?|geBreak(?:(?:Befor|Insid)e|After)|rentRule)|o(?:s(?:(?:(?:He|R)igh|Lef)t|Bottom|Width|ition|Top)|interEvents)|ixel(?:(?:(?:He|R)igh|Lef)t|Bottom|Width|Top)|erspective(?:Origin)?)|c(?:o(?:l(?:umn(?:Rule(?:Color|Style|Width)?|Count|Width|Fill|Span|Gap)|or)|unter(?:Incremen|Rese)t|n(?:structor|tent))|l(?:ip(?:(?:Righ|Lef)t|Bottom|Path|Top)?|ear)|ss(?:Floa|Tex)t|aptionSide|ursor)|s(?:t(?:roke(?:Dash(?:offset|array)|Line(?:join|cap)|Miterlimit|Opacity|Width)?|op(?:Opacity|Color)|yleFloat)|crollbar(?:(?:(?:Dark)?Shad|Arr)ow|(?:Highl|3dL)ight|(?:Bas|Fac)e|Track)Color)|l(?:i(?:stStyle(?:(?:Imag|Typ)e|Position)?|ne(?:Height|Break))|ayout(?:Grid(?:(?:Lin|Mod|Typ)e|Char)?|Flow)|e(?:tterSpacing|ngth|ft))|a(?:nimation(?:D(?:(?:irec|ura)tion|elay)|(?:PlayStat|FillMod|Nam)e|IterationCount|TimingFunction)?|ccelerator|ttributes)|f(?:ont(?:S(?:ize(?:Adjust)?|t(?:retch|yle))|(?:Varian|Weigh)t|Family)?|il(?:l(?:Opacity|Rule)?|ter))|w(?:ord(?:Spacing|Break|Wrap)|(?:ritingMod|hiteSpac)e|id(?:ows|th))|o(?:utline(?:Color|Style|Width)?|verflow[XY]?|pacity|rphans)|r(?:uby(?:(?:Positio|Alig)n|Overhang)|ight|ole)|d(?:i(?:rection|splay)|ominantBaseline)|glyphOrientation(?:Horizont|Vertic)al|v(?:erticalAlign|isibility)|(?:emptyCell|quote)s|z(?:Index|oom)|unicodeBidi|imeMode|kerning|height))).)+?\s*\x3d\s*document\.createElement\x28[\x27\x22].+?[\x27\x22]\x29\s*?\x3b[\r\n\s]+?CollectGarbage\(\)\s*\x3b/si"; reference:cve,2012-4787; classtype:attempted-user; sid:2805782; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft WORD .DOC File download CLSID_DirectPlay8Peer"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|00|W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; distance:0; content:"|00 03 00|O|00|b|00|j|00|I|00|n|00|f|00|o|00|"; distance:0; content:"|4D 48 6F 28 5E 37 58 44 72 A2 B1 38 E2 F8 0A 6A|"; fast_pattern:only; reference:cve,2012-1537; classtype:attempted-user; sid:2805787; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft WORD .DOC File download CLSID_DirectPlay8LobbyClient"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|00|W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; distance:0; content:"|00 03 00|O|00|b|00|j|00|I|00|n|00|f|00|o|00|"; distance:0; content:"|75 67 2B 3B B6 70 45 AF EA 8D A2 09 C6 95 59 F3|"; fast_pattern:only; reference:cve,2012-1537; classtype:attempted-user; sid:2805788; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft WORD .DOC File download CLSID_DirectPlay8LobbiedApplication"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|00|W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; distance:0; content:"|00 03 00|O|00|b|00|j|00|I|00|n|00|f|00|o|00|"; distance:0; content:"|AD 55 79 66 3B 6B CA 43 49 B9 BC 69 B5 BA FF 7F|"; fast_pattern:only; reference:cve,2012-1537; classtype:attempted-user; sid:2805789; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft WORD .DOC File download CLSID_DP8SP_MODEM"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|00|W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; distance:0; content:"|00 03 00|O|00|b|00|j|00|I|00|n|00|f|00|o|00|"; distance:0; content:"|50 36 4A 6D 8D 62 D2 11 0F AE 00 60 97 B0 14 11|"; fast_pattern:only; reference:cve,2012-1537; classtype:attempted-user; sid:2805790; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft WORD .DOC File download CLSID_DP8SP_SERIAL"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|00|W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; distance:0; content:"|00 03 00|O|00|b|00|j|00|I|00|n|00|f|00|o|00|"; distance:0; content:"|60 5D 3B 74 8D 62 D2 11 0F AE 00 60 97 B0 14 11|"; fast_pattern:only; reference:cve,2012-1537; classtype:attempted-user; sid:2805791; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft WORD .DOC File download CLSID_DirectPlay8Client"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|00|W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; distance:0; content:"|00 03 00|O|00|b|00|j|00|I|00|n|00|f|00|o|00|"; distance:0; content:"|C6 1D 3F 74 BA 5A 9F 42 DF 8B C5 4D 03 25 3D C2|"; fast_pattern:only; reference:cve,2012-1537; classtype:attempted-user; sid:2805792; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft WORD .DOC File download CLSID_DirectPlay8Address"; flow:from_server,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|00|W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; distance:0; content:"|00 03 00|O|00|b|00|j|00|I|00|n|00|f|00|o|00|"; distance:0; content:"|23 95 4A 93 CA A3 C5 4B A0 AD D6 D9 5D 97 94 21|"; fast_pattern:only; reference:cve,2012-1537; classtype:attempted-user; sid:2805793; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File .RTF File download CLSID_DirectPlay8Peer"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"4D486F285E37584472A2B138E2F80A6A"; distance:0; reference:cve,2012-1537; classtype:attempted-user; sid:2805794; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File .RTF File download CLSID_DirectPlay8LobbyClient"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"75672B3BB67045AFEA8DA209C69559F3"; distance:0; reference:cve,2012-1537; classtype:attempted-user; sid:2805795; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File .RTF File download CLSID_DirectPlay8LobbiedApplication"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"AD5579663B6BCA4349B9BC69B5BAFF7F"; distance:0; classtype:attempted-user; sid:2805796; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File .RTF File download CLSID_DP8SP_MODEM"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"50364A6D8D62D2110FAE006097B01411"; distance:0; reference:cve,2012-1537; classtype:attempted-user; sid:2805797; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File .RTF File download CLSID_DP8SP_SERIAL"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"605D3B748D62D2110FAE006097B01411"; distance:0; reference:cve,2012-1537; classtype:attempted-user; sid:2805798; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File .RTF File download CLSID_DirectPlay8Client"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"C61D3F74BA5A9F42DF8BC54D03253DC2"; distance:0; reference:cve,2012-1537; classtype:attempted-user; sid:2805799; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File .RTF File download CLSID_DirectPlay8Address"; flow:from_server,established; flowbits:isset,ETPRO.RTF; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"23954A93CAA3C54BA0ADD6D95D979421"; distance:0; reference:cve,2012-1537; classtype:attempted-user; sid:2805800; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Rich Text File .RTF File download with invalid listoverridecount"; flow:from_server,established; file_data; content:"|5c|listoverridetable"; distance:0; content:"|5c|listoverride|5c|"; fast_pattern:only; content:"|5c|listoverridecount"; isdataat:2,relative; pcre:"/^(?:0*?[19]\d|[^190])/R"; reference:cve,2012-2539; classtype:attempted-user; sid:2018315; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT RealPlayer RealMedia File Handling Buffer Overflow"; flow:established,to_client; content:"Content-Type|3a| audio/x-pn-realaudio"; http_header; file_data; content:"[InternetShortcut]|0a|URL="; pcre:"/^[^\x00\x0d\x0a]{2000}/R"; reference:cve,2012-5691; reference:url,service.real.com/realplayer/security/12142012_player/en/; reference:bugtraq,56956; classtype:attempted-user; sid:2805872; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file with openDoc() Information Leakage 1"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"try"; nocase; distance:0; content:".openDoc("; nocase; distance:0; content:"catch"; nocase; distance:0; pcre:"/try[\r\n\s]*?{((?!\}[\r\n\s]*?catch).)*?\.openDoc\([\r\n\s]*?(?P<q>[\x22\x27])\x5c{4}((?!(?P=q)).)+(?P=q)|{((?!\)[\r\n\s]*\x3b).)*?cPath[\r\n\s]*?\x3a[\r\n\s]*?[\x22\x27]\x5c{4}/si"; reference:cve,2013-0622; classtype:attempted-user; sid:2805888; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file with openDoc() Information Leakage 2"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"try"; nocase; content:".openDoc("; nocase; distance:0; content:"catch"; nocase; distance:0; pcre:"/var[\r\n\s]*(?P<var1>[^\r\n\s]*)[\r\n\s]*\x3d[\r\n\s]*(?P<qvar>[\x22\x27])\x5c{4}((?!(?P=qvar)).)+(?P=qvar).+?try[\r\n\s]*{((?!\}[\r\n\s]*?catch).)*?\.openDoc\(((?!}).)*?cPath[\r\n\s]*?\x3a[\r\n\s]*?(?P=var1)/si"; reference:cve,2013-0622; classtype:attempted-user; sid:2805889; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file with openDoc() Information Leakage 3"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"try"; nocase; content:".openDoc("; nocase; distance:0; content:"catch"; nocase; distance:0; pcre:"/var[\r\n\s]*(?P<var1>[^\r\n\s]*)[\r\n\s]*\x3d[\r\n\s]*(?P<qvar>[\x22\x27])\x5c{4}((?!(?P=qvar)).)+(?P=qvar).+?try[\r\n\s]*{((?!\}[\r\n\s]*?catch).)*?\.openDoc\(\s*(?P=var1)\s*\)/si"; reference:cve,2013-0622; classtype:attempted-user; sid:2805890; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file with openDoc() Information Leakage 4"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"try"; nocase; content:".openDoc("; nocase; distance:0; content:"catch"; nocase; distance:0; pcre:"/try[\r\n\s]*{((?!\}[\r\n\s]*?catch).)*?var[\r\n\s]*(?P<var1>[^\r\n\s]*)[\r\n\s]*\x3d[\r\n\s]*(?P<qvar>[\x22\x27])\x5c{4}((?!(?P=qvar)).)+(?P=qvar).+?\.openDoc\(((?!}).)*?cPath[\r\n\s]*?\x3a[\r\n\s]*?(?P=var1)/si"; reference:cve,2013-0622; classtype:attempted-user; sid:2805891; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file with Hybrid file at header"; flow:established,from_server; file_data; content:!"%PDF-"; within:5; pcre:"/^(PK\x03\x04|PK\x05\x06|!<arch>\n|.{257}ustar\x00|BZh|BZ0|\x1F\x8B|\x1F\x9D|RE\x7e\x5e|MSCF|7z\xBC\xAF\x27\x1C|LZIP|\x5d\x00\x00\x80|\xfd7zXZ\x00|.{2}-lh|.{2}-lz|LZX|\x89\x4c\x5a\x4f\x00\x0d\x0a\x1a\x0a|.{7}\*\*ACE\*\*|\x60\xEA|\x45\x52\x02\x00|2IMG|koly|SIT!|StuffIt|\(This file must be converted with BinHex|xar!|\xff\xd8\xff|\x00\x00\x00\x0C\x6A\x50\x20\x20\x0D\x0A\x87\x0A|\xFF\x4F\xFF\x51\x00|MM\x00\x2a|II\x2a\x00|BM|\x00\x00\x01\x00|\x00\x00\x02\x00|GIF8|\x89PNG\x0d\x0a\x1a\x0a|P1|P2|P3|P4|P5|P6|P7|RIFF|RIFX|\x97JB2\x0d\x0a\x1a\x0a|8BPS|Paint Shop Pro Image File|.{522}\x00\x11\x02\xff\x0c\x00|\x0a\x00\x00|\x0a\x02\x00|\x0a\x03\x00|\x0a\x04\x00|\x0a\x05\x00|\x0a\x00\x01|\x0a\x02\x01|\x0a\x03\x01|\x0a\x04\x01|\x0a\x05\x01|#\?RADIANCE|\x76\x2f\x31\x01|.{128}DICM|\x80\x2a\x5f\xd7|SDPX|XPDS|.{4}(\x11\xAF|\x12\xAF|\x30\xAF|\x31\xAF|\x44\xAF)|\x00MRM|FOVb|gimp xcf|\x49\x49\xBC|BegMF|BEGMF|\xD7\xCD\xC6\x9A|.{40}EMF|U3D\x00|PRC|AC10|\(DWF|XPR|DDS|\x4d\x4d|FWS|CWS|FLV|MThd|FORM|MROF|\xFF\xF0|\xFF\xF1|\xFF\xF2|\xFF\xF3|\xFF\xF4|\xFF\xF5|\xFF\xF6|\xFF\xF7|\xFF\xF8|\xFF\xF9|\xFF\xFA|\xFF\xFB|\xFF\xFC|\xFF\xFD|\xFF\xFE|ID3|\x30\x26\xb2\x75|ftypM4A|ftyp3g|ftypmmp|.{4}ftyp|ADIF|.{4}(moov|mdat|idsc|pckg)|\.ra\xFD|\.RMF|OggS|\x0B\x77|\x1a\x45\xdf\xa3|\x00\x00\x01\xBA|\x00\x00\x00\x01|\x00\x00\x01\xB0|\x00\x00\x01\xB1|\x00\x00\x01\xB2|\x00\x00\x01\xB3|\x00\x00\x01\xB4|\x00\x00\x01\xB5|\x00\x00\x01\xB6|\x00\x00\x01\xB7|\x00\x00\x01\xB8|\x00\x00\x01\xB9|\x00\x00\x01\xBA|\x00\x00\x01\xBB|\x00\x00\x01\xBC|\x00\x00\x01\xBD|\x00\x00\x01\xBE|\x00\x00\x01\xBF|fLaC|\.snd|dns\.|\x00ds\.|\.sd\x00|.{4}\x47\x40|\x47\x40|NSV|\x1F\x07\x00|\x1F\x17\x00|\x1F\x27\x00|\x1F\x37\x00|\x1F\x47\x00|\x1F\x57\x00|\x1F\x67\x00|\x1F\x77\x00|\x1F\x87\x00|\x1F\x97\x00|\x1F\xA7\x00|\x1F\xB7\x00|\x06\x06\xED\xF5|AT&TFORM|\xD0\xCF\x11\xE0\xA1\xB1\x1A\xE1|\x31\xBE\x00\x00|\xDB\xA5\x2D\x00|\xE4\x52\x5C\x7B|\xA1\x2F\xFF\x43|ITSF\003\000\000\000|ITOLITLS|\x3f\x5f\x03\x00|\xFFWPC|AGD|\x1C\x01\x00\x00|\xC5\xD0\xD3\xC6|.{60}(\.pdfADBE|TEXtREAd|PNRdPPrs|DataPPrs|ToGoToGo|SDocSilX|TEXtTlDc|BOOKMOBI)|\x4C\x00\x52\x00\x46\x00\x00\x00|.%-12345X@PJL|\x00\x01\x00\x00\x00|OTTO|ttcf|MZ|\x7FELF|\xCA\xFE\xBA\xBE|\xCE\xFA\xED\xFE|!BDN|SQLite format|\xED\xAB\xEE\xDB|\xa1\xb2\xc3\xd4|\xa1\xb2\xcd\x34|\xd4\xc3\xb2\xa1|\x34\xcd\xb2\xa1|.{36}acsp)/R"; content:"%PDF-"; distance:0; reference:cve,2013-0624; classtype:attempted-user; sid:2805892; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat Reader integer overflow at Open Type Font"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"/FontFile2"; nocase; content:"|74 74 63 66|"; distance:0; byte_test:4,>,1073741824,4,relative,big; reference:cve,2013-0604; classtype:attempted-user; sid:2805921; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Uncompressed"; flow:from_server,established; file_data; content:"FWS"; within:3; flowbits:set,HTTP.UncompressedFlash; flowbits:noalert; classtype:trojan-activity; sid:2016394; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft OLE Compound File With Flash"; flow:to_client,established; content:"CONTROL ShockwaveFlash.ShockwaveFlash"; flowbits:isset,OLE.CompoundFile; flowbits:set,OLE.WithFlash; classtype:protocol-command-decode; sid:2016395; rev:7;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer SetCapture Use After Free"; flow:established,from_server; file_data; content:".setCapture("; nocase; content:".setCapture("; nocase; distance:0; content:"<svg"; pcre:"/^((?!<\/svg).)+?id\s*=\s*[\x27\x22](?P<elem_id>[^\x22\x27]+?)[\x27\x22]((?!<\/svg).)+?id\s*=\s*[\x27\x22](?P<elem_id2>[^\x22\x27]+?)[\x27\x22].+?<\/svg.+?(?P<var1>[^\x20]+)[\r\n\s]*\x3d[\r\n\s]*document\.getElementById\x28\s*[\x27\x22](?P=elem_id)\s*[\x27\x22]\x29.+?(?P=var1)\.setCapture\x28.+?(?P<var2>[^\x20]+)[\r\n\s]*\x3d[\r\n\s]*document\.getElementById\x28\s*[\x27\x22](?P=elem_id2)\s*[\x27\x22]\x29.+?(?P=var2)\.setCapture\x28/Rsi"; reference:cve,2013-0018; classtype:attempted-user; sid:2806004; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:"window.open"; nocase; content:"window.open"; distance:0; nocase;  pcre:"/<(?P<html_tag>[^\x20]+?)\x20[\r\n\s]*(id|name)[\r\n\s]*\x3d[\r\n\s]*[\x22\x27](?P<iframe_name>[^\x22]+)[\x22\x27]>[\r\n\s]*<\/(?P=html_tag)>.+?window\.open\x28((?!\x29).)+?[\x27\x22](?P=iframe_name)[\x27\x22].+?\x29.+?window\.open\x28.+?\x2c((?!\x29).)+?[\x27\x22](?P=iframe_name)[\x27\x22]/si"; reference:cve,2013-0019; classtype:attempted-user; sid:2806005; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CMarkUP Use After Free CVE-2013-0020"; flow:established,to_client; file_data; content:" DomParser"; nocase; content:".parseFromString"; nocase; distance:0; content:"createCDATASection"; nocase; distance:0; content:".cloneNode"; nocase; content:".adoptNode"; nocase; distance:0; pcre:"/var[\r\n\s]+(?P<dparser>[^\r\n\s=]+)[\r\n\s]*=[\r\n\s]*new[\r\n\s]*DomParser.+?var[\r\n\s]+(?P<doc>[^\r\n\s=]+)[\r\n\s]*=[\r\n\s]*(?P=dparser)\.parseFromString\([\r\n\s]*(?P<q1>[\x22\x27])?.+(?P=q1)?\,[\r\n\s]*(?P<q2>[\x22\x27])(application|text)\/xml(?P=q2).+?var[\r\n\s]+(?P<cdata>[^\r\n\s=]+)[\r\n\s]*=[\r\n\s](?P=doc)\.createCDATASection.+?(?P=cdata)\.cloneNode.+?\.adoptNode\([\r\n\s]*(?P=cdata)/si"; reference:cve,2013-0020; classtype:attempted-user; sid:2806006; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:"onreadystatechange"; nocase; fast_pattern:only; pcre:"/\.attachEvent\x28[\x27\x22]onreadystatechange[\x27\x22]\x2c\s*(?P<function_name>[^\x20\x29]+)\s*\x29.+?function (?P=function_name).+?(?P<node1>[^\x20]+)[\r\n\s]*\x3d[\r\n\s]*document\.(createElement|getElementById)\x28[\x27\x22](?P<elem_name>[^\x27\x22]+)[\x27\x22]\x29.+?(?P=node1)\.innerHTML.+?appendChild\x28(?P=node1)\x29.+?\.removeChild\x28(?P=node1)\x29.+?(?P<node2>[^\x20]+)[\r\n\s]*\x3d[\r\n\s]*document\.(createElement|getElementById)\x28[\x27\x22](?P=elem_name)[\x27\x22].+?appendChild\x28(?P=node2)\x29/si"; reference:cve,2013-0021; classtype:attempted-user; sid:2806007; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".createRange("; nocase; fast_pattern:only; content:".pasteHTML"; nocase; content:"var "; pcre:"/^\s*(?P<range>[^\x20\x3d]+)[\r\n\s]*\x3d[\r\n\s]*document\.selection\.createRange\x28.+?(?P=range)\.moveToElementText.+?(?P=range)\.collapse\x28\s*true\s*\x29.+?(?P=range)\.select\x28.+?(?P=range)\.pasteHTML\x28[\x22\x27]/Rsi"; reference:cve,2013-0024; classtype:attempted-user; sid:2806008; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer SLayoutRun Use After Free"; flow:established,from_server; file_data; content:".style.whiteSpace"; nocase; fast_pattern:only; pcre:"/function (?P<function_name>[^\x28]+).+(?P<elem>[^\x20\x2e]+)\.style\.whitespace[\r\n\s]*\x3d[\r\n\s]*[\x27\x22]pre-(line|wrap)[\x27\x22].+?load[\r\n\s]*\x3d[\r\n\s]*[\x27\x22](?P=function_name)\x28.+?\s+id\x3d[\x27\x22](?P=elem)[\x27\x22]/si"; reference:cve,2013-0025; classtype:attempted-user; sid:2806009; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CPasteCommand Use After Free 1"; flow:established,from_server; file_data; content:".execCommand"; nocase; fast_pattern:only; content:"SelectAll"; content:"Justify"; content:"Justify"; distance:0; pcre:"/execCommand\x28\s*[\x22\x27]SelectAll[\x22\x27]\s*\x29.+?execCommand\x28\s*[\x22\x27]Justify(Center|Full|Left|None|Right)[\x22\x27]\s*\x29.+?execCommand\x28\s*[\x22\x27]Justify(Center|Full|Left|None|Right)[\x22\x27]\s*\x29.+?execCommand\x28\s*[\x22\x27]SelectAll[\x22\x27]\s*\x29/si"; reference:cve,2013-0026; classtype:attempted-user; sid:2806010; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CPasteCommand Use After Free 2"; flow:established,from_server; file_data; content:".execCommand"; nocase; fast_pattern:only; content:"SelectAll"; content:"Justify"; content:"Justify"; distance:0; pcre:"/execCommand\x28\s*[\x22\x27]Justify(Center|Full|Left|None|Right)[\x22\x27]\s*\x29.+?execCommand\x28\s*[\x22\x27]SelectAll[\x22\x27]\s*\x29.+?execCommand\x28\s*[\x22\x27]SelectAll[\x22\x27]\s*\x29.+?execCommand\x28\s*[\x22\x27]Justify(Center|Full|Left|None|Right)[\x22\x27]\s*\x29/si"; reference:cve,2013-0026; classtype:attempted-user; sid:2806011; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CPasteCommand Use After Free 1"; flow:established,from_server; file_data; content:"createTextRange("; nocase; fast_pattern:only; content:"queryCommandState("; content:"onbeforepaste"; content:"function "; pcre:"/^\s*(?P<function1>[^\x20\x28]+).+?document\.body\.createTextRange\x28\x29\.queryCommandState\x28\s*[\x22\x27]Paste[\x22\x27]\s*\x29.+?function (?P<function2>[^\x20\x28]+).+?document\.write\x28\s*([\x22\x27][\x22\x27])?\s*\x29.+?load\x3d[\x27\x22](?P=function1).+?onbeforepaste\x3d[\x27\x22](?P=function2)/Rsi"; reference:cve,2013-0027; classtype:attempted-user; sid:2806012; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CPasteCommand Use After Free 2"; flow:established,from_server; file_data; content:"createTextRange("; nocase; fast_pattern:only; content:"queryCommandState("; content:"onbeforepaste"; content:"function "; pcre:"/^\s*(?P<function2>[^\x20\x28]+).+?document\.write\x28\s*([\x22\x27][\x22\x27])?\s*\x29.+?function (?P<function1>[^\x20\x28]+).+?document\.body\.createTextRange\x28\x29\.queryCommandState\x28\s*[\x22\x27]Paste[\x22\x27]\s*\x29.+?load\x3d[\x27\x22](?P=function1).+?onbeforepaste\x3d[\x27\x22](?P=function2)/Rsi"; reference:cve,2013-0027; classtype:attempted-user; sid:2806013; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CObjectElement Use After Free"; flow:established,from_server; file_data; content:"location.reload("; nocase; content:"cursor|3a|URL("; fast_pattern:only; content:"function "; pcre:"/\s*(?P<function>[^\x20\x28]+).+?location\.reload\x28.+?<[^\x2f](?P<html_tag>[^\x20]+?)\x20[\r\n\s]*.+?((?!<\/(?P=html_tag)).)+?load[\r\n\s]*\x3d[\r\n\s]*[\x27\x22](?P=function)\x28((?!<\/(?P=html_tag)).)+?<object style\s*\x3d\s*[\x27\x22]cursor\x3aURL\x28.+?\x29[\x27\x22][\r\n\s]*>/Rsi"; reference:cve,2013-0028; classtype:attempted-user; sid:2806014; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CHTML Use After Free"; flow:established,from_server; file_data; content:"onbeforeeditfocus"; nocase; fast_pattern:only; content:".focus("; pcre:"/load[\r\n\s]*\x3d[\r\n\s]*[\x27\x22](?P<tArea>[^\x2e]+)\x2efocus\x28.+?<[^\x2f\x20]+?\x20id\s*\x3d\s*[\x27\x22](?P=tArea)[\x27\x22].+?onbeforeeditfocus\s*=\s*[\x27\x22]document\.write\x28\s*([\x22\x27][\x22\x27])?\s*\x29/si"; reference:cve,2013-0029; classtype:attempted-user; sid:2806015; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT DirectShow MPEG Buffer Overlflow CVE-2013-0077"; flow:established,to_client; flowbits:isset,ET.mpeg.HTTP; file_data; content:"|00 00 01 B3|"; isdataat:143,relative; content:!"|00 00 01|"; within:143; content:"|00 00 01|"; distance:140; reference:cve,2013-0077; classtype:attempted-user; sid:2806016; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File download with vulnerable ActiveX control TabStrip"; flow:from_server,established; flowbits:isset,ET.http.rtf.download; file_data; content:"|5c|object"; distance:0; content:"|5c|objocx"; distance:0; content:"|5c|objdata"; distance:0; content:"D0CF11E0A1B11AE1"; nocase; distance:0; content:"9665fb1e7c85d111b16a00c0f0283628"; nocase; distance:0; content:"21433412"; distance:0; pcre:"/^.{24}(c17a2ad1|8a7ee1e6|4144d99e)/R"; reference:cve,2013-1313; classtype:attempted-user; sid:2806017; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CMarkUP Use After Free CVE-2013-0030"; flow:established,to_client; file_data; content:"urn|3a|schemas-microsoft-com|3a|vml"; nocase; content:"#default#VML"; distance:0; nocase; content:"var"; nocase; pcre:"/^[\r\n\s]+(?P<shape>[^\r\n\s=]+)[\r\n\s]*=[\r\n\s]*[^\;]+\.createElement\([\r\n\s]*(?P<q1>[\x22\x27])((?!(?P=q1)).)+?\x3ashape(?P=q1)[\r\n\s]*\).+?(?P=shape)\.setAttribute\([\r\n\s]*(?P<q2>[\x22\x27])path(?P=q2)[\r\n\s]*,[\r\n\s]*(?P<q3>[\x22\x27])((?!(?P=q3)).){506,}(?P=q3).+?(?P=shape)\.path/Rsi"; reference:cve,2013-0030; classtype:attempted-user; sid:2806020; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer OnResize Use After Free"; flow:established,from_server; file_data; content:"onresize"; nocase; content:"contenteditable"; fast_pattern:only; pcre:"/<(?P<elem>[^\x20]+)\x20.+?((?!<\/(?P=elem)).)+?contenteditable[\r\n\s]*\x3d[\r\n\s]*[\x27\x22]true[\x27\x22]*[\r\n\s]*((?!<\/(?P=elem)).)+?[\r\n\s]*onresize\x3d[\r\n\s]*[^\x3b]+?(\.write\x28\s*[\x22\x27]{2}\s*\x29|NULL|CollectGarbage\x28)/si"; reference:cve,2013-0087; classtype:attempted-user; sid:2806107; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer saveHistory Use After Free 1"; flow:established,from_server; file_data; content:"{behavior|3a|url(#default#savehistory)|3b|}"; fast_pattern:only; content:".outerHTML"; pcre:"/\.(?P<class>[^\r\n\s]+)[\r\n\s]+{behavior\x3aurl\x28#default#savehistory\x29.+?function\s+?(?P<function>[^\x20\x28]+).+?[\r\n\s]+?(?P<divid>[^\x2e]+?)\.outerHTML.+?CLASS\x3d(?P=class).+?onload=[\x27\x22](?P=function)\x28/si"; reference:cve,2013-0088; classtype:attempted-user; sid:2806108; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer saveHistory Use After Free 2"; flow:established,from_server; file_data; content:"{behavior|3a|url(#default#savehistory)|3b|}"; fast_pattern:only; content:".outerHTML"; pcre:"/\.(?P<class>[^\r\n\s]+)[\r\n\s]+{behavior\x3aurl\x28#default#savehistory\x29.+?function\s+?(?P<function>[^\x20\x28]+).+?[\r\n\s]+?(?P<divid>[^\x2e]+?)\.outerHTML.+?onload=[\x27\x22](?P=function)\x28.+?CLASS\x3d(?P=class)/si"; reference:cve,2013-0088; classtype:attempted-user; sid:2806109; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CMarkupBehaviorContext Use After Free 1"; flow:established,from_server; file_data; content:"{behavior|3a|url(#default#savehistory)|3b|}"; fast_pattern:only; content:"onsave="; pcre:"/\.(?P<class>[^\r\n\s]+)[\r\n\s]+{behavior\x3aurl\x28#default#savehistory\x29.+?function\s+?(?P<function>[^\x20\x28]+).+?document\.open\x28.+?CLASS\x3d(?P=class).+?onsave=[\x27\x22](?P=function)\x28/si"; reference:cve,2013-0089; classtype:attempted-user; sid:2806110; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer CMarkupBehaviorContext Use After Free 2"; flow:established,from_server; file_data; content:"{behavior|3a|url(#default#savehistory)|3b|}"; fast_pattern:only; content:"onsave="; pcre:"/\.(?P<class>[^\r\n\s]+)[\r\n\s]+{behavior\x3aurl\x28#default#savehistory\x29.+?function\s+?(?P<function>[^\x20\x28]+).+?document\.open\x28.+?onsave=[\x27\x22](?P=function)\x28.+?CLASS\x3d(?P=class)/si"; reference:cve,2013-0089; classtype:attempted-user; sid:2806111; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CVE-2013-0092 GetMarkUpPtr Use After free 1"; flow:to_client,established; file_data; content:"onbeforeprint"; fast_pattern:only; content:"<body "; pcre:"/^((?!\/>).)*onload[\r\n\s]*=[\r\n\s]*(?P<q1>[\x22\x27])((?!(?P=q1)).)+\.execCommand\x28[\r\n\s]*(?P<q2>[\x22\x27])print(?P=q2).+onbeforeprint[\r\n\s]*=[\r\n\s]*(?P<q3>[\x22\x27])((?!(?P=q3)).)*document.write\x28/Rsi"; classtype:attempted-user; sid:2806112; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CVE-2013-0092 GetMarkUpPtr Use After free 2"; flow:to_client,established; file_data; content:"onbeforeprint"; fast_pattern:only; pcre:"/function[\r\n\s]+(?P<func>[^\r\n\s\x28]+)[\r\n\s]*\x28[^\x29]*?\x29[\r\n\s]*{.*?document\.write\x28.+?\<body[\r\n\s]+((?!\/>).)*onload[\r\n\s]*=[\r\n\s]*(?P<q1>[\x22\x27])((?!(?P=q1)).)+\.execCommand\x28[\r\n\s]*(?P<q2>[\x22\x27])print(?P=q2).+onbeforeprint[\r\n\s]*=[\r\n\s]*[\x22\x27](?P=func)\s*\x28/si"; classtype:attempted-user; sid:2806113; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CVE-2013-0092 GetMarkUpPtr Use After free 3"; flow:to_client,established; file_data; content:"onbeforeprint"; fast_pattern:only; pcre:"/function[\r\n\s]+(?P<func>[^\r\n\s\x28]+)[\r\n\s]*\x28[^\x29]*?\x29[\r\n\s]*{.*?document\.write\x28.+?\<body[\r\n\s]+((?!\/>).)*onbeforeprint[\r\n\s]*=[\r\n\s]*[\x22\x27](?P=func)\s*\x28.+onload[\r\n\s]*=[\r\n\s]*(?P<q1>[\x22\x27])((?!(?P=q1)).)+\.execCommand\x28[\r\n\s]*(?P<q2>[\x22\x27])print(?P=q2)/si"; classtype:attempted-user; sid:2806114; rev:3;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer onBeforeCopy Use After Free"; flow:established,from_server; file_data; content:"onbeforecopy"; fast_pattern:only; pcre:"/function\s+?(?P<function>[^\x20\x28]+).+?document\.write\x28.+?<(?P<elem>[a-z]+)\x20((?!<\/(?P=elem)).)+?onbeforecopy[\r\n\s]*\x3d[\r\n\s]*[\x27\x22](?P=function)/si"; reference:cve,2013-0093; classtype:attempted-user; sid:2806115; rev:1;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer SLayoutRun Use After Free 2"; flow:established,from_server; file_data; content:".style.whiteSpace"; nocase; content:"pre-line"; content:"CollectGarbage("; fast_pattern:only; pcre:"/(?P<elem>[^\r\n\s]+)\.style\.whitespace[\r\n\s]*\x3d[\r\n\s]*[\x27\x22]pre-line[\x27\x22].+?(CollectGarbage\x28|(?P=elem)\.[a-z]+?[\r\n\s]*\x3d[\r\n\s]*([\x27\x22]{2}|NULL)).+?(?P=elem)\.innerHTML[\r\n\s]*\x3d[\r\n\s]*[\x27\x22]/si"; reference:cve,2013-1288; classtype:attempted-user; sid:2806119; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Microsoft Internet Explorer HTML Sanitization Component Privilege Escalation"; flow:from_server,established; file_data; content:"expression("; nocase; fast_pattern:only; content:"<style>"; nocase; pcre:"/^((?!<\/style>).)+?expression\x28/Ri"; reference:cve,2013-1289; classtype:attempted-user; sid:2806222; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 1"; flow:from_server,established; file_data; content:"a9d7038d-b5ed-472e-9c47-94bea90a5910"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806223; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 2"; flow:from_server,established; file_data; content:"9059f30f-4eb1-4bd2-9fdc-36f43a218f4a"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806224; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 3"; flow:from_server,established; file_data; content:"971127BB-259F-48c2-BD75-5F97A3331551"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806225; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 4"; flow:from_server,established; file_data; content:"7584c670-2274-4efb-b00b-d6aaba6d3850"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806226; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 5"; flow:from_server,established; file_data; content:"6A6F4B83-45C5-4ca9-BDD9-0D81C12295E4"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806227; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 6"; flow:from_server,established; file_data; content:"4EDCB26C-D24C-4e72-AF07-B576699AC0DE"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806228; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 7"; flow:from_server,established; file_data; content:"54CE37E0-9834-41ae-9896-4DAB69DC022B"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806229; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 8"; flow:from_server,established; file_data; content:"4eb89ff4-7f78-4a0f-8b8d-2bf02e94e4b2"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806230; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 9"; flow:from_server,established; file_data; content:"7390f3d8-0439-4c05-91e3-cf5cb290c3d0"; nocase; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806231; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 10"; flow:from_server,established; file_data; content:"MsRDP.MsRDP"; nocase; fast_pattern:only; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806232; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Remote Desktop Client Remote Code Execution 11"; flow:from_server,established; file_data; content:"MsTsAx.MsTsAx"; nocase; fast_pattern:only; content:"outer"; pcre:"/^(text|html)/Ri"; pcre:"/(?:Transport|Advanced)Settings/i"; pcre:"/(?:client(?:(?:Heigh|Lef)t|Width|Top)|offset(?:(?:Heigh|Lef)t|Width|Top))/i"; reference:cve,2013-1296; classtype:attempted-user; sid:2806233; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Windows Live Essentials Insecure URI Handler CVE-2013-0096"; flow:established,from_server; file_data; content:"wlw|3a|//"; nocase; fast_pattern; pcre:"/^[^\x22]+?\x22[^\x22]+\/p(?:roxy\x3a(\d{1,3}\.){3}\d{1,3}\x3a\d{1,5}|erflog)/Ri"; classtype:attempted-user; sid:2806234; rev:9;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible CVE-2013-1347 IE 0-day used in DOL attack"; flow:established,to_client; file_data; content:".offsetParent"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?(\x22{2}|\x27{2}|null)/Ri"; content:"datalist"; nocase; pcre:"/^[\x22\x27\s\>]/R"; content:".innerHTML"; nocase; distance:0; pcre:"/^[\r\n\s]*?=[\r\n\s]*?(\x22{2}|\x27{2}|null)/Ri"; content:"<!doctype html"; nocase; pcre:"/[\x22\x27\<]table[\x22\x27\>]/"; pcre:"/[\x22\x27\<]hr[\x22\x27\>]/"; content:"CollectGarbage"; nocase; fast_pattern:only; reference:cve,2013-1347; reference:url,labs.alienvault.com/labs/index.php/2013/u-s-department-of-labor-website-hacked-and-redirecting-to-malicious-code/; reference:url,technet.microsoft.com/en-us/security/advisory/2847140; classtype:attempted-user; sid:2016822; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Microsoft Visio information disclosure"; flow:established,from_server; file_data; content:"<!DOCTYPE svg ["; nocase; distance:0; content:"remote"; nocase; distance:0; content:"SYSTEM"; nocase; distance:0; content:"<svg"; fast_pattern:only; nocase; content:"<!ENTITY"; nocase; pcre:"/^[\r\n\s]+?\x25[\r\n\s]+?((?!>).)+?SYSTEM[\r\n\s]+?[\x22\x27]http\x3a\x2f\x2f[^\x22\x27]+?\.xml/Rsi"; reference:cve,2013-1301; classtype:attempted-recon; sid:2806354; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer cross-domain JSON file content disclosure"; flow:established,from_server; file_data; content:".json"; nocase; content:"vbs"; distance:0; pcre:"/<script[\r\n\s]+?(src[\r\n\s]*?=[\r\n\s]*?[\x22\x27][^\x22\x27]*?\.json[\x22\x27][\r\n\s]*?language[\r\n\s]*?\x3dvbs[\r\n\s]*?|language[\r\n\s]*?\x3dvbs[\r\n\s]*?src[\r\n\s]*?=[\r\n\s]*?[\x22\x27][^\x22\x27]*?\.json[\x22\x27])/si"; reference:cve,2013-1297; classtype:attempted-recon; sid:2806355; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:"border"; nocase; distance:0; content:"Array("; nocase; distance:0; content:"join("; nocase; distance:0; content:"runtimeStyle"; fast_pattern:only; pcre:"/var[\r\s\n]*(?P<var1>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*.+?var[\r\s\n]*(?P<var2>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*(?P=var1)(\.runtimeStyle|\[[\x22\x27]runtimeStyle[\x22\x27]\]).+?[\r\n\s]*(?P=var2)(\.border(Right|left)|\[[\x22\x27]border(right|left)[\x22\x27])[\r\n\s]*\x3d[\r\n\s]*Array\x28[^\x29]*?\x29\.join\x28/si"; reference:cve,2013-1307; classtype:attempted-user; sid:2806356; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:"innerHTML"; nocase; distance:0; content:"CollectGarbage("; nocase; distance:0; pcre:"/var[\r\s\n]*(?P<var1>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*.+CollectGarbage\x28.+set(Timeout|Interval)\x28[\r\n\s]*function\x28\x29[\r\n\s]*\x7b[\r\n\s]*?.+?((?P=var1)\.innerHTML|getElementById\x28\s*?[\x27\x22](?P=var1)[\x27\x22]\s*?\x29\.innerHTML)[\r\n\s]*?\x3d[\r\n\s]*?.+?\x2c[\r\n\s]*?\d+?\x29/si"; reference:cve,2013-1311; classtype:attempted-user; sid:2806357; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Microsoft Internet Explorer VML Use After Free 2 CVE-2013-2551"; flow:established,from_server; file_data; content:"#default#VML"; nocase; content:"|3a|stroke "; content:"dashstyle.array.length"; nocase; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<len_var>[^\r\n\s\x3d]+)[\r\n\s]*?=[\r\n\s]*?[^\x3b]*?-.+?dashstyle\.array\.length[\r\n\s]*?=[\r\n\s]*?(?P=len_var)/Rsi"; reference:cve,2013-2551; classtype:attempted-user; sid:2806358; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Microsoft Internet Explorer VML Use After Free 1 CVE-2013-2551"; flow:established,from_server; file_data; content:"#default#VML"; nocase; content:"|3a|stroke "; content:"dashstyle.array.length"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[^\x3b]*?-/Rsi"; reference:cve,2013-2551; classtype:attempted-user; sid:2806359; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".appendChild"; nocase; content:"ownerDocument.get"; distance:0; content:".focusNode"; nocase; content:".focusNode["; nocase; distance:0; content:"null"; nocase; distance:0; content:"CollectGarbage("; distance:0; fast_pattern; nocase; content:".previousSibling"; distance:0; nocase; reference:cve,2013-1312; classtype:attempted-user; sid:2806364; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:"setTimeout("; nocase; distance:0; content:"var"; nocase; pcre:"/^[\r\s\n]*(?P<varp3>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*.+?\.appendChild\((?P=varp3)\).+?setTimeout\(<p((?!>).)+?(dir[\r\n\s]*\x3d[\r\n\s]*.+?id[\r\n\s]*\x3d[\r\n\s]*[\x22\x27](?P=varp3)[\x22\x27]|id[\r\n\s]*\x3d[\r\n\s]*[\x22\x27](?P=varp3)[\x22\x27].+?dir[\r\n\s]*\x3d[\r\n\s]*)/Rsi"; reference:cve,2013-3110; classtype:attempted-user; sid:2806481; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".swapNode("; fast_pattern; distance:0; content:".execCommand("; pcre:"/^\s*?[\x27\x28]superscript[\x27\x28]\s*?\).+?setTimeout\(/si"; content:"getElementsByTagName("; nocase; pcre:"/^\s*[\x27\x22]sup[\x27\x22]\s*\)/Rsi"; reference:cve,2013-3111; classtype:attempted-user; sid:2806482; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".swapNode("; fast_pattern; distance:0; content:"<sup>"; content:"setTimeout("; content:"getElementsByTagName("; nocase; pcre:"/^\s*[\x27\x22]sup[\x27\x22]\s*\)/Rsi"; reference:cve,2013-3111; classtype:attempted-user; sid:2806483; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".createStyleSheet("; fast_pattern; distance:0; pcre:"/^\s*[\x22\x27]((?!\.css).)+?[\x27\x22](\x2d\s*?\d+?)?\s*?\)/Rsi"; content:"setTimeout("; content:"getElementsByTagName("; nocase; pcre:"/^\s*?[\x27\x22]link[\x27\x22]\s*\x29\x5b\d+?\x5d\.href[\r\n\s]*\x3d[\r\n\s]*[\x22\x27]/Rsi"; reference:cve,2013-3117; classtype:attempted-user; sid:2806484; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Double Free CVE-2013-3118"; flow:established,to_client; file_data; content:".getElementsByTagNameNS("; content:".removeAttributeNS("; nocase; distance:0; content:"var"; pcre:"/^[\r\n\s\+]+(?P<var1>[^\r\n\s\+\x3d]+)[\r\n\s\+]*?=[\r\n\s\+]*?document.getElementsByTagNameNS\([\r\n\s\+]*(?!null).+?(?P=var1)\.removeAttributeNS\([\r\n\s\+]*?null/Rsi"; reference:cve,2013-3118; classtype:attempted-user; sid:2806485; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".removeEventListener"; fast_pattern; distance:0; content:"DOMNodeRemoved"; distance:0; content:"var "; nocase; pcre:"/^\s*?(?P<var1>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*.+?var\s+?(?P<var2>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*.+?var\s+?(?P<callback>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*function[\r\n\s]*\x28\s*event\s*\x29.+?(?P=var1)\.removeEventListener\x28[\r\n\s]*[\x27\x22]DOMNodeRemoved[\x27\x22][\r\n\s]*\x2c[\r\n\s]*(?P=callback)[\r\n\s]*\x2c[\r\n\s]*true.+?(?P=var1)\.applyElement\x28[\r\n\s]*(?P=var2)[\r\n\s]*\x2c[\r\n\s]*[\x27\x28]outside[\x27\x28].+?(?P=var1)\.appendChild\(\s*?(?P<nav>[^\x20\x29]+?)\s*?\).+?(?P=nav)\.appendChild\(\s*?(?P=var2)\s*?\).+?(?P=var1)\.addEventListener\x28[\r\n\s]*[\x27\x22]DOMNodeRemoved[\x27\x22][\r\n\s]*\x2c[\r\n\s]*(?P=callback)[\r\n\s]*\x2c[\r\n\s]*true.+?appendChild\(\s*(?P=nav)\s*\).+?(?P=nav)\.parentElement/Rsi"; reference:cve,2013-3119; classtype:attempted-user; sid:2806486; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2013-3120"; flow:established,to_client; file_data; content:"eval("; nocase; fast_pattern:only; content:"window.open("; nocase; content:".designMode"; nocase; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?[\x22\x27]?on[\x22\x27]/Ri"; content:"window.getSelection("; distance:0; nocase; content:".designMode"; nocase; distance:0; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?[\x22\x27]?off[\x22\x27]/Ri"; content:"var"; nocase; pcre:"/^[\r\n\s\+]+?(?P<var1>[^\r\n\s\+\x3d]+)[\r\n\s\+]*?=[\r\n\s\+]*?window.open\(.+?(?P=var1)\.eval\(/Rsi"; reference:cve,2013-3120; classtype:attempted-user; sid:2806487; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".runtimeStyle.setExpression"; distance:0; content:"innerHTML"; distance:0; content:"var "; nocase; pcre:"/^\s*?(?P<var1>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*document\.getElementById\s*\(\s*?[\x27\x22](?P<elem>[^\x22\x27\x20\x29]+?)[\x27\x22]\s*?\).+?(?P=var1)\.runtimeStyle\.setExpression\s*\(.+?document\.body\.innerHTML[\r\n\s]*\x3d[\r\n\s]*[\x22\x27].+?[\x22\x27].+?<dfn((?!>).)+?id[\r\n\s]*\x3d[\r\n\s]*[\x27\x22](?P=elem)[\x27\x22]/Rsi"; reference:cve,2013-3121; classtype:attempted-user; sid:2806488; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer onscroll CVE-2013-3123"; flow:established,to_client; file_data; content:"onscroll"; nocase; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?(?P<q1>[\x22\x27])((?!(?P=q1)).)*?document\.write\([\r\n\s\+]*?(?P<q2>(?!(?P=q1))[\x22\x27])(?P=q2)/Rsi"; reference:cve,2013-3123; classtype:attempted-user; sid:2806489; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer onscroll CVE-2013-3123"; flow:established,to_client; file_data; content:"onscroll"; fast_pattern:only; nocase; content:"function"; pcre:"/^[\r\n\s]+(?P<func>[^\r\n\s\x28]+)[\r\n\s]*\x28[^\x29]*?\x29[\r\n\s]*?(\{[^\}]*)*?document\.write\([\r\n\s\+]*?(?P<q2>[\x22\x27])(?P=q2).+?\bonscroll[\r\n\s\+]*?=[\r\n\s\+]*?[\x22\x27]*?(?P=func)\b/Rsi"; reference:cve,2013-3123; classtype:attempted-user; sid:2806490; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:".createRange("; content:".createRange("; distance:0; content:".createRange("; distance:0; content:".createRange("; distance:0; content:".setStart"; content:".setStart"; distance:0; content:".setEnd"; nocase; content:".setEnd"; nocase; distance:0; content:".addRange("; content:".addRange("; distance:0; content:".execCommand"; content:".execCommand"; distance:0; content:"delete"; content:"undo"; content:"getSelection("; content:"getSelection("; distance:0; content:".appendChild("; content:".childNodes["; content:"var "; nocase; pcre:"/^\s*?(?P<var1>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*document\.createRange\(.+?(?P=var1)(\.set(Start|End))\(.+?getSelection\(\s*\)\.(create|add)Range\(.+?document\.execCommand\(\s*[\x22\x27](undo|delete)[\x27\x22][\r\n\s]*?\x2c[\r\s\n]*?null[\r\s\n]*?\x2c[\r\s\n]*?true[\r\s\n]*?\).+?/Rsi"; reference:cve,2013-3124; classtype:attempted-user; sid:2806491; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:"document.createElement("; nocase; content:"select"; distance:0; nocase; content:".appendChild("; distance:0; content:".getElementsByTagName("; distance:0; content:"select"; nocase; distance:0; content:".parentNode.removeChild("; fast_pattern:4,20; distance:0; content:"var "; nocase; pcre:"/^\s*?(?P<var1>[^\x3d\x20]+?)[\r\n\s]*\x3d[\r\n\s]*document\.createElement\(\s*[\x27\x22]select[\x27\x22]\s*\).+?\.appendChild\(\s*(?P=var1)\s*\).+?.getElementsByTagName\(\s*[\x22\x27]select[\x22\x27]\s*\).+?parentNode\.removeChild\(/Rsi"; reference:cve,2013-3139; classtype:attempted-user; sid:2806499; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free"; flow:established,from_server; file_data; content:"jquery.js"; content:".replaceAll($"; fast_pattern; nocase; content:".append("; distance:0; content:".replaceAll($"; nocase; distance:0; content:".css"; distance:0; nocase; content:"margin-"; distance:0; nocase; content:"$("; pcre:"/\s*[\x22\x27](?P<elem>[^\x22\x27]+?)[\x27\x22]\s*\)\.replaceAll\(.+?\x24\x28\s*[\x22\x27](?P=elem)[\x27\x22]\s*\)\.append\x28.+?\x24\x28\s*[\x27\x22][^\x27\x22]+?[\x27\x22]\s*\x29\.replaceAll\x28\s*\x24\s*\x28\s*[\x27\x22][^\x27\x22]+?[\x27\x22]\s*\x29.+?\x24\x28\s*[\x27\x22][^\x27\x22]+?[\x27\x22]\s*\x29\.css\x28\s*[\x27\x28]margin\x2d/Rsi"; reference:cve,2013-3142; classtype:attempted-user; sid:2806500; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 1 CVE-2013-3115"; flow:established,from_server; file_data; content:".focus("; nocase; distance:0; content:".height"; nocase; distance:0; content:"disabled"; nocase; distance:0; content:".noWrap"; nocase; fast_pattern; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; pcre:"/[\r\s\n]*(?P<var1>[^\x3d\x20]+?)\.focus\(\).+?(?P=var1)\.height[\r\n\s]*\x3d[\r\n\s]*0[\r\n\s]*\x3b.+?(?P=var1)\.disabled[\r\n\s]*\x3d[\r\n\s]*true[\r\n\s]*\x3b/si"; reference:cve,2013-3115; classtype:attempted-user; sid:2806625; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 2 CVE-2013-3115"; flow:established,from_server; file_data; content:".focus("; nocase; distance:0; content:"disabled"; nocase; distance:0; content:".height"; nocase; distance:0; content:".noWrap"; nocase; fast_pattern; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; pcre:"/[\r\s\n]*(?P<var1>[^\x3d\x20]+?)\.focus\(\).+?(?P=var1)\.disabled[\r\n\s]*\x3d[\r\n\s]*true[\r\n\s]*\x3b.+?(?P=var1)\.height[\r\n\s]*\x3d[\r\n\s]*0[\r\n\s]*\x3b/si"; reference:cve,2013-3115; classtype:attempted-user; sid:2806626; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 3 CVE-2013-3115"; flow:established,from_server; file_data; content:".height"; nocase; distance:0; content:".focus("; nocase; distance:0; content:"disabled"; nocase; distance:0; content:".noWrap"; nocase; fast_pattern; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; pcre:"/[\r\s\n]*(?P<var1>[^\x3d\x20]+?)\.height[\r\n\s]*\x3d[\r\n\s]*0[\r\n\s]*\x3b.+?(?P=var1)\.focus\(\).+?(?P=var1)\.disabled[\r\n\s]*\x3d[\r\n\s]*true[\r\n\s]*\x3b/si"; reference:cve,2013-3115; classtype:attempted-user; sid:2806627; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 4 CVE-2013-3115"; flow:established,from_server; file_data; content:".height"; nocase; distance:0; content:"disabled"; nocase; distance:0; content:".focus("; nocase; distance:0; content:".noWrap"; nocase; fast_pattern; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; pcre:"/[\r\s\n]*(?P<var1>[^\x3d\x20]+?)\.height[\r\n\s]*\x3d[\r\n\s]*0[\r\n\s]*\x3b.+?(?P=var1)\.disabled[\r\n\s]*\x3d[\r\n\s]*true[\r\n\s]*\x3b.+?(?P=var1)\.focus\(\)/si"; reference:cve,2013-3115; classtype:attempted-user; sid:2806628; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 5 CVE-2013-3115"; flow:established,from_server; file_data; content:"disabled"; nocase; distance:0; content:".focus("; nocase; distance:0; content:".height"; nocase; distance:0; content:".noWrap"; nocase; fast_pattern; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; pcre:"/[\r\s\n]*(?P<var1>[^\x3d\x20]+?)\.disabled[\r\n\s]*\x3d[\r\n\s]*true[\r\n\s]*\x3b.+?(?P=var1)\.focus\(\).+?(?P=var1)\.height[\r\n\s]*\x3d[\r\n\s]*0[\r\n\s]*\x3b/si"; reference:cve,2013-3115; classtype:attempted-user; sid:2806629; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 1 CVE-2013-3143"; flow:established,from_server; file_data; content:".removeNode("; pcre:"/^\s*true\s*\)/Rsi"; content:"DOMNodeRemoved"; nocase; distance:0; fast_pattern; content:".addEventListener("; nocase; pcre:"/^\s*[\x27\x22]load[\x27\x22]/Rsi"; content:".addEventListener("; nocase; distance:0; pcre:"/^\s*[\x27\x22]DOMNodeRemoved[\x27\x22]/Rsi"; content:".write("; nocase; pcre:"/^[\r\n\s]*?(?P<q>[\x22\x27])(?P=q)/Rsi"; reference:cve,2013-3143; classtype:attempted-user; sid:2806631; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 6 CVE-2013-3115"; flow:established,from_server; file_data; content:"disabled"; nocase; distance:0; content:".height"; nocase; distance:0; content:".focus("; nocase; distance:0; content:".noWrap"; nocase; fast_pattern; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; pcre:"/[\r\s\n]*(?P<var1>[^\x3d\x20]+?)\.disabled[\r\n\s]*\x3d[\r\n\s]*true[\r\n\s]*\x3b.+?(?P=var1)\.height[\r\n\s]*\x3d[\r\n\s]*0[\r\n\s]*\x3b.+?(?P=var1)\.focus\(\).+?(?P=var1)/si"; reference:cve,2013-3115; classtype:attempted-user; sid:2806630; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 2 CVE-2013-3143"; flow:established,from_server; file_data; content:".removeNode("; pcre:"/^\s*true\s*\)/Rsi"; content:"DOMNodeRemoved"; nocase; distance:0; fast_pattern; content:".addEventListener("; nocase; pcre:"/^\s*[\x27\x22]load[\x27\x22]/Rsi"; content:".addEventListener("; nocase; distance:0; pcre:"/^\s*[\x27\x22]DOMNodeRemoved[\x27\x22]/Rsi"; content:"CollectGarbage("; nocase; reference:cve,2013-3143; classtype:attempted-user; sid:2806632; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-1346"; flow:established,from_server; file_data; content:"table"; nocase; content:"td"; nocase; pcre:"/^[\x22\x27][\r\n\s]*?\)\.item\([\r\n\s]*?0[\r\n\s]*\)/R"; content:"column-count"; nocase; pcre:"/^[\x22\x27]?[\r\n\s]*?[\,\=\x3a][\r\n\s]*?[\x22\x27]?(?:1(?:7(?:1(?:79(?:8(?:69(?:[2-9]\d|19)|[7-9]\d{3})|9\d{4})|[8-9]\d{6})|[2-9]\d{7})|[8-9]\d{8})|[2-9]\d{9})/R"; reference:cve,2013-3146; classtype:attempted-user; sid:2806633; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 1 CVE-2013-1347"; flow:established,from_server; file_data; content:"onbeforeeditfocus"; fast_pattern:only; content:"<input "; nocase; content:"function "; pcre:"/^(?P<func>[^\r\n\s\x28]+?).+?\.write\([\r\n\s]*?(?P<q>[\x22\x27])(?P=q).+?onbeforeeditfocus[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func)/Rsi"; reference:cve,2013-1347; classtype:attempted-user; sid:2806634; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 2 CVE-2013-1347"; flow:established,from_server; file_data; content:"onbeforeeditfocus"; fast_pattern:only; content:"<input "; nocase; content:"CollectGarbage"; content:"function "; pcre:"/^(?P<func>[^\r\n\s\x28]+?).+?CollectGarbage\(.+?onbeforeeditfocus[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func)/Rsi"; reference:cve,2013-1347; classtype:attempted-user; sid:2806635; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 1 CVE-2013-1348"; flow:established,from_server; file_data; content:"onbeforecopy"; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]document\.write\((?P<q>[\x22\x27])(?P=q).+?contenteditable[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27]true[\x22\x27]/Rsi"; content:"contenteditable"; nocase; content:"setTimeout("; pcre:"/^[\r\n\s]*?[\x27\x22]document\.execCommand\(\s*[\x27\x22]selectAll[\x27\x22]\s*\)/Rsi"; reference:cve,2013-1348; classtype:attempted-user; sid:2806636; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 2 CVE-2013-1348"; flow:established,from_server; file_data; content:"onbeforecopy"; fast_pattern:only; content:"setTimeout("; pcre:"/^[\r\n\s]*?[\x27\x22]document\.execCommand\(\s*[\x27\x22]selectAll[\x27\x22]\s*\)/Rsi"; content:"function "; pcre:"/^(?P<func>[^\r\n\s\x28]+?).+?\.write\([\r\n\s]*?(?P<q>[\x22\x27])(?P=q).+?onbeforecopy[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func).+?contenteditable[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27]true[\x22\x27]/Rsi"; reference:cve,2013-1348; classtype:attempted-user; sid:2806637; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 1 CVE-2013-3150"; flow:established,from_server; file_data; content:"setCapture"; distance:0; content:"setCapture"; distance:0; content:"setCapture"; distance:0; content:"var "; pcre:"/^[^\r\n\s]*?(?P<var1>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementById\([\r\n\s]*?[\x22\x27][\r\n\s]*?(?P<elem1>[^\r\n\s\x27\x22)]+?)[\x22\x27][\r\n\s]*?\).+?var [^\r\n\s]*?(?P<var2>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementById\([\r\n\s]*?[\x22\x27]?[\r\n\s]*?(?P<elem2>[^\r\n\s\)]+)[\r\n\s]*?\).+?(?P=var2)\.setCapture\((?P=var1)\).+?\.setCapture\(.+?\.setCapture\(.+?<svg[^>]+?[\r\n\s\>]((?!<\/svg>).)+?<[^>]+?[\r\n\s]+?id[\r\n\s]*?=[\r\n\s]*?(?P<q>[\x22\x27])(?P=elem1)(?P=q).+?<\/svg>/Rsi"; reference:cve,2013-3150; classtype:attempted-user; sid:2806638; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 2 CVE-2013-3150"; flow:established,from_server; file_data; content:"setCapture"; distance:0; content:"setCapture"; distance:0; content:"setCapture"; distance:0; content:"<svg"; pcre:"/^[^>]+?[\r\n\s\>]((?!<\/svg>).)+?<[^>]+?[\r\n\s]+?id[\r\n\s]*?=[\r\n\s]*?[\x22\x27](?P<elem1>[^\r\n\s\x22\x27]+?)[\x22\x27][\r\n\s]*?.+?((?!<\/svg>).)+?<[^>]+?[\r\n\s]+?id[\r\n\s]*?=[\r\n\s]*?[\x22\x27](?P<elem2>[^\r\n\s\x22\x27]+?)[\x22\x27][\r\n\s]*?.+?<\/svg>.+?var [^\r\n\s]*?(?P<var1>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementById\([\r\n\s]*?[\x22\x27][\r\n\s]*?(?P=elem1)[\x22\x27][\r\n\s]*?\).+?var [^\r\n\s]*?(?P<var2>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementById\([\r\n\s]*?[\x22\x27][\r\n\s]*?(?P=elem2)[\x22\x27][\r\n\s]*?\).+?(?P=var2)\.setCapture\((?P=var1)\).+?\.setCapture\(.+?\.setCapture\(/Rsi"; reference:cve,2013-3150; classtype:attempted-user; sid:2806639; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 1 CVE-2013-3152"; flow:established,from_server; file_data; content:"table"; nocase; content:".createTHead("; nocase; fast_pattern; pcre:"/\.(?:insert(?:Row\(.+?\.(?:insertAdjacentHTML\(.+?\.scrollIntoView|scrollIntoView\(.+?\.insertAdjacentHTML)|AdjacentHTML\(.+?\.(?:insertRow\(.+?\.scrollIntoVie|scrollIntoView\(.+?\.insertRo)w)|scrollIntoView\(.+?\.insert(?:AdjacentHTML\(.+?\.insertRow|Row\(.+?\.insertAdjacentHTML))\(/Rsi"; content:".innerText"; distance:0; nocase; reference:cve,2013-3152; classtype:attempted-user; sid:2806640; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 2 CVE-2013-3152"; flow:established,from_server; file_data; content:"table"; nocase; content:".insertAdjacentHTML("; nocase; fast_pattern; pcre:"/\.(?:insertRow\(.+?\.(?:createTHead\(.+?\.scrollIntoView|scrollIntoView\(.+?\.createTHead)|createTHead\(.+?\.(?:insertRow\(.+?\.scrollIntoVie|scrollIntoView\(.+?\.insertRo)w|scrollIntoView\(.+?\.(?:createTHead\(.+?\.insertRow|insertRow\(.+?\.createTHead))\(/Rsi"; content:".innerText"; distance:0; nocase; reference:cve,2013-3152; classtype:attempted-user; sid:2806641; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 3 CVE-2013-3152"; flow:established,from_server; file_data; content:"table"; nocase; content:".scrollIntoView("; nocase; fast_pattern; pcre:"/\.(?:insert(?:Row\(.+?\.(?:createTHead\(.+?\.insertAdjacentHTML|insertAdjacentHTML\(.+?\.createTHead)|AdjacentHTML\(.+?\.(?:createTHead\(.+?\.insertRow|insertRow\(.+?\.createTHead))|createTHead\(.+?\.insert(?:AdjacentHTML\(.+?\.insertRow|Row\(.+?\.insertAdjacentHTML))\(/Rsi"; content:".innerText"; distance:0; nocase; reference:cve,2013-3152; classtype:attempted-user; sid:2806642; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free 4 CVE-2013-3152"; flow:established,from_server; file_data; content:"table"; nocase; content:".insertRow("; nocase; fast_pattern; pcre:"/\.(?:createTHead\(.+?\.(?:insertAdjacentHTML\(.+?\.scrollIntoView|scrollIntoView\(.+?\.insertAdjacentHTML)|scrollIntoView\(.+?\.(?:createTHead\(.+?\.insertAdjacentHTML|insertAdjacentHTML\(.+?\.createTHead)|insertAdjacentHTML\(.+?\.(?:createTHead\(.+?\.scrollIntoView|scrollIntoView\(.+?\.createTHead))\(/Rsi"; content:".innerText"; distance:0; nocase; reference:cve,2013-3152; classtype:attempted-user; sid:2806643; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3153"; flow:established,from_server; file_data; content:".onpropertychange"; distance:0; content:".swapNode("; distance:0; content:"<object"; pcre:"/^[^>]+?[\r\n\s]*?id[\r\n\s]*?=[\r\n\s]*?[\x22\x27](?P<t1>[^\r\n\s\x22\x27]+)((?!<\/object>).)+?<[^>]+?[\r\n\s]+?id[\r\n\s]*?=[\r\n\s]*?[\x22\x27](?P<t4>[^\r\n\s\x22\x27]+?)[\x22\x27][\r\n\s]*?((?!<\/object>).)+?<[^>]+?[\r\n\s]+?id[\r\n\s]*?=[\r\n\s]*?[\x22\x27](?P<t8>[^\r\n\s\x22\x27]+?)[\x22\x27][\r\n\s]*?.+?<\/object>.+?(?P<obj>[^\r\n\s\x3d]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementById\([\r\n\s]*?[\x22\x27](?P=t4)[\x27\x22][\r\n\s]*?\).+?(?P=t1)\.onpropertychange[\r\n\s]*?\x3d[\r\n\s]*?.+?(?P=obj)\.swapnode\([\r\n\s]*?(?P=t8)[\r\n\s]*?\)/Rsi"; reference:cve,2013-3153; classtype:attempted-user; sid:2806644; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3163"; flow:established,from_server; file_data; content:"<bdo"; nocase; pcre:"/^[\r\n\s\+\>]((?!<\/bdo>).)*?<fieldset[\r\n\s\+\>]((?!<\/fieldset>).)*?<\/bdo>/Rsi"; reference:cve,2013-3163; classtype:attempted-user; sid:2017133; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Potential Internet Explorer Use After Free CVE-2013-3163"; flow:established,from_server; file_data; content:".contentEditable"; nocase; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; content:"var"; pcre:"/^[\r\n\s\+]+?(?P<var>[^\r\n\s\+\x3d]+)[\r\n\s\+]*?=[\r\n\s\+]*?[^\)]+\.createElement\(.+?\.body.appendChild\([\r\n\s]*?[\x22\x27]?(?P=var)[\x22\x27]?[\r\n\s]*?\).+\b(?P=var)\.innerHTML[\r\n\s\+]*?=[\r\n\s\+]*?(?P<q>[\x22\x27])(?P=q)/Rsi"; content:"CollectGarbage("; fast_pattern; nocase; distance:0; content:"eval("; distance:0; nocase; reference:cve,2013-3163; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:2017129; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Potential Internet Explorer Use After Free CVE-2013-3163 2"; flow:established,from_server; file_data; content:"CollectGarbage("; fast_pattern:only; nocase; content:".contentEditable"; nocase; pcre:"/^[\r\n\s\+]*?=[\r\n\s\+]*?true/Ri"; content:"var"; pcre:"/^[\r\n\s\+]+?(?P<var>[^\r\n\s\+\x3d]+)[\r\n\s\+]*?=[\r\n\s\+]*?[^\)]+\.createElement\(.+?\.appendChild\([\r\n\s]*?[\x22\x27]?(?P=var)[\x22\x27]?[\r\n\s]*?\).+\b(?P=var)\.innerHTML[\r\n\s\+]*?=[\r\n\s\+]*?(?P<q>[\x22\x27])(?P=q).+?CollectGarbage\(.+?\b(?P=var)\./Rsi"; reference:cve,2013-3163; reference:url,blogs.technet.com/b/srd/archive/2013/07/10/running-in-the-wild-not-for-so-long.aspx; classtype:attempted-user; sid:2017130; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Firefox CVE-2013-1690"; flow:established,from_server; file_data; content:"window.stop("; fast_pattern:only; nocase; content:"ownerDocument.write("; nocase; content:"addEventListener("; nocase; content:"readystatechange"; distance:0; nocase; content:"Array"; nocase; reference:cve,2013-1690; classtype:attempted-user; sid:2017298; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Potential Microsoft Internet Explorer Use-After-Free CVE-2013-3199"; flow:from_server,established; file_data; content:"setTimeout("; nocase; content:".write("; pcre:"/^[\r\n\s]*[\x22\x27][^\x22\x27]+?[\x22\x27][\r\n\s]*\x29/Ri"; content:".createElement("; distance:0; pcre:"/^[\r\n\s]*[\x22\x27][^\x22\x27]+?[\x22\x27]\s*\x29/Ri"; content:".classname"; nocase; distance:0; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*[\x22\x27][^\x22\x27]+?[\x22\x27]/Ri"; content:".execCommand("; fast_pattern; distance:0; pcre:"/^[\r\n\s]*[\x22\x27]undo[\x22\x27][\r\n\s]*\x29/Ri"; reference:cve,2013-3199; classtype:attempted-user; sid:2806816; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3184"; flow:from_server,established; file_data; content:".innerText"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[\x27\x22][^\x22\x27]+?[\x27\x22]/Ri"; content:".fireEvent("; distance:0; pcre:"/^[\r\n\s]*?[\x22\x27][^\x22\x27]+?[\x22\x27][\r\n\s]*?\x29/Rsi"; content:".contentEditable"; nocase; pcre:"/^[\r\n\s]*=[\r\n\s]*[\x27\x22]false[\x27\x22].+?[\r\n\s]+(var\s+)?(?P<obj>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\(.+?(?P=obj)\.classname\s*\x3d\s*[\x27\x22].+?\.appendChild\(\s*(?P=obj)/Rsi"; reference:cve,2013-3184; classtype:attempted-user; sid:2806817; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3187"; flow:established,from_server; file_data; content:".surroundContents("; fast_pattern:only; nocase; content:".setAttribute("; nocase; content:"<svg"; nocase; pcre:"/^((?!<\/svg>).)+?<(?P<element1>(f(e(Co(mpo(nentTransfer|site)|(nvolve|lor)Matrix)|Di(s(placementMap|tantLight)|ffuseLighting)|M(erg(eNod)?e|orphology)|Sp(ecularLighting|otLight)|(T(urbulenc|il)|Imag)e|(PointLigh|Offse)t|F(unc[ABGR]|lood)|GaussianBlur|Blend)|o(nt(-face(-(format|name|src|uri))?)?|reignObject)|ilter)|a(nimate(Transform|Motion|Color)?|ltGlyph(Item|Def)?)|m((issing-glyp|pat)h|a(rker|sk)|etadata)|s((crip|e)t|t(yle|op)|witch|ymbol|vg)|c((olor-profi|irc)le|lipPath|ursor)|p(oly(line|gon)|at(tern|h))|t(ext(Path)?|itle|span|ref)|((ellip|u)s|imag)e|r(adialGradien|ec)t|line(arGradient)?|g(lyph(Ref)?)?|v(kern|iew)|de(fs|sc)|hkern))[\r\n\s\>]((?!<\/(?P=element1)).)*?<(?:f(?:e(?:Co(?:mpo(?:nentTransfer|site)|(?:nvolve|lor)Matrix)|Di(?:s(?:placementMap|tantLight)|ffuseLighting)|M(?:erg(?:eNod)?e|orphology)|Sp(?:ecularLighting|otLight)|(?:T(?:urbulenc|il)|Imag)e|(?:PointLigh|Offse)t|F(?:unc[ABGR]|lood)|GaussianBlur|Blend)|o(?:nt(?:-face(?:-(?:format|name|src|uri))?)?|reignObject)|ilter)|a(?:nimate(?:Transform|Motion|Color)?|ltGlyph(?:Item|Def)?)|m(?:(?:issing-glyp|pat)h|a(?:rker|sk)|etadata)|s(?:(?:crip|e)t|t(?:yle|op)|witch|ymbol|vg)|c(?:(?:olor-profi|irc)le|lipPath|ursor)|p(?:oly(?:line|gon)|at(?:tern|h))|t(?:ext(?:Path)?|itle|span|ref)|(?:(?:ellip|u)s|imag)e|r(?:adialGradien|ec)t|line(?:arGradient)?|g(?:lyph(?:Ref)?)?|v(?:kern|iew)|de(?:fs|sc)|hkern)/Rsi"; reference:cve,2013-3187; classtype:attempted-user; sid:2806818; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Potential Internet Explorer Use After Free CVE-2013-3188 1"; flow:established,from_server; file_data; content:".innerHTML"; nocase; pcre:"/^[\r\n\s]*?\+?=/R"; content:"document.body.innerHTML"; nocase; distance:0; pcre:"/^[\r\n\s]*?\+?=/R"; content:"style.unicodeBidi"; nocase; fast_pattern:only; content:"document.body.appendChild("; nocase; reference:url,web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-3188; classtype:attempted-user; sid:2806819; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Potential Internet Explorer Use After Free CVE-2013-3188 2"; flow:established,from_server; file_data; content:"document.body.innerHTML"; nocase; pcre:"/^[\r\n\s]*?\+?=/R"; content:".innerHTML"; nocase; distance:0; pcre:"/^[\r\n\s]*?\+?=/R"; content:"style.unicodeBidi"; nocase; fast_pattern:only; content:"document.body.appendChild("; nocase; reference:cve,2013-3188; classtype:attempted-user; sid:2806820; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3194"; flow:from_server,established; file_data; content:".createRange("; nocase; content:".setStart("; nocase; fast_pattern:only; content:".insertNode("; nocase; content:"document.write("; nocase; content:"var"; pcre:"/^\s+(?P<varID>[^\x20]+)\s*\x3d\s*document\.createRange\(.+?(?P=varID)\.setStart\(.+?(?P=varID)\.insertNode\(.+?document\.write\x28\s*[\x22\x27][^\x22\x27]+?[\x22\x27]\s*\x29/Rsi"; reference:cve,2013-3194; classtype:attempted-user; sid:2806821; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Potential Microsoft Internet Explorer Use-After-Free CVE-2013-3193"; flow:from_server,established; file_data; content:"document.execCommand("; nocase; pcre:"/^\s*[\x22\x27]SelectAll[\x22\x27]\s*\x29/Ri"; content:"document.execCommand("; nocase; distance:0; pcre:"/^[\r\n\s]*[\x22\x27]RemoveFormat[\x22\x27][\r\n\s]*\x29/Ri"; content:".innerHTML"; distance:0; pcre:"/^[\r\n\s]*\x3d[\r\n\s]*[\x27\x29]/Ri"; reference:cve,2013-3193; classtype:attempted-user; sid:2806825; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3202"; flow:established,from_server; file_data; content:"<table"; nocase; content:"<hgroup"; nocase; fast_pattern; distance:0; content:"<a"; distance:0; nocase; content:".innerHTML"; nocase; pcre:"/^[\r\n\s]*?=/R"; content:".getElementsByTagName("; nocase; pcre:"/^[\r\n\s]*?[\x22\x27]hgroup/Ri"; content:"<table"; nocase; pcre:"/^((?!<\/table).)+?<hgroup((?!<\/hgroup>).)+?<a[>\r\n\s]((?!<\/a>).)*?<(?P<utag>(address|s(cript|ection)))[>\r\n\s]((?!(?P=utag)).)+?<\/a>/Rsi"; reference:cve,2013-3202; classtype:attempted-user; sid:2806973; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer type confusion 1 CVE-2013-3203"; flow:established,from_server; file_data; content:".onfocus"; nocase; content:".call("; nocase; pcre:"/^[\r\n\s]*?0x[a-f0-9]/Rsi"; content:"onload"; content:"function"; nocase; pcre:"/^.+?\b(?P<var1>[^\x3d\x20]+)\s*\x3d\s*[^\r\n]+?\.onfocus.+?(?P=var1)\.call\x28\s*0x[a-f0-9]/Rsi"; reference:cve,2013-3203; classtype:attempted-user; sid:2806974; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer type confusion 2 CVE-2013-3203"; flow:established,from_server; file_data; content:".onfocus"; nocase; content:".apply("; nocase; pcre:"/^[\r\n\s]*?0x[a-f0-9]/Rsi"; content:"onload"; content:"function"; nocase; pcre:"/^.+?\b(?P<var1>[^\x3d\x20]+)\s*\x3d\s*[^\r\n]+?\.onfocus.+?(?P=var1)\.apply\x28\s*0x[a-f0-9]/Rsi"; reference:cve,2013-3203; classtype:attempted-user; sid:2806975; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3205"; flow:established,from_server; file_data; content:".execCommand("; nocase; content:".write("; nocase; content:".innerHTML"; nocase; content:"onload"; nocase; content:"onbeforeeditfocus"; nocase; fast_pattern:only; content:".contentEditable"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[\x22\x27]true/Ri"; reference:cve,2013-3205; classtype:attempted-user; sid:2806976; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3206"; flow:established,from_server; file_data; content:".getElementById("; nocase; content:".contentDocument"; distance:0; content:".createRange("; nocase; content:".selectNode("; nocase; distance:0; content:".deleteContents("; nocase; distance:0; content:".insertNode("; nocase; distance:0; content:"setTimeout("; nocase; distance:0; content:"location.reload("; nocase; distance:0; content:"function"; pcre:"/^.+?\b(?P<var1>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementById\(\s*[\x22\x27]root[\x22\x27]\s*\).contentDocument.+?var (?P<var2>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?(?P=var1)\.getElementById\(\s*[\x22\x27](?P<var3>[^\x22\x27]+?)[\x22\x27]\s*\).+?var (?P<var4>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createRange\(.+?(?P=var4)\.selectNode\(\s*(?P=var2)\s*\).+?(?P=var4)\.deleteContents\(.+?(?P=var4)\.insertNode\(\s*(?P=var2)\s*\).+?setTimeout\(\s*[\x27\x22]location\.reload\(/si"; reference:cve,2013-3206; classtype:attempted-user; sid:2806977; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3207"; flow:established,from_server; file_data; content:".open("; nocase; content:".createEvent("; nocase; content:"MutationEvents"; nocase; content:"DOMNodeRemoved"; nocase; content:".initMutationEvent"; nocase; fast_pattern:only; content:"setTimeout"; nocase; content:".close("; nocase; reference:cve,2013-3207; classtype:attempted-user; sid:2806978; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3208"; flow:established,from_server; file_data; content:".getElementById("; nocase; content:".contentDocument"; fast_pattern; distance:0; content:".execCommand("; nocase; content:"selectAll"; nocase; distance:0; content:"<object"; content:" data"; distance:0; content:"onload"; content:"setTimeout("; nocase; pcre:"/^.+?\.getElementById\(\s*[\x27\x22][^\x27\x22]+?[\x27\x22]\s*\)\.(?:inner(?:HTML|Text)|outer(?:HTML|Text))[\r\n\s]*?=[\r\n\s]*?[\x22\x27][\x22\x27]/Rsi"; content:"function"; nocase; pcre:"/^.+?\b(?P<var1>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementById\(\s*[\x22\x27](?P<page2>[^\x22\x27]+?)[\x22\x27]\s*\)\.contentDocument.+?(?P=var1)\.execCommand\(.+?<object[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=page2)[\x27\x22]/Rsi"; reference:cve,2013-3208; classtype:attempted-user; sid:2806979; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3209"; flow:established,from_server; file_data; content:"onreadystatechange"; nocase; content:"document.execCommand("; nocase; pcre:"/^[\r\n\s]*?[\x22\x27]SelectAll[\x22\x27]/Ri"; content:"document.execCommand("; nocase; distance:0; pcre:"/^[\r\n\s]*?[\x22\x27]SelectAll[\x22\x27]/Ri"; content:"document.selection.clear("; nocase; content:"<fieldset"; reference:cve,2013-3209; classtype:attempted-user; sid:2806980; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3845"; flow:established,from_server; file_data; content:"getElementsByTagName("; nocase; content:"textarea"; distance:0; content:"getElementsByTagName("; distance:0; nocase; content:"textarea"; distance:0; content:".innerHTML"; nocase; fast_pattern:only; content:"var "; pcre:"/^(?P<varid1>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementsByTagName\(\s*[\x27\x22]textarea\s*[\x27\x22]\).+?(?P=varid1)\x5b[^\x5d]+?\x5d\.innerHTML[\r\n\s]*?\x3d[\r\n\s]*?.+?var (?P<varid2>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.getElementsByTagName\(\s*[\x27\x22]textarea\s*[\x27\x22]\).+?(var )?(?P<varid3>[^\r\n\s]+?)[\r\s\n]*?\x3d[\r\s\n]*?(?P=varid2)\x5b[^\x5d]+?\x5d\./Rsi"; reference:cve,2013-3845; classtype:attempted-user; sid:2806981; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible FrontPage information disclosure via XML CVE-2013-3137"; flow:established,from_server; file_data; content:"SYSTEM"; nocase; content:"file|3a|///"; nocase; distance:0; content:"<!ENTITY"; nocase; pcre:"/^[\r\n\s]+?\x25[\r\n\s]+?((?!>).)+?SYSTEM[\r\n\s]+?[\x22\x27]file\x3a\/\/\//Rsi"; reference:cve,2013-3137; classtype:attempted-recon; sid:2806983; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT MS13-055 CAnchorElement Use-After-Free"; flow:established,from_server; file_data; content:".outer"; fast_pattern; pcre:"/^(?:Text|HTML)[\r\n\s]*?=[\r\n\s]*?(?:\x22\x22|\x27\x27)/Ri"; content:".getElementById("; nocase; content:"<span"; nocase; content:"on"; pcre:"/^(?:(?:(?:s(?:elec|ubmi)|rese)t|d(?:blclick|ragdrop)|(?:mouse|key)[a-z]|c(?:hange|lick)|(?:un)?load|focus|blur)|s(?:cript|tyle=))/Ri"; content:"<table"; nocase; pcre:"/^((?!<table>).)+?<tr[\r\n\s\>]((?!<\/tr>).)*?<span[\r\n\s\>]((?!<\/span>).)*?<(?:[QU]|S(?:TR(?:IKE|ONG)|U[BP]|MALL|AMP)?|B(?:LINK|DO|IG)?|A(?:CRONYM|BBR)|R(?:[PT]|UBY)|(?:NOB|VA)R|C(?:IT|OD)E|D(?:EL|FN)|I(?:NS)?|KBD|EM|TT)[^>]*?\bid[\r\n\s]*?=/Rsi"; classtype:attempted-user; sid:2017463; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT CVE-2013-3893 IE Memory Corruption Vulnerability"; flow:established,to_client; file_data; content:"outer"; nocase; pcre:"/^(?:Text|HTML)/Ri"; content:"onlosecapture"; fast_pattern; nocase; pcre:"/^(:?([\x22\x27][\r\n\s]*?\])?[\r\n\s]*?=|[\x22\x27][\r\n\s]*?\,)[\r\n\s]*?function[\r\n\s]*?\([^\)]*?\)[\r\n\s]*?\{.*?(\b(?P<var>[^\r\n\s\=]+)[\r\n\s]*?=[\r\n\s]*?(\x22\x22|\x27\x27))?.*?document\.write\([\r\n\s]*?(\x22\x22|\x27\x27|(?P=var))[\r\n\s]*?\)/Rsi"; reference:cve,2013-3893; reference:url,blogs.technet.com/b/srd/archive/2013/09/17/cve-2013-3893-fix-it-workaround-available.aspx; classtype:attempted-user; sid:2017478; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT CVE-2013-3893 IE Memory Corruption Vulnerability"; flow:established,to_client; file_data; content:"outer"; nocase; pcre:"/^(?:Text|Html)/Ri"; content:"onlosecapture"; nocase; fast_pattern:only; content:"function"; pcre:"/^[\r\n\s]+(?P<func>[^\r\n\s]+)[\r\n\s]*?\([^\)]*?\)[\r\n\s]*?\{((?!function).)*?(\b(?P<var>[^\r\n\s\=]+)[\r\n\s]*?=[\r\n\s]*?(?:\x22\x22|\x27\x27))?((?!function).)*?document\.write\([\r\n\s]*?(?:\x22\x22|\x27\x27|(?P=var))[\r\n\s]*?\).+?onlosecapture(:?([\x22\x27][\r\n\s]*?\])?[\r\n\s]*?=|[\x22\x27][\r\n\s]*?\,)[\r\n\s]*?(?P=func)\b/Rsi"; reference:cve,2013-3893; reference:url,blogs.technet.com/b/srd/archive/2013/09/17/cve-2013-3893-fix-it-workaround-available.aspx; classtype:attempted-user; sid:2017479; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT CVE-2013-3893 IE Memory Corruption Vulnerability"; flow:established,to_client; file_data; content:"outer"; nocase; pcre:"/^(?:Text|HTML)/Ri"; content:"onlosecapture"; nocase; fast_pattern; pcre:"/^(:?([\x22\x27][\r\n\s]*?\])?[\r\n\s]*?=|[\x22\x27][\r\n\s]*?\,)[\r\n\s]*?(?!function)(?P<func>[^\r\n\s]+)\b.+?function[\r\n\s]+(?P=func)[\r\n\s]*?\([^\)]*?\)[\r\n\s]*?\{((?!function).)*?(\b(?P<var>[^\r\n\s\=]+)[\r\n\s]*?=[\r\n\s]*?(\x22\x22|\x27\x27))?((?!function).)*?document\.write\([\r\n\s]*?(\x22\x22|\x27\x27|(?P=var))[\r\n\s]*?\)/Rsi"; reference:cve,2013-3893; reference:url,blogs.technet.com/b/srd/archive/2013/09/17/cve-2013-3893-fix-it-workaround-available.aspx; classtype:attempted-user; sid:2017480; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT CVE-2013-3893 Possible IE Memory Corruption Vulnerability with HXDS ASLR Bypass"; flow:established,to_client; file_data; content:"ms-help|3a|//"; nocase; content:"onlosecapture"; nocase; fast_pattern:only; reference:cve,2013-3893; reference:url,blogs.technet.com/b/srd/archive/2013/09/17/cve-2013-3893-fix-it-workaround-available.aspx; classtype:attempted-user; sid:2017477; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3871 1"; flow:established,from_server; file_data; content:"window.navigate("; fast_pattern:only; nocase; content:"document.open"; nocase; content:"<a"; nocase; pcre:"/^\s+?[^>]*?name[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<anchor>[^\x27\x22]+?)[\x27\x22].+?window\.navigate\(\s*[\x27\x22]#(?P=anchor)[\x27\x22]\s*\)/Rsi"; reference:cve,2013-3871; classtype:attempted-user; sid:2807098; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3871 2"; flow:established,from_server; file_data; content:"window.navigate("; fast_pattern:only; content:"document.open"; nocase; content:"var"; nocase; pcre:"/^\s+?(?P<varid>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\(\s*?[\x27\x22](?P<anchor>a)[\x27\x22].+?window\.navigate\(\s*[\x27\x22](?P=varid)[\x27\x22]\s*\)/Rsi"; reference:cve,2013-3871; classtype:attempted-user; sid:2807099; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3873"; flow:established,from_server; file_data; content:"display|3a|"; nocase; content:"none"; distance:0; nocase; content:"Italic"; nocase; content:"SelectAll"; nocase; content:"colgroup{"; fast_pattern; pcre:"/^[\r\n\s]*?display\x3a[\r\n\s]*?none/Rsi"; content:"document.execCommand("; nocase; pcre:"/^\s*?[\x27\x22]Italic[\x27\x22]\s*?\x29/Rsi"; content:"document.execCommand("; nocase; pcre:"/^\s*?[\x27\x22]SelectAll[\x27\x22]\s*?\x29/Rsi"; reference:cve,2013-3873; classtype:attempted-user; sid:2807100; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3874"; flow:established,from_server; file_data; content:"document.execCommand("; nocase; pcre:"/^\s*?[\x27\x22]Delete[\x27\x22]\x2c\s*false\s*?\x29/Rsi"; content:"document.execCommand("; nocase; pcre:"/^\s*?[\x27\x22](?:removeformat|delete)[\x27\x22]/Rsi"; content:"document.execCommand("; distance:0; nocase; pcre:"/^\s*?[\x27\x22](?:removeformat|delete)[\x27\x22]/Rsi"; reference:cve,2013-3874; classtype:attempted-user; sid:2807101; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3875"; flow:established,from_server; file_data; content:"].clientWidth"; nocase; content:"<ruby"; nocase; fast_pattern:only; content:".length"; nocase; content:"document.write("; nocase; pcre:"/^\s*?[\x27\x22]<ruby/Rsi"; content:"document.getElementsByTagName("; nocase; pcre:"/^\s*?[\x27\x22]li[\x27\x22]\s*\x29\.length/Rsi"; content:"document.getElementsByTagName("; pcre:"/^\s*[\x27\x22]li[\x27\x22]\)\[[^\]+?]\]\.clientWidth/Rsi"; reference:cve,2013-3875; classtype:attempted-user; sid:2807102; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3885"; flow:established,from_server; file_data;  content:"].innerHTML"; nocase; content:"<thead"; nocase; distance:0; content:"caption"; nocase; content:"document.getElementsByTagName("; nocase; pcre:"/^\s*?[\x27\x22]caption[\x27\x22]\s*\x29\.length[\r\n\s]*?/Rsi"; content:"document.getElementsByTagName("; pcre:"/^\s*[\x27\x22]caption[\x27\x22]\)\[[^\]+?]\]\.innerHTML[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]<thead/Rsi"; reference:cve,2013-3885; classtype:attempted-user; sid:2807103; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Microsoft Internet Explorer Use-After-Free CVE-2013-3897"; flow:established,from_server; file_data; content:"onpropertychange"; fast_pattern:only; nocase; content:".execCommand("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]Unselect[\x27\x22]/Rsi"; content:"appendChild("; nocase; content:"textarea"; nocase; content:".select("; nocase; content:".onselect"; reference:cve,2013-3897; classtype:attempted-user; sid:2017572; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free CVE-2013-3845 2"; flow:established,from_server; file_data; content:"getElementsByTagName("; nocase; content:"textarea"; distance:0; content:"getElementsByTagName("; distance:0; nocase; content:"textarea"; distance:0; content:".innerHTML"; nocase; fast_pattern:only; content:"for"; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?(?P<varid1>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?\d+?[\r\n\s]*?\x3b[\r\n\s]*?(?P=varid1)[\r\n\s]*?<[\r\n\s]*?document\.getElementsByTagName\(\s*[\x27\x22]textarea\s*[\x27\x22]\)\.length[\r\n\s]*?\x3b.+?document\.getElementsByTagName\(\s*[\x27\x22]textarea\s*[\x27\x22]\)\x5b[\r\n\s]*?(?P=varid1)[\r\n\s]*?\x5d\.innerHTML[\r\n\s]*?\x3d[\r\n\s]*?/Rsi"; content:"for"; distance:0; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?(?P<varid1>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?\d+?[\r\n\s]*?\x3b[\r\n\s]*?(?P=varid1)[\r\n\s]*?<[\r\n\s]*?document\.getElementsByTagName\(\s*[\x27\x22]textarea\s*[\x27\x22]\)\.length[\r\n\s]*?\x3b.+?document\.getElementsByTagName\(\s*[\x27\x22]textarea\s*[\x27\x22]\)\x5b[\r\n\s]*?(?P=varid1)[\r\n\s]*?\x5d\.[a-z]/Rsi"; reference:cve,2013-3845; classtype:attempted-user; sid:2807157; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT SUSPICIOUS JS Multiple Debug Math.atan2 calls with CollectGarbage"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"Math.atan2"; nocase; content:"Math.atan2"; nocase; distance:0; content:"Math.atan2"; nocase; distance:0; reference:url,blog.exodusintel.com/2013/01/02/happy-new-year-analysis-of-cve-2012-4792/; reference:url,cyvera.com/cve-2013-3897-analysis-of-yet-another-ie-0-day/; classtype:attempted-user; sid:2017657; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible IE 0day CVE-2013-3918 1"; flow:established,from_server; file_data; content:"19916E01-B44E-4E31-94A4-4696DF46157B"; nocase; content:".requiredClaims"; nocase; content:".remove("; nocase; content:".add("; nocase; reference:url,www.fireeye.com/blog/technical/cyber-exploits/2013/11/operation-ephemeral-hydra-ie-zero-day-linked-to-deputydog-uses-diskless-method.html; classtype:attempted-user; sid:2017704; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible IE 0day CVE-2013-3918 2"; flow:established,from_server; file_data; content:"InformationCardSigninHelper"; nocase; content:".requiredClaims"; nocase; content:".remove("; nocase; content:".add("; nocase; reference:url,www.fireeye.com/blog/technical/cyber-exploits/2013/11/operation-ephemeral-hydra-ie-zero-day-linked-to-deputydog-uses-diskless-method.html; classtype:attempted-user; sid:2017705; rev:3;)

#
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT SUSPICIOUS WordPerfect Document with .doc extension 1"; flow:from_server,established; flowbits:isset,http.doc.download; flowbits:set,http.wpd.doc; file_data; content:"|FF 57 50 43|"; within:4; classtype:attempted-user; sid:2807198; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT SUSPICIOUS WordPerfect Document with .doc extension 2"; flow:from_server,established; content:"Content-Disposition|3a| "; http_header; pcre:"/filename\s*?=\s*?[\x22\x27]?[^\x22\x27\r\n]+?\.doc[\x22\x27]?\r\n/Hi"; file_data; content:"|FF 57 50 43|"; fast_pattern; within:4; flowbits:set,http.wpd.doc; classtype:attempted-user; sid:2807199; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT POSSIBLE CVE-2013-1324 CVE-2013-1325 EXPLOIT WordPerfect Document"; flow:from_server,established; flowbits:isset,http.wpd.doc; file_data; content:"|d2 0b|"; content:"|dc 01|"; distance:0; content:"|01 dc|"; distance:0; content:"|0b d2|"; distance:0; classtype:attempted-user; sid:2807200; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3871) 1"; flow:from_server,established; file_data; content:"document.open("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]text\/html[\x27\x22][\r\n\s]*?\)/Rsi"; content:"<a "; nocase; pcre:"/^[^>]*?name[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<element>[^\x22\x27]+?)[\x27\x22].+?window\.navigate\([\r\n\s]*?[\x27\x22]#(?P=element)[\x27\x22][\r\n\s]*?\)/Rsi"; classtype:attempted-user; sid:2807201; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3871) 2"; flow:from_server,established; file_data; content:"document.open("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]text\/html[\x27\x22][\r\n\s]*?\)/Rsi"; content:"document.createElement("; nocase; pcre:"/\b(?P<var>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document.createElement\x28[\r\n\s]*?[\x27\x22]a[\x27\x22][\r\n\s]*?\x29.+?\.appendChild\([\r\n\s]*?(?P=var)\s*?\).+?window\.navigate\([\r\n\s]*?[\x27\x22]?(?P=var)[\x27\x22]?/si"; classtype:attempted-user; sid:2807202; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3871) 3"; flow:from_server,established; file_data; content:"document.open("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]text\/html[\x27\x22][\r\n\s]*?\)/Rsi"; content:"document.createElement("; nocase; content:"window.navigate("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]?(?P<var>[^\x22\x27\x29]+?)[\x27\x22]?\x29.+?\b(?P=var)[\r\n\s]*?\x3d[\r\n\s]*?document.createElement\x28[\r\n\s]*?[\x27\x22]a[\x27\x22][\r\n\s]*?\x29.+?\.appendChild\([\r\n\s]*?(?P=var)\s*?\).+?/Rsi"; classtype:attempted-user; sid:2807203; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3871) 4"; flow:from_server,established; file_data; content:"document.open("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]text\/html[\x27\x22][\r\n\s]*?\)/Rsi"; content:"window.navigate("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]?#?(?P<elem>[^\x22\x27\x29]+?)[\x27\x22]?\x29.+?<a [^>]*?name[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=elem)[\x27\x22]/Rsi"; classtype:attempted-user; sid:2807204; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3910)"; flow:from_server,established; file_data; content:"document.createElement("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]track[\x27\x22][\r\n\s]*?\)/Rsi"; content:"document.body.innerHTML"; nocase; content:"document.execCommand("; nocase; distance:0; pcre:"/^[\r\n\s]*?[\x22\x27]SelectAll[\x22\x27][\r\n\s]*?\)/Rsi"; content:"document.selection"; nocase; fast_pattern; content:".createRange("; nocase; distance:0; classtype:attempted-user; sid:2807205; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3911) 1"; flow:from_server,established; file_data; content:"document.createElement("; nocase; pcre:"/[\r\n\s]*?[\x27\x22]canvas[\x27\x22][\r\n\s]*?\)/Rsi"; content:".createControlRange("; nocase; fast_pattern:only; content:".select("; nocase; content:".addBehavior("; nocase; pcre:"/^[\r\n\s]*?[\x22\x27]#default#VML[\x22\x27][\r\n\s]*?\)/Rsi"; classtype:attempted-user; sid:2807206; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3911) 2"; flow:from_server,established; file_data; content:"<canvas"; nocase; content:".createControlRange("; nocase; content:".select("; nocase; content:".addBehavior("; nocase; pcre:"/^[\r\n\s]*?[\x22\x27]#default#VML[\x22\x27][\r\n\s]*?\)/Rsi"; classtype:attempted-user; sid:2807207; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3912)"; flow:from_server,established; file_data; content:"document.selection.createRange("; nocase; fast_pattern:11,20; pcre:"/^[\r\n\s]*?\)/Rsi"; content:".pasteHTML("; within:11; nocase; content:".setStart("; nocase; content:".setEnd("; nocase; content:"getSelection("; nocase; pcre:"/^[\r\n\s]*?\)/Rsi"; content:".removeAllRanges("; within:17; nocase; content:"CollectGarbage("; nocase; classtype:attempted-user; sid:2807208; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3914)"; flow:from_server,established; file_data; content:"document.createRange("; nocase; content:".setStart("; nocase; content:".setEnd("; nocase; content:"getSelection("; nocase; fast_pattern:only; content:"document.execCommand("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22](?:un|re)do[\x27\x22]/Rsi"; content:"document.execCommand("; nocase; distance:0; pcre:"/^[\r\n\s]*?[\x27\x22](?:un|re)do[\x27\x22]/Rsi"; content:"document.execCommand("; nocase; distance:0; pcre:"/^[\r\n\s]*?[\x27\x22](?:un|re)do[\x27\x22]/Rsi"; classtype:attempted-user; sid:2807209; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3915)"; flow:from_server,established; file_data; content:"document.body.contentEditable"; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[\x27\x22]true[\x27\x22]/Rsi"; content:"document.createElement("; nocase; content:".appendChild("; nocase; content:".appendChild("; nocase; distance:0; content:"document.execCommand("; nocase; pcre:"/[\r\n\s]*?[\x27\x22]undo[\x27\x22]/Rsi"; content:"document.execCommand("; nocase; pcre:"/[\r\n\s]*?[\x27\x22]undo[\x27\x22]/Rsi"; classtype:attempted-user; sid:2807210; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3916)"; flow:from_server,established; file_data; content:"InsertInputReset"; nocase; fast_pattern:only; content:".onresize"; nocase; content:"onselectstart"; nocase; content:"onload"; nocase; content:".innerHTML"; nocase; content:"<body"; nocase; pcre:"/^[^>]*?(?:onload[^>]+?onselect|onselect[^>]+?onload)/Ri"; content:"body.contentEditable"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[\x22\x27]?false/Rsi"; content:"body.contentEditable"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[\x22\x27]?true/Rsi"; reference:cve,2013-3916; classtype:attempted-user; sid:2807211; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use-After-Free (CVE-2013-3917)"; flow:from_server,established; file_data; content:"document.designMode"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[\x27\x22]off[\x27\x22]/Rsi"; content:"contenteditable"; nocase; pcre:"/^[\r\n\s]*?=[\r\n\s]*?[\x27\x22]true[\x27\x22]/Rsi"; content:"onresize"; nocase; content:".outerHTML"; nocase; content:"document.getElementById("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22](?P<element>[^\x27\x22]+?)[\x27\x22][\r\n\s]*?\)\.outerHTML.+?<div [^>]*?(id[\r\n\s]*?=[\r\n\s]*?[\x27\x22](?P=element)[\x27\x22][^>]+?onresize|onresize[^>]+?id[\r\n\s]*?=[\r\n\s]*?[\x27\x22](?P=element)[\x27\x22])/Rsi"; content:"document.execCommand("; nocase; pcre:"/^[\r\n\s]*?[\x27\x22]undo[\x27\x22]/Rsi"; classtype:attempted-user; sid:2807212; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible IE 0day CVE-2013-3918 3"; flow:established,from_server; file_data; content:"19916E01-B44E-4E31-94A4-4696DF46157B"; nocase; content:"|5c|u"; content:"|5c|u"; distance:4; within:4; content:"|5c|u"; distance:4; within:4; pcre:"/^\{?[a-fA-F0-9]{4}\}?(\x5cu\{?[a-fA-F0-9]{4}\}?){20}/Rs"; reference:url,www.fireeye.com/blog/technical/cyber-exploits/2013/11/operation-ephemeral-hydra-ie-zero-day-linked-to-deputydog-uses-diskless-method.html; classtype:attempted-user; sid:2017708; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible IE 0day CVE-2013-3918 4"; flow:established,from_server; file_data; content:"19916E01-B44E-4E31-94A4-4696DF46157B"; nocase; content:"|25|u"; content:"|25|u"; distance:4; within:4; content:"|25|u"; distance:4; within:4; pcre:"/^\{?[a-fA-F0-9]{4}\}?(\x25u\{?[a-fA-F0-9]{4}\}?){20}/Rs"; reference:url,www.fireeye.com/blog/technical/cyber-exploits/2013/11/operation-ephemeral-hydra-ie-zero-day-linked-to-deputydog-uses-diskless-method.html; classtype:attempted-user; sid:2017709; rev:3;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT CVE-2013-3908 IE information disclosure"; flow:to_server,established; content:"<meta"; nocase; http_uri; fast_pattern:only; content:"<img"; nocase; http_uri; content:"src="; nocase; distance:0; http_uri; pcre:"/<meta[^&]+?<img[^&>]+?src=[\x22\x27]https?[^>]+?(:?&|$)/Ui"; classtype:attempted-recon; sid:2807213; rev:8;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Acrobat Reader Font Memory Corruption Vulnerability CVE-2013-3353"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"/FontFile2"; content:"stream"; pcre:"/^[\r\n\s]*(?:OTTO|\x00\x01\x00\x00|t(?:rue|yp1))/R"; byte_extract:2,0,table_entries,relative,multiplier 16; content:!"endstream"; distance:4; within:table_entries; content:"head"; distance:4; within:table_entries; byte_test:4,>,54,8,relative; reference:cve,CVE-2013-3353; classtype:attempted-user; sid:2807231; rev:7;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file corrupted download  (CVE-2013-3355) 1"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"/Fields"; content:"/Parent"; content:"/Kids"; pcre:"/\b(?P<obj1>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/Kids[\r\n\s]*?\[[^\]]+?(?P<obj1kid>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?R[^\]]+?\]((?!>>).)*?(((?!\/FT).)*?((?!\/Tx).)*?((?!\/Parent).)*?\/(T[UM]?|Ff|V|DV|AA)).+?>>[\r\n\s]*?endobj.+?\b(?P<objR>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/Fields[\r\n\s]*?\[[\r\n\s]*?(?P=obj1)[\r\n\s]*?\d+?[\r\n\s]*?R.+?\b(?P=obj1kid)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/Parent[\r\n\s]*?(?P=obj1)[\r\n\s]*?\d+?[\r\n\s]*?R/si"; reference:cve,2013-3351; classtype:attempted-user; sid:2807237; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file corrupted download  (CVE-2013-3355) 2"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"/Fields"; content:"/Parent"; content:"/Kids"; pcre:"/\b(?P<obj1>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/Kids[\r\n\s]*?\[[^\]]+?(?P<obj1kid>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?R[^\]]+?\]((?!>>).)*?(((?!\/FT).)*?((?!\/Tx).)*?((?!\/Parent).)*?\/(T[UM]?|Ff|V|DV|AA)).+?>>[\r\n\s]*?endobj.+?\b(?P=obj1kid)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/Parent[\r\n\s]*?(?P=obj1)[\r\n\s]*?\d+?[\r\n\s]*?R.+?\b(?P<objR>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/Fields[\r\n\s]*?\[[\r\n\s]*?(?P=obj1)[\r\n\s]*?\d+?[\r\n\s]*?R/si"; reference:cve,2013-3351; classtype:attempted-user; sid:2807238; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file corrupted download (CVE-2013-3351) 1"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"endobj"; fast_pattern:only; content:"/K"; pcre:"/^[\r\n\s]*?\d+?[\r\n\s]*?\d+? R/R"; content:"/K"; distance:0; pcre:"/^[\r\n\s]*?\d+?[\r\n\s]*?\d+?[\r\n\s]*?R/R"; pcre:"/\b(?P<obj1>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*?<<[\r\n\s]*?((?!>>).)*?\/K[\r\n\s]*?(?P<obj1kid>[0-9]+?)[\r\n\s]*?\d+?[\r\n\s]*?R.+?>>.+?\b(?P=obj1kid)[\r\n\s]*?\d+?[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/K[\r\n\s]*?(?P=obj1)[\r\n\s]*?\d+?[\r\n\s]*?R/si"; reference:cve,2013-3351; classtype:attempted-user; sid:2807239; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file corrupted download (CVE-2013-3351) 2"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"endobj"; fast_pattern:only; content:"/K"; pcre:"/^[\r\n\s]*?\d+?[\r\n\s]*?\d+?[\r\n\s]*?R/R"; content:"/K"; distance:0; pcre:"/^[\r\n\s]*?\d+?[\r\n\s]*?\d+?[\r\n\s]*?R/R"; pcre:"/\b(?P<obj1>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?\/K[\r\n\s]*?(?P=obj1)[\r\n\s]*?\d+[\r\n\s]*?R/si"; reference:cve,2013-3351; classtype:attempted-user; sid:2807240; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file corrupted download (CVE-2013-3351) 3"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"endobj"; fast_pattern:only; content:"/K"; pcre:"/^[\r\n\s]*?\d+?[\r\n\s]*?\d+?[\r\n\s]*?R/R"; content:"/K"; distance:0; pcre:"/^[\r\n\s]*?\d+?[\r\n\s]*?\d+?[\r\n\s]*?R/R"; pcre:"/\b(?P<obj1>[0-9]+)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*<<[\r\n\s]*((?!>>).)*?(\/P[\r\n\s]*?(?P<parent>[0-9]+?)[\r\n\s]*?\d+[\r\n\s]*?R((?!>>).)*?\/K[\r\n\s]*?(?P=parent)|\/K[\r\n\s]*?(?P<kid>[0-9]+?) \d+[\r\n\s]*?R((?!>>).)*?\/P[\r\n\s]*?(?P=kid))/si"; reference:cve,2013-3351; classtype:attempted-user; sid:2807241; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE noembed user after free CVE-2013-5049"; flow:from_server,established; file_data; content:"onerror"; nocase; content:".parentNode.removeChild"; nocase; content:"location.reload"; nocase; content:"setTimeout"; nocase; content:"<noembed"; nocase; fast_pattern; pcre:"/^((?!<\/noembed>).)*?<object((?!<\/object>).)*\bonerror[\r\n\s]*?=/Rsi"; pcre:"/\b(?P<name>.+)\.parentNode\.removeChild\([\r\n\s]*?(?P=name)[\r\n\s]*?\)/i"; reference:cve,2013-5049; classtype:attempted-user; sid:2807298; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE CViewportChangeInvalidation User-After-Free CVE-2013-5051"; flow:from_server,established; file_data; content:"<a"; nocase; pcre:"/^[\r\n\s\>]((?!<\/a>).)*?<i[\r\n\s\>]((?!<\/i>).)*?<\/a>((?!<\/i>).)*?<marquee/Rsi"; content:"</i>"; nocase; distance:0; content:"<marquee"; nocase; fast_pattern:only; reference:cve,2013-5051; classtype:attempted-user; sid:2807299; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE OnControlSelect Memory Corruption CVE-2013-5052 1"; flow:from_server,established; file_data; content:"document.write"; nocase; pcre:"/^[\r\n\s]*?\([\r\n\s]*?(?:\x22\x22|\x27\x27)[\r\n\s]*?\)/R"; content:"oncontrolselect"; fast_pattern; nocase; pcre:"/^(?:[\r\n\s]*?=|[\x22\x27]?[\r\n\s]*?\,)[\r\n\s]*?([\x22\x27]?function[\r\n\s]*?\([^\)]*?\)[\r\n\s]*?\{?((?!function).)*?)?[\x22\x27]?document.write[\r\n\s]*?\([\r\n\s]*?(?:\x22\x22|\x27\x27)[\r\n\s]*?\)/Ri"; reference:cve,2013-5052; classtype:attempted-user; sid:2807300; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE OnControlSelect Memory Corruption CVE-2013-5052 2"; flow:from_server,established; file_data; content:"document.write"; nocase; pcre:"/^[\r\n\s]*?\([\r\n\s]*?(?:\x22\x22|\x27\x27)[\r\n\s]*?\)/R"; content:"oncontrolselect"; nocase; fast_pattern; pcre:"/^(?:[\r\n\s]*?=|[\x22\x27]?[\r\n\s]*?\,)[\r\n\s]*?[\x22\x27]?document.write[\r\n\s]*?\([\r\n\s]*?(?:\x22\x22|\x27\x27)[\r\n\s]*?\)/Ri"; reference:cve,2013-5052; classtype:trojan-activity; sid:2807301; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Scripting Dictionary User-After-Free CVE-2013-5056"; flow:from_server,established; file_data; content:"vbscript"; nocase; content:"sub"; nocase; pcre:"/^[\r\n\s]+?/R"; content:"Class_Terminate"; nocase; content:"RemoveAll("; nocase; content:"RemoveAll("; nocase; distance:0; reference:cve,2013-5056; classtype:attempted-user; sid:2807302; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe PDF file download with corrupted JBIG2 file"; flow:from_server,established; file_data; flowbits:isset,ET.pdf.in.http; content:"/JBIG2Globals"; pcre:"/\b(?P<obj1>[0-9]+?)[\r\n\s]*?\d+[\r\n\s]*?obj[\r\n\s]*?<<[\r\n\s]*?\/Length[\r\n\s]+?\d+?[\r\n\s]+?\x3e\x3e[\r\n\s]*?stream[\r\n\s]+?\x00{4}\x28[\x01\x02\x03\x04\x05\x06\x07].+?\/JBIG2Globals[\r\n\s]*?(?P=obj1)[\r\n\s]*?\d+?[\r\n\s]*?R[\r\n\s]/si"; reference:cve,2013-3352; classtype:not-suspicious; sid:2807399; rev:3;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF use after free (CVE-2014-0496) 1"; flow:established,to_client; file_data; content:"%PDF-"; content:"OpenAction"; nocase; distance:0; content:"addToolButton"; nocase; distance:0; pcre:"/^[\r\n\s]*?\([\r\n\s]*?\{[\r\n\s]*?(?:(?!addtoolbutton).)*?cName[\r\n\s]*?\x3a[\r\n\s]*?[\x22\x27](?P<buttonname>[^\x22\x27]+)[\x22\x27](?:(?!addtoolbutton).)*?removetoolbutton[\r\n\s]*?\([\r\n\s]*?[\x22\x27](?P=buttonname)[\x22\x27]/Rsi"; content:"removeToolButton"; nocase; fast_pattern:only; reference:cve,2014-0496; classtype:attempted-user; sid:2807511; rev:1;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF use after free (CVE-2014-0496) 2"; flow:established,to_client; file_data; content:"%PDF-"; content:"OpenAction"; nocase; distance:0; content:"addToolButton"; nocase; distance:0; pcre:"/^[\r\n\s]*?\([\r\n\s]*?\{[\r\n\s]*?(?:(?!addtoolbutton).)*?removetoolbutton[\r\n\s]*?\([\r\n\s]*?[\x22\x27](?P<buttonname>[^\x22\x27]+)[\x22\x27](?:(?!addtoolbutton).)*?cName[\r\n\s]*?\x3a[\r\n\s]*?[\x22\x27](?P=buttonname)[\x22\x27]/Rsi"; content:"removeToolButton"; nocase; fast_pattern:only; reference:cve,2014-0496; classtype:attempted-user; sid:2807512; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT PDF Malformed Pattern Entry"; flow:from_server,established; file_data; content:"%PDF-"; within:5; fast_pattern; content:"/Resources"; nocase; content:"/Pattern"; nocase; content:"obj"; pcre:"/^\s+(<<\s*?)?\/Pattern\s+?(>>\s*?)?endobj/Rsi"; reference:cve,CVE-2014-0495; classtype:attempted-user; sid:2807609; rev:2;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_CLIENT BeEF Cookie Outbound"; flow:to_server,established; content:"Cookie|3a 20|BEEFSESSION="; fast_pattern:only; threshold: type limit, track by_src, seconds 300, count 1; reference:url,beefproject.com; classtype:attempted-user; sid:2018088; rev:2;)

#
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible BeEF Default SSL Cert"; flow:established,from_server; content:"|0b|Bovine Land"; fast_pattern; content:"|1e|Browser Exploitation Framework"; classtype:attempted-user; sid:2018089; rev:1;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible BeEF Module in use"; flow:established,from_server; file_data; content:"beef.execute"; pcre:"/^\s*?\(/Rs"; threshold: type limit, track by_src, seconds 300, count 1; classtype:attempted-user; sid:2018090; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft XML Core Services 3.0 same-origin policy bypass (CVE-2014-0266)"; flow:from_server,established; file_data; content:"Msxml2.FreeThreadedDomDocument.3.0"; fast_pattern:only; content:"loadXML"; content:"transformNode"; content:"<xml"; content:"<xsl:stylesheet"; content:"<msxsl:script"; content:"Msxml2.XMLHTTP.3.0"; content:".open"; pcre:"/^[\r\n\s]*?[\x22\x27]GET[\x22\x27]/R"; content:".send"; content:"<base"; content:"file|3a 2f 2f|"; distance:0; reference:cve,2014-0266; classtype:attempted-recon; sid:2807640; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0270)"; flow:to_client,established; file_data; content:"<nl"; pcre:"/^[\s>](?:(?!<\/nl>).)+?<ruby[\s>]/Rsi"; content:"<ruby>"; fast_pattern:only; reference:cve,2014-0270; classtype:attempted-user; sid:2807641; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0271)"; flow:to_client,established; file_data; content:"vbscript"; content:"Property"; content:"Class"; fast_pattern; pcre:"/^[\r\n\s]+?(?P<class>[^\r\n\s]+?)[\r\n\s]+?.+?Property[\r\n\s]+?Get[\r\n\s]*?(?P<property>[^\r\n\s]+?)[\r\n\s]+?((?!(?P=property)).)+?End Property.+?Set[\r\n\s]+?(?P<classinst>[^\r\n\s]+?)[\r\n\s]+?\x3d[\r\n\s]+?new[\r\n\s]+?(?P=class).+?j(ava)?script.+?(?P=classinst)\x28/Rsi"; reference:cve,2014-0271; classtype:attempted-user; sid:2807642; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0273)"; flow:to_client,established; file_data; content:"CollectGarbage("; fast_pattern:only; content:".swapNode("; content:".focus("; content:"var "; pcre:"/^[\r\n\s]*?(?P<var1>[^\r\n\s]+?).+?(?P=var1)\.swapNode.+?CollectGarbage\x28.+?(?P=var1)\.focus\x28.+?CollectGarbage\x28/Rsi"; content:"function "; pcre:"/^[\r\n\s]*?(?P<function1>[^\r\n\s\x28]+?)\x28.+?\.swapNode\x28.+?CollectGarbage\(.+?onfocusin[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=function1)\x28/Rsi"; reference:cve,2014-0273; classtype:attempted-user; sid:2807643; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0274)"; flow:to_client,established; file_data; content:".addEventListener("; pcre:"/^\s*?[\x27\x22]DOMNodeRemoved[\x27\x22]/Rsi"; content:".removeEventListener("; pcre:"/^\s*?[\x27\x22]DOMNodeRemoved[\x27\x22]/Rsi"; content:"getSelection().removeAllRanges("; distance:0; content:"getSelection().selectAllChildren("; content:"getSelection().deleteFromDocument("; distance:0; reference:cve,2014-0274; classtype:attempted-user; sid:2807644; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0275)"; flow:to_client,established; file_data; content:"CollectGarbage("; fast_pattern:only; content:"<area"; content:".setTimeout("; content:"<map "; pcre:"/^[^>]*?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<map>[^\r\n\s]+?)[\x27\x22]((?!(<\/map>)).)+?<area[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<area>[^\r\n\s]+?)[\x27\x22].+?<img[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<img>[^\r\n\s]+?)[\x27\x22][^>]+?usemap[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]#(?P=map)[\x27\x22].+?\.setTimeout\(.+?(?P=area)\.attachEvent\(\s*?[\x27\x22]onfocusin[\x27\x22].+?\.setTimeout\(.+?(?P=img)\.focus.+?(?P=area)\.detachEvent\(\s*?[\x22\x27]onfocusin[\x22\x27]/Rsi"; reference:cve,2014-0275; classtype:attempted-user; sid:2807645; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0276) 1"; flow:to_client,established; file_data; content:"<body "; nocase; content:"style"; nocase; distance:0; content:"position"; nocase; distance:0; content:"absolute"; fast_pattern; nocase; within:100; content:"<a"; nocase; content:"style"; nocase; distance:0; content:"position"; distance:0; nocase; content:"relative"; within:100; content:"<body"; nocase; pcre:"/^[^>]*?style\s*?=\s*?[\x22\x27]*?position\s*?\x3a\s*?absolute(?:(?!<\/body).)+?<a\s[^>]*?style\s*?=\s*?[\x22\x27]*?position\s*?\x3a\s*?relative/Rsi"; reference:cve,2014-0276; classtype:attempted-user; sid:2807647; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0276) 2"; flow:to_client,established; file_data; content:"<style"; content:"body"; nocase; distance:0; content:"position"; nocase; distance:0; content:"absolute"; fast_pattern; content:"<a"; nocase; content:"style"; nocase; distance:0; content:"position"; distance:0; nocase; content:"relative"; within:100; content:"<style"; nocase; pcre:"/^[\s>](?:(?!<\/style>).)*?\bbody\s*?\{[^\}]*?position\s*?\x3a\s*?absolute\s*?\x3b/Rsi"; content:"<body"; pcre:"/^[\s>](?:(?!<\/body).)+?<a\s[^>]*?style\s*?=\s*?[\x22\x27]*?position\s*?\x3a\s*?relative/Rsi"; reference:cve,2014-0276; classtype:attempted-user; sid:2807648; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0276) 3"; flow:to_client,established; file_data; content:"body"; nocase; distance:0; content:"position"; nocase; distance:0; content:"absolute"; fast_pattern; content:"a"; nocase; content:"position"; distance:0; nocase; content:"relative"; within:100; content:"<style"; pcre:"/^[\s>](?:(?!<\/style>).)*?\b(?:a\s*?(\x3a\s*?[a-zA-Z]+\s*?)?\{[^}]*?position\s*?:\s*?relative(?:(?!<\/style>).)+?\bbody\s*?\{[^}]*?position\s*?:\s*?absolut|body\s*?\{[^}]*?position\s*?:\s*?absolute(?:(?!<\/style>).)+?\ba\s*?(\x3a\s*?[a-zA-Z]+\s*?)?\{[^}]*?position\s*?:\s*?relativ)e/Rsi"; content:"<body"; nocase; pcre:"/^(?:(?!<\/body).)+?<a/Rsi"; reference:cve,2014-0276; classtype:attempted-user; sid:2807649; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0277) 1"; flow:to_client,established; file_data; content:".appendChild("; content:".children["; fast_pattern; content:"setTimeout("; content:".getElementById("; pcre:"/^\s*[\x22\x27](?P<table>[^\r\n\s\x22\x27]+?)[\x22\x27]\s*\)\.appendChild\(\s*?[^\x29]+?\.children\[.+\.getElementById\(\s*[\x27\x22](?P<div>[^\r\n\s\x22]+?).+?setTimeout\(.+?<div[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=div)[\x27\x22].+?<table[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=table)[\x27\x22]/Rsi"; content:".innerHTML"; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]{2}/Rsi"; reference:cve,2014-0277; classtype:attempted-user; sid:2807650; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0277) 2"; flow:to_client,established; file_data; content:".appendChild("; content:".children["; fast_pattern; content:"setTimeout("; content:".getElementById("; pcre:"/^\s*[\x22\x27](?P<table>[^\r\n\s\x22\x27]+?)[\x22\x27]\s*\)\.appendChild\(\s*?[^\x29]+?\.children\[.+\.getElementById\(\s*[\x27\x22](?P<div>[^\r\n\s\x22]+?).+?setTimeout\(.+?<table[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=table)[\x27\x22].+?<div[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=div)[\x27\x22]/Rsi"; content:".innerHTML"; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]{2}/Rsi"; reference:cve,2014-0277; classtype:attempted-user; sid:2807651; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0279)"; flow:to_client,established; file_data; content:".outerText"; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27]\x26nbsp\x3b[\x22\x27].+?\.cssText[\r\n\s]*?\+=[\r\n\s]*?[\x27\x22]div\x3afirst-letter{background\x3a#/Rsi"; content:"div|3a|first-letter{"; fast_pattern:only; content:"setTimeout("; reference:cve,2014-0279; classtype:attempted-user; sid:2807652; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0281)"; flow:to_client,established; file_data; content:"document.body.offsetHeight"; content:".deleteRule("; content:"CollectGarbage("; fast_pattern:only; content:"<style "; pcre:"/^[^>]*?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<style>[^\r\n\s]+?)[\x27\x22].+?\.getElementById\(\s*[\x22\x27](?P=style)[\x22\x27]\s*\)\.textContent.+?document\.body\.offsetHeight.+?document\.documentElement\.innerText.+?document\.styleSheets\[\d+\]\.deleteRule\(.+?document\.styleSheets\[\d+\]\.deleteRule\(.+?CollectGarbage\(.+?document\.body\.offsetHeight/Rsi"; reference:cve,2014-0281; classtype:attempted-user; sid:2807653; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0283)"; flow:to_client,established; file_data; content:"<svg"; nocase; fast_pattern:only; content:"setTimeout"; nocase; content:"document.body.innerHTML"; nocase; pcre:"/^\s*?=/Rsi"; reference:cve,2014-0283; classtype:attempted-user; sid:2807654; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0284)"; flow:to_client,established; file_data; content:"<style"; nocase; content:"@font-face"; nocase; distance:0; content:".innerHTML"; nocase; content:"style.fontFamily"; nocase; distance:0; content:"window.onload"; nocase; content:"<style"; pcre:"/^[^>]*?\sid\s*?=\s*?[\x22\x27](?P<id>[^\x22\x27]+)[\x22\x27](?:(?!<\/style>).)+?@font-face.+?<\/style>.+?\s(?P<var_name>[^\s\x3d]+)\s*?=\s*?document\.getElementById\s*?\(\s*?[\x22\x27](?P=id)[\x22\x27].+\s(?P<div>[^\.]+)\.innerHTML\s*?(?:\+\s*?)?=.+?(?P=div)\.style.fontFamily\s*?(?:\+\s*?)?=.+?\s(?P=var_name)\./Rsi"; reference:cve,2014-0284; classtype:attempted-user; sid:2807655; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0285)"; flow:to_client,established; file_data; content:"<legend"; nocase; fast_pattern:only; content:"onload"; nocase; content:"window.navigate("; nocase; content:"onactivate"; content:"document.open("; content:"function "; pcre:"/^(?P<func>[^\r\n\s\x28]+?)\x28.+?window.navigate\(\s*[\x27\x22]#(?P<legend>[^\r\n\s\x27\x22]+?)[\x22\x27].+?<body[\r\n\s]*?onload[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27](?P=func)\x28/Rsi"; reference:cve,2014-0285; classtype:attempted-user; sid:2807656; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0286)"; flow:to_client,established; file_data; content:"<form"; pcre:"/^[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<form>[^\r\n\s]+?)[\x27\x22]((?!<\/form).)+?<input[^>]+?type[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]radio[^>]+?onpropertychange[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<func>[^\r\n\s\x28]*?).+?function (?P=func).+?(?P=form)\.innerHTML[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]text[\x27\x22]/Rsi"; content:"onpropertychange"; fast_pattern:only; content:".innerHTML"; reference:cve,2014-0286; classtype:attempted-user; sid:2807657; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0287)"; flow:to_client,established; file_data; content:"setTimeout"; nocase; content:"document.appendChild"; nocase; pcre:"/^\s*?\(\s*?document\s*?\)/Rsi"; content:"document.body.selectionEnd"; nocase; distance:0; content:"document.execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]SelectAll[\x22\x27]/Rsi"; content:"document.open"; nocase; pcre:"/^\s*?\(\s*?\)/Rs"; content:"<body"; nocase; pcre:"/^[^>]*?\son(?P<evt_handler>[a-z]+)\s*?=[^>]*?\son(?:(?!(?P=evt_handler))[a-z])+?\s*?=/Rsi"; reference:cve,2014-0287; classtype:attempted-user; sid:2807658; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0288)"; flow:to_client,established; file_data; content:"createAttributeNS"; pcre:"/[\r\s\n]*?(?P<obj_var>[^\r\s\n]+?)[\r\s\n]*?=[\r\s\n]*?(?P<docobj_var>[^\r\s\n]+?)\.createAttributeNS[\r\n\s]*?\(.*?[\x22\x27](?:id|name)[\x22\x27].+?(?P=docobj_var)\.getelementbyid[\r\s\n]*?\([\x22\x27](?P<elementid>[^\r\s\n]+?)[\x22\x27][\r\s\n]*?\)\.setattributenode[\r\s\n]*?\([\r\s\n]*?(?P=obj_var)[\r\s\n]*?\).+?[\r\s\n]*?(?P<elem_var>[^\r\s\n]+?)[\r\s\n]*?=[\r\s\n]*?(?P=docobj_var)\.getElementsByTagName.+?(?P=elem_var)\[\d\]\.clonenode\(\d\)\.appendchild[\r\s\n]*?\([\r\s\n]*?(?P=docobj_var)\.getelementbyid[\r\s\n]*?\([\r\s\n]*?[\x22\x27](?P=elementid)[\x22\x27][\r\s\n]*?\)/si"; reference:cve,2014-0288; classtype:trojan-activity; sid:2807659; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Microsoft Internet Explorer Use After free (CVE-2014-0289)"; flow:to_client,established; file_data; content:"appendChild"; nocase; content:"createTextNode"; fast_pattern:only; content:"createRange"; nocase; content:"getSelection"; nocase; pcre:"/^\s*?\([^\)]*?\)\.addRange/Rsi"; content:".execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]delete[\x22\x27]/Rsi"; content:".lastChild"; nocase; distance:0; content:".execCommand"; nocase; distance:0; pcre:"/^\s*?\(\s*?[\x22\x27]undo[\x22\x27]/Rsi"; reference:cve,2014-0289; classtype:trojan-activity; sid:2807660; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free 1 (CVE-2014-0290)"; flow:to_client,established; file_data; content:"swapNode"; nocase; content:"Undo"; nocase; content:"contentEditable"; nocase; content:"InsertUnorderedList"; nocase; pcre:"/.+?(?P<swapnode>[^\r\n\s\x22]+?)\.swapnode[\r\n\s]*?\([\r\n\s]*?[^\r\n\s]+?[\r\n\s]*?\).+?undo.+?<p[\r\n\s]+?id=[\r\n\s]*?(?P=swapnode)/Rsi"; reference:cve,2014-0290; classtype:trojan-activity; sid:2807661; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free 2 (CVE-2014-0290)"; flow:to_client,established; file_data; content:"InsertUnorderedList"; nocase; content:"swapNode"; nocase; content:"contentEditable"; nocase; content:"Undo"; nocase; pcre:"/.+?<[\r\n\s]*?p[\r\n\s]*?id=(?P<swapnode>[^\r\n\s]+)[\r\n\s]*?\/?>.+InsertUnorderedList.+?(?P=swapnode)\.swapnode.+?undo/Rsi"; reference:cve,2014-0290; classtype:trojan-activity; sid:2807662; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible IE10 Use After Free CVE-2014-0322"; flow:established,to_client; file_data; content:"onpropertychange"; nocase; fast_pattern:only; content:".outerHTML"; pcre:"/^\s*?=\s*?[^\s]+?\.outerHTML/Rsi"; content:"appendChild"; nocase; content:"getElementsByTagName"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]script[\x22\x27].+?\s(?P<vname>[^\s]+)\.onpropertychange\s*=.+?\s(?P<vname2>[^\s\x3d]+)\s*?=\s*?[^\s]*?createElement\s*?\(\s*?[\x22\x27]select[\x22\x27].+?(?P=vname)\.appendChild\(\s*?[\x22\x27]?(?P=vname2)[\x22\x27]?/Rsi"; reference:cve,2014-0322; classtype:attempted-user; sid:2018147; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT EMET Detection Via XMLDOM"; flow:established,from_server; file_data; content:"loadXML"; nocase; content:"parseError"; nocase; content:"res:/"; content:"AppPatch"; nocase; distance:0; pcre:"/^.+?\bEMET\.DLL/Rsi"; content:"EMET.DLL"; nocase; fast_pattern:only; classtype:attempted-user; sid:2018152; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Double Free CVE-2014-0493 1"; flow:from_server,established; file_data; content:"DCTDecode"; nocase; fast_pattern:only; content:"/XObject"; nocase; content:"/AP"; nocase; content:"/Widget"; nocase; pcre:"/^(?:(?!endobj).)*?\/AP\s*?<<\s*?(?:(?!>>).)*?\/N\s*(?P<relativ_o>((?!\s*R).)+)\s*R.+?\s(\d+\s)*?(?P=relativ_o)\s*?obj\s*?<<(?:(?!endobj).)*?\/(?:Filter.+?DCTDecode(?:(?!endobj).)*?\/(?:SubType\s*?\/Image(?:(?!endobj).)*?\/Type\s*?\/XObject|Type\s*?\/XObject(?:(?!endobj).)*?\/SubType\s*?\/Image)|SubType\s*?\/Image(?:(?!endobj).)*?\/(?:Filter.+?DCTDecode(?:(?!endobj).)*?\/Type\s*?\/XObject|Type\s*?\/XObject(?:(?!endobj).)*?\/Filter.+?DCTDecode)|Type\s*?\/XObject(?:(?!endobj).)*?\/(?:Filter.+?DCTDecode(?:(?!endobj).)*?\/SubType\s*?\/Imag|SubType\s*?\/Image(?:(?!endobj).)*?\/Filter.+?DCTDecod)e)/Rsi"; reference:cve,CVE-2014-0493; classtype:attempted-user; sid:2807717; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Adobe Reader Double Free CVE-2014-0493 2"; flow:from_server,established; file_data; content:"DCTDecode"; nocase; fast_pattern:only; content:"/XObject"; nocase; content:"/Widget"; nocase; content:"/AP"; nocase; pcre:"/^s*?<<\s*?(?:(?!>>).)*?\/N\s*(?P<relativ_o>((?!\s*R).)+)\s*R(?:(?!endobj).)*?\/Widget.+?\s(\d+\s)*?(?P=relativ_o)\s*?obj\s*?<<(?:(?!endobj).)*?\/(?:Filter.+?DCTDecode(?:(?!endobj).)*?\/(?:SubType\s*?\/Image(?:(?!endobj).)*?\/Type\s*?\/XObject|Type\s*?\/XObject(?:(?!endobj).)*?\/SubType\s*?\/Image)|SubType\s*?\/Image(?:(?!endobj).)*?\/(?:Filter.+?DCTDecode(?:(?!endobj).)*?\/Type\s*?\/XObject|Type\s*?\/XObject(?:(?!endobj).)*?\/Filter.+?DCTDecode)|Type\s*?\/XObject(?:(?!endobj).)*?\/(?:Filter.+?DCTDecode(?:(?!endobj).)*?\/SubType\s*?\/Imag|SubType\s*?\/Image(?:(?!endobj).)*?\/Filter.+?DCTDecod)e)/Rsi"; reference:cve,CVE-2014-0493; classtype:attempted-user; sid:2807718; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0297)"; flow:to_client,established; file_data; content:"document.createRange"; nocase; content:"deleteContents"; nocase; content:"insertIFrame"; nocase; pcre:"/.+?(?P<rangevar>[^\r\n\s\x22]+?)[\r\n\s]*?=[\r\n\s]*?document\.createrange.+?(?P=rangevar)\.deletecontents.+?insertIFrame/si"; reference:cve,2014-0297; classtype:trojan-activity; sid:2807800; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0298)"; flow:to_client,established; file_data; content:".createRange("; nocase; content:".setStart("; nocase; content:".setEnd("; nocase; content:"getSelection().addRange"; fast_pattern:3,20; nocase; content:"document.execCommand"; nocase; content:"delete"; distance:0; nocase; content:".execCommand("; nocase; content:"undo"; distance:0; nocase; content:"contentEditable"; content:".createTextNode("; content:".appendChild("; pcre:"/\b(?P<eletxt>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createTextNode\(.+?\b(?P<ele_edit>[^\r\n\s\x2e]+?)\.appendChild\((?P=eletxt).+?\b(?P<range>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createRange\(.+?(?:(?P=range)\.setStart\((?P=ele_edit)|(?P=range)\.setEnd\((?P=ele_edit)).+?getSelection\(\)\.addRange\((?P=range).+?document\.execCommand\(\s*[\x22\x27]delete[\x22\x27].+?(?P=ele_edit)\.lastChild.+?document\.execCommand\(\s*[\x22\x27]undo[\x22\x27].+?<[^>]+?contentEditable[\r\n\s]*?[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27](?P=ele_edit)[\x22\x27]/si"; reference:cve,2014-0298; classtype:attempted-user; sid:2807801; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0299)"; flow:to_client,established; file_data; content:"document.write("; nocase; content:"document.writeln("; nocase; pcre:"/^\s*?[\x22\x27]<table>[\x22\x27].+?/Rsi"; content:"document.getElementsByTagName("; nocase; pcre:"/^\s*?[\x22\x27]table[\x22\x27]\s*?\x29\[\w+?\]\.removeNode\(\s*?false/Rsi"; content:"].removeNode("; nocase; fast_pattern:only; content:"<table"; pcre:"/^[\s>](?:(<\/table>).)*?<table/Rsi"; reference:cve,2014-0299; classtype:attempted-user; sid:2807802; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0302)"; flow:to_client,established; file_data; content:"onbeforedeactivate"; nocase; content:".innerHTML"; nocase; content:"onreadystatechange"; nocase; content:"contentEditable"; nocase; content:".addBehavior"; nocase; content:"CollectGarbage"; nocase; pcre:"/^\s*?\(\s*?/Rsi"; pcre:"/\b(?P<button>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\(\s*[\x27\x22]button[\x27\x22]\s*\).+?document\.body\.contentEditable[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]true[\x27\x22].+?(?P=button)\.onreadystatechange.+?document\.execCommand\(\s*[\x22\x27]InsertFieldset[\x22\x27].+?onbeforedeactivate[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=button)\.innerHTML[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22][\x27\x22]/si"; reference:cve,2014-0302; classtype:attempted-user; sid:2807803; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0303)"; flow:to_client,established; file_data; content:"document.write"; nocase; pcre:"/^\s*?\(\s*?/Rsi"; content:"CollectGarbage"; nocase; distance:0; pcre:"/^\s*?\(\s*?/Rsi"; content:"document.body.contentEditable"; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]true[\x27\x22].+?\.swapNode\s*?\(\s*?document\.createElement\s*?\(\s*?.+?CollectGarbage\s*?\(\s*?/Rsi"; content:"onreadystatechange"; nocase; reference:cve,2014-0303; classtype:attempted-user; sid:2807804; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0304)"; flow:to_client,established; file_data; content:"document.body.contentEditable"; nocase; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]true[\x27\x22].+?document\.execCommand\s*?\(\s*?[\x27\x22]Delete[\x27\x22]\s*?\).+?focus.+?document\.body\.createTextRange\s*?\(\s*?\)\.execCommand\s*?\(\s*?[\x22\x27]SelectAll[\x22\x27].+?\.innerHTML[\r\n\s]*?\x3d/Rsi"; content:"document.execCommand"; nocase; content:"delete"; nocase; content:".focus"; distance:0; content:"document.body.createTextRange"; content:"SelectAll"; content:".innerHTML"; reference:cve,2014-0304; classtype:attempted-user; sid:2807805; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible User-After-Free CVE-2014-0309"; flow:established,from_server; file_data; content:"<ruby"; fast_pattern:only; content:"insertInputSubmit"; content:"insertInputHidden"; content:"createElement"; pcre:"/^(?:[\x22\x27]\s*?\])?\s*?\(\s*?[\x22\x27]media[\x22\x27]/Rsi"; content:"innerHTML"; pcre:"/^(?:[\x22\x27]\s*?\])?\s*?=\s*?(?:\x22\x22|\x27\x27)/Rsi"; content:"createRange"; content:"getSelection().addRange"; classtype:attempted-user; sid:2807806; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible User-After-Free CVE-2014-0312"; flow:established,from_server; file_data; content:"<select"; pcre:"/^[\s>](?:(?!<\/select>).)*?<option[\s>]/Rsi"; content:"onpropertychange"; content:"setTimeout"; content:".selected"; distance:0; pcre:"/^\s*?=\s*?[\x22\x27]true[\x22\x27]/Rsi"; content:"document.open"; pcre:"/^\s*?\(\s*?[\x22\x27]text/html[\x22\x27]/Rsi"; content:"CollectGarbage"; nocase; fast_pattern:only; classtype:attempted-user; sid:2807807; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE10 Memory Corruption Vulnerability CVE-2014-0313 1"; flow:established,from_server; file_data; content:"-ms-hyphens"; nocase; fast_pattern; pcre:"/^\s*?\x3a\s*?auto/Rsi"; content:"<rt"; pcre:"/^[^>]*?\sstyle\s*?=\s*?[\x22\x27][^\x22\x27]*?ms-hyphens\s*?\x3a\s*?auto/Rsi"; content:!"</rt>"; within:500; classtype:attempted-user; sid:2807808; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE10 Memory Corruption Vulnerability CVE-2014-0313 2"; flow:established,from_server; file_data; content:"-ms-hyphens"; nocase; fast_pattern; pcre:"/^\s*?\x3a\s*?auto/Rsi"; content:"<style"; pcre:"/^(?:(?!<\/style>).)*?\srt\s*?\{[^}]*?-ms-hyphens\s*?\x3a\s*?auto/Rsi"; content:"<rt"; content:!"</rt>"; within:500; classtype:attempted-user; sid:2807809; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CSelectTracker type confusion CVE-2014-0314"; flow:established,from_server; file_data; content:"createTextRange"; nocase; content:"moveToElementText"; nocase; distance:0; content:"createTextRange"; nocase; distance:0; content:"moveToElementText"; nocase; distance:0; content:"setEndPoint"; nocase; distance:0; content:"delete"; nocase; distance:0; pcre:"/(?P<range1var>[^\r\n\s]+?)[\r\n\s]*?\=[\r\n\s]*?document\.?[^\r\n\s]*?\.createtextrange.*?(?P=range1var)\.movetoelementtext.*?(?P<range2var>[^\r\n\s]+?)[\r\n\s]*?\=[\r\n\s]*?document\.?[^\r\n\s]*?\.createtextrange.*?(?P=range2var)\.movetoelementtext.*?(?P=range1var)\.setendpoint[\r\n\s]*?\([\r\n\s]*?[\x27\x22]endtostart[\x27\x22][\r\n\s]*?\,[\r\n\s]*?(?P=range2var).*?(?P=range1var)\.select.*?document\.execcommand[\r\n\s]*?\([\r\n\s]*?[\x27\x22]delete[\x27\x22]/si"; reference:cve,2014-0314; classtype:attempted-user; sid:2807810; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE8 Memory Corruption Vulnerability CVE-2014-0324"; flow:established,from_server; file_data; content:"<body"; nocase; pcre:"/^[^>]*\son(?:load\s*?=[^>]*?\sonmove|move\s*?=[^>]*?\sonload)\s*?=/Rsi"; content:"swapNode"; content:"scroll"; pcre:"/^(?:Top|Left)\s*?=/Rs"; content:"createElement"; pcre:"/^(?:[\x22\x27]\s*?\])?\s*?\(\s*?[\x22\x27]html[\x22\x27]/Rsi"; content:"appendChild"; content:"applyElement"; content:"execCommand"; content:"CollectGarbage"; nocase; fast_pattern:only; reference:cve,2014-0324; classtype:attempted-admin; sid:2807811; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Generic HeapSpray Construct"; flow:established,from_server; file_data; content:"createElement(|22|div|22|)"; fast_pattern:only; content:"for("; pcre:"/^\s*?(?P<var>[^\x3d\x3b\)\s]+)\s*?=\s*?0\s*?\x3b(?P=var)\s*?\<\s*?(?:0x)?\d{3,4}\s*?\x3b\s*?(?P=var)\+\+\s*?\)\s*?\x7b[^\x7d]+?\[\s*?(?P=var)\s*?\]\s*?=\s*?document\.createElement\([\x22]div[\x22]\)[^\x7d]+?\[\s*?(?P=var)\s*?\]/Rsi"; classtype:trojan-activity; sid:2018299; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible CVE-2014-1761 HTTP"; flow:from_server,established; file_data; content:"{|5c|rt{"; content:"|5c|objocx|5c|"; distance:0; content:"MSComctlLib."; content:"|5c|u-554"; fast_pattern; content:"|5c|u-554"; distance:0; content:"|5c|u-554"; distance:0; content:"|5c|u-554"; content:"|5c|u-554"; distance:0; content:"|5c|u-554"; distance:0; content:"|5c|u-554"; distance:0; content:"|5c|u-554"; distance:0; reference:url,blogs.technet.com/b/srd/archive/2014/03/24/security-advisory-2953095-recommendation-to-stay-protected-and-for-detections.aspx; classtype:attempted-user; sid:2018313; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1751)"; flow:to_client,established; file_data; content:".outerText"; nocase; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27][\x22\x27]/Rsi"; content:"document.execCommand"; nocase; distance:0; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?[\x22\x27]SelectAll[\x22\x27][\r\n\s]*?\)/Rsi"; content:"onselectstart"; distance:0; nocase; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?\x27[\r\n\s]*?(?P<elem>[^\x2e\r\n\s]+?)\x2eapplyElement[\r\n\s]*?\x28[\r\n\s]*?document\.createElement[\r\n\s]*?\x28[\r\n\s]*?[\x22\x27].+?\bid[\r\n\s]*?\x3d[\r\n\s]*?(?P=elem)/Rsi"; reference:cve,2014-1751; classtype:attempted-user; sid:2807933; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1752)"; flow:to_client,established; file_data; content:".appendChild"; nocase; content:".swapNode"; nocase; content:"CollectGarbage"; nocase; fast_pattern:only; pcre:"/\b(?P<elem>[^\r\n\s\x2e]+?)\.appendChild[\r\n\s]*?\x28[\r\n\s]*?document\.createElement.+?(?P<elem2>[^\r\n\s\x2e]+?)\.swapNode[\r\n\s]*?\x28[\r\n\s]*?document\.createElement.+?CollectGarbage.+?<[^>]+?\bid[\r\n\s]*?\x3d[\r\n\s]*?(?P=elem2).+?<button((?!(<\/button)).)+<[^>]+?\bid[\r\n\s]*?\x3d[\r\n\s]*?(?P=elem)/si"; reference:cve,2014-1752; classtype:attempted-user; sid:2807934; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1753)"; flow:to_client,established; file_data; content:"cloneNode("; nocase; content:".setAttribute"; fast_pattern:only; nocase; pcre:"/\b(?P<var>[^\r\n\s]+?)\s+?[\r\n\s]*?\x3d[\r\n\s]*?(?:0x)?0*?\d{6,}.+?\b(?P<var2>[^\r\n\s]+?)\s+?[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27]\w+?[\x22\x27].+?\bwhile[\r\n\s]+?\x28[\r\n\s]*?(?P=var2)\.length\s*?<\x3d?\s*?\x28?\s*?[^\x29]+?(?P=var).*?\x29.+?\b(?P<var3>[^\r\n\s\x2e]+?)\x2esetAttribute[\r\n\s]*?\x28[^\x29]+?(?P=var2).+?(?P=var3)\.cloneNode/si"; reference:cve,2014-1753; classtype:attempted-user; sid:2807935; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1755)"; flow:to_client,established; file_data; content:"nth-child"; nocase; content:"createRange"; nocase; distance:0; content:"extractContents"; nocase; distance:0; pcre:"/(?P<range1var>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]+?document\.createrange.*\b(?P<node1var>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document.getelementbyid[\r\n\s]?\([\r\n\s]?[\x22\x27](?P<element1id>[^\r\n\s]+?)[\x22\x27][\r\n\s]?.*(?P=range1var)\.setEnd\((?P=node1var).*(?P=range1var)\.extractcontents.*<[\r\n\s]*?li.+\x3d(?P=element1id)/si"; reference:cve,2014-1755; classtype:attempted-user; sid:2807936; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer RCE CVE-2014-1776"; flow:established,from_server; file_data; content:"#default#VML"; nocase; fast_pattern:only; content:"|3a|shape"; nocase; content:"on"; nocase; pcre:"/^[a-z]{4}/Ri"; content:"removeNode"; pcre:"/\s*?\(\s*?/Rsi"; content:"style"; nocase; content:"appendChild"; content:"disabled"; pcre:"/^(?:[\x22\x27]\s*?\])?\s*?=\s*?/Rs"; content:!"undefined"; within:9; nocase; content:!"false"; within:5; nocase; content:!"null"; within:4; nocase; content:!"0"; within:1; content:!"-0"; within:2; content:!"NaN"; nocase; within:3; content:!"|22 22|"; within:2; content:!"<g_vml_"; reference:cve,2014-1776; reference:url,www.fireeye.com/blog/uncategorized/2014/04/new-zero-day-exploit-targeting-internet-explorer-versions-9-through-11-identified-in-targeted-attacks.html; classtype:attempted-user; sid:2807985; rev:3;)

#
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"ET WEB_CLIENT SUSPICOUS Possible automated connectivity check (www.google.com)"; flow:established,to_server; dsize:35<>41; content:"GET / HTTP/1."; content:"|0d 0a|Host|3a 20|"; distance:1; content:"google.com|0d 0a 0d 0a|"; distance:0; within:18; fast_pattern; threshold: type limit, count 1, seconds 300, track by_src; classtype:bad-unknown; sid:2018430; rev:2;)

#
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"ET WEB_CLIENT SUSPICOUS Possible automated connectivity check (www.msn.com)"; flow:established,to_server; dsize:37; content:"GET / HTTP/1."; content:"|0d 0a|Host|3a 20|www.msn.com|0d 0a 0d 0a|"; distance:1; within:23; fast_pattern:3,20; threshold: type limit, count 1, seconds 300, track by_src; classtype:bad-unknown; sid:2018431; rev:1;)

#
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"ET WEB_CLIENT SUSPICOUS Possible automated connectivity check (www.bing.com)"; flow:established,to_server; dsize:38; content:"GET / HTTP/1."; content:"|0d 0a|Host|3a 20|www.bing.com|0d 0a 0d 0a|"; distance:1; within:24; fast_pattern:4,20; threshold: type limit, count 1, seconds 300, track by_src; classtype:bad-unknown; sid:2018432; rev:1;)

#
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"ET WEB_CLIENT SUSPICOUS Possible automated connectivity check (www.yahoo.com)"; flow:established,to_server; dsize:39; content:"GET / HTTP/1."; content:"|0d 0a|Host|3a 20|www.yahoo.com|0d 0a 0d 0a|"; distance:1; within:25; fast_pattern:5,20; threshold: type limit, count 1, seconds 300, track by_src; classtype:bad-unknown; sid:2018433; rev:1;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_CLIENT Microsoft Application Crash Report Indicates Potential VGX Memory Corruption"; flow:established,to_server; content:"/Generic/BEX/iexplore_exe/"; http_uri; content:"/vgx_dll_unloaded/"; http_uri; fast_pattern; content:"Host|3A| watson.microsoft.com"; http_header; reference:url,community.websense.com/blogs/securitylabs/archive/2014/04/28/cve-2014-1776-using-crash-reports-to-find-possible-exploited-vulnerabilities.aspx; reference:url,www.websense.com/assets/reports/websense-crash-report-en.pdf; reference:cve,2014-1776; classtype:attempted-user; sid:2018434; rev:2;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_CLIENT Microsoft Application Crash Report Indicates Potential VGX Memory Corruption 2"; flow:established,to_server; content:"/StageOne/iexplore_exe/"; http_uri; content:"/vgx_dll/"; http_uri; fast_pattern; content:"Host|3A| watson.microsoft.com"; http_header; reference:url,community.websense.com/blogs/securitylabs/archive/2014/04/28/cve-2014-1776-using-crash-reports-to-find-possible-exploited-vulnerabilities.aspx; reference:url,www.websense.com/assets/reports/websense-crash-report-en.pdf; reference:cve,2014-1776; classtype:attempted-user; sid:2018436; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Base64 Encoded Java Value"; flow:established,to_client; file_data; content:"<applet"; content:"<param"; distance:0; content:"<value="; distance:0; pcre:"/\x3Cvalue\x3D\x22([a-z0-9+/]{4})*(?:[a-z0-9+/]{2}==|[a-z0-9+/]{3}=)/smi"; reference:url,vrt-blog.snort.org/2014/05/continued-analysis-of-lightsout-exploit.html; classtype:bad-unknown; sid:2018447; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0310)"; flow:to_client,established; file_data; content:"CollectGarbage"; fast_pattern; content:"CollectGarbage"; distance:0; content:"parentNode.removeChild"; content:"parentNode.removeChild"; distance:0; content:"<dir"; nocase; content:"<sub"; nocase; content:".firstChild"; nocase; content:"onfocusout"; nocase; content:"onfocusout"; nocase; distance:0; content:".focus"; nocase; content:".focus"; nocase; distance:0; pcre:"/^\s*?\(/Rs"; content:".focus"; nocase; distance:0; pcre:"/^\s*?\(/Rs"; reference:cve,2014-0310; classtype:attempted-user; sid:2808038; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1815)"; flow:to_client,established; file_data; content:"CollectGarbage"; fast_pattern:only; content:".className"; content:"<marquee"; nocase; content:".outerText"; pcre:"/\s*?(?:\x22\x22|\x27\x27)/Rs"; content:"onload"; nocase; content:"onresize"; nocase; content:"applyElement"; nocase; content:"document.createTextNode"; nocase; content:".replaceNode"; content:".createRange"; reference:cve,2014-1815; classtype:attempted-user; sid:2808040; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1815)"; flow:to_client,established; file_data; content:"CollectGarbage"; fast_pattern:only; content:".className"; content:"<marquee"; nocase; content:"document.write"; pcre:"/\s*?\(\s*?(?:\x22\x22|\x27\x27)\s*?\)/Rs"; content:"onload"; nocase; content:"onresize"; nocase; content:"applyElement"; nocase; content:"document.createTextNode"; nocase; content:".replaceNode"; content:".createRange"; reference:cve,2014-1815; classtype:attempted-user; sid:2808041; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Acrobat Reader Possible CVE-2014-0527 Use After Free"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"AcroPDF.PDF"; nocase; content:"setTimeout"; nocase; content:".innerHTML"; nocase; pcre:"/^\s*?=\s*?(?:undefined|false|null|-?0|NaN|\x22\x22|\x27\x27)[^{}]+?\.(?:Set(?:Show(?:Scrollbars|Toolbar)|Current(?:Highlight|Page)|View(?:Scroll|Rect)?|(?:Layout|Page)Mode|Zoom(?:Scroll)?|NamedDest)|G(?:o(?:to(?:(?:(?:Fir|La)s|Nex)t|Previous)Page|BackwardStack)|etVersions)|Print(?:Pages(?:Fit)?|All(?:Fit)?|WithDialog)?|LoadFile)\s*?\(/Rsi"; reference:cve,2014-0527; classtype:attempted-user; sid:2808081; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Acrobat Reader Possible CVE-2014-0527 Use After Free"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"CA8A9780-280D-11CF-A24D-444553540000"; nocase; content:"setTimeout"; nocase; content:".innerHTML"; nocase; pcre:"/^\s*?=\s*?(?:undefined|false|null|-?0|NaN|\x22\x22|\x27\x27)[^{}]+?\.(?:Set(?:Show(?:Scrollbars|Toolbar)|Current(?:Highlight|Page)|View(?:Scroll|Rect)?|(?:Layout|Page)Mode|Zoom(?:Scroll)?|NamedDest)|G(?:o(?:to(?:(?:(?:Fir|La)s|Nex)t|Previous)Page|BackwardStack)|etVersions)|Print(?:Pages(?:Fit)?|All(?:Fit)?|WithDialog)?|LoadFile)\s*?\(/Rsi"; reference:cve,2014-0527; classtype:attempted-user; sid:2808082; rev:2;)

#
#alert tcp $EXTERNAL_NET [!21,!22,!23,!2100,!3535] -> $HOME_NET 1024:65535 (msg:"ET WEB_CLIENT Possible GnuTLS Client ServerHello SessionID Overflow CVE-2014-3466"; flow:established,to_client; content:"|16 03|"; depth:2; byte_test:1,<,4,2; content:"|02|"; distance:3; within:1; content:"|03|"; distance:3; within:1; byte_test:1,<,4,0,relative; byte_test:4,>,1370396981,1,relative; byte_test:4,<,1465091381,1,relative; byte_test:1,>,32,33,relative; reference:url,radare.today/technical-analysis-of-the-gnutls-hello-vulnerability/; reference:cve,2014-3466; classtype:attempted-user; sid:2018537; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-0282)"; flow:to_client,established; file_data; content:".checked"; nocase; content:".onpropertychange"; nocase; content:"checkbox"; nocase; content:".propertyName"; nocase; content:"checked"; nocase; content:"<html></html>"; fast_pattern:only; nocase; content:"<form "; nocase; pcre:"/^[\r\n\s]*?[^>]*?\bid[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<form_id>[^\r\n\s\x22\x27]+?)[\x27\x22]((?!(<\/form)).)+<input\s+?[^>]*?\b(type[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]checkbox[\x27\x22][^>]*?\bid[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<input_id>[^\r\n\s\x22\x27]+?)[\x27\x22]|id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P<input_id2>[^\r\n\s\x22\x27]+?)[\x27\x22][^>]*?\btype[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22]checkbox[\x27\x22]).+?window\.setTimeout[\r\n\s]*\(.+?document\.getElementById[\r\n\s]*?\([\r\n\s]*[\x27\x22]((?P=input_id)|(?P=input_id2))[\x27\x22][\r\n\s]*\)\.checked[\r\n\s]*\x3d[\r\n\s]*true\b.+?document\.getElementById[\r\n\s]*?\([\r\n\s]*[\x27\x22]((?P=input_id)|(?P=input_id2))[\x27\x22][\r\n\s]*\)\.onpropertychange[\r\n\s]*\x3d[\r\n\s]*(?P<func>[^\r\n\s\x3b]+?).+?\bfunction[\r\n\s]*?(?P=func).+?\.propertyName[\r\n\s]*\x3d\x3d[\r\n\s]*[\x22\x27]checked[\x22\x27].+?document\.write[\r\n\s]*\([\r\n\s]*[\x22\x27]<html><\/html>[\x22\x27]/Rsi"; reference:cve,2014-0282; classtype:attempted-user; sid:2808142; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1762)"; flow:to_client,established; file_data; content:".createRange("; nocase; content:".setStart("; nocase; content:".setEnd("; nocase; content:"startContainer"; nocase; content:"replaceData"; nocase; content:"endContainer"; nocase; content:"previousSibling"; nocase; content:"CollectGarbage("; nocase; fast_pattern:only; content:"removeNode"; nocase; content:"range"; pcre:"/^\[[\r\n\s]*?[\x27\x22]startContainer[\x27\x22][\r\n\s]*?\]\[[\r\n\s]*?[\x27\x22]replaceData[\x27\x22][\r\n\s]*?\]/Rsi"; content:"range"; pcre:"/^\[[\r\n\s]*?[\x27\x22]endContainer[\x27\x22][\r\n\s]*?\]\[[\r\n\s]*?[\x27\x22]previousSibling[\x27\x22][\r\n\s]*?\]/Rsi"; content:"range"; pcre:"/^\[[\r\n\s]*?[\x27\x22]endContainer[\x27\x22][\r\n\s]*?\]\[[\r\n\s]*?[\x27\x22]removeNode[\x27\x22][\r\n\s]*?\]/Rsi"; reference:cve,2014-1762; classtype:attempted-user; sid:2808143; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1766)"; flow:to_client,established; file_data; content:"<li"; content:".replaceNode"; content:"contentEditable"; nocase; content:"<body"; nocase; pcre:"/^[^>]+contentEditable\s*?=\s*?[\x22\x27]true[\x22\x27]/Rsi"; content:"onresize"; fast_pattern; nocase; pcre:"/^\s*=\s*[\x22\x27]\s*(?P<element1var>[^>]+?)\.replacenode\s*\(\s*(?P=element1var)\s*\)/Rsi"; reference:cve,2014-1766; classtype:attempted-user; sid:2808144; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free 1 (CVE-2014-1785)"; flow:to_client,established; file_data; content:"document.execCommand"; nocase; content:"document.execCommand"; nocase; distance:0; content:"document.execCommand"; nocase; distance:0; content:"DOMNodeRemoved"; fast_pattern; nocase; pcre:"/^[\x22\x27]\s*?\,\s*?function\([^)]*?\)\s*?\{[^}]*?document\.open/Rsi"; reference:cve,2014-1785; classtype:attempted-user; sid:2808145; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free 2 (CVE-2014-1785)"; flow:to_client,established; file_data; content:"document.execCommand"; nocase; content:"document.execCommand"; nocase; distance:0; content:"document.execCommand"; nocase; distance:0; content:"DOMNodeRemoved"; fast_pattern; nocase; content:"function"; nocase; pcre:"/^\s+?(?P<functionVar>\S+?)\s*?\([^)]*\)\s*?\{[^}]*?document.open.+?addeventlistener\s*?\([\x22\x27]domnoderemoved[\x22\x27]\s*?\,\s*?(?P=functionVar)/Rsi"; reference:cve,2014-1785; classtype:attempted-user; sid:2808146; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1789)"; flow:to_client,established; file_data; content:".swapNode("; nocase; content:"<summary "; nocase; fast_pattern:only; pcre:"/\b(?P<summary_id>[^\r\n\s\x2e]+?)\.swapNode.+?<summary\s[^>]*?\bid[\r\n\s]*?\x3d[\r\n\s]*?(?P=summary_id)\b/si"; reference:cve,2014-1789; classtype:attempted-user; sid:2808147; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1791)"; flow:to_client,established; file_data; content:".removeNode"; nocase; content:"CollectGarbage("; nocase; fast_pattern; content:"onfocus"; nocase; content:"setCapture("; nocase; content:"onmousemove"; nocase; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22][\r\n\s]*?(?P<obj>[^\r\n\s\x2e]+?)\.removeNode\([\r\n\s]*?true[\r\n\s]*?\).+?CollectGarbage\(.+?onfocus[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27](?P=obj)\.setCapture\(.+?\bid[\r\n\s]*?\x3d[\r\n\s]*?(?P=obj)\b/Rsi"; reference:cve,2014-1791; classtype:attempted-user; sid:2808148; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1795)"; flow:to_client,established; file_data; content:"contentEditable"; nocase; content:"iframe"; nocase; content:"onpagehide"; nocase; content:"onload"; nocase; content:"InsertInputSubmit"; nocase; content:"selectAll"; fast_pattern:only; nocase; content:"document.write"; nocase; content:"Refresh"; nocase; pcre:"/^[\x22\x27]\s*?\).*?createtextrange\([^)]*?\).execcommand\s*?\([\x22\x27]selectall[\x22\x27]\s*?\).*?window\.location\.href/Rsi"; content:"document.execCommand"; nocase; pcre:"/^\(\s*?[\x22\x27]insertinputsubmit[\x22\x27]\s*?\).*?document.write/Rsi"; reference:cve,2014-1795; classtype:attempted-user; sid:2808149; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1797)"; flow:to_client,established; file_data; content:"isindex.setAttribute"; nocase; fast_pattern:only; content:"document.createElement("; nocase; pcre:"/\b(?P<var_id>[^\r\n\s\x3d]*?)[\r\n\s]*\x3d[\r\n\s]*?document\.createElement\([\r\n\s]*?[\x22\x27]isindex[\x22\x27][\r\n\s]*?\).+?for[\r\n\s]*?\x28[\r\n\s]*?(?P<forIndex>[^\x3d\r\n\s]*?)\x3d[^\x3b]*?\x3b[\r\n\s]*?(?P=forIndex)[\r\n\s]*?<=?(0xfff[a-f0-9]|6553\d).*setAttribute\.(?P=var_id)\([\r\n\s]*[^\x29]+?\x2c/si"; reference:cve,2014-1797; classtype:attempted-user; sid:2808150; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1800)"; flow:to_client,established; file_data; content:"parentNode.removeChild"; fast_pattern:only; content:"innerText"; nocase; pcre:"/^\s*?=\s*?\x22\x22/Rs"; content:"<![CDATA"; nocase; pcre:"/^\[(?:(?!\]\]\>).)*?var\s(?P<elementVar>\S+?)\s*?=\s*?document\.getelementbyid\(\s*?[\x22\x27]element[\x22\x27].*?(?P=elementVar)\.innertext.*?(?P=elementVar).parentnode.removechild\(\s*?(?P=elementVar)/Rsi"; reference:cve,2014-1800; classtype:attempted-user; sid:2808151; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1802)"; flow:to_client,established; file_data; content:"createElement"; nocase; content:"header"; nocase; content:"onload"; nocase; content:"white-space|3a|pre"; nocase; content:"<ul"; nocase; pcre:"/^[^>]*?style\s*?\=\s*?[\x22\x27]white-space\:pre/Rsi"; pcre:"/(?P<element1var>[^\r\n\s]+?)\.applyelement\(\s*?document\.createelement\(\s*?[\x22\x27]header[\x22\x27]\s*?\).*?document\.createelement\(\s*?.+?\)\.applyelement\(\s*?(?P=element1var)/si"; content:".applyElement"; nocase; fast_pattern:only; reference:cve,2014-1802; classtype:attempted-user; sid:2808152; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1804)"; flow:to_client,established; file_data; content:"onresize"; nocase; content:"onload"; nocase; content:".applyElement("; nocase; content:".createTextRange("; nocase; content:".createTextNode("; nocase; content:"<table"; nocase; content:"selectAll"; nocase; fast_pattern:only; content:"function"; pcre:"/^[\r\n\s]*?(?P<func_id1>[^\r\n\s\x28]+?)\x28.+?\b(?P<tt_id>[^\r\n\s\x2e]+?)\.appendChild\([\r\n\s]*?document\.createTextNode\(.+?document\.body\.createTextRange\(\)\.execCommand\([\r\n\s]*?[\x27\x22]SelectAll[\x27\x22][\r\n\s]*?\).+?function[\r\n\s]*?(?P<func_id2>[^\r\n\s\x28]+?)\x28.+?(?P=tt_id)\.applyElement\([\r\n\s]*?document\.createElement\([\r\n\s]*[\x22\x27]th[\x27\x22][\r\n\s]*\)[\r\n\s]*,[\x27\x22]inside[\x22\x27][\r\n\s]*\).+?<body [^>]*?(onload[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id1).*?onresize[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id2)|onresize[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id2).*?onload[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id1)).+?<tt [^>]*?[\r\n\s]*?\x3d[\r\n\s]*?(?P=tt_id)/Rsi"; reference:cve,2014-1804; classtype:attempted-user; sid:2808153; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-1804) 2"; flow:to_client,established; file_data; content:"onresize"; nocase; content:"onload"; nocase; content:".applyElement("; nocase; content:".createTextRange("; nocase; content:".createTextNode("; nocase; content:"<table"; nocase; content:"selectAll"; nocase; fast_pattern:only; content:"function"; pcre:"/^[\r\n\s]*?(?P<func_id2>[^\r\n\s\x28]+?)\x28.+?(?P<tt_id>[^\r\n\s\x2e]+?)\.applyElement\([\r\n\s]*?document\.createElement\([\r\n\s]*[\x22\x27]th[\x27\x22][\r\n\s]*\)[\r\n\s]*,[\x27\x22]inside[\x22\x27][\r\n\s]*\).+?function[\r\n\s]*?(?P<func_id1>[^\r\n\s\x28]+?)\x28.+?\b(?P=tt_id)\.appendChild\([\r\n\s]*?document\.createTextNode\(.+?document\.body\.createTextRange\(\)\.execCommand\([\r\n\s]*?[\x27\x22]SelectAll[\x27\x22][\r\n\s]*?\).+?<body [^>]*?(onload[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id1).*?onresize[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id2)|onresize[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id2).*?onload[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=func_id1)).+?<tt [^>]*?[\r\n\s]*?\x3d[\r\n\s]*?(?P=tt_id)/Rsi"; reference:cve,2014-1804; classtype:attempted-user; sid:2808154; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2014-1805"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"getSVGDocument"; nocase; content:"document.write"; nocase; pcre:"/^\s*?\(\s*?(?:\x22\x22|\x27\x27)/Rs"; content:"createRange"; nocase; pcre:"/^\W/R"; content:"addRange"; nocase; pcre:"/^\W/R"; reference:cve,2014-1805; classtype:attempted-admin; sid:2808156; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Acrobat Reader Privilaged API Acess CVE-2014-0521"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:"javascript"; nocase; content:"__defineSetter__"; fast_pattern; pcre:"/^\s*?\([^\x3b]+app\.beginPriv\W/Rsi"; content:"app.trustedFunction"; reference:cve,2014-0521; classtype:trojan-activity; sid:2808231; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Adobe Flash CVE-2014-0536"; flow:from_server,established; flowbits:isset,HTTP.UncompressedFlash; file_data; content:"RegExp"; content:"|28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d 28 3f 3d|"; reference:cve,2014-0536; classtype:attempted-user; sid:2808263; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-1765"; flow:established,to_client; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"onpropertychange"; nocase; content:"createElement"; nocase; pcre:"/^(?:\x22\x27\s*?\])?\s*?\(\s*?[\x22\x27]font[\x27\x22]/Rsi"; content:"removeAttribute"; nocase; pcre:"/^(?:\x22\x27\s*?\])?\s*?\(\s*?[\x22\x27]style[\x27\x22]/Rsi"; reference:cve,2014-1765; classtype:attempted-user; sid:2808298; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-2795"; flow:established,to_client; file_data; content:"list-style-type"; nocase; fast_pattern:only; content:"<ul"; pcre:"/^[^>]*?\sstyle\s*?=\s*?[\x22\x27][^\x22\x27]*?list-style-type\x3a\s*?lower-latin\W(?:(?!<\/ul>).)+?<li[\s>]/Rsi"; content:"applyElement"; nocase; pcre:"/^(?:\x22\x27\s*?\])?\s*?\([^\)]+[\x22\x27]inside[\x22\x27]/Rsi"; content:"applyElement"; nocase; distance:0; pcre:"/^(?:\x22\x27\s*?\])?\s*?\([^\x3b\x2c]+\x2c\s*?[\x22\x27]inside[\x22\x27]/Rsi"; reference:cve,CVE-2014-2795; classtype:attempted-user; sid:2808299; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Vulnerability CVE-2014-2797"; flow:established,to_client; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"pasteHTML"; content:"innerHTML"; pcre:"/^\s*?=\s*?(?:undefined|false|null|-?0|NaN|\x22\x22|\x27\x27)/Rsi"; content:"createRange"; nocase; pcre:"/^(?:\x22\x27\s*?\])?\s*?\(\s*?[^\)]*?\)(?:\[\s*?[\x22\x27]pasteHTML[\x22\x27]\s*?\]|\.pasteHTML)\s*?\(/Rsi"; content:"replaceNode"; nocase; pcre:"/^(?:\x22\x27\s*?\])?\s*?\([^\)]+createTextNode/Rsi"; reference:cve,2014-2797; classtype:attempted-user; sid:2808300; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-2801)"; flow:to_client,established; file_data; content:"createTextRange"; nocase; content:"SelectAll"; fast_pattern; distance:0; content:"createTextRange"; nocase; distance:0; content:"select"; distance:0; content:"document"; nocase; pcre:"/^(?:\[\s*?[\x22\x27]body[\x22\x27]\s*?\]|\.body)(?:\[\s*?[\x22\x27]createTextRange[\x22\x27]\s*?\]|\.createTextRange)\s*?\([^\)]*?\)(?:\[\s*?[\x22\x27]execCommand[\x22\x27]\s*?\]|\.execCommand)\s*?\(\s*?[\x22\x27]SelectAll[\x22\x27]/Rsi"; content:"document"; nocase; distance:0; pcre:"/^(?:\[\s*?[\x22\x27]body[\x22\x27]\s*?\]|\.body)(?:\[\s*?[\x22\x27]createTextRange[\x22\x27]\s*?\]|\.createTextRange)\s*?\([^\)]*?\)(?:\[\s*?[\x22\x27]select[\x22\x27]\s*?\]|\.select)\s*?\(\s*?\)/Rsi"; reference:cve,2014-2801; classtype:attempted-user; sid:2808301; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Use After free (CVE-2014-2804)"; flow:to_client,established; file_data; content:"applet"; fast_pattern; pcre:"/^[\x22\x27]/R"; content:"replaceState"; content:"document"; pcre:"/^(?:\[\s*?[\x22\x27]createElement[\x22\x27]\s*?\]|\.createElement)\s*?\(\s*?[\x22\x27]applet[\x22\x27]/Rsi"; content:"appendChild"; distance:0; content:"history"; pcre:"/^(?:\[\s*?[\x22\x27]replaceState[\x22\x27]\s*?\]|\.replaceState)\s*?\(/Rsi"; reference:cve,2014-2804; classtype:attempted-user; sid:2808302; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Player Rosetta Flash compressed CWS"; flow:established,from_server; content:"callback=CWS"; nocase; fast_pattern:only; content:"<object"; nocase; pcre:"/^((?!(?i:<\/object>)).)+?data\s*?\=\s*?[\x22\x27][^\x22\x27]*[?&]callback=CWS[a-zA-Z0-9_\.\x0d\x0a]{50,}+[&\x22\x27]/Rsi"; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:cve,2014-4671; classtype:attempted-user; sid:2018656; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Player Rosetta Flash compressed FWS"; flow:established,from_server; content:"callback=FWS"; nocase; fast_pattern:only; content:"<object"; nocase; pcre:"/^((?!(?i:<\/object>)).)+?data\s*?\=\s*?[\x22\x27][^\x22\x27]*[?&]callback=FWS[a-zA-Z0-9_\.\x0d\x0a]{50,}+[&\x22\x27]/Rsi"; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:cve,2014-4671; classtype:attempted-user; sid:2018657; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Adobe Flash Player Rosetta Flash compressed ZWS"; flow:established,from_server; content:"callback=ZWS"; nocase; fast_pattern:only; content:"<object"; nocase; pcre:"/^((?!(?i:<\/object>)).)+?data\s*?\=\s*?[\x22\x27][^\x22\x27]*[?&]callback=ZWS[a-zA-Z0-9_\.\x0d\x0a]{50,}+[&\x22\x27]/Rsi"; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:cve,2014-4671; classtype:attempted-user; sid:2018658; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-2820 1"; flow:established,to_client; file_data; content:"UIEvents"; nocase; content:"initUIEvent"; nocase; content:"DOMFocusIn"; fast_pattern:only; nocase; content:"document.write"; pcre:"/^\s*?\(\s*?(?:\x22\x22|\x27\x27)/Rs"; reference:cve,2014-2820; classtype:attempted-user; sid:2808539; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-2820 2"; flow:established,to_client; file_data; content:"UIEvents"; nocase; content:"initUIEvent"; nocase; content:"DOMFocusIn"; nocase; fast_pattern:only; content:"document.body.innerHTML"; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?(?:\x22\x22|\x27\x27)/Rs"; reference:cve,2014-2820; classtype:attempted-user; sid:2808540; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-2823"; flow:established,to_client; file_data; content:"hgroup"; nocase; content:".createRange("; nocase; content:".getSelection"; nocase; content:".selectNodeContents"; nocase; content:".addRange"; nocase; content:"CollectGarbage"; nocase; fast_pattern:only; content:"detach"; nocase; pcre:"/\b(?P<hgroup>[^\x3d\x3b\)\s]+)\s*?=\s*?document\.createElement\s*\(\s*[\x22\x27]hgroup[\x22\x27]\s*\).+?\b(?P<element_i>[^\x3d\x3b\)\s]+)\s*?=\s*?document\.createElement\s*\(\s*[\x22\x27]i[\x22\x27]\s*\).+?\b(?P=hgroup)\.appendChild\(\s*(?P=element_i)\s*\).+?\b(?P<range>[^\x3d\x3b\)\s]+)\s*?=\s*?document\.createRange\s*\(.+?(?P<selection>[^\x3d\x3b\)\s]+)\s*?=\s*?window\.getSelection\s*\(.+?\b(?P=range)\.selectNodeContents\s*\(\s*(?P=element_i).+?\b(?P=selection)\.addRange\s*\(\s*(?P=range).+?\b(?P=element_i)[\r\n\s]*\x3d[\r\n\s]*null.+?CollectGarbage\s*\(.+?(?P=range)(\[\s*[\x22\x27]detach[\x22\x27]\s*\]|\.detach)\(/si"; reference:cve,2014-2823; classtype:attempted-user; sid:2808541; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4050"; flow:established,from_server; file_data; content:"</kbd>"; nocase; fast_pattern:only; content:"|3a|nth-child"; nocase; pcre:"/^\s*?\(\s*?[^-]/Rsi"; content:"|3a|nth-child"; nocase; pcre:"/^\s*?\(\s*?-/Rsi"; content:"|3a|nth-child"; nocase; pcre:"/^\s*?\(\s*?[^-]/Rsi"; reference:cve,2014-4050; classtype:attempted-user; sid:2808542; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4057 1"; flow:established,to_client; file_data; content:"span"; nocase; content:"input"; nocase; content:"appendChild"; nocase; content:"applyElement"; nocase; content:"createTextRange"; nocase; content:"setActive"; nocase; content:"InsertMarquee"; nocase; fast_pattern:only; content:"onpropertychange"; nocase; pcre:"/^\s*?=\s*?function(?:(?!function).)+?\.execCommand\s*\(\s*[\x22\x27]InsertMarquee[\x22\x27](?:(?!function).)+?(?:\.innerHTML[\r\n\s]*\x3d|document\.write\s*?\()/Rsi"; reference:cve,CVE-2014-4057; classtype:attempted-user; sid:2808543; rev:7;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4057 2"; flow:established,to_client; file_data; content:"span"; nocase; content:"input"; nocase; content:"appendChild"; nocase; content:"applyElement"; nocase; content:"createTextRange"; nocase; content:"setActive"; nocase; content:"InsertMarquee"; nocase; fast_pattern:only; content:"onpropertychange"; nocase; content:"function"; nocase; pcre:"/[\r\n\s]*?(?P<function>[^\r\n\s\x28]+?)\x28.+?.+?\.execCommand\s*\(\s*[\x22\x27]InsertMarquee[\x22\x27].+?(?:\.innerHTML[\r\n\s]*\x3d|document\.write\s*?\().+?\bonpropertychange\s*?=\s*?(?P=function)/Rsi"; reference:cve,CVE-2014-4057; classtype:attempted-user; sid:2808544; rev:5;)

#
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4063"; flow:established,to_client; file_data; content:"Math.atan"; fast_pattern; nocase; content:"execCommand"; nocase; distance:0; content:"selectAll"; nocase; distance:0; content:"Math.atan"; nocase; content:"execCommand"; nocase; distance:0; content:"Indent"; nocase; distance:0; content:"onreadystatechange"; nocase; content:"<fieldset"; nocase; content:"style"; nocase; content:"function"; pcre:"/^[\r\n\s]*?(?P<function>[^\r\n\s\x28]+?)\x28.+?Math\.atan\s*?\(.+?(\.execCommand\s*\(\s*[\x22\x27]selectAll[\x22\x27].+?\.execCommand\s*\(\s*[\x22\x27]Indent[\x22\x27]|\.execCommand\s*\(\s*[\x22\x27]Indent[\x22\x27].+?execCommand\s*\(\s*[\x22\x27]selectAll[\x22\x27]).+?\bevent[\r\n\s]*\x3d[\r\n\s]*[\x22\x27]onreadystatechange[\x22\x27].+?\b(?P=function)/Rsi"; content:"<fieldset"; pcre:"/^(?:(?!<\/fieldset>).)+?style[\r\n\s]*\x3d[\r\n\s]*[\x22\x27]position\x3aexpression\s*?\(/Rsi"; reference:cve,CVE-2014-4063; classtype:attempted-user; sid:2808545; rev:4;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_CLIENT DRIVEBY Social Engineering Toolkit JAR Download"; flow:established,to_server; content:"/Signed_Update.jar"; nocase; http_uri; fast_pattern:only; content:"Java/1."; http_user_agent; reference:url,trustedsec.com/downloads/social-engineer-toolkit/; reference:url,securelist.com/blog/research/66108/el-machete/; classtype:trojan-activity; sid:2018969; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT DRIVEBY Social Engineering Toolkit JAR filename detected"; flow:established,to_client; content:"<applet"; content:"Signed_Update.jar"; fast_pattern:only; reference:url,trustedsec.com/downloads/social-engineer-toolkit/; reference:url,securelist.com/blog/research/66108/el-machete/; classtype:trojan-activity; sid:2018970; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT DRIVEBY Social Engineering Toolkit Web Clone code detected"; flow:established,from_server; file_data; content:"|3c|param name=|22|"; content:"value=|22|nix.bin|22 3e|"; distance:0; reference:url,trustedsec.com/downloads/social-engineer-toolkit/; reference:url,securelist.com/blog/research/66108/el-machete/; classtype:trojan-activity; sid:2018972; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Malicious iframe guessing router password 1"; flow:established,from_server; file_data; content:"dnsPrimary="; nocase; fast_pattern:only; content:"dnsSecondary="; nocase; content:"dnsDynamic="; nocase; content:"dnsconfig.cgi"; nocase; reference:url,securelist.com/blog/incidents/66358/web-based-attack-targeting-home-routers-the-brazilian-way/; classtype:attempted-user; sid:2019111; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Malicious iframe guessing router password 2"; flow:established,from_server; file_data; content:"dnsPrimary="; nocase; fast_pattern:only; content:"dnsSecondary="; nocase; content:"dnsDynamic="; nocase; content:"rebootinfo.cgi"; nocase; reference:url,securelist.com/blog/incidents/66358/web-based-attack-targeting-home-routers-the-brazilian-way/; classtype:attempted-user; sid:2019112; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-2799"; flow:established,to_client; file_data; content:"onreadystatechange"; nocase; fast_pattern:only; content:"document.write"; nocase; pcre:"/^[\r\n\s]*?\x28\s*([\x22\x27]{2}\s*\x29|NULL)/Rsi"; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document\.createElement\([\r\n\s]*?[\x22\x27]var[\x22\x27][\r\n\s]*?\).+?(?P=var1)\.applyElement\([\r\n\s]*?document\.body[\r\n\s]*?\).+?(?P=var1)\.appendChild\([\r\n\s]*?document\.createElement/Rsi"; reference:cve,CVE-2014-2799; classtype:attempted-user; sid:2808755; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4065"; flow:established,to_client; file_data; content:"0x1FFFF"; nocase; fast_pattern:only; content:"setAttribute"; nocase; content:"lang"; nocase; content:"outerHTML"; nocase; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document\.getElementById\([\r\n\s]*?[\x22\x27](?P<font_id>[^\x22\x27]+?)[\x22\x27][\r\n\s]*?\).+?for[\r\n\s]*?\x28[\r\n\s]*?(var\s)?\s*?(?P<forIndex>[^\x3d\r\n\s]*?)\x3d[^\x3b]*?\x3b[\r\n\s]*?(?P=forIndex)[\r\n\s]*?<=?0x1ffff.+?(?P=var1)\.setAttribute.+?(?P=var1)\[[\x27\x22]lang[\x27\x22]\][\r\n\s]*\x3d[\r\n\s]*[^\x3b]+?outerHTML/Rsi"; reference:cve,CVE-2014-4065; classtype:attempted-user; sid:2808756; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Remote Code Execution CVE-2014-4080"; flow:established,to_client; file_data; content:"insertAdjacentHTML"; nocase; fast_pattern; pcre:"/^[\r\n\s]*\x28[\r\n\s]*[\x22\x27]beforeBegin[\x22\x27][\r\n\s]*\x2c/Rsi"; content:"replaceNode"; nocase; pcre:"/^[\r\n\s]*\x28document\.createTextNode[\r\n\s]*\x28[\r\n\s]*[\x22\x27]/Rsi"; content:"createTextNode"; nocase; content:"createTextRange"; nocase; pcre:"/^[\r\n\s]*\x28\x29[\r\n\s]*\.execCommand[\r\n\s]*?\x28[\r\n\s]*?[\x22\x27]JustifyRight[\x22\x27]/Rsi"; content:"applyElement"; pcre:"/^[\r\n\s]*\x28document\.createElement[\r\n\s]*\x28[\r\n\s]*[\x22\x27]/Rsi"; reference:cve,CVE-2014-4080; classtype:attempted-user; sid:2808757; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Remote Code Execution CVE-2014-4081"; flow:established,to_client; file_data; content:"document.body.contentEditable"; nocase; pcre:"/^[\r\n\s]*\x3d[\r\n\s]*[\x22\x27]true[\x22\x27]/Rsi"; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document\.createElement\([\r\n\s]*?[\x22\x27]head[\x22\x27][\r\n\s]*?\).+?\b(?P<hr_id>[^\r\n\s\x3d\x2e]+?)[\r\n\s]*\x2eapplyElement\([\r\n\s]*?[\x22\x27]?(?P=var1)[\x22\x27]?[\r\n\s]*?\).+?<hr[^\r\n\s]*?[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?(?P=hr_id)/Rsi"; content:"createTextRange"; nocase; pcre:"/^[\r\n\s]*?\x28\x29\.execCommand\x28[\r\n\s]*?[\x22\x27]Outdent[\x22\x27]/Rsi"; content:"createTextRange"; nocase; pcre:"/^[\r\n\s]*?\x28\x29\.execCommand\x28[\r\n\s]*?[\x22\x27]InsertInputCheckbox[\x22\x27]/Rsi"; reference:cve,CVE-2014-4081; classtype:attempted-user; sid:2808758; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4084"; flow:established,to_client; file_data; content:"document.body.contentEditable"; nocase; pcre:"/^[\r\n\s]*\x3d[\r\n\s]*[\x22\x27]true[\x22\x27].+?var[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document\.createElement[\r\n\s]*\x28[\r\n\s]*[\x22\x27]html[\x22\x27].+?\b(?P<var2>[^\r\n\s\x2e]+?)\.applyElement[\r\n\s]*\x28[\r\n\s]*(?P=var1)[\r\n\s]*\x29.+?(?P=var1)\.appendChild[\r\n\s]*\x28[\r\n\s]*(?P=var1)[\r\n\s]*\x29.+?<IMG[\r\n\s]*[^>]+?id[\r\n\s]*=[\r\n\s]*(?P=var2)/Rsi"; content:"createTextRange"; nocase; pcre:"/^[\r\n\s]*?\x28\x29\.execCommand\x28[\r\n\s]*?[\x22\x27]Indent[\x22\x27]/Rsi"; content:"createTextRange"; nocase; pcre:"/^[\r\n\s]*?\x28\x29\.execCommand\x28[\r\n\s]*?[\x22\x27]Outdent[\x22\x27]/Rsi"; reference:cve,CVE-2014-4084; classtype:attempted-user; sid:2808759; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4087"; flow:established,to_client; file_data; content:"onbeforeactivate"; fast_pattern:only; nocase; content:"list-style-image|3a|url"; content:"id"; pcre:"/^[\r\n\s]*?=[\r\n\s]*?(?P<var_id>\S+?)[\r\n\s]+?.*onbeforeactivate[\r\n\s]*?=[\r\n\s]*?[\x22\x27][\r\n\s]*?(?P=var_id)\.removeNode[\r\n\s]*?\([\r\n\s]*?true[\r\n\s]*?\)/Rsi"; reference:cve,CVE-2014-4087; classtype:attempted-user; sid:2808760; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4088"; flow:established,to_client; file_data; content:"onload"; content:"InsertInputSubmit"; fast_pattern:only; content:"innerHTML"; content:"undo"; nocase; pcre:"/[^\r\n\s]*?(?P<var_element>\S+?)\.applyElement\s*?\(\s*?document.createElement\s*?\(.*?createTextRange\s*?\(.*?\)\.execCommand\s*?\(.*?[\x22\x27]InsertInputSubmit[\x22\x27].*?(?P=var_element).innerHTML\s*?=\s*?\"\"/si"; reference:cve,CVE-2014-4088; classtype:attempted-user; sid:2808761; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4089"; flow:established,to_client; file_data; content:"DOMNodeInserted"; nocase; content:"selectAllChildren"; nocase; content:"createRange"; nocase; content:"pasteHTML"; nocase; content:"document.addEventListener"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]DOMNodeInserted[\x27\x22].+?getSelection\(\)\.selectAllChildren[\r\n\s]*?\x28(?P<th_id>[^\r\n\s\x29]+?)\x29.+?(?P=th_id)\.applyElement.+?document\.selection\.createRange\(\)\.pasteHTML.+?<th[\r\n\s]*[^>]+?id[\r\n\s]*=[\r\n\s]*(?P=th_id)/Rsi"; reference:cve,CVE-2014-4089; classtype:attempted-user; sid:2808762; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4092"; flow:established,to_client; file_data; content:"DOMNodeRemoved"; nocase; content:"DOMNodeInserted"; nocase; content:"OuterHTML"; nocase; content:"JustifyNone"; content:"CollectGarbage"; nocase; fast_pattern:only; pcre:"/\W(?P<var>[^\.]*?)\.outerHTML\s*?\=\s*?(?P=var)\.outerHTML/si"; reference:cve,CVE-2014-4092; classtype:attempted-user; sid:2808763; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4094"; flow:established,to_client; file_data; content:"ruby"; nocase; content:"absolute"; nocase; content:"relative"; nocase; content:"select"; nocase; content:"SelectAll"; nocase; content:"createTextRange"; nocase; pcre:"/(?:\s*?ruby[^>]?id\s*?=(?P<var1_element>\S+?)[\s>].*(?P=var1_element)\.style\.position\s*?=\s*?[\x27\x22]absolute[\x27\x22].*?createTextRange\s*?\(.*?\)\.execCommand\s*?\(\s*?[\x22\x27]SelectAll[\x22\x27].*(?P=var1_element)\.style.position\s*?=\s*?[\x22\x27]relative[\x22\x27].*createTextRange\s*?\(.*?\)\.select|\s*?(?P<var2_element>\S+?)\.style\.position\s*?=\s*?[\x27\x22]absolute[\x27\x22].*?createTextRange\s*?\(.*?\)\.execCommand\s*?\(\s*?[\x22\x27]SelectAll[\x22\x27].*(?P=var2_element)\.style.position\s*?=\s*?[\x22\x27]relative[\x22\x27].*createTextRange\s*?\(.*?\)\.select\s*?\(.*?ruby[^>]?id=(?P=var2_element))/si"; reference:cve,CVE-2014-4094; classtype:attempted-user; sid:2808764; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4095"; flow:established,to_client; file_data; content:"ol"; nocase; content:"textarea"; nocase; content:"progress"; nocase; content:"source"; nocase; content:"outside"; nocase; content:"swapNode"; content:"appendChild"; content:"createElement"; content:"file|3a 2f 2f|C|3a 2f|"; fast_pattern:only; reference:cve,CVE-2014-4095; classtype:attempted-user; sid:2808765; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Adobe Reader CVE-2014-0567"; flow:established,from_server; flowbits:isset,ET.pdf.in.http; file_data; content:".replace"; nocase; content:".substr"; nocase; content:"endobj"; fast_pattern:only; nocase; content:"var "; pcre:"/^\s*?(?P<var>[^\x3d\s]+)\s*?=\s*?(?P<q>[\x22\x27])(?:(?!(?P=q)).)*?[^\x2f]\x24(?:(?!(?P=q)).)+?(?P=q)\.substr\x28\s*?\d+\s*?\x29.+?(?P=var)\.replace\x28\s*?(?P=var)\s*?,\s*?(?P=var)\s*?\x29/Rsi"; classtype:trojan-activity; sid:2808867; rev:3;)

#
#alert tcp $EXTERNAL_NET [80,443,1935] -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible FlashPlayer CVE-2014-0551"; flow:from_server,established; byte_test:1,!&,1,0; byte_test:1,&,2,0; byte_test:1,!&,4,0; byte_test:1,!&,8,0; byte_test:1,!&,16,0; byte_test:1,!&,32,0; byte_test:1,!&,128,0; content:"|00 00 04 02|"; offset:4; depth:5; content:"|00 00 00 02|"; distance:4; within:4; classtype:attempted-user; sid:2808969; rev:1;)

#
alert tcp any any -> any any (msg:"ETPRO WEB_CLIENT Possible malformed disk image transfer CVE-2014-4115"; flow:established,to_client; file_data; content:"FAT32|20 20 20|"; content:"|55 aa|"; distance:420; within:2; byte_test:1,>,2,-496,relative; reference:cve,2014-4115; classtype:attempted-user; sid:2808986; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4126"; flow:established,to_client; file_data; content:"nth-child"; nocase; content:"inline-table"; nocase; content:"transition-duration"; fast_pattern; nocase; content:"height"; nocase; content:"document.getElementById"; nocase; content:"parentNode.removeChild"; distance:0; nocase; content:"article"; nocase; pcre:"/^[^>]+?id\s*?\x3d\s*?[\x22\x27](?P<elem>[^\x22\x27]+?)[\x22\x27].*?(?P<child>\w+?)\s*?=\s*?document.getElementbyID\s*?\x28[^\x29]+?(?P=elem).+?\.parentNode\.removeChild\s*?\x28\s*?(?P=child)/Rsi"; reference:cve,2014-4126; classtype:attempted-user; sid:2808987; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Buffer use after free CVE-2014-4127"; flow:established,to_client; file_data; content:"onload"; nocase; content:"v|3a|line"; content:"SelectAll"; nocase; content:"Indent"; nocase; content:"pasteHTML"; content:"Undo"; nocase; content:"innerHTML"; content:"onbeforeeditfocus"; fast_pattern:only; nocase; content:"contentEditable"; pcre:"/^\s*?=\s*?[\x22\x27]true[\x22\x27]/Rsi"; content:".replaceNode"; pcre:"/^\s*?\(\s*?document\.createTextNode\s*?\([\x22\x27]\w+?[\x22\x27]\s*?\)\s*?\)/Rsi"; content:"createTextRange"; pcre:"/^\s*?\([^)]*?\)\.execCommand\s*?\(\s*?[\x22\x27]SelectAll[\x22\x27]\s*?\)/Rsi"; content:"createTextRange"; pcre:"/^\s*?\([^)]*?\)\.execCommand\s*?\(\s*?[\x22\x27]Indent[\x22\x27]\s*?\)/Rsi"; content:"createRange"; pcre:"/^\s*?\([^)]*?\)\.pasteHTML\s*?\(\s*?[\x22\x27]<td/Rsi"; content:"execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]undo[\x22\x27]\s*?\)/Rsi"; reference:cve,CVE-2014-4127; classtype:attempted-user; sid:2808988; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Buffer overflow CVE-2014-4128"; flow:established,to_client; file_data; content:"CollectGarbage"; fast_pattern:only; content:"<script"; nocase; pcre:"/^.*?CollectGarbage\s*?\(.*?\)\s*?\;?\s*?document.execCommand\s*?\(\s*?[\x22\x27]SelectAll[\x22\x27]\s*?\).*?</script>/Rsi"; content:"SelectAll"; content:"table"; nocase; reference:cve,CVE-2014-4128; classtype:attempted-user; sid:2808989; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4129"; flow:established,to_client; file_data; content:"ruby"; fast_pattern; nocase; content:"inside"; nocase; content:"bdo"; nocase; content:"base"; nocase; content:"table"; nocase; content:"styleFloat"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]right[\x22\x27]/Ri"; content:"applyElement"; pcre:"/^\s*?\(\s*?\w*?\s*?,\s*?[\x22\x27]inside/Ri"; content:"applyElement"; pcre:"/^\s*?\(\s*?document\.createElement\s*?\(\s*?"ruby"\s*?\)\s*?,\s*?[\x22\x27]inside[\x22\x27]\s*?\)/Ri"; reference:cve,CVE-2014-4129; classtype:attempted-user; sid:2808990; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4130"; flow:established,to_client; file_data; content:"OBJECT"; nocase; content:"HGROUP"; nocase; content:"OPTGROUP"; nocase; content:"METER"; nocase; content:"FIELDSET"; nocase; content:"FIGURE"; nocase; content:"MAP"; nocase; content:"LINK"; nocase; content:"TABLE"; nocase; content:"tbody"; nocase; content:".style.whiteSpace"; nocase; fast_pattern:only; pcre:"/(?P<elem>[^\r\n\s]+)\.style\.whitespace[\r\n\s]*\x3d[\r\n\s]*[\x27\x22]pre-line[\x27\x22].+?(\s+[\x27\x22](?P=elem)[\x27\x22]|<(?P=elem)[\r\s\n]|[\r\n\s](?P=elem)\x2e)/si"; content:".addEventListener"; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]activate[\x27\x22][\r\n\s]*?\x2c(?P<event>[^\r\n\s\x2c]+?).+?function[\r\n\s]*?(?P=event).+?\.parentNode\.swapNode[\r\n\s]*?\x28[^\x29]+?\.parentNode\.parentNode/Rsi"; content:".addEventListener"; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]DOMAttrModified[\x27\x22][\r\n\s]*?\x2c(?P<event2>[^\r\n\s\x2c]+?).+?function[\r\n\s]*?(?P=event2).+?\.previousSibling\.previousSibling[\r\n\s]*?\!=[\r\n\s]*?null.+?previousSibling\.previousSibling\.outerHTML[\r\n\s]*?=[\r\n\s]*?(?P<q>[\x27\x22])(?P=q)/Rsi"; reference:cve,2014-4130; classtype:attempted-user; sid:2808991; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4132"; flow:established,to_client; file_data; content:"table"; nocase; content:"caption"; nocase; content:".textContent"; nocase; content:"createTextRange"; nocase; content:"setStart"; nocase; content:"setEnd"; nocase; content:"deleteContents"; nocase; content:"moveToElementText"; fast_pattern:only; nocase; content:"document.createElement"; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?[\x22\x27]table[\x22\x27][\r\n\s]*?\x29/Rsi"; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document\.createElement\([\r\n\s]*?[\x22\x27]caption[\x22\x27][\r\n\s]*?\).+?(?P=var1)\.setAttribute[\r\n\s]*\x28[\r\n\s]*?[\x27\x22]id[\x27\x22][\r\n\s]*?\x2c[\r\n\s]*?[\x27\x22](?P<caption_id>[^\r\n\s\x29]*?)[\x27\x22][\r\n\s]*?\x29.+?\b(?P=var1)\.textContent[\r\n\s]*?\x3d[\r\n\s]*?.+?appendChild[\r\n\s]*?\x28(?P=var1)[\r\n\s]*?\x29.+?(document\.createElement([\r\n\s]*?\x28[\r\n\s]*?[\x22\x27](?:t(body|head|foot|d|h))[\x22\x27][\r\n\s]*?\x29).+?(setAttribute)?.+?appendChild.+?){4,}.+?\bvar[\r\n\s]+?(?P<var2>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document(\.body)?\.createTextRange\(\).+?(?P=var2)\.moveToElementText[\r\n\s]*?\x28document\.getElementById[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22](?P=caption_id)[\x27\x22].+?(?P=var2)\.select\(\).+?(\.setStart.+?setEnd.+?){3,}/Rsi"; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document(\.body)?\.createTextRange\([\r\n\s]*?\).+?(?P=var1)\.moveToElementText.+?(?P=var1)\.select.+?document\.execCommand/Rsi"; content:"var"; nocase; distance:0; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document(\.body)?\.createTextRange\([\r\n\s]*?\).+?(?P=var1)\.moveToElementText.+?(?P=var1)\.select.+?document\.execCommand/Rsi"; reference:cve,2014-4132; classtype:attempted-user; sid:2808992; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4133"; flow:established,to_client; file_data; content:"createTextRange"; nocase; content:"moveToElementText"; nocase; content:"select"; nocase; content:"execCommand"; nocase; content:"superscript"; fast_pattern:only; nocase; content:"setAttribute"; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]dir[\x27\x22]/Rsi"; pcre:"/(setAttribute[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]((?:c(?:o(?:ntenteditable|ords)|l(?:ass|ear))|s(?:pellcheck|crolling|andbox|hape)|a(?:l(?:ign|t)|ccesskey|rea)|t(?:a(?:bindex|rget)|itle)|d(?:ata-ldwj|raggable|ir)|margin(?:height|width)|h(?:eight|ref)|i(?:frame|d)|w(?:idth|br)|frameborder|lang|name|rel))[\x27\x22][\r\n\s]*?\x2c[\r\n\s]*?[\x22\x27].+?setAttribute[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]((?:c(?:o(?:ntenteditable|ords)|l(?:ass|ear))|s(?:pellcheck|crolling|andbox|hape)|a(?:l(?:ign|t)|ccesskey|rea)|t(?:a(?:bindex|rget)|itle)|d(?:ata-ldwj|raggable|ir)|margin(?:height|width)|h(?:eight|ref)|i(?:frame|d)|w(?:idth|br)|frameborder|lang|name|rel))[\x27\x22][\r\n\s]*?\x2c[\r\n\s]*?[\x22\x27].+?){12,}/si"; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document(\.body)?\.createTextRange\([\r\n\s]*?\).+?(?P=var1)\.moveToElementText[\r\n\s]*?\x28[\r\n\s]*?document\.body\.all.+?(?P=var1)\.select.+?document\.execCommand/Rsi"; reference:cve,2014-4133; classtype:attempted-user; sid:2808993; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2014-4134"; flow:established,to_client; file_data; content:"createTextRange"; nocase; content:"moveToElementText"; nocase; content:"select"; nocase; content:"execCommand"; nocase; content:"textContent"; pcre:"/^[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27](\x25u[a-f0-9]{2})+[\x22\x27]/Rsi"; content:"subscript"; fast_pattern:only; nocase; content:"setAttribute"; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]dir[\x27\x22]/Rsi"; pcre:"/(setAttribute[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]((?:c(?:o(?:ntenteditable|ords)|l(?:ass|ear))|s(?:pellcheck|crolling|andbox|hape)|a(?:l(?:ign|t)|ccesskey|rea)|t(?:a(?:bindex|rget)|itle)|d(?:ata-ldwj|raggable|ir)|margin(?:height|width)|h(?:eight|ref)|i(?:frame|d)|w(?:idth|br)|frameborder|lang|name|rel))[\x27\x22][\r\n\s]*?\x2c[\r\n\s]*?[\x22\x27].+?setAttribute[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]((?:c(?:o(?:ntenteditable|ords)|l(?:ass|ear))|s(?:pellcheck|crolling|andbox|hape)|a(?:l(?:ign|t)|ccesskey|rea)|t(?:a(?:bindex|rget)|itle)|d(?:ata-ldwj|raggable|ir)|margin(?:height|width)|h(?:eight|ref)|i(?:frame|d)|w(?:idth|br)|frameborder|lang|name|rel))[\x27\x22][\r\n\s]*?\x2c[\r\n\s]*?[\x22\x27].+?){12,}/si"; content:"var"; nocase; pcre:"/^[\r\n\s]+?(?P<var1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?document(\.body)?\.createTextRange\([\r\n\s]*?\).+?(?P=var1)\.moveToElementText[\r\n\s]*?\x28[\r\n\s]*?document\.body\.all.+?(?P=var1)\.select.+?document\.execCommand/Rsi"; reference:cve,2014-4134; classtype:attempted-user; sid:2808994; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Heap Corruption CVE-2014-4138"; flow:established,to_client; file_data; content:"getSelection"; nocase; content:"collapseToEnd"; nocase; fast_pattern:only; content:"Copy"; nocase; content:"Paste"; nocase; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]Copy[\x22\x27].+?execCommand\s*?\(\s*?[\x22\x27]Paste[\x22\x27]/Rsi"; content:"designMode"; pcre:"/^\s*?=[\x22\x27]on[\x22\x27]/Rsi"; reference:cve,2014-4138; classtype:attempted-user; sid:2808995; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer 11 Sandbox Escapes vulnerable ActiveX control in executable (CVE-2014-4123)"; flow:to_client,established; flowbits:isset,ET.http.binary; file_data; content:"4|00|8|00|7|00|1|00|A|00|8|00|7|00|A|00 2d 00|B|00|F|00|D|00|D|00 2d 00|4|00|1|00|0|00|6|00 2d 00|8|00|1|00|5|00|3|00 2d 00|F|00|F|00|D|00|E|00|2|00|B|00|A|00|C|00|2|00|9|00|6|00|7"; nocase; reference:cve,2014-4123; reference:cve,2014-4124; classtype:attempted-user; sid:2808996; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer 11 Sandbox Escapes methods in executable (CVE-2014-4123)"; flow:to_client,established; flowbits:isset,ET.http.binary; file_data; content:"AX Install Broker"; fast_pattern:only; content:"User Broker"; nocase; content:"InstallFile"; nocase; reference:cve,2014-4123; reference:cve,2014-4124; classtype:attempted-user; sid:2808997; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Memory Corruption Vulnerability CVE-2014-4137"; flow:to_client,established; file_data; content:"document.createElement"; nocase; content:"table"; nocase; content:"document.body.appendChild"; nocase; content:"tbody"; nocase; content:"deleteRow"; nocase; fast_pattern; pcre:"/\b(?P<table_var_id>[^\r\n\s]*?)[\r\n\s]+?\x3d[\r\n\s]*?document\.createElement[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]table[\x27\x22][\r\n\s]*?\x29.+?\b(?P<tr_var_id>[^\r\n\s]*?)[\r\n\s]+?\x3d[\r\n\s]*?document\.createElement[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]tr[\x27\x22][\r\n\s]*?\x29.+?\b(?P<tr_var_id2>[^\r\n\s]*?)[\r\n\s]+?\x3d[\r\n\s]*?document\.createElement[\r\n\s]*?\x28[\r\n\s]*?[\x27\x22]tr[\x27\x22][\r\n\s]*?\x29.+?\b(?P=table_var_id)\.deleteRow[\r\n\s]*?\x28[\r\n\s]*?\x2d\x31[\r\n\s]*?\x29/"; reference:cve,2014-4137; classtype:attempted-user; sid:2808998; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer heap corruption CVE-2014-4140"; flow:established,to_client; file_data; content:"|3c 2f|basefont"; fast_pattern:only; pcre:"/&(?:crarr|#(?:8629|21B5|10|13|xA|xD))\x82&<\/basefont/i"; reference:cve,2014-4140; classtype:attempted-user; sid:2808999; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Memory Corruption Vulnerability CVE-2014-4141"; flow:to_client,established; file_data; content:"ms-beginUndoUnit"; content:".childNodes[0].getElementsByTagName"; content:"rt"; content:"CollectGarbage"; fast_pattern; content:"document.execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]Undo[\x22\x27]/Ri"; reference:cve,2014-4141; classtype:attempted-user; sid:2809000; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Local Privilege Escalation Vulnerability methods in executable (CVE-2014-4113) x64 1"; flow:to_client,established; flowbits:isset,ET.http.binary; file_data; content:"ZwAllocateVirtualMemory"; fast_pattern:only; content:"|89 1D 03 00 00 00 C6 05 11 00 00 00 04 C7 05 5B 00 00 00|"; content:"|B8 FB FF FF FF|"; content:"|5A 77 41 6C 6C 6F 63 61 74 65 56 69 72 74 75 61 6C 4D 65 6D 6F 72 79 00|"; reference:cve,2014-4113; classtype:attempted-user; sid:2809001; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Local Privilege Escalation Vulnerability methods in executable (CVE-2014-4113) x64 2"; flow:to_client,established; flowbits:isset,ET.http.binary; file_data; content:"ZwAllocateVirtualMemory"; fast_pattern:only; content:"|48 A3 0B 00 00 00 01 00 00 00 B0 04 A2 25 00 00 00 01 00 00 00|"; nocase; content:"|B8 FB FF FF FF|"; nocase; content:"|5A 77 41 6C 6C 6F 63 61 74 65 56 69 72 74 75 61 6C 4D 65 6D 6F 72 79 00|"; reference:cve,2014-4123; reference:cve,2014-4113; classtype:attempted-user; sid:2809002; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible CVE-2014-4113 Exploit Download"; flow:to_client,established; file_data; content:"MZ"; within:2; byte_jump:4,58,relative,little; content:"PE|00 00|"; distance:-64; within:4; content:"|fb ff ff ff|"; content:"|0b 00 00 00 01 00 00 00|"; content:"|25 00 00 00 01 00 00 00|"; content:"|8b 00 00 00 01 00 00 00|"; fast_pattern; reference:url,blog.crowdstrike.com/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/; reference:cve,2014-4141; classtype:attempted-user; sid:2019420; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible CVE-2014-4113 Exploit Download with Hurricane Panda IOC"; flow:to_client,established; flowbits:isset,ET.http.binary; file_data; content:"woqunimalegebi"; fast_pattern:only; reference:url,blog.crowdstrike.com/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/; reference:cve,2014-4113; classtype:attempted-user; sid:2019421; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer CSecurityContext Use-After-Free CVE-2014-4143"; flow:to_client,established; file_data; content:"classList.toggle"; nocase; content:"contentWindow.document"; nocase; content:"setTimeout"; nocase; content:"CollectGarbage"; nocase; fast_pattern; content:"removeChild"; nocase; content:"childNodes"; nocase; content:"nextSibling"; nocase; content:"firstElementChild"; nocase; content:"parentNode"; nocase; content:"location.reload"; pcre:"/\b(?P<iframe_id>[^\r\n\s\x2e]*?)\x2esrc[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22][^\x22\x27]+?\.html[\x22\x27].+?(?P=iframe_id)\.onload[\r\n\s]*?\x3d[\r\n\s]*?function.+?(?P=iframe_id)\.contentWindow.document.+?setTimeout.+?<iframe[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=iframe_id)[\x27\x22]/si"; reference:cve,2014-4143; classtype:attempted-user; sid:2809143; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer IE_AudioSrv_SandboxEscape (CVE-2014-6322)"; flow:to_client,established; flowbits:isset,ET.http.binary; file_data; content:"|00 5c 00 53 00 6f 00 66 00  74 00 77 00 61 00 72 00 65 00 5c 00 4d 00 69 00  63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00  49 00 6e 00 74 00 65 00 72 00 6e 00 65 00 74 00  20 00 45 00 78 00 70 00 6c 00 6f 00 72 00 65 00  72 00 5c 00 4c 00 6f 00 77 00 52 00 65 00 67 00  69 00 73 00 74 00 72 00 79 00 5c 00 41 00 75 00  64 00 69 00 6f 00 00|"; nocase; content:"DeleteKey"; content:"CreateKey"; content:"SetValueKey"; reference:cve,2014-6322; classtype:attempted-user; sid:2809144; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer clipboardData Use-After-Free CVE-2014-6323"; flow:to_client,established; file_data; content:"clipboard"; nocase; content:"event"; nocase; content:"clipboardData"; fast_pattern:only; nocase; content:"setInterval"; nocase; content:"setTimeout"; nocase; content:"on"; nocase; pcre:"/^(?:paste|copy|cut)[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27](?P<event_handle>[^\r\n\s\x22\x27\x28]+?)\x28event\x29[\x22\x27].+?(?P=event_handle)[\r\n\s]*?\x28event\x29.+?clipboardData\.(?:clear|get|set)Data.+?set(?:Interval|Timeout).+?set(?:Interval|Timeout)/Rsi"; reference:cve,2014-6323; classtype:attempted-user; sid:2809145; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Word RCE (CVE-2014-6333)"; flow:to_client,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|ec a5 c1 00|"; nocase; fast_pattern; content:"|0e 00|"; distance:28; within:2; content:"|16 00|"; distance:28; within:2; pcre:"/^.{88}[\x5d\x6c\x88\xa4\xb7]\x00/R"; content:"|00 00 00 00|"; distance:1316; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:"|00 00 00 00|"; distance:4; within:4; content:!"|00 00 00 00|"; distance:4; within:4; reference:cve,2014-6333; classtype:attempted-user; sid:2809148; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Word RCE (CVE-2014-6334)"; flow:to_client,established; flowbits:isset,OLE.CompoundFile; file_data; content:"|ec a5 c1 00|"; nocase; fast_pattern; content:"|0e 00|"; distance:28; within:2; content:"|16 00|"; distance:28; within:2; pcre:"/^.{88}[\x5d\x6c\x88\xa4\xb7]\x00/R"; byte_test:4,&,0x8000000,28,relative,little; content:"|00 00 00 00|"; distance:868; within:4; byte_test:4,&,0x8000000,16,relative,little; content:!"|00 00 00 00|"; distance:20; within:4; reference:cve,2014-6334; classtype:attempted-user; sid:2809149; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Memory Corruption Vulnerability CVE-2014-6337"; flow:from_server,established; file_data; content:"body.contentEditable"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]true[\x22\x27]/Rsi"; content:"style.display"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]none[\x22\x27]/Rsi"; content:"selection.createRange"; nocase; fast_pattern; pcre:"/^\s*?\x28[^\x29]*?\x29\.scrollIntoView\s*?\x28\s*?true\s*?\x29/Rsi"; content:"innerHTML"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]{2}/Rsi"; content:"body.contentEditable"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]false[\x22\x27]/Rsi"; reference:cve,2014-6337; classtype:attempted-user; sid:2809152; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer ASLR Bypass CVE-2014-6339"; flow:from_server,established; file_data; content:"appendChild"; pcre:"/^\s*?\x28\s*?document\.createElement\s*?\x28\s*?[\x22\x27]th[\x22\x27]/Rsi"; content:".pasteHTML"; nocase; fast_pattern:only; content:"selection.createRange"; nocase; pcre:"/^\s*?\x28[^\x29]*?\x29\.pasteHTML\s*?\x28\s*?[\x22\x27]<td/Rsi"; content:"style.position"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]absolute[\x22\x27]/Rsi"; content:".createTextRange"; nocase; pcre:"/^\s*?\x28[^\x29]*?\x29\.execCommand\s*?\x28\s*?[\x22\x27]Outdent[\x22\x27]/Rsi"; content:".createTextRange"; nocase; pcre:"/^\s*?\x28[^\x29]*?\x29\.execCommand\s*?\x28\s*?[\x22\x27]SelectAll[\x22\x27]/Rsi"; content:"style.display"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]none[\x22\x27]/Rsi"; reference:cve,2014-6339; classtype:attempted-user; sid:2809153; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Cross-domain Information Disclosure CVE-2014-6340"; flow:established,to_client; file_data; content:"__IE_DisplayURL"; fast_pattern; nocase; content:"ExecWB"; nocase; pcre:"/^[\s]*?\([\s]*?51[\s]*?,[^\)]+?true[\s]*?\)/Rsi"; reference:cve,CVE-2014-6340; classtype:attempted-user; sid:2809154; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer CStyleSheet Use-After-Free CVE-2014-6341"; flow:to_client,established; file_data; content:".setAttribute"; nocase; content:".addImport"; nocase; content:".imports.item"; nocase; content:"removeImport"; nocase; content:"setTimeout"; nocase; content:"CollectGarbage"; fast_pattern:only; nocase; content:"parentStyleSheet"; pcre:"/\b(?P<vstyle1>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?(?P<style1>[^\r\n\s\x3d\x2e]+?)\x2esheet.+?(?P=style1)\.setAttribute\([\r\n\s]*?[\x27\x22]type[\x27\x22]\x2c[\r\n\s]*?null[\r\n\s]*?\).+?(?P=vstyle1)\.addImport.+?(?P<vstyle2>[^\r\n\s\x3d]+?)[\r\n\s]*?=[\r\n\s]*?(?P=vstyle1)\.imports.+?(?P=vstyle1)\.removeImport.+?setTimeout.+?CollectGarbage.+?(?P=vstyle2)\.parentStyleSheet.+?<style[^>]+?id[\r\n\s]*?\x3d[\r\n\s]*?[\x27\x22](?P=style1)[\x27\x22]/si"; nocase; reference:cve,2014-6341; classtype:attempted-user; sid:2809155; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer out of bounds write RCE CVE-2014-6342"; flow:to_client,established; file_data; content:"position|3a|"; nocase; pcre:"/^[\r\n\s]*?relative/Rsi"; content:"position|3a|"; nocase; pcre:"/^[\r\n\s]*?fixed/Rsi"; content:"display|3a|"; nocase; pcre:"/^[\r\n\s]*?block/Rsi"; content:".appendChild"; nocase; content:"document.documentElement"; fast_pattern:only; content:"<style>"; nocase; pcre:"/^[\r\n\s]*((?!<\/style>).)+?(position\x3a[^}]+?relative[\r\n\s]*?}.+?position\x3a[^}]+?fixed[\r\n\s]*?}|position\x3a[^}]+?fixed[\r\n\s]*?}.+?position\x3a[^}]+?relative[\r\n\s]*?})/Rsi"; content:"window.onload"; pcre:"/^[\r\n\s]*\x3d[\r\n\s]*function/Rsi"; reference:cve,2014-6342; classtype:attempted-user; sid:2809156; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer  JavaScript parsing error Information Disclosure CVE-2014-6345"; flow:to_client,established; file_data; content:"csv|22|>"; fast_pattern:only; content:"<script"; nocase; pcre:"/^[^>]+?src[\r\n\s]*?\x3d[\r\n\s]*?[\x22\x27][^\x22\x27]+\.csv[\x22\x27]\x3e/Rsi"; reference:cve,2014-6345; classtype:attempted-user; sid:2809157; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Memory Corruption Vulnerability CVE-2014-6347"; flow:from_server,established; file_data; content:".createTextNode"; content:".__proto__"; fast_pattern; pcre:"/^\s*?=\s*/Rs"; content:"document.documentElement.dataset"; within:32; content:"unescape"; content:"u"; nocase; pcre:"/^[A-Fa-f0-9]{4}[\x5c\x25]u[A-Fa-f0-9]{4}/Rsi"; reference:cve,2014-6347; classtype:attempted-user; sid:2809158; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Memory Corruption Vulnerability CVE-2014-6347"; flow:from_server,established; file_data; content:".createComment"; content:".__proto__"; fast_pattern; pcre:"/^\s*?=\s*/Rs"; content:"document.documentElement.dataset"; within:32; content:"unescape"; content:"u"; nocase; pcre:"/^[A-Fa-f0-9]{4}[\x5c\x25]u[A-Fa-f0-9]{4}/Rsi"; reference:cve,2014-6347; classtype:attempted-user; sid:2809160; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE Memory Corruption Vulnerability CVE-2014-6351"; flow:from_server,established; file_data; content:"frameset"; nocase; content:"applyElement"; nocase; content:"onload"; nocase; content:"<table"; nocase; content:"quotes"; nocase; pcre:"/\s*?[\x3a\x3d]\s*?[\x22\x27]?none/Rsi"; content:"window.location.href"; fast_pattern; nocase; pcre:"/^\s*?=\s*?[\x22\x27]?https?\x3a\x2f/Rsi"; content:"<body "; nocase; pcre:"/^[^>]*?onload\s*?=\s*?/Rsi"; reference:cve,2014-6351; classtype:attempted-user; sid:2809161; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Memory Corruption Vulnerability CVE-2014-6353"; flow:from_server,established; file_data; content:"u475046"; fast_pattern:only; nocase; content:"onkeydown"; nocase; content:"fireEvent"; nocase; content:"createControlRange"; nocase; content:"innerText"; nocase; content:"appendChild"; nocase; content:"select"; nocase; content:"delete"; nocase; content:"window"; content:"location"; content:"reload"; reference:cve,2014-6353; classtype:attempted-user; sid:2809162; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Malformed MP4 Possible Adobe FlashPlayer CVE-2014-0553"; flow:established,from_server; file_data; content:"stsc"; byte_test:4,>,0,4,relative; byte_test:4,>,1,8,relative; byte_test:4,=,1,12,relative; classtype:attempted-user; sid:2809168; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Internet Explorer VBscript failure to handle error case information disclosure CVE-2014-6332"; flow:to_client,established; file_data; content:"vbscript"; nocase; content:"redim "; nocase; fast_pattern; pcre:"/^\s*?Preserve/Rsi"; content:"<script "; nocase; pcre:"/^[^>]*?(?:language\s*?=\s*?[\x22\x27]vbscript[\x22\x27]|type\s*?=\s*?[\x22\x27]text\/vbscript[\x22\x27])/Rsi"; reference:cve,2014-6332; classtype:attempted-user; sid:2019706; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT GENERIC VB ShellExecute Function Inside of VBSCRIPT tag"; flow:to_client,established; file_data; content:"vbscript"; nocase; content:"shellexecute"; nocase; fast_pattern:only; content:"<script "; nocase; pcre:"/^[^>]*?(?:language\s*?=\s*?[\x22\x27]vbscript[\x22\x27]|type\s*?=\s*?[\x22\x27]text/vbscript[\x22\x27](?:(?!<\/script>).)+?\WShellExecute)/Rsi"; reference:cve,2014-6332; classtype:attempted-user; sid:2019707; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Internet Explorer VBscript failure to handle error case information disclosure obfuscated CVE-2014-6332"; flow:to_client,established; file_data; content:"vbscript"; nocase; content:"Xor"; nocase; pcre:"/^\W/R"; content:"Execute"; nocase; content:"&chr"; nocase; content:"UBound"; fast_pattern:only; nocase; content:"Cint"; nocase; pcre:"/^\W/R"; content:"Split"; nocase; pcre:"/^\W/R"; content:"Mid"; pcre:"/^\W/R"; content:"Len"; pcre:"/^\W/R"; reference:cve,2014-6332; classtype:attempted-user; sid:2019715; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT GENERIC Possible IE Memory Corruption CollectGarbage with DOM Reset"; flow:established,to_client; file_data; content:"unescape"; nocase; content:"%u"; nocase; content:"CollectGarbage"; nocase; fast_pattern:only; content:"innerHTML"; nocase; pcre:"/^\s*?=\s*?(?:undefined|false|null|-?0|NaN|\x22\x22|\x27\x27)/Rsi"; classtype:attempted-user; sid:2019730; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Internet Explorer VBscript failure to handle error case information disclosure CVE-2014-6332 Percent Hex Encode"; flow:to_client,established; file_data; content:"vbscript"; nocase; content:"redim|25|"; nocase; fast_pattern; pcre:"/^(?:25)?20(?:\x25(?:25)?20|\s)*?Preserve/Rsi"; content:"redim|25|"; nocase; distance:0; pcre:"/^(?:25)?20(?:\x25(?:25)?20|\s)*?Preserve/Rsi"; reference:cve,2014-6332; classtype:attempted-user; sid:2019732; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Samsung Galaxy Knox Android Browser RCE smdm attempt"; flow:to_client,established; file_data; content:"smdm|3a|//"; nocase; distance:0; reference:url,blog.quarkslab.com/abusing-samsung-knox-to-remotely-install-a-malicious-application-story-of-a-half-patched-vulnerability.html; reference:osvdb,114590; reference:url,cxsecurity.com/issue/WLB-2014110124; classtype:web-application-activity; sid:2019750; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Memory Corruption Vulnerability CVE-2014-6348"; flow:from_server,established; file_data; content:"<q><img><h4>"; nocase; fast_pattern:only; content:"pasteHTML"; nocase; content:"pasteHTML"; distance:0; content:"insertimage"; nocase; content:"createTextRange"; nocase; content:"createTextRange"; nocase; distance:0; content:"createRange"; content:"h6"; reference:cve,2014-6348; classtype:attempted-user; sid:2809228; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT SUSPICIOUS Possible Office Doc with Embedded VBA Project"; flow:established,from_server; flowbits:isset,et.http.PK; file_data; content:"/vbaProject"; nocase; pcre:"/\d*?\.bin/Ri"; flowbits:set,et.DocVBAProject; classtype:bad-unknown; sid:2019835; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT SUSPICIOUS Possible Office Doc with Embedded VBA Project"; flow:established,from_server; flowbits:isset,et.http.PK; file_data; content:"_VBA_PROJECT"; nocase; flowbits:set,et.DocVBAProject; classtype:bad-unknown; sid:2019836; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT SUSPICIOUS Possible Office Doc with Embedded VBA Project (Wide)"; flow:established,from_server; flowbits:isset,et.MCOFF; file_data; content:"_|00|V|00|B|00|A|00|_|00|P|00|R|00|O|00|J|00|E|00|C|00|T|00|"; nocase; flowbits:set,et.DocVBAProject; classtype:bad-unknown; sid:2019837; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Internet Explorer VBscript CVE-2014-6332 multiple redim preserve"; flow:to_client,established; content:"preserve"; nocase; content:"redim "; nocase; fast_pattern; pcre:"/^\s*?Preserve\s*?(?P<var1>[a-z]\w{0,254}+)\s*?\x28\s*?[^\x29]+?\x29.*?redim\s*?Preserve\s*?(?P=var1)/Rsi"; reference:cve,2014-6332; classtype:attempted-user; sid:2019842; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT PDF With Hidden Embedded File"; flow:established,to_client; flowbits:isset,ET.pdf.in.http; file_data; content:"obj"; distance:0; content:"<<"; within:4; content:"/Embeddedfile"; distance:0; pcre:"/\x3C\x3C[^>]*\x2FEmbeddedfile/sm"; reference:url,blog.didierstevens.com/2009/07/01/embedding-and-hiding-files-in-pdf-documents/; classtype:bad-unknown; sid:2019850; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE CSetTimeoutInfo Use-After-Free CVE-2014-6327"; flow:from_server,established; file_data; content:"removeChild"; fast_pattern; nocase; content:"iframe"; nocase; content:"delete"; content:"setTimeout"; content:"function"; pcre:"/^\s+?(?P<functionname>[\S]+?)\s*?\(\s*?(?P<functionvar>\S+?)\s*?\)\s*?{.*?setTimeout\s*?\([^,]+?(?P=functionname)\s*?\(\s*?(?P=functionvar)\s*?\)[^,]+?,\s*?\d+?\s*?,\s*?(?P=functionvar)/Rsi"; reference:cve,2014-6327; classtype:attempted-user; sid:2809298; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use After Free CVE-2014-6329 M1"; flow:established,from_server; file_data; content:"insertAdjacent"; content:"insertAdjacent"; distance:0; content:" Array"; content:"for"; pcre:"/^\s*?\x28\s*(?P<var>[^\s\x3d]+)\s*?=\s*?\d+\s*?\x3b\s*?(?P=var)\s*?\<\s*?(?:0x(?:(6[4-9a-f]|[7-9a-f])|\d{3,})|\d{3,})\s*?\x3b\s*?(?P=var)\+\+[^}]+\[\s*?(?P=var)\s*?\]\s*?=\s*?document.create/Rsi"; classtype:attempted-user; sid:2809299; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use After Free CVE-2014-6329 M2"; flow:established,from_server; file_data; content:"insertAdjacent"; content:"insertAdjacent"; distance:0; content:" Array"; content:"for"; pcre:"/^\s*?\x28\s*(?P<var>[^\s\x3d]+)\s*?=\s*(?:0x(?:(6[4-9a-f]|[7-9a-f])|\d{3,})|\d{3,})\s*?\x3b\s*?(?P=var)\s*?\<\s*?\d{3,}\s*?\x3b\s*?(?P=var)\+\+[^}]+\[\s*?(?P=var)\s*?\]\s*?var\s+(?P<varname>[^\x3d\s]+)\s*?=\s*?document.create[^}]+\.push\x28\s*?(?P=varname)\s*?\x29/Rsi"; classtype:attempted-user; sid:2809300; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use After Free CVE-2014-6329 M3"; flow:established,from_server; file_data; content:"insertAdjacent"; nocase; content:"insertAdjacent"; nocase; distance:0; content:"Array"; nocase; content:"for"; nocase; pcre:"/^\s*?\x28\s*(?P<var>[^\s\x3d]+)\s*?=\s*(?:0x(?:(6[4-9a-f]|[7-9a-f])|\d{3,})|\d{3,})\s*?\x3b\s*?(?P=var)\s*?\<\s*?\d{3,}\s*?\x3b\s*?(?P=var)\+\+[^}]+\[\s*?(?P=var)\s*?\]\s*?var\s+(?P<varname>[^\x3d\s]+)\s*?=\s*?document.create[^}]+\.appendChild\x28\s*?(?P=varname)\s*?\x29/Rsi"; classtype:attempted-user; sid:2809301; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorerer Use After Free CVE-2014-6330"; flow:established,from_server; file_data; content:"createTextRange"; nocase; content:"NodeFilter.FILTER_REJECT"; nocase; content:"currentNode"; pcre:"/^\s*?=/R"; content:"nextNode"; content:"createTreeWalker"; nocase; pcre:"/^\s*?\(\s*?document.body\s*?,\s*?(?:-?1|NodeFilter\.SHOW_(?:ELEMENT|ALL))/Ri"; content:"appendChild"; nocase; content:"appendChild"; distance:0; nocase; content:"parentNode"; nocase; content:"parentNode"; nocase; distance:0; reference:cve,2014-6330; classtype:trojan-activity; sid:2809302; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft IE Information Leak Unitialized Stack Variable (CVE-2014-6355)"; flow:from_server,established; file_data; content:"|FF D8 FF E0|"; fast_pattern; content:"JFIF|00|"; distance:2; within:5; content:"|FF C4|"; distance:0; content:!"|00 00|"; within:2; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:2; within:17; content:!"|00|"; within:1; reference:cve,CVE-2014-6355; classtype:attempted-user; sid:2809303; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Rich Text File Use-After-Free cve-2014-6357"; flow:from_server,established; file_data; flowbits:isset,ETPRO.RTF; content:"|7b 5c|shp|7b|"; content:"|7b 5c|sp"; distance:0; content:"|7b 5c|sn"; distance:0; pcre:"/^\s+(?P<snproperty>[^{}\r\n\s]+?).*?\x7b\x5cshp.*?\x7b\x5csp.*?\x7b\x5csn\s+?(?P=snproperty)/Rsi"; content:"|7b 5c|sp"; content:"|5c|pict"; distance:0; content:"|5c|dibitmap0"; distance:0; content:"|5c|wbmwidthbytes"; distance:0; fast_pattern; pcre:"/^\s*(?P<wbmwidthbytes>[A-F0-9]+?).+?\x7b\\sp.*?\\pict.*?\\dibitmap0.*?\\wbmwidthbytes(?P=wbmwidthbytes)/Rsi"; classtype:attempted-user; sid:2809304; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted OfficeArtBstoreContainer record download cve-2014-6360"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; file_data; content:"|eb 00|"; content:"|00 f0|"; distance:4; within:2; content:"|01 f0|"; distance:0; content:"|02 00 07 e0|"; distance:4; within:4; byte_test:1,&,0x0f,-12,relative,little; content:"|40 3d 1a f0|"; within:100; content:"|00 6e 1e f0|"; content:"|89|PNG"; distance:0; reference:cve,2014-6360; classtype:attempted-user; sid:2809305; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted incorrect type assumed BiffRecord download cve-2014-6361 - SET"; flow:established,from_server; flowbits:isset,ETPRO.Microsoft.Excel; file_data; content:"|85 00|"; content:"|02|"; distance:6; within:2; byte_test:2,<,0x32,0,relative,little; byte_test:2,>,0x00,0,relative,little; byte_extract:2,0,ShortXLUnicodeString.length,relative,little; content:!"|00|"; within:ShortXLUnicodeString.length; content:!"|03|"; within:ShortXLUnicodeString.length; content:!"|3a|"; within:ShortXLUnicodeString.length; content:!"|5c|"; within:ShortXLUnicodeString.length; content:!"|2a|"; within:ShortXLUnicodeString.length; content:!"|3f|"; within:ShortXLUnicodeString.length; content:!"|2f|"; within:ShortXLUnicodeString.length; content:!"|5b|"; within:ShortXLUnicodeString.length; content:!"|5d|"; within:ShortXLUnicodeString.length; flowbits:set,ETPRO.2014-6361; flowbits:noalert; reference:cve,2014-6361; classtype:attempted-user; sid:2809306; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Excel corrupted incorrect type assumed BiffRecord download cve-2014-6361"; flow:established,from_server; flowbits:isset,ETPRO.2014-6361; file_data; content:"|08 02 18 00|"; byte_jump:2,-2,relative,little; content:"|0a 00|"; within:2; content:!"|00 00|"; within:2; reference:cve,2014-6361; classtype:attempted-user; sid:2809307; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT VBScript Use-After-Free CVE-2014-6363"; flow:from_server,established; file_data; content:"VBScript"; fast_pattern; nocase; content:"regexp"; nocase; content:"global"; nocase; content:"language"; nocase; pcre:"/^\s*?=\s*?[\x22\x27](?:text/)?vbscript[\x22\x27]/Rsi"; content:"set"; nocase; pcre:"/^\s+?(?P<regexobj>\S+?)\s+?=\s+?new\s+?regexp.+?(?P=regexobj).global\s+?=\s+?true/Rsi"; reference:cve,2014-6363; classtype:attempted-user; sid:2809308; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Double Encoding Reflected XSS Vulnerability CVE-2014-6365"; flow:to_server,established; content:"%253C"; fast_pattern:only; content:"%253C"; http_raw_uri; nocase; pcre:"/\?[^&]+?\?[^&]*?%253C[^&]+?%253E/I"; reference:cve,2014-6365; classtype:attempted-user; sid:2809309; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After Free CVE-2014-6366"; flow:established,to_client; file_data; content:"srcElement.parentNode.outerHTML"; nocase; pcre:"/^\s*?=\s*?(?:\x22{2}|\x27{2})/Rsi"; content:"document.createElement"; nocase; pcre:"/^\s*\x28\s*?[\x22\x27]form[\x22\x27]/Rsi"; content:"document.createElement"; nocase; pcre:"/^\s*\x28\s*?[\x22\x27]input[\x22\x27]/Rsi"; content:"appendChild"; nocase; content:"KBD"; nocase; content:"COL"; nocase; content:"CAPTION"; nocase; content:"BASE"; nocase; content:"attachEvent"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]onpropertychange[\x22\x27]/Rsi"; content:"eval"; nocase; pcre:"/^\s*?\x28\s*?[^\x2e]+?\.applyElement/Rsi"; reference:cve,CVE-2014-6366; classtype:attempted-user; sid:2809310; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After Free CVE-2014-6369"; flow:established,to_client; file_data; content:".createTFoot"; nocase; fast_pattern; content:"CollectGarbage"; nocase; distance:0; content:".applyElement"; nocase; distance:0; content:".applyElement"; nocase; distance:0; content:".innerHTML"; nocase; distance:0; content:"CollectGarbage"; nocase; distance:0; content:".createTFoot"; nocase; distance:0; content:"var"; pcre:"/^\s*?(?P<var>[^\s\x3d]+?)\s*?=\s*?document\.createElement\x28\s*?[\x22\x27]media[\x22\x27].+?document\.body\.appendChild\x28\s*?(?P=var)\s*?\x29.+?(?P=var)\.innerHTML\s*?=\s*?(?:\x22{2}|\x27{2})/Rsi"; reference:cve,CVE-2014-6369; classtype:attempted-user; sid:2809311; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Incorrect Object Type CVE-2014-6373"; flow:from_server,established; file_data; content:"<style"; nocase; content:"setTimeout"; content:"display"; nocase; content:"table-cell"; distance:0; nocase; content:"position"; nocase; content:"relative"; distance:0; nocase; content:"style.setProperty"; fast_pattern; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]position[\x22\x27]\s*?\,\s*?[\x22\x27]relative[\x22\x27]/Rsi"; content:"style.setProperty"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]display[\x22\x27]\s*?\,\s*?[\x22\x27]table-cell[\x22\x27]/Rsi"; content:"style.setProperty"; nocase; pcre:"/\s(?P<nodevar>\S+?)\.parentnode\.appendchild\s*?\(\s*?(?P=nodevar)/si"; reference:cve,2014-6373; classtype:attempted-user; sid:2809312; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE OOB Array Access CVE-2014-6376"; flow:from_server,established; file_data; content:"insertAdjacentHTML"; pcre:"/\s*?\(\s*?[\x22\x27]beforeend[\x22\x27]\s*?\,/"; content:"appendChild"; content:"colgroup"; nocase; content:"noscript"; nocase; content:"tr"; nocase; content:"frameset"; nocase; content:"tt"; nocase; content:"bdo"; nocase; content:"kbd"; nocase; content:"beforeend"; content:"nth-child"; nocase; content:"document.createElement"; pcre:"/\s*?\(\s*?[\x22\x27]colgroup[\x22\x27]/Rsi"; content:"document.createElement"; pcre:"/\s*?\(\s*?[\x22\x27]tr[\x22\x27]/Rsi"; content:"document.createElement"; pcre:"/\s*?\(\s*?[\x22\x27]noscript[\x22\x27]/Rsi"; content:"document.createElement"; pcre:"/\s*?\(\s*?[\x22\x27]frameset[\x22\x27]/Rsi"; content:"document.createElement"; pcre:"/\s*?\(\s*?[\x22\x27]tt[\x22\x27]/Rsi"; content:"document.createElement"; pcre:"/\s*?\(\s*?[\x22\x27]bdo[\x22\x27]/Rsi"; content:"document.createElement"; pcre:"/\s*?\(\s*?[\x22\x27]kbd[\x22\x27]/Rsi"; reference:cve,2014-6376; classtype:attempted-user; sid:2809313; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE Incorrect Object Type CVE-2014-8966"; flow:from_server,established; file_data; content:"appendChild"; content:"radio"; nocase; content:"input"; nocase; content:"table"; nocase; content:"onpropertychange"; nocase; fast_pattern:only; content:"name"; nocase; content:"img"; nocase; content:"swapNode"; content:"createTFoot"; content:"innerHTML"; pcre:"/\s(?P<inputvar>\S+?)\s*?=\s*?document.createElement\s*?\(\s*?[\x22\x27]input[\x22\x27].*(?P=inputvar)\.type\s*?=\s*?[\x22\x27]radio[\x22\x27].*(?P=inputvar)\.attachEvent\s*?\(\s*?[\x22\x27]onpropertychange[\x22\x27]/si"; pcre:"/\s(?P<tvar>\S+?)\s*?=\s*?document.createElement\s*?\(\s*?[\x22\x27]table[\x22\x27].*(?P=tvar)\.attachEvent\s*?\(\s*?[\x22\x27]onpropertychange[\x22\x27].*(?P=tvar)\.createTFoot/si"; reference:cve,2014-8966; classtype:attempted-user; sid:2809314; rev:3;)

#
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Exchange URL Redirection Vulnerability GET request (CVE-2014-6336)"; flow:to_server,established; content:"/owa/redir.aspx?"; http_uri; content:"C="; distance:0; http_uri; content:"URL="; http_uri; pcre:"/GET https?\x3a\/\/[^\x2f]+?\.(?P<dom>[^\x2f]+\.[^\x2f]+)\/owa\/redir\.aspx\?.*URL=https?\x3a\/\/(?![^\x2f&]+?\.(?P=dom)(?:[\x2f&]|$))[^\x2f&]+?(?:[\x2f&]|$)/"; reference:cve,2014-6336; classtype:attempted-user; sid:2809315; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Exchange URL Redirection Vulnerability link (CVE-2014-6336)"; flow:from_server,established; file_data; content:"/owa/redir.aspx?"; content:"C="; distance:0; content:"URL="; pcre:"/https?\x3a\/\/[^\x2f]+?\.(?P<dom>[^\x2f]+\.[^\x2f]+)\/owa\/redir\.aspx\?.*URL=https?\x3a\/\/(?![^\x2f&]+?\.(?P=dom)(?:[\x2f&]|$))[^\x2f&]+?(?:[\x2f&]|$)/"; reference:cve,2014-6336; classtype:attempted-user; sid:2809316; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer execCommand function Use after free Vulnerability 0day Metasploit 2"; flow:established,to_client; file_data; content:"execCommand"; nocase; content:"YMjf"; content:"u0c08"; distance:1; within:6; content:"u0c0cKDog"; distance:1; within:10; fast_pattern; reference:url,eromang.zataz.com/2012/09/16/zero-day-season-is-really-not-over-yet/; reference:cve,CVE-2012-4969; classtype:attempted-user; sid:2020099; rev:8;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE Same Origin Bypass Attempt CVE-2015-0072"; flow:established,from_server; file_data; content:"location"; pcre:"/^\s*=\s*\x5c?[\x22\x27]/Rs"; content:"javascript|3a|"; nocase; within:11; fast_pattern; content:"<iframe"; nocase; pcre:"/^(?:(?!<\/iframe).)*?\ssrc\s*?=\s*?[\x22\x27]http/Rsi"; content:"<iframe"; nocase; pcre:"/^(?:(?!<\/iframe).)*?\ssrc\s*?=\s*?[\x22\x27]/Rsi"; content:!"http"; nocase; within:4; flowbits:set,ET.IE.SOB; flowbits:noalert; reference:cve,CVE-2015-0072; classtype:attempted-user; sid:2809666; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE Same Origin Bypass Attempt CVE-2015-0072"; flow:established,from_server; flowbits:isset,ET.IE.SOB; content:"302"; http_stat_code; content:"Location|3a 20|"; http_header; fast_pattern:only; reference:cve,CVE-2015-0072; classtype:attempted-user; sid:2809667; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After CVE-2014-8967 set"; flow:established,from_server; file_data; content:"<object"; nocase; content:"onload"; nocase; distance:0; content:"contentDocument"; nocase; content:"styleSheets[0].insertRule"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27]\s*?\*\s*?\{\s*?display\x3a\s*?run-in/Rsi"; content:"defaultView.scrollBy"; nocase; distance:0; fast_pattern; pcre:"/^\s*?\x28\s*?1\s*?,\s*?1\s*?\x29/Rsi"; content:"execCommand|28|"; nocase; distance:0; pcre:"/^\s*?[\x22\x27]\s*?selectAll/Rsi"; content:"execCommand"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27]\s*?justifyLeft/Rsi"; content:"defaultView.getSelection"; distance:0; pcre:"/^\s*?\x28\s*?\x29\.deleteFromDocument\s*?\x28\s*?\x29/Rsi"; flowbits:set,ET.CVE-2014-8967; flowbits:noalert; reference:cve,2014-8967; classtype:attempted-user; sid:2809716; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After CVE-2014-8967"; flow:established,from_server; file_data; content:"<head>"; nocase; content:"<style"; distance:0; nocase; content:"div "; distance:0; pcre:"/^\s*?\{\s*?display\x3a\s*?block/Rsi"; content:"</style>"; nocase; distance:0; content:"</head>"; nocase; distance:0; content:"<iframe></iframe>"; nocase; fast_pattern:only; content:"<h2"; nocase; content:"<div "; nocase; pcre:"/^[^>]*?style\s*?=\s*?[\x22\x27]height\x3a\s*?\d+\s*?px/Rsi"; flowbits:isset,ET.CVE-2014-8967; reference:cve,2014-8967; classtype:attempted-user; sid:2809717; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0017"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:".write"; nocase; pcre:"/^\s*?\(\s*?(?:\x22\x22|\x27\x27)/Rs"; content:"createRange"; nocase; content:"scrollIntoView"; nocase; content:"onresize"; nocase; content:"frameset"; nocase; content:"<v|3a|"; nocase; pcre:"/^\s*?[^>]*?oval/Rsi"; reference:cve,2015-0017; classtype:attempted-user; sid:2809718; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CVE-2015-0018 MS15-009 IE UAF"; flow:established,from_server; file_data; content:"onload=document.write(|22 22|)"; nocase; fast_pattern:only; pcre:"/<script[^\w]{2,}?\/script>.*<\/\s*head/is"; pcre:"/<embed[^\w]{2,}?\/\s*embed>/i"; classtype:attempted-user; sid:2809719; rev:5;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After (CVE-2015-0019)"; flow:established,from_server; file_data; content:"document.createElement"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]ol[\x22\x27]/Rsi"; content:"document.body.createTextRange"; nocase; fast_pattern:9,20; content:".onresize"; nocase; pcre:"/^\s*?=\s*?function/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]Outdent[\x22\x27]/Rsi"; content:".outerText"; nocase; pcre:"/^\s*?=\s*?(?P<var>[\x22\x27])(?P=var)/Rs"; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]Indent[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]selectAll[\x22\x27]/Rsi"; content:"<li"; nocase; reference:cve,2015-0019; classtype:attempted-user; sid:2809720; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After (CVE-2015-0020)"; flow:established,from_server; file_data; content:"body.createTextRange"; nocase; fast_pattern; content:"execCommand"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27]insertOrderedList[\x22\x27]/Rsi"; content:"document.createElement"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]form[\x22\x27]/Rsi"; content:"document.body.appendChild"; nocase; content:"document.createElement"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]input[\x22\x27]/Rsi"; content:".type"; nocase; distance:0; pcre:"/^\s*?=\s*?[\x22\x27]radio[\x22\x27]/Rsi"; content:"appendChild"; distance:0; content:"document.createElement"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]lable[\x22\x27]/Rsi"; content:"appendChild"; nocase; pcre:"/^\s*?\x28\s*?document\.createTextNode\s*?\x28/Rsi"; content:"appendChild"; nocase; distance:0; content:"CAPTION"; nocase; content:"BASE"; nocase; content:"OPTGROUP"; nocase; content:"TR"; nocase; content:"NOFRAMES"; nocase; content:"AREA"; nocase; content:"IFRAME"; nocase; content:"BLOCKQUOTE"; nocase; reference:cve,2015-0020; classtype:attempted-user; sid:2809721; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After Free (CVE-2015-0021)"; flow:established,from_server; file_data; content:"getElementById"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27][^\x22\x27]+[\x22\x27]\s*?\x29\s*?\.\s*?contentWindow\s*?\.\s*?document/Rsi"; content:"body.style.whiteSpace"; fast_pattern; nocase; pcre:"/^\s*?=\s*?[\x22\x27]pre[\x22\x27]/Rsi"; content:"body.offsetWidth"; nocase; content:"body.createTextRange"; content:"CollectGarbage"; nocase; distance:0; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]delete[\x22\x27]/Rsi"; reference:cve,2015-0021; classtype:attempted-user; sid:2809722; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0023"; flow:established,from_server; file_data; content:"CollectGarbage"; fast_pattern:only; content:"RemoveNode"; nocase; content:"<ruby"; nocase; pcre:"/^(?=(?:(?!<\/ruby).)+?[\x22\x27<]li[\x22\x27>])(?:(?!<\/ruby).)+?[\x22\x27<]script[\x22\x27>]/Rsi"; reference:cve,2015-0023; classtype:attempted-user; sid:2809723; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After Free (CVE-2015-0025)"; flow:established,from_server; file_data; content:"applyElement"; nocase; pcre:"/^\s*?\x28\s*?document.createElement\x28\s*?[\x22\x27]img[\x22\x27]/Rsi"; content:"applyElement"; nocase; pcre:"/^\s*?\x28\s*?document.createElement\x28\s*?[\x22\x27]caption[\x22\x27]/Rsi"; content:"body.createTextRange|28|"; nocase; content:"select"; distance:0; nocase; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]fontSize[\x22\x27]\s*?,\s*?null\s*?,\s*?true/Rsi"; content:"collapse"; pcre:"/^\s*?\x28\s*?false/Rsi"; content:"select"; distance:0; nocase; content:"execCommand"; pcre:"/^\s*?\x28\s*?[\x22\x27]indent[\x22\x27]/Rsi"; content:"var "; distance:0; nocase; pcre:"/^\s*?(?P<var>[^\s=]+)\s*?=\s*?[^\x3b]*?createElement\x28\s*?[\x22\x27]strike[\x22\x27].*?(?P=var)\.innerHTML.*?body\.appendChild\x28\s*?(?P=var)/Rsi"; content:"cssText"; pcre:"/^\s*?=\s*?[\x22\x27]body\x3a\s*?first-line\s*?\{\s*?color\x3a\s*?blue\s*?\}/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]delete[\x22\x27]/Rsi"; content:"first-line"; nocase; fast_pattern:only; reference:cve,2015-0025; classtype:attempted-user; sid:2809724; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After Free (CVE-2015-0026)"; flow:established,from_server; file_data; content:"createElement"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]form[\x22\x27]/Rsi"; content:"appendChild"; nocase; distance:0; content:"createElement"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]input[\x22\x27]/Rsi"; content:"createElement"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27]input[\x22\x27]/Rsi"; content:"createElement"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]iframe[\x22\x27]/Rsi"; content:".src"; nocase; distance:0; content:"function"; nocase; content:"null"; distance:0; nocase; content:"document.body.innerHTML"; distance:0; nocase; pcre:"/^\s*?=\s*?(?P<var>[\x22\x27])(?P=var)/Rsi"; content:"CollectGarbage"; nocase; distance:0; fast_pattern; pcre:"/^.*?(?P<var>[^\s\x5b]+)\x5b[\x22\x27]{2}\x5d.*?(?P=var)\s*?=\s*?null/Rsi"; content:"document.write"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]{2}\s*?\x29/Rsi"; classtype:attempted-user; sid:2809725; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use After (CVE-2015-0035)"; flow:established,from_server; file_data; content:"createRange"; nocase; content:"setStartBefore"; nocase; distance:0; content:"setEnd"; nocase; content:"getSelection"; nocase; pcre:"/^\s*?\x28\s*?\x29\s*?\.\s*?addRange/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]InsertIFrame[\x22\x27]/Rsi"; content:"createTextRange"; nocase; pcre:"/^\s*?\x28\s*?\x29\s*?\.\s*?scrollIntoView\s*?\x28\s*?true\s*?\x29/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]ms-clearUndoStack[\x22\x27]/Rsi"; content:"swapNode"; nocase; content:"ms-clearUndoStack"; nocase; fast_pattern:only; reference:cve,2015-0035; classtype:attempted-user; sid:2809726; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CVE-2015-0036 MS15-009 IE Index OOB"; flow:established,from_server; file_data; content:"dximagetransform.microsoft.shadow"; nocase; fast_pattern:only; pcre:"/direction\s*=\s*(?:[2][1-9]\d{8}|[3-9]\d{9}|\d{11}})/"; classtype:attempted-user; sid:2809727; rev:6;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CVE-2015-0039 MS15-009 IE UAF"; flow:established,to_client; file_data; content:"msHyphens"; nocase; fast_pattern:only; content:"outlineStyle"; nocase; content:"inherit"; nocase; pcre:"/\.style\[\s*[\x22\x27]\s*msHyphens\s*[\x22\x27]\s*\]\s*=\s*[\x22\x27]\s*auto/i"; pcre:"/\.style\[\s*[\x22\x27]\s*outlineStyle\s*[\x22\x27]\s*\]\s*=\s*[\x22\x27]\s*ridge/i"; pcre:"/\.replaceAdjacentText\(\s*[\x22\x27]\s*afterBegin\s*[\x22\x27]\s*,\s*[\x22\x27]\s*inherit/i"; classtype:attempted-user; sid:2809728; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0040"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"oContainer"; nocase; content:"removeNode"; nocase; content:"appendChild"; nocase; pcre:"/[^\r\n\s]*?(?P<oContainer>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\x28\s*?[\x22\x27]oContainer[\x22\x27]\s*?\x29.+?(?P<oMap1>[^\r\n\s]+?)\s*?\x3d\s*?[^\x3b]+?document\.createElement\x28\s*?[\x22\x27]map[\x22\x27]\s*?\x29.+?\b(?P<oMap2>[^\r\n\s]+?)\s*?\x3d\s*?[^\x3b]+?document\.createElement\x28\s*?[\x22\x27]map[\x22\x27]\s*?\x29.+?(?P=oContainer)\.removeNode.+((?P=oMap1)\.removeNode.+(?P=oMap2)\.removeNode|(?P=oMap2)\.removeNode.+(?P=oMap1)\.removeNode)/si"; reference:cve,2015-0040; classtype:attempted-user; sid:2809729; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0041 1"; flow:established,from_server; file_data; content:"button"; nocase; content:"div"; nocase; content:"createRange"; nocase; content:"createDocumentFragment"; nocase; fast_pattern:only; content:"selectNodeContents"; nocase; content:"replaceNode"; nocase; pcre:"/[^\r\n\s]*?(?P<button>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\x28\s*?[\x22\x27]button[\x22\x27]\s*?\x29.+?\b(?P<range>[^\r\n\s]+?)\s*?\x3d\s*?document\.createRange\x28\s*?\x29.+?\b(?P<docFrag>[^\r\n\s]+?)\s*?\x3d\s*?document\.createDocumentFragment\x28\s*?\x29.+?(?P=docFrag)\.appendChild.+?(?P=docFrag)\.appendChild.+?(?P=range)\.selectNodeContents\x28\s*(?P=button)\s*\x29.+?((?P=button)\.replaceNode\x28(?P=docFrag)\x29.+?(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29|(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29.+?(?P=button)\.replaceNode\x28(?P=docFrag)\x29)/si"; reference:cve,2015-0041; classtype:attempted-user; sid:2809730; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0041 2"; flow:established,from_server; file_data; content:"button"; nocase; content:"div"; nocase; content:"createRange"; nocase; content:"createDocumentFragment"; nocase; fast_pattern:only; content:"selectNodeContents"; nocase; content:"replaceNode"; nocase; pcre:"/[^\r\n\s]*?(?P<button>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\x28\s*?[\x22\x27]button[\x22\x27]\s*?\x29.+?\b(?P<docFrag>[^\r\n\s]+?)\s*?\x3d\s*?document\.createDocumentFragment\x28\s*?\x29.+?\b(?P<range>[^\r\n\s]+?)\s*?\x3d\s*?document\.createRange\x28\s*?\x29.+?(?P=docFrag)\.appendChild.+?(?P=docFrag)\.appendChild.+?(?P=range)\.selectNodeContents\x28\s*(?P=button)\s*\x29.+?((?P=button)\.replaceNode\x28(?P=docFrag)\x29.+?(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29|(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29.+?(?P=button)\.replaceNode\x28(?P=docFrag)\x29)/si"; reference:cve,2015-0041; classtype:attempted-user; sid:2809731; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0041 3"; flow:established,from_server; file_data; content:"button"; nocase; content:"div"; nocase; content:"createRange"; nocase; content:"createDocumentFragment"; nocase; fast_pattern:only; content:"selectNodeContents"; nocase; content:"replaceNode"; nocase; pcre:"/[^\r\n\s]*?\b(?P<range>[^\r\n\s]+?)\s*?\x3d\s*?document\.createRange\x28\s*?\x29.+?(?P<button>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\x28\s*?[\x22\x27]button[\x22\x27]\s*?\x29.+?\b(?P<docFrag>[^\r\n\s]+?)\s*?\x3d\s*?document\.createDocumentFragment\x28\s*?\x29.+?(?P=docFrag)\.appendChild.+?(?P=docFrag)\.appendChild.+?(?P=range)\.selectNodeContents\x28\s*(?P=button)\s*\x29.+?((?P=button)\.replaceNode\x28(?P=docFrag)\x29.+?(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29|(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29.+?(?P=button)\.replaceNode\x28(?P=docFrag)\x29)/si"; reference:cve,2015-00410; classtype:attempted-user; sid:2809732; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0041 4"; flow:established,from_server; file_data; content:"button"; nocase; content:"div"; nocase; content:"createRange"; nocase; content:"createDocumentFragment"; nocase; fast_pattern:only; content:"selectNodeContents"; nocase; content:"replaceNode"; nocase; pcre:"/[^\r\n\s]*?\b(?P<range>[^\r\n\s]+?)\s*?\x3d\s*?document\.createRange\x28\s*?\x29.+?\b(?P<docFrag>[^\r\n\s]+?)\s*?\x3d\s*?document\.createDocumentFragment\x28\s*?\x29.+?(?P<button>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\x28\s*?[\x22\x27]button[\x22\x27]\s*?\x29.+?(?P=docFrag)\.appendChild.+?(?P=docFrag)\.appendChild.+?(?P=range)\.selectNodeContents\x28\s*(?P=button)\s*\x29.+?((?P=button)\.replaceNode\x28(?P=docFrag)\x29.+?(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29|(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29.+?(?P=button)\.replaceNode\x28(?P=docFrag)\x29)/si"; reference:cve,2015-0041; classtype:attempted-user; sid:2809733; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0041 5"; flow:established,from_server; file_data; content:"button"; nocase; content:"div"; nocase; content:"createRange"; nocase; content:"createDocumentFragment"; nocase; fast_pattern:only; content:"selectNodeContents"; nocase; content:"replaceNode"; nocase; pcre:"/[^\r\n\s]*?\b(?P<docFrag>[^\r\n\s]+?)\s*?\x3d\s*?document\.createDocumentFragment\x28\s*?\x29.+?\b(?P<range>[^\r\n\s]+?)\s*?\x3d\s*?document\.createRange\x28\s*?\x29.+?(?P<button>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\x28\s*?[\x22\x27]button[\x22\x27]\s*?\x29.+?(?P=docFrag)\.appendChild.+?(?P=docFrag)\.appendChild.+?(?P=range)\.selectNodeContents\x28\s*(?P=button)\s*\x29.+?((?P=button)\.replaceNode\x28(?P=docFrag)\x29.+?(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29|(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29.+?(?P=button)\.replaceNode\x28(?P=docFrag)\x29)/si"; reference:cve,2015-0041; classtype:attempted-user; sid:2809734; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0041 6"; flow:established,from_server; file_data; content:"button"; nocase; content:"div"; nocase; content:"createRange"; nocase; content:"createDocumentFragment"; nocase; fast_pattern:only; content:"selectNodeContents"; nocase; content:"replaceNode"; nocase; pcre:"/[^\r\n\s]*?\b(?P<docFrag>[^\r\n\s]+?)\s*?\x3d\s*?document\.createDocumentFragment\x28\s*?\x29.+?(?P<button>[^\r\n\s]+?)[\r\n\s]*?\x3d[\r\n\s]*?document\.createElement\x28\s*?[\x22\x27]button[\x22\x27]\s*?\x29.+?\b(?P<range>[^\r\n\s]+?)\s*?\x3d\s*?document\.createRange\x28\s*?\x29.+?(?P=docFrag)\.appendChild.+?(?P=docFrag)\.appendChild.+?(?P=range)\.selectNodeContents\x28\s*(?P=button)\s*\x29.+?((?P=button)\.replaceNode\x28(?P=docFrag)\x29.+?(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29|(?P=docFrag)\.replaceNode\x28\s*?(?P=button)\s*\x29.+?(?P=button)\.replaceNode\x28(?P=docFrag)\x29)/si"; reference:cve,2015-0041; classtype:attempted-user; sid:2809735; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CVE 2015-0042 MS15-009 IE CGeneratedSvgTreeNode UAF"; flow:established,from_server; file_data; content:"altGlyph"; fast_pattern; nocase; content:"marker"; distance:0; nocase; content:"InsertOrderedList"; distance:0; nocase; content:"document.getElementsByTagNameNS("; nocase; distance:0; pcre:"/\s*marker[^)]*\)/R"; classtype:attempted-user; sid:2809736; rev:4;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use-After-Free CVE-2015-0043"; flow:established,from_server; file_data; content:"marker"; nocase; content:"<line>"; nocase; content:"<polyline"; fast_pattern; nocase; content:"linearGradient"; nocase; content:"animateColor"; nocase; content:"mask"; nocase; content:"polygon"; nocase; content:"Math.sin"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?(?:0\s*\x29|(?P<number>[123456789]\d*?)\s*-(?P=number)\s*?\x29)/Rsi"; content:"createRange"; nocase; content:"setTimeout"; nocase; content:"surroundContents"; nocase; content:"onresize"; nocase; content:"<svg"; nocase; pcre:"/^(?:(?!<\/svg).)+?<marker[^>]+?\bid\s*?=\s*?[\x22\x27](?P<markerid>[^\x22\x27\s]+?)[\x22\x27].+?(<line>\s*?<\/line>.+?<polyline(?:(?!<\/polyline).)+?display\s*?\x3d\s*?[\x22\x27]list-item[\x22\x27]|<polyline(?:(?!<\/polyline).)+?display\s*?\x3d\s*?[\x22\x27]list-item[\x22\x27].+?<line>\s*?<\/line>).+?<\/marker>(?:(?!<\/svg).)+?<linearGradient(?:(?!<\/linearGradient).)+?color-rendering\s*?\x3d\s*?[\x22\x27]auto[\x22\x27][^>]+?id\s*?=\s*?[\x27\x22](?P<lineargradientID>[^\x22\x27\s]+?)[\x27\x22].+?<\/linearGradient>.+?<animateColor>\s*?<\/animateColor>.+?<mask(?:(?!<\/mask).)+?marker-mid\s*?\x3d\s*?[\x22\x27]url\x28\s*?#(?P=markerid).+?<polygon(?:(?!<\/polygon).)+?fill\s*?\x3d\s*?[\x22\x27]url\x28\s*?#(?P=lineargradientID).+?<\/polygon>.+?<\/mask>.+?<\/svg>/Rsi"; content:"<div"; nocase; pcre:"/[^]*?\bid\s*?\x3d\s*?[\x27\x22](?P<divID>[^\x22\x27\s]+?)[\x27\x22].+?\b(?P<range>[^\r\n\s]+?)\s*?\x3d\s*?document\.createRange\x28.+?(?P=range)\.setStart.+?(?P=range)\.surroundContents.+?(?P=divID)\.onresize\s*?\x3d/Rsi"; reference:cve,2015-0043; classtype:attempted-user; sid:2809737; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Use After Free RCE (CVE-2015-0045)"; flow:to_client,established; file_data; content:"fieldset"; nocase; content:"frameset"; nocase; content:"print"; nocase; content:"document.createElement"; nocase; content:"runtimeStyle.position"; distance:0; nocase; fast_pattern; content:"parentNode.removeNode"; distance:0; nocase; content:"appendchild"; distance:0; nocase; pcre:"/\W?(?P<divobj>\w+)\s*=\s*document\.createElement\s*\(\s*[\x22\x27]DIV[\x22\x27].*(?P=divobj)\.runtimeStyle.position\s*=\s*[\x22\x27]fixed[\x22\x27].*\W(?P<refobj>\w+)\s*=\s*(?P=divobj)\.parentNode.*(?P=divobj)\.parentNode\.removeNode.*(?P=divobj)\.appendchild\s*\(\s*(?P=refobj)\s*\)/si"; reference:cve,2015-0045; classtype:attempted-user; sid:2809738; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CVE 2015-0046 MS15-009 IE Type Confusion"; flow:established,from_server; file_data; content:".setAttribute("; nocase; distance:0; content:"884E2049-217D-11DA-B2A4-000E7BBB2B09"; nocase; fast_pattern:6,20; distance:0; content:"document.body.swapNode("; nocase; distance:0; pcre:"/[\s]*(?P<objname>\w+?)\s*\).*?(?P=objname)\[\s*'\s*0\s*'/Rsi"; classtype:attempted-user; sid:2809739; rev:8;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CVE 2015-0048 MS15-009 IE UAF"; flow:established,from_server; file_data; content:"url()"; nocase; fast_pattern:only; pcre:"/document.createElement\(\s*[\x22\x27]\s*textarea\s*[\x22\x27]\s*\)/i"; pcre:"/([\s\r\n]*?\w+\.(?:dataSrc|id|innerHTML|onvolumechange)\s*=\s*1\s*\x3b){4}/si"; pcre:"/\.style\.setProperty\(\s*[\x22\x27]list-style[\x22\x27]\s*,\s*[\x22\x27]url\(\)[\x22\x27]/i"; classtype:attempted-user; sid:2809740; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CHTMLEditorProxy Use After Free (CVE-2015-0049)"; flow:to_client,established; file_data; content:"setTimeout"; nocase; content:"designMode"; nocase; content:"InsertFieldset"; distance:0; nocase; content:"delete"; distance:0; nocase; content:"designMode"; distance:0; nocase; content:"off"; distance:0; nocase; pcre:"/\W?(?P<windowvar>\w+)\s*\.\s*document\s*\.\s*designMode\s*=\s*[\x22\x27]on[\x22\x27].*(?P=windowvar)\s*\.\s*document\s*\.\s*execCommand\s*\(\s*[\x22\x27]InsertFieldset[\x22\x27].*(?P=windowvar)\s*\.\s*document\s*\.\s*execCommand\s*\(\s*[\x22\x27]delete[\x22\x27].*(?P=windowvar)\s*\.\s*document\s*\.\s*designMode\s*=\s*[\x22\x27]off[\x22\x27]/si"; reference:cve,2015-0049; classtype:attempted-user; sid:2809741; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer type confusion RCE (CVE-2015-0052)"; flow:to_client,established; file_data; content:"visibility"; nocase; pcre:"/^\s*[=\x3a]\s*?[\x22\x27]?collapse/Rsi"; content:"location.reload"; nocase; fast_pattern:only; content:"removeAttribute"; nocase; pcre:"/^\s*\(\s*[\x22\x27]class[\x22\x27]/Rsi"; content:"setAttribute"; nocase; pcre:"/^\s*\(\s*[\x22\x27]class[\x22\x27]/Rsi"; content:"setAttribute"; distance:0; nocase; pcre:"/^\s*\(\s*[\x22\x27]class[\x22\x27]/Rsi"; content:"float"; nocase; pcre:"/^\s*[=\x3a]/Rsi"; content:"setTimeout"; nocase; content:"setTimeout"; distance:0; reference:cve,2015-0052; classtype:attempted-user; sid:2809742; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CTreePos Use After Free (CVE-2015-0053)"; flow:to_client,established; file_data; content:"runtimeStyle"; nocase; content:".posleft"; nocase; content:"0x0d0d0d0d"; fast_pattern:only; nocase; pcre:"/\W?(?P<rtsvar>\w+)\s*=\s*document\s*\.\s*body\s*\.\s*runtimeStyle.*(?P=rtsvar)(?:\s*\.\s*left\s*=\s*[\x22\x27]auto[\x22\x27].*(?P=rtsvar)\s*\.\s*posLeft\s*=\s*(?:NaN|-?Infinity)|\s*\.\s*posLeft\s*=\s*(?:NaN|-?Infinity).*(?P=rtsvar)\s*\.\s*left\s*=\s*[\x22\x27]auto[\x22\x27])/si"; reference:cve,2015-0053; classtype:attempted-user; sid:2809743; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CTreePos Use After Free (CVE-2015-0067) 1"; flow:to_client,established; file_data; content:"onLoad"; nocase; content:"recordset"; nocase; content:"DataSource"; nocase; fast_pattern:only; content:"getElementById"; nocase; pcre:"/^\s*\(\s*[\x22\x27](?P<xmlid>\w+)[\x22\x27]\s*\)\s*\.\s*recordset.*<XML[^>]*id\s*=\s*[\x22\x27](?P=xmlid)[\x22\x27]/Rsi"; reference:cve,2015-0067; classtype:attempted-user; sid:2809744; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CTreePos Use After Free (CVE-2015-0067) 2"; flow:to_client,established; file_data; content:"onLoad"; nocase; content:"recordset"; nocase; content:"DataSource"; nocase; fast_pattern:only; content:"<XML"; nocase; pcre:"/^[^>]*id\s*=\s*[\x22\x27](?P<xmlid>\w+)[\x22\x27].*document\s*\.\s*getElementById\s*\(\s*[\x22\x27](?P=xmlid)[\x22\x27]\s*\)\s*\.\s*recordset/Rsi"; reference:cve,2015-0067; classtype:attempted-user; sid:2809745; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CTreePos Use After Free (CVE-2015-0068) 1"; flow:to_client,established; file_data; content:"cite"; nocase; fast_pattern:only; content:"basefont"; nocase; content:"scrollIntoView"; nocase; content:"createTextRange"; nocase; content:"removeNode"; nocase; pcre:"/\W*(?P<citeobj>\w+)\s*=\s*document\s*\.\s*createElement\s*\(\s*[\x22\x27]cite[\x22\x27]\s*\).+?(?P<basefontobj>\w+)\s*\.\s*applyElement\s*\((?P=citeobj)\)[^[]*<basefont [^>]*id\s*=\s*(?P=basefontobj)/si"; reference:cve,2015-0068; classtype:attempted-user; sid:2809746; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer CTreePos Use After Free (CVE-2015-0068) 2"; flow:to_client,established; file_data; content:"cite"; nocase; fast_pattern:only; content:"scrollIntoView"; nocase; content:"createTextRange"; nocase; content:"removeNode"; nocase; content:"<basefont "; nocase; pcre:"/^[^>]*id\s*=\s*(?P<basefontobj>\w+)[^>]*>.*\W(?P<citeobj>\w+)\s*=\s*document\s*\.\s*createElement\s*\(\s*[\x22\x27]cite[\x22\x27]\s*\).+?(?P=basefontobj)\s*\.\s*applyElement\s*\((?P=citeobj)\)/Rsi"; reference:cve,2015-0068; classtype:attempted-user; sid:2809747; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible IE XSS filter bypass (CVE-2015-0070)"; flow:to_server,established; content:"onerror="; fast_pattern; nocase; http_uri; content:"throw"; nocase; http_uri; content:"MSIE 9.0|3b|"; http_user_agent; reference:cve,2015-0070; classtype:attempted-user; sid:2809748; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Android RCE via XSS and Play Store XFO"; flow:from_server,established; file_data; content:"|5c|u00"; byte_test:2,<,0x21,0,relative,string,hex; content:"javascript|3a|"; nocase; within:11; distance:2; content:"/store/apps/details?id="; nocase; fast_pattern:only; reference:url,1337day.com/exploit/22581; reference:cve,2014-6041; reference:url,github.com/rapid7/metasploit-framework/commit/7f2add2ce30f33e7787310d7abcb1781e8ea8f43; classtype:attempted-user; sid:2020393; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer RegeXP Memory Read (CVE-2015-0071)"; flow:to_client,established; file_data; content:"RegExp.input"; fast_pattern; nocase; pcre:"/^\s*=/R"; content:"RegExp.$"; content:".exec"; nocase; content:"RegExp"; nocase; pcre:"/^\s*?\(\s*?(?P<q>[\x22\x27])(?:(?!(?P=q)).)*?(?<!\x5c)\x28/Rsi"; reference:cve,2015-0052; classtype:attempted-user; sid:2809773; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT VBScript Memory Corruption Vulnerability CVE-2015-0032"; flow:from_server,established; file_data; content:"<script"; nocase; content:"VBScript"; nocase; distance:0; content:"execute"; nocase; distance:0; pcre:"/^[^\r\n]+ReDim\s*(?P<arrayname>\w+)\(\d+\).*?Class\s+(?P<classname>\w+).*?set\s+(?P=arrayname)\(\d+\)\s+=\s+new\s+(?P=classname).*?\w+\(\d+\)\s+=\s+filter\((?P=arrayname)[^)]*",\s+false\s*,\s*0\s*\)/Rsi"; content:"Filter("; fast_pattern:only; reference:cve,2015-0032; classtype:attempted-user; sid:2810021; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Word (CVE-2015-0086)"; flow:to_client,established; file_data; content:"|5c|dppolyline"; nocase; content:"|5c|dppolyline"; distance:0; nocase; content:"|5c|dppolycount"; pcre:"/^\d/R"; distance:0; content:"|5c|dptxbx"; distance:0; nocase; content:"|5c|dptxbx"; distance:0; nocase; flowbits:isset,ET.http.rtf.download; reference:cve,2015-0086; classtype:attempted-user; sid:2810022; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Word (CVE-2015-0097)"; flow:to_client,established; file_data; content:"<script"; nocase; content:"ADODB.Recordset"; distance:0; nocase; flowbits:isset,et.MCOFF; reference:cve,2015-0097; classtype:attempted-user; sid:2810023; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Word (CVE-2015-0097 2)"; flow:to_client,established; file_data; content:"<script"; nocase; content:"00000535-0000-0010-8000-00AA006D2EA4"; nocase; distance:0; flowbits:isset,et.MCOFF; reference:cve,2015-0097; classtype:attempted-user; sid:2810024; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Memory OOB Access Vulnerability CVE-2015-0099"; flow:from_server,established; file_data; content:"<style"; nocase; content:"animation-name|3a|"; fast_pattern:only; content:"@keyframes"; pcre:"/^\s+(?P<name>[\w-]+)\s*{[^}]*from\s*{[^}]*url\(\),auto[^}]*opacity:\s+inherit[^{]*{[^}]*animation-name:\s+(?P=name)/Rsi"; reference:cve,2015-0099; classtype:attempted-user; sid:2810025; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-0100)"; flow:established,from_server; file_data; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]TEXTAREA[\x22\x27]/Rsi"; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]CANVAS[\x22\x27]/Rsi"; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]BDO[\x22\x27]/Rsi"; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]CITE[\x22\x27]/Rsi"; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]FRAMESET[\x22\x27]/Rsi"; content:"onfocusout"; nocase; fast_pattern:only; content:"contentEditable"; pcre:"/^\s*?=\s*?true/Rsi"; content:"setActive"; distance:0; content:"setActive"; distance:0; content:"setActive"; distance:0; reference:cve,2015-0100; classtype:attempted-user; sid:2810026; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MS15-018 Internet Explorer Elevation of Privilege Vulnerability CVE-2015-1622"; flow:from_server,established; file_data; content:"url(data|3a|text/plain,"; fast_pattern:only; content:"document.body.appendChild(document.createElement("; nocase; content:"body.offsetTop"; content:"text/css|22|>"; pcre:"/[^/]*#(?P<id>\w+)\s+{\s*display:\s*list-item\s*\x3b\s*}[^/]*#(?P=id):after[^}]+block[^}]+content:\s*url\(data:text\/plain.*\.appendChild\(document.createElement.*\.id\s*=\s*\x22?(?P=id).*?body.offsetTop/Rsi"; reference:cve,2015-1622; classtype:attempted-user; sid:2810027; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT MS15-018 Internet Explorer Elevation of Privilege Vulnerability CVE-2015-1623"; flow:from_server,established; file_data; content:"MutationObserver("; fast_pattern:only; content:"childList"; content:"characterData"; content:"characterDataOldValue"; content:"location.reload()"; content:"text/javascript"; pcre:"/[^/]*var\s+(?P<mo_name>[^ =]+)\s*=\s*new\s*MutationObserver\(\s*function\(\s*\).*(?P=mo_name).observe\(.*\.insertAdjacentText\((?:\x22|\x27)\s*afterEnd.*]\.replaceNode\(.*document.getSelection\(\).*\.adoptNode\(/Rsi"; reference:cve,2015-1623; classtype:attempted-user; sid:2810028; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible IE User-After-Free Vulnerability (CVE-2015-1624)"; flow:established,from_server; file_data; content:"CollectGarbage"; fast_pattern:only; content:"innerHTML"; pcre:"/^(?:[\x22\x27]\s*?\])?\s*?=\s*?(?:\x22\x22|\x27\x27)/Rsi"; content:"execCommand"; nocase; content:"selectAll"; nocase; content:"<object"; nocase; pcre:"/^((?!(<\/object>)).)*?\Wdata\s*=/Rsi"; content:"style"; nocase; reference:cve,CVE-2015-1624; classtype:attempted-user; sid:2810029; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Memory Corruption Vulnerability M1 (CVE-2015-1625)"; flow:established,from_server; file_data; content:"X-UA-Compatible"; nocase; content:"IE=5"; nocase; fast_pattern; pcre:"/^[\x22\x27]/R"; content:"mergeAttributes"; nocase; content:"swapNode"; nocase; content:"rowspan"; nocase; content:"colspan"; nocase; content:"<tr"; nocase; pcre:"/^(?=[\s>])[^>]*?>\s*?<\/tr>/Rsi"; content:"swapNode"; pcre:"/^\s*?\(\s*?(?P<var>[^\s\x29,]).+?mergeAttributes\s*?\(\s*?(?P=var)/Rsi"; content:"<thead"; nocase; pcre:"/^((?!(<\/thead>)).)+?<tr(?=[\s>])[^>]*?>((?!(<\/tr>)).)*?<th((?!(<\/tr>)).)+?<th(?=[\s>])[^>]*rowspan/Rsi"; reference:cve,CVE-2015-1625; classtype:attempted-user; sid:2810030; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT IE Memory Corruption Vulnerability M2 (CVE-2015-1625)"; flow:established,from_server; file_data; content:"X-UA-Compatible"; nocase; content:"IE=5"; nocase; fast_pattern; pcre:"/^[\x22\x27]/R"; content:"mergeAttributes"; nocase; content:"swapNode"; nocase; content:"rowspan"; nocase; content:"colspan"; nocase; content:"<tr"; nocase; pcre:"/^(?=[\s>])[^>]*?>\s*?<\/tr>/Rsi"; content:"mergeAttributes"; pcre:"/^\s*?\(\s*?(?P<var>[^\s\x29,]).+?swapNode\s*?\(\s*?(?P=var)/Rsi"; content:"<thead"; nocase; pcre:"/^((?!(<\/thead>)).)+?<tr(?=[\s>])[^>]*?>((?!(<\/tr>)).)*?<th((?!(<\/tr>)).)+?<th(?=[\s>])[^>]*rowspan/Rsi"; reference:cve,CVE-2015-1625; classtype:attempted-user; sid:2810031; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1634)"; flow:established,from_server; file_data; content:"JustifyRight"; nocase; fast_pattern:only; content:"contentEditable"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]true[\x22\x27]/Rsi"; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]EMBED[\x22\x27]/Rsi"; content:"appendChild"; distance:0; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]FRAMESET[\x22\x27]/Rsi"; content:"appendChild"; distance:0; content:"execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]JustifyRight[\x22\x27]/Rsi"; content:"execCommand"; distance:0; pcre:"/^\s*?\(\s*?[\x22\x27]copy[\x22\x27]/Rsi"; reference:cve,2015-1634; classtype:attempted-user; sid:2810036; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft Office RTF Stack Buffer Overflow"; flow:from_server,established; file_data; content:"|7b 5c|rt"; within:4; flowbits:set,ETPRO.RTF; flowbits:noalert; reference:cve,2010-3333; classtype:misc-activity; sid:2020699; rev:5;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Firefox Proxy Prototype RCE Attempt (CVE-2014-8636)"; flow:from_server,established; file_data; content:"chrome|3a 2f 2f|"; nocase; content:"open"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]chrome\x3a\/\//Ri"; content:"messageManager.loadFrameScript"; nocase; content:"Proxy.create"; nocase; reference:url,community.rapid7.com/community/metasploit/blog/2015/03/23/r7-2015-04-disclosure-mozilla-firefox-proxy-prototype-rce-cve-2014-8636; reference:cve,2014-8636; classtype:attempted-user; sid:2020756; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Possible Use-After-Free CVE-2015-1652"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; fast_pattern:only; content:"www.w3.org/2000/svg"; nocase; content:"DocumentFragment"; nocase; content:"MutationObservers"; nocase; content:"Selection"; nocase; content:"Range"; content:"focus"; nocase; content:"window"; content:"location"; within:25; content:"href"; within:25; content:"dispatch"; nocase; content:"appendChild"; nocase; reference:cve,CVE-2015-1652; classtype:attempted-user; sid:2810616; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1657)"; flow:established,from_server; file_data; content:"insertBefore"; nocase; pcre:"/^\s*?\([^)]+createTextNode\s*?\(\s*?(?:\x22{2}|\x27{2})\s*?\)\s*?,[^)]+childNodes/Rsi"; content:"normalize"; nocase; distance:0; content:"innerHTML"; nocase; distance:0; content:"createElement"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]script[\x22\x27]/Rsi"; content:"appendChild"; nocase; distance:0; content:"innerHTML"; nocase; distance:0; content:"addEventListener"; nocase; distance:0; pcre:"/^\s*?\(\s*?[\x22\x27DOMAttrModified[\x22\x27]/Rsi"; content:"style"; nocase; pcre:"/^\s*?\[\s*?[\x22\x27msHyphenateLimitChars[\x22\x27]/Rsi"; content:"msHyphenateLimitChars"; nocase; fast_pattern:only; reference:cve,2015-1657; classtype:attempted-user; sid:2810617; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1660)"; flow:established,from_server; file_data; content:"contentDocument"; content:"onpropertychange"; nocase; content:"defaultView"; distance:0; nocase; pcre:"/^\s*?\.\s*?focus\s*?\(/Rsi"; content:"getElementsByTagName"; nocase; content:"innerHTML"; nocase; pcre:"/^[^\x3b]+=[^\x3b]+[\x22\x27]<strong></strong>[\x22\x27]/Rsi"; content:"innerHTML"; distance:0; nocase; pcre:"/^[^\x3b]+=[^\x3b]+[\x22\x27]<strong></strong>[\x22\x27]/Rsi"; content:"<strong></strong>"; fast_pattern:only; reference:cve,2015-1660; classtype:attempted-user; sid:2810618; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1661)"; flow:established,from_server; file_data; content:"Array"; nocase; content:"toString"; nocase; content:"typeof"; pcre:"/^\s*?\([^\x5b]+\x5b\s*?9\s*?\x5d\s*?\.\s*?offsetLeft/Rsi"; content:"v|3a|arc"; nocase; content:"center"; nocase; content:"hkern"; nocase; fast_pattern:only; content:"string"; nocase; content:"path"; nocase; content:"push"; nocase; pcre:"/^\s*?\(\s*?(?P<var>[^\x5b]+)\x5b\s*?8\s*?\x5d\s*?\.\s*?createTextRange.*(?P=var)\s*?\x5b\s*?8\s*?\x5d\s*?\.\s*?removeNode.*(?P=var)\s*?\x5b\s*?0\s*?\x5d\s*?\.\s*?toString/Rsi"; reference:cve,2015-1661; classtype:attempted-user; sid:2810619; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1665)"; flow:established,from_server; file_data; content:"createTextRange"; nocase; content:"moveToElementText"; nocase; distance:0; fast_pattern; pcre:"/^\s*?\(\s*?document\s*?\.\s*?body\s*?\.\s*?getElementsByTagName\s*?\([^)]+\)\s*?\x5b\s*?12\s*?\x5d/Rsi"; content:"moveEnd"; nocase; distance:0; pcre:"/^\s*?\(\s*?[\x22\x27]character[\x22\x27]\s*?,\s*?64\s*?\)/Rsi"; content:"removeChild"; nocase; distance:0; pcre:"/^\s*?\(\s*?[^)]+childNodes\s*?\x5b\s*?1\s*?\x5d/Rsi"; content:"moveToElementText"; pcre:"/^\s*?\(\s*?[^)]+childNodes\s*?\x5b\s*?0\s*?\x5d/Rsi"; reference:cve,2015-1665; classtype:attempted-user; sid:2810620; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free CVE-2015-1666"; flow:established,from_server; file_data; content:"MutationObserver"; nocase; fast_pattern:only; content:"feFuncR"; nocase; content:"textPositioning"; nocase; content:"createRange"; nocase; content:"removedNodes"; nocase; content:"appendChild"; nocase; content:"insertNode"; nocase; content:"removeChild"; nocase; content:"meta"; nocase; reference:cve,CVE-2015-1666; classtype:attempted-user; sid:2810621; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1667)"; flow:established,from_server; file_data; content:"getElementById"; nocase; pcre:"/^\s*?\([^)]+\)\s*?\.\s*?style\s*?\.\s*?quotes\s*?=\s*?[\x22\x27]none[\x22\x27]/Rsi"; content:"appendChild"; nocase; pcre:"/^\s*?\([^)]+createElement\s*?\(\s*?[\x22\x27]FRAMESET[\x22\x27]/Rsi"; content:"getElementbyId"; nocase; pcre:"/^\s*?\([^)]+\)\s*?\.\s*/Rsi"; content:"removeNode"; within:10; nocase; fast_pattern; content:"setTimeout"; nocase; content:"setTimeout"; nocase; distance:0; reference:cve,2015-1667; classtype:attempted-user; sid:2810622; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1668)"; flow:established,from_server; file_data; content:"<svg"; nocase; content:"<circle"; nocase; distance:0; content:"<marker"; nocase; pcre:"/^[^>]+marker-end\s*?=\s*?[\x22\x27]\s*?url/Rsi"; content:"<polyline"; content:"<line"; nocase; pcre:"/^[^>]+marker-mid\s*?=\s*?[\x22\x27]\s*?url/Rsi"; content:".r.baseVal.convertToSpecifiedUnits"; nocase; fast_pattern; pcre:"/^\s*?\(\s*?SVGLength\s*?\.\s*?SVG_LENGTHTYPE_PERCENTAGE/Rsi"; content:"createRange"; distance:0; nocase; content:"setStartBefore"; nocase; distance:0; content:"setEndBefore"; nocase; distance:0; content:"deleteContents"; nocase; distance:0; reference:cve,2015-1668; classtype:attempted-user; sid:2810623; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Possible CVE-2013-1710/CVE-2012-3993 Firefox Exploit Attempt"; flow:established,to_client; file_data; content:"generateCRMFRequest"; nocase; fast_pattern:only; content:"InstallTrigger"; nocase; content:"__exposedProps__"; nocase; content:"__defineGetter__"; nocase; content:"getInstallForURL"; nocase; content:".install|28|"; nocase; content:"x-xpinstall"; nocase; reference:cve,CVE-2013-1710; reference:cve,CVE-2012-3993; classtype:attempted-user; sid:2021078; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1658)"; flow:established,from_server; file_data; content:"<style></style>"; nocase; content:"figcaption"; nocase; content:"insertBefore"; nocase; content:"appendChild"; nocase; content:"swapNode"; nocase; content:"applyElement"; nocase; content:"outerText"; nocase; content:"outerText"; nocase; distance:0; content:"scrollLeft"; nocase; content:"createCaption"; nocase; fast_pattern; content:"styleSheets"; pcre:"/^\s*?\[\s*?\d+\s*?\]\s*?\.\s*?addRule/Rsi"; reference:cve,2015-1658; classtype:attempted-user; sid:2810960; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1689)"; flow:established,from_server; file_data; content:"DOMNodeInserted"; nocase; content:"document.documentElement"; nocase; fast_pattern:only; content:"window"; nocase; pcre:"/^\s*\.(?P<globalVarName>[a-z][\w:-]*)\s*\.outerText.*window\.(?P=globalVarName)\s*=\s*document\s*\.documentElement.*var\s+(?P<bodyElement>[a-z][\w:-]*)\s*=\s*document\s*\.\s*createElement\([\x22\x27\s]*body[\x22\x27\s]*\).*window\s*\.\s*(?P=globalVarName).applyElement\(\s*(?P=bodyElement)\s*\).*(?P=bodyElement)\s*\.\s*addEventListener\([\x22\x27\s]*DOMNodeInserted/Rsi"; content:"head"; pcre:"/^\s*[\x22\x27\s]*\)\[0\]\.applyElement\([\x22\x27\s]*document\s*\.\s*createElement\([\x22\x27\s]*object/Rsi"; reference:cve,2015-1689; classtype:attempted-user; sid:2810961; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Information Disclosure (CVE-2015-1691)"; flow:to_client,established; file_data; content:"scrollIntoView"; nocase; content:"attachEvent"; nocase; content:"createTextRange"; nocase; fast_pattern:only; content:"onmove"; nocase; content:"createElement"; nocase; pcre:"/^\s*\(\s*[\x22\x27]dd[\x22\x27]/Rsi"; content:"createElement"; pcre:"/^\s*\(\s*[\x22\x27]input[\x22\x27]/Rsi"; pcre:"/\W?(?P<textvar>\w+)\s*=\s*document\s*\.\s*body\s*\.\s*createTextRange.+(?P=textvar)\s*\.\s*execCommand\s*\(.*[\x22\x27]InsertSelectDropdown[\x22\x27]/si"; reference:cve,2015-1691; classtype:attempted-user; sid:2810962; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Information Disclosure (CVE-2015-1692)"; flow:to_client,established; file_data; content:"oncopy"; nocase; pcre:"/^\s*\x3d\s*/Rsi"; content:"window.clipboardData.getData"; nocase; fast_pattern:7,20; pcre:"/^\s*\x28\s*[\x22\x27]Text[\x22\x27]\s*\x29/Rsi"; reference:cve,2015-1692; classtype:attempted-recon; sid:2810963; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer CSecurityContext RCE (CVE-2015-1706)"; flow:established,from_server; file_data; content:"<table></table>"; nocase; content:"addEventListener"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]DOMNodeInserted[\x22\x27]/Rsi"; content:"createRange"; nocase; distance:0; content:"setStart"; nocase; distance:0; content:"surroundContents"; distance:0; nocase; content:"reload"; distance:0; nocase; content:"createTextRange"; nocase; distance:0; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]InsertOrderedList[\x22\x27]/Rsi"; content:"swapNode"; nocase; content:"execCommand"; fast_pattern; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]Undo[\x22\x27]/Rsi"; classtype:attempted-user; sid:2810964; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1708)"; flow:established,from_server; file_data; content:"<legend"; nocase; content:"dt"; nocase; content:"Delete"; nocase; content:"<table"; nocase; content:"<tbody"; distance:0; nocase; content:"createElement"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]head[\x22\x27]\s*?\)\s*?\.\s*?applyElement/Rsi"; content:"styleFloat"; pcre:"/^\s*?=\s*?[\x22\x27]right[\x22\x27]/Rsi"; content:"createElement"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]dt[\x22\x27]/Rsi"; content:"selection"; nocase; pcre:"/^\s*?\.\s*?createRange\s*?\(\s*?\)\s*?\.\s*?queryCommandState\s*?\(\s*?[\x22\x27]Delete[\x22\x27]/Rsi"; content:"queryCommandState"; nocase; fast_pattern:only; reference:cve,2015-1708; classtype:attempted-user; sid:2810965; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Use-After-Free Vulnerability (CVE-2015-1710)"; flow:established,from_server; file_data; content:"InsertIFrame"; fast_pattern:only; content:"InsertInputSubmit"; nocase; content:"AbsolutePosition"; nocase; content:"createTextRange"; nocase; content:"select"; pcre:"/^\s*\x28\s*?\x29/Rs"; content:"meta"; nocase; content:"http-equiv"; nocase; content:"X-UA-Compatible"; nocase; content:"input"; nocase; pcre:"/^[\s\x22\x27>]/R"; content:"appendchild"; nocase; content:"IE="; pcre:"/^[2-8]/R"; reference:cve,CVE-2015-1710; classtype:attempted-user; sid:2810966; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1711)"; flow:established,from_server; file_data; content:"<svg"; nocase; pcre:"/^\s*?[^>]+?onresize\s*\x3d\s*/Rsi"; content:"onresize="; nocase; content:"document.normalize("; nocase; fast_pattern:only; content:"SelectAll"; nocase; pcre:"/document\s*\.\s*body\s*\.\s*createTextRange\(\)\.execCommand\([\s\x22\x27]*SelectAll/i"; pcre:"/document\s*\.\s*body\s*\.\s*applyElement\((?P<svgName>[a-z][\w:-]*).*<svg\s+id=[\x22\x27]*(?P=svgName).*onresize=/si"; reference:cve,2015-1711; classtype:attempted-user; sid:2810967; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Memory Corruption Vulnerability (CVE-2015-1712)"; flow:established,from_server; file_data; content:"insertOrderedList"; nocase; content:"JustifyLeft"; nocase; content:"meta"; nocase; content:"http-equiv"; nocase; content:"cache-control"; nocase; content:"no-cache"; nocase; content:"superscript"; nocase; fast_pattern:only; content:"insertbutton"; nocase; content:"selectall"; nocase; content:"reload"; nocase; content:"execCommand"; nocase; content:"setTimeout"; nocase; content:"setInterval"; nocase; content:"th"; pcre:"/^[\s\x22\x27>]/R"; classtype:attempted-user; sid:2810968; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer CTitleElement Use After Free (CVE-2015-1714)"; flow:established,from_server; file_data; content:"adoptNode"; fast_pattern; nocase; pcre:"/^\s*\(\s*document\s*\.\s*getElementsByTagName\s*\(\s*[\x22\x27]\*[\x22\x27]/Rsi"; content:"createElement"; nocase; pcre:"/^\s*\(\s*[\x22\x27]title[\x22\x27]/Rsi"; content:"swapNode"; nocase; pcre:"/^\s*\(\s*document\s*\.\s*all/Rsi"; content:"insertAdjacentHTML"; nocase; pcre:"/^\s*\(\s*[\x22\x27]afterEnd[\x22\x27]\x2C[\x22\x27]document\s*\.\s*getElementsByTagName\s*\(\s*[\x22\x27]\*[\x22\x27]/Rsi"; classtype:attempted-user; sid:2810969; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1718)"; flow:established,from_server; file_data; content:"createTextRange"; nocase; content:"InsertButton"; distance:0; nocase; content:"scrollIntoView"; nocase; content:"documentElement"; nocase; pcre:"/^\s*?\.\s*?removeNode/Rsi"; content:"createControlRange"; nocase; fast_pattern:only; content:"getElementsByTagName"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]button[\x22\x27]/Rsi"; content:"createTextRange"; distance:0; nocase; pcre:"/^\s*?\(\s*?\)\s*?\.\s*?pasteHTML/Rsi"; content:"createElement"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]q[\x22\x27]/Rsi"; content:"documentElement"; distance:0; nocase; pcre:"/^\s*?\.\s*?applyElement/Rsi"; content:"style"; nocase; pcre:"/^\s*?\[\s*?[\x22\x27]pixelWidth[\x22\x27]/Rsi"; content:"style"; nocase; pcre:"/^\s*?\[[\x22\x27]overflowY[\x22\x27]\s*?\]\s*?=\s*?[\x22\x27]scroll[\x22\x27]/Rsi"; reference:cve,2015-1718; classtype:attempted-user; sid:2810970; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT TextData object OOB (CVE-2015-1685)"; flow:established,to_client; file_data; content:"createTextRange"; nocase; fast_pattern; content:"addEventListener"; nocase; content:"appendChild"; nocase; content:"DOMAttrModified"; nocase; content:"DOMNodeInserted"; nocase; content:"undo"; nocase; content:"document"; nocase; pcre:"/^\s*\.\s*all\s*\[\s*0\s*\]\s*\.removeChild\s*\(\s*document\s*\.\s*body/Rsi"; reference:cve,CVE-2015-1685; classtype:attempted-user; sid:2810971; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CElement UAF RCE (CVE-2015-1705)"; flow:established,to_client; file_data; content:"replaceChild"; nocase; content:"contentEditable"; nocase; content:"CollectGarbage"; nocase; fast_pattern:only; content:"for"; nocase; pcre:"/^\s*?\([^\x3b\)]*?\x3b[^\x3b\)]+?<=?\s*(?:0x(?:(6[4-9a-f]|[7-9a-f])|\d{3,})|\d{3,})[^\)]+?\)\s*?(?:\{[^}]*?|[^\r\n]*?)document\.createElement/Rsi"; reference:cve,CVE-2015-1705; classtype:attempted-user; sid:2810972; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible TableGridBlock UAF RCE CVE-2015-1709"; flow:established,to_client; file_data; content:"insertAdjacentText"; fast_pattern; content:"createTextRange"; content:"appendChild"; content:"createElement"; content:"InsertOrderedList"; nocase; content:"formatblock"; nocase; content:"frameset"; nocase; content:"colgroup"; nocase; content:"table"; nocase; pcre:"/\s*(?P<framesetvar>\w+)\s*=\s*document\s*\.\s*createElement\s*\(\s*[\x22\x27]frameset.*(?P=framesetvar)\s*\.\s*insertAdjacentText/si"; pcre:"/\s*(?P<colgroup1var>\w+)\s*=\s*document\s*\.\s*createElement\s*\(\s*[\x22\x27]colgroup.*(?P=colgroup1var)\s*\.\s*style\s*\.\s*lineHeight\s*=\s*/si"; pcre:"/\s*(?P<colgroup2var>\w+)\s*=\s*document\s*\.\s*createElement\s*\(\s*[\x22\x27]colgroup.*(?P=colgroup2var)\s*\.\s*setAttribute\s*\(\s*[\x22\x27]hidden[\x22\x27]\s*\,\s*[\x22\x27]null/si"; pcre:"/\s*(?P<objtextvar>\w+)\s*=\s*document\s*\.\s*body\s*\.\s*createTextRange.*(?P=objtextvar).*(?:InsertOrderedList|formatblock).*(?P=objtextvar).*(?:InsertOrderedList|formatblock)/si"; reference:cve,CVE-2015-1709; classtype:attempted-user; sid:2810973; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT TrueType Font Parsing Vulnerability (2015-1671)"; flow:established,to_client; file_data; content:"|CF F4 00 03 7F FF 00 00 00 00 00 00 00 0A 00 00 00 00 00 64 00 00 00 00 00 02|"; content:"|B0 27 B0 15 B0 38 43 60 42 B0 01 68|"; fast_pattern; reference:cve,CVE-2015-1671; classtype:attempted-admin; sid:2810980; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1687)"; flow:established,from_server; file_data; content:"posHeight"; fast_pattern:only; content:"uniqueNumber"; content:"accessKey"; content:"listStyleImage"; content:"style"; pcre:"/^\s*?\[\s*?[\x22\x27]height[\x22\x27]/Rsi"; content:"style"; pcre:"/^\s*?\[\s*?[\x22\x27]listStyleImage[\x22\x27]\s*?\]\s*?=\s*?[\x22\x27]none[\x22\x27]/Rsi"; content:"style"; pcre:"/^\s*?\[\s*?[\x22\x27]posHeight[\x22\x27]/Rsi"; reference:cve,2015-1687; classtype:attempted-user; sid:2811344; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1730)"; flow:established,from_server; file_data; content:"location.reload("; nocase; fast_pattern:only; content:"window.open"; pcre:"/^\s*\([\x22\x27]\s*about:blank/Ri"; content:".execScript"; nocase; pcre:"/(?P<objWindowName>[^\s]+?)\.execScript\s*\([\x22\x27]\s*[\w.-]+\s*=\s*new\s*URIError.*?\.name\s*=\s*(?P<oURIErrorName>[\w.-]+).*?[\27\x22][^\x3b]*[\x22\x27]\s*\+\s*(?P=objWindowName)\.(?P=oURIErrorName)/si"; reference:cve,2015-1730; classtype:attempted-user; sid:2811345; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1731)"; flow:established,from_server; file_data; content:"optgroup"; content:"beforeEnd"; content:"createTextRange"; nocase; content:"JustifyRight"; nocase; distance:0; content:"BackColor"; nocase; content:"FontSize"; nocase; content:"insertAdjacentText"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]beforeEnd[\x22\x27]/Rsi"; content:"addEventListener"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]DOMSubtreeModified[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]JustifyRight[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]BackColor[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]FontSize[\x22\x27]/Rsi"; content:"DOMSubtreeModified"; fast_pattern:only; reference:cve,2015-1731; classtype:attempted-user; sid:2811346; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1732)"; flow:established,from_server; file_data; content:"AREA"; nocase; content:"beforeBegin"; nocase; content:"insertButton"; nocase; content:"selectAll"; nocase; content:"undo"; nocase; content:"insertAdjacentText"; pcre:"/^\s*?\(\s*?[\x22\x27]beforeBegin[\x22\x27]/Rsi"; content:"addEventListener"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]DOMNodeRemoved[\x22\x27]/Rsi"; content:"execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]selectAll[\x22\x27]/Rsi"; content:"execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]insertButton[\x22\x27]/Rsi"; content:"execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]undo[\x22\x27]/Rsi"; content:"DOMNodeRemoved"; fast_pattern:only; reference:cve,2015-1732; classtype:attempted-user; sid:2811347; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1736)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; content:"IE=EmulateIE7"; nocase; content:"CollectGarbage"; nocase; content:"spellcheck"; content:"pasteHTML"; nocase; content:"-ms-block-progression"; nocase; fast_pattern; pcre:"/^\s*?\x3a\s*?lr\s*?\x3b/Rsi"; content:"appendChild"; content:"removeAttributeNode"; pcre:"/^\s*?\([^\x2e]+\x2e\s*?getAttributeNode\s*?\(\s*?[\x22\x27]spellcheck[\x22\x27]/Rsi"; reference:cve,2015-1736; classtype:attempted-user; sid:2811349; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1737)"; flow:established,from_server; file_data; content:"BlockDirLTR"; nocase; content:"contentEditable"; nocase; content:"createTextRange"; nocase; content:"execCommand"; pcre:"/^\s*?\(\s*?[\x22\x27]BlockDirLTR[\x22\x27]/Rsi"; content:"adoptNode"; nocase; distance:0; content:"deleteFromDocument"; nocase; distance:0; content:"msElementsFromRect"; nocase; distance:0; fast_pattern; content:"deleteFromDocument"; nocase; distance:0; content:"reload"; nocase; distance:0; reference:cve,2015-1737; classtype:attempted-user; sid:2811350; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1740) set"; flow:established,from_server; file_data; content:"setCapture"; nocase; content:"showModelessDialog"; nocase; content:"onlostpointercapture"; nocase; fast_pattern:only; flowbits:set,CVE-2015-1740; flowbits:noalert; reference:cve,2015-1740; classtype:attempted-user; sid:2811351; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1740)"; flow:established,from_server; file_data; content:"designMode"; nocase; fast_pattern; pcre:"/^\s*?=\s*?[\x22\x27]on[\x22\x27]/Rsi"; content:"contentEditable"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]true[\x22\x27]/Rsi"; flowbits:isset,CVE-2015-1740; reference:cve,2015-1740; classtype:attempted-user; sid:2811352; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Memory Corruption Vulnerability (CVE-2015-1741)"; flow:established,from_server; file_data; content:"setStart"; nocase; content:"cloneContents"; distance:0; nocase; content:"styleMedia"; nocase; content:"matchMedium"; distance:0; fast_pattern; nocase; content:"iframe"; nocase; content:"window"; pcre:"/^\s*?\[\s*?[\x22\x27]\d+[\x22\x27]\s*?\]\s*?\[[\x22\x27]styleMedia[\x22\x27]\s*?\]\s*?\[\s*?[\x22\x27]matchMedium[\x22\x27]/Rsi"; content:"div"; nocase; reference:cve,2015-1741; classtype:attempted-user; sid:2811353; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Memory Corruption Vulnerability (CVE-2015-1742)"; flow:established,from_server; file_data; content:"rtc"; nocase; content:"col"; nocase; content:"aside"; nocase; content:"table"; nocase; content:"colgroup"; nocase; content:"style"; nocase; content:"innerText"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]col\s+?\{\s*?display\s*?\x3a\s*?table-footer-group/Rsi"; content:"scrollTop"; nocase; content:"background"; nocase; content:"outerHTML"; nocase; content:"table-footer-group"; nocase; fast_pattern:only; reference:cve,2015-1742; classtype:attempted-user; sid:2811354; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1744)"; flow:established,to_client; file_data; content:"<meta http-equiv=|22|x-ua-compatible|22| content=|22|IE=9|22|>"; content:"body|3a 3a|first-line"; content:"background-color|3a|transparent"; content:"progid|3a|DXImageTransform.Microsoft.Barn(Orientation=|27|horizontal|27 29|"; fast_pattern:only; content:"contentEditable"; pcre:"/^\s*=\s*[\x22\x27]\s*true\s*[\x22\x27]/Rsi"; content:"DXImageTransform.Microsoft.Barn"; reference:cve,2015-1744; classtype:attempted-user; sid:2811355; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Sandbox escape Elevation of Privilege(CVE-2015-1745)"; flow:established,to_client; file_data; content:"X-UA-Compatible"; content:"EmulateIE8"; fast_pattern; distance:0; content:"Jscript.Encode"; distance:0; content:"setAttribute"; content:"reload"; content:"mergeAttributes"; content:"<video"; reference:cve,CVE-2015-1745; classtype:attempted-user; sid:2811356; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1748)"; flow:established,from_server; file_data; content:"res|3a 2f 2f|ieframe.dll|5c 5c 2e 2e 5c 5c|apds.dll/"; fast_pattern:only; reference:cve,2015-1748; classtype:attempted-user; sid:2811357; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Sandbox escape Elevation of Privilege(CVE-2015-1748)"; flow:established,to_client; file_data; content:"res|3a 2f 2f|ieframe.dll|5c 5c 2e 2e 5c 5c|apds.dll/redirect.html?"; pcre:"/[\S]*target=/Ri"; content:"<script"; reference:cve,CVE-2015-1748; classtype:attempted-user; sid:2811358; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1750)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; pcre:"/^[\x22\x27]\s*content\s*=\s*[\x22\x27]\s*IE\s*=\s*8/Rsi"; content:"onpropertychange="; nocase; content:"border-image-slice"; fast_pattern:only; content:"document.body.applyElement"; nocase; pcre:"/^\(\s*(?P<elementID>[\w-.]+)\s*.*?<textarea\s*id=(?P=elementID)/Rsi"; content:"<body"; nocase; pcre:"/^.*?<body\s*style\s*=\s*[\x22\x27]\s*border-image-slice:\d+/Rsi"; content:"<q"; nocase; pcre:"/^\s*>\s*</q\s*>/Ri"; reference:cve,2015-1750; classtype:attempted-user; sid:2811359; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1752)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; pcre:"/^[\x22\x27]\s*content\s*=\s*[\x22\x27]\s*IE\s*=\s*8/Rsi"; content:"http|3a|//http|3a|//<>"; pcre:"/(?:http://http://<>){5}/Ri"; reference:cve,2015-1752; classtype:attempted-user; sid:2811360; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer CLegentElement UAF (CVE-2015-1753)"; flow:established,to_client; file_data; content:"createTextRange"; content:"createElement"; content:"insertMarquee"; nocase; content:"scrollIntoView"; content:"undo"; nocase; content:"scrollbarArrowColor"; nocase; content:"document"; pcre:"/\s*\.\s*execCommand\s*\(\s*[\x22\x27]Undo[\x22\x27]/Rsi"; pcre:"/\W+?(?P<inputVarName>\w+?)\s*=\s*document\s*\.\s*createElement\s*\(\s*[\x22\x27]input.*?document\s*\.\s*documentElement\s*\.\s*appendChild\s*\(\s*(?P=inputVarName)/si"; pcre:"/\W+?(?P<inputVarName>\w+?)\s*=\s*document\s*\.\s*body\s*.\s*createTextRange\s*\(.*(?P=inputVarName)\s*\.\s*execcommand\s*\(\s*[\x22\x27]InsertMarquee[\x22\x27]/si"; pcre:"/\W+?(?P<inputVarName>\w+?)\s*=\s*document\s*\.\s*body\s*.\s*createTextRange\s*\(.*(?P=inputVarName)\s*\.\s*scrollintoView/si"; reference:cve,CVE-2015-1753; classtype:attempted-user; sid:2811361; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer COptionElement UAF (CVE-2015-1755)"; flow:established,to_client; file_data; content:"CollectGarbage"; fast_pattern:only; content:"createElement"; content:"datalist"; nocase; content:"<option"; nocase; pcre:"/^[^>]*>\s*</option/Rsi"; content:"<div"; nocase; content:"removeNode"; pcre:"/\W+?(?P<VarName>\w+?)\s*=\s*document\s*\.\s*createElement\s*\([\x22\x27]datalist[\x22\x27].*(?P=VarName)\s*\.\s*options.*(?P=VarName)\s*\.\s*removenode\s*\(/si"; reference:cve,CVE-2015-1755; classtype:attempted-user; sid:2811362; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Memory Corruption Vulnerability (CVE-2015-1766)"; flow:established,from_server; file_data; content:"load"; nocase; content:"join"; nocase; content:"<pre"; nocase; distance:0; content:"window"; pcre:"/^\s*?\.\s*?open\s*?\(/Rsi"; content:"addEventListener"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]load[\x22\x27]/Rsi"; content:"designMode"; nocase; fast_pattern; pcre:"/^\s*?=\s*?[\x22\x27]on[\x22\x27]/Rsi"; content:"write"; nocase; distance:0; pcre:"/^\s*?\([^\x28]+\(\s*?\d{3,}\s*?\)\s*?\.\s*?join\s*?\(\s*?[\x22\x27]<pre/Rsi"; content:"insertBefore"; nocase; distance:0; reference:cve,2015-1766; classtype:attempted-user; sid:2811363; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Adobe Flash CVE-2015-3113 in FLV"; flow:established,from_server; file_data; content:"|46 4C 56 01 04 00 00 00 09 00 00 00 00 08 00 00 1A 00 00 00 00 00 00 00 68 DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD DD 00 00 00 2B 08 00 04 41 00 00 0F 00 00 00 00 68|"; within:66; reference:cve,2015-3113; classtype:attempted-admin; sid:2811687; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Adobe Flash CVE-2015-3113 in FLV 1"; flow:established,from_server; file_data; content:"FLV"; within:3; fast_pattern; byte_test:1,&,4,1,relative; byte_jump:4,2,relative,from_beginning; byte_jump:3,5,relative,post_offset 7; content:"|08|"; distance:4; within:1; byte_test:3,>,1024,0,relative; byte_test:1,&,64,10,relative; byte_test:1,!&,2,10,relative; byte_test:1,&,16,10,relative; byte_test:1,!&,128,10,relative; byte_test:1,!&,32,10,relative; reference:cve,2015-3113; classtype:attempted-admin; sid:2811699; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Adobe Flash CVE-2015-3113 in FLV 2"; flow:established,from_server; file_data; content:"FLV"; within:3; fast_pattern; byte_test:1,&,4,1,relative; byte_jump:4,2,relative,from_beginning; byte_jump:3,5,relative,post_offset 7; content:"|08|"; distance:4; within:1; byte_test:3,>,1024,0,relative; byte_test:1,&,64,10,relative; byte_test:1,!&,2,10,relative; byte_test:1,&,32,10,relative; byte_test:1,!&,128,10,relative; byte_test:1,!&,16,10,relative; reference:cve,2015-3113; classtype:attempted-admin; sid:2811700; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Adobe Flash CVE-2015-3113 in FLV 3"; flow:established,from_server; file_data; content:"FLV"; within:3; fast_pattern; byte_test:1,&,4,1,relative; byte_jump:4,2,relative,from_beginning; byte_jump:3,5,relative,post_offset 7; content:"|08|"; distance:4; within:1; byte_test:3,>,1024,0,relative; byte_test:1,&,64,10,relative; byte_test:1,!&,2,10,relative; byte_test:1,!&,32,10,relative; byte_test:1,!&,128,10,relative; byte_test:1,!&,16,10,relative; reference:cve,2015-3113; classtype:attempted-admin; sid:2811701; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1733)"; flow:established,from_server; file_data; content:"X-UA-Compatible"; nocase; content:"IE=6"; nocase; distance:0; content:"table"; nocase; content:"inside"; nocase; content:"outside"; nocase; content:"createElement"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]table[\x22\x27]/Rsi"; content:"applyElement"; nocase; distance:0; pcre:"/^\s*?\([^,]+,\s*?[\x22\x27]inside[\x22\x27]/Rsi"; content:"innerText"; nocase; distance:0; content:"applyElement"; nocase; distance:0; pcre:"/^\s*?\([^,]+,\s*?[\x22\x27]outside[\x22\x27]/Rsi"; content:"createTHead"; distance:0; fast_pattern; reference:cve,2015-1733; classtype:attempted-user; sid:2811938; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1738)"; flow:established,from_server; file_data; content:"insertIFrame"; nocase; content:"insertFieldset"; nocase; content:"delete"; nocase; content:"insertOrderedList"; nocase; content:"addEventListener"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]DOMNodeRemoved[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]insertIFrame[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]insertFieldset[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]delete[\x22\x27]/Rsi"; content:"execCommand"; nocase; pcre:"/^\s*?\(\s*?[\x22\x27]insertOrderedList[\x22\x27]/Rsi"; content:"DOMNodeRemoved"; nocase; fast_pattern:only; reference:cve,2015-1738; classtype:attempted-user; sid:2811939; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-1767)"; flow:from_server,established; file_data; content:"createElement"; pcre:"/^\s*\(\s*[\x22\x27]tfoot[\x22\x27]/Rsi"; content:"createElement"; distance:0; pcre:"/^\s*\(\s*[\x22\x27]area[\x22\x27]/Rsi"; content:"DOMNodeRemoved"; fast_pattern; distance:0; content:"createTreeWalker"; distance:0; content:"swapNode"; distance:0; content:"innerText"; distance:0; reference:cve,2015-1767; classtype:attempted-user; sid:2811940; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer VBScript Memory Corruption Vulnerability (CVE-2015-2372)"; flow:established,from_server; file_data; content:"vbscript"; nocase; content:"Public Default Property Get"; distance:0; nocase; fast_pattern; content:"Erase"; nocase; content:"Set"; nocase; content:"new"; nocase; distance:0; content:"Join|28|"; nocase; distance:0; content:"redim|20|"; nocase; pcre:"/^\s*?(?P<array>\w+)\x28\d+\x29.*?Class\s+?(?P<class>\w+).*?Public Default Property Get.*?Erase\s+?(?P=array).*?Set\s+?(?P=array)\x28\d+\x29\s*?=\s*?new\s+(?P=class).*?Join\x28(?P=array)\x29/Rsi"; reference:cve,2015-2372; classtype:attempted-user; sid:2811941; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2383)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; pcre:"/^[\x22\x27]\s*content\s*=\s*[\x22\x27]\s*IE\s*=\s*9/Rsi"; content:"base"; nocase; content:"outerHTML"; nocase; distance:0; content:"outerHTML"; nocase; distance:0; content:"createElement"; pcre:"/^\s*?\x28\s*?[\x22\x27]img[\x22\x27]/Rsi"; content:"getElementsByTagName"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]script[\x22\x27]\s*?\x29\s*?\x5b\s*?0\s*?\x5d\s*?\.\s*?applyElement\s*?\x28[^,]+,\s*?[\x22\x27]inside[\x22\x27]/Rsi"; content:"createRange"; nocase; distance:0; content:"selectNode"; nocase; distance:0; content:"insertNode"; nocase; distance:0; fast_pattern; content:"reload"; nocase; reference:cve,2015-2383; classtype:attempted-user; sid:2811942; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Control Flow Guard Mitigation Bypass (CVE-2015-2386)"; flow:established,from_server; file_data; content:"Image"; nocase; content:"appendChild"; nocase; distance:0; content:"addEventListener"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]DOMAttrModified[\x22\x27]/Rsi"; content:"replaceNode"; nocase; distance:0; content:"reload"; nocase; distance:0; content:"outerText"; nocase; pcre:"/^\s*?=\s*?(?P<quote>[\x22\x27])(?P=quote)/Rsi"; content:"DOMAttrModified"; nocase; fast_pattern:only; reference:cve,2015-2386; classtype:attempted-user; sid:2811943; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2388)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; pcre:"/^[\x22\x27]\s*content\s*=\s*[\x22\x27]\s*IE\s*=\s*8/Rsi"; content:"createElement"; nocase; content:"table"; nocase; content:"tr"; nocase; content:"frameset"; nocase; content:"td"; nocase; content:"var"; nocase; pcre:"/^\s*?(?P<var>\w+)\s*?=\s*?document\s*?\.\s*?createElement\s*?\x28\s*?[\x22\x27]td[\x22\x27].*?(?P=var)\s*?\.\s*?colSpan\s*?=\s*?10[^0-9].*?appendChild\s*?\x28\s*?(?P=var)\x29/Rsi"; content:"cells[0]"; nocase; pcre:"/^\s*?\.colSpan\s*?=\s*?9[^0-9]/Rsi"; content:"cells[1]"; nocase; distance:0; fast_pattern; reference:cve,2015-2388; classtype:attempted-user; sid:2811944; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2389)"; flow:established,from_server; file_data; content:"bdo"; nocase; content:"keygen"; nocase; content:"dd"; nocase; content:"tfoot"; nocase; content:"DOMSubtreeModified"; nocase; content:"DOMNodeInserted"; nocase; content:"rt"; nocase; content:"DOMNodeRemoved"; nocase; content:"normalize"; nocase; content:"setAttribute"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]tabIndex[\x22\x27]\s*?,\s*?\d/Rsi"; content:"swapNode"; nocase; content:"execCommand"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]insertSelectListbox[\x22\x27]/Rsi"; content:"insertSelectListbox"; nocase; fast_pattern:only; reference:cve,2015-2389; classtype:attempted-user; sid:2811945; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2390)"; flow:established,from_server; file_data; content:"CollectGarbage"; nocase; content:"rp"; nocase; content:"iframe"; nocase; content:"contentDocument"; nocase; content:"appendChild"; nocase; distance:0; pcre:"/^\s*?\x28[^\x28\x29]+?createElement\s*?\x28\s*?[\x22\x27]WBR[\x22\x27]/Rsi"; content:"adoptNode"; nocase; distance:0; content:"progress"; nocase; content:"adoptNode"; nocase; distance:0; content:"addEventListener"; pcre:"/^\s*?\x28\s*?[\x22\x27]DOMNodeRemoved[\x22\x27]/Rsi"; content:"swapNode"; nocase; distance:0; content:"DOMNodeRemoved"; nocase; fast_pattern:only; reference:cve,2015-2390; classtype:attempted-user; sid:2811946; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2391) 2"; flow:established,from_server; file_data; content:"name"; nocase; content:"name"; nocase; distance:0; content:"name"; nocase; distance:0; content:"<meta|20|"; nocase; pcre:"/^[^>]*?content\s*?=\s*?[\x22\x27][^\x22\x27]*?name\s*?=[^\x22\x27]+?[\x22\x27][^>]+?name\s*?=\s*?[\x22\x27]msapplication-task[\x22\x27]/Rsi"; content:"<meta|20|"; nocase; pcre:"/^[^>]*?name\s*?=\s*?[\x22\x27]msapplication-task[\x22\x27][^>]+?content\s*?=\s*?[\x22\x27](?![^\x22\x27]*?name\s*?=[^\x22\x27]*?)/Rsi"; content:"msapplication-task"; nocase; fast_pattern:only; reference:cve,2015-2391; classtype:attempted-user; sid:2811948; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2391) 4"; flow:established,from_server; file_data; content:"name"; nocase; content:"name"; nocase; distance:0; content:"name"; nocase; distance:0; content:"<meta|20|"; nocase; pcre:"/^[^>]*?name\s*?=\s*?[\x22\x27]msapplication-task[\x22\x27][^>]+?content\s*?=\s*?[\x22\x27][^\x22\x27]*?name\s*?=/Rsi"; content:"<meta|20|"; nocase; pcre:"/^[^>]*?content\s*?=\s*?[\x22\x27](?![^\x22\x27]*?name\s*?=[^\x22\x27]*?)[^>]+?name\s*?=\s*?[\x22\x27]msapplication-task[\x22\x27]/Rsi"; content:"msapplication-task"; nocase; fast_pattern:only; reference:cve,2015-2391; classtype:attempted-user; sid:2811950; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2397)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; pcre:"/^[\x22\x27]\s*content\s*=\s*[\x22\x27]\s*IE\s*=\s*5/Rsi"; content:"table"; nocase; content:"outside"; nocase; content:"tFoot"; nocase; content:"style"; pcre:"/^\s*?\.\s*?borderWidth/Rsi"; content:"th"; nocase; content:"applyElement"; nocase; pcre:"/^\s*?\x28[^,]+,\s*?[\x22\x27]inside[\x22\x27]/Rsi"; content:"innerHTML"; nocase; pcre:"/^\s*?=\s*?(?P<var>[\x22\x27])(?P=var)/Rsi"; content:"CollectGarbage"; nocase; distance:0; fast_pattern; content:"removeChild"; distance:0; nocase; reference:cve,2015-2397; classtype:attempted-user; sid:2811951; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2401)"; flow:established,from_server; file_data; content:"<code>"; nocase; content:"<meter>"; nocase; distance:0; content:!"</meter>"; nocase; distance:0; content:"<output>"; nocase; distance:0; content:!"</output>"; distance:0; nocase; content:"<button>"; nocase; distance:0; content:"<form>"; nocase; distance:0; content:"<button></button>"; nocase; distance:0; fast_pattern; content:"getElementsByTagName"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27]meter[\x22\x27]\s*?\x29\s*?\x5b[^0-9][^\x5d]*?\x5d\s*?\.\s*?innerHTML\s*?=/Rsi"; content:"<fieldset>"; nocase; content:!"</fieldset>"; nocase; distance:0; content:"<button>"; nocase; distance:0; content:!"</button>"; nocase; distance:0; content:"<input>"; nocase; distance:0; content:!"</input>"; nocase; distance:0; content:"getElementsByTagName"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27]button[\x22\x27]\s*?\x29\s*?\x5b[^0-9][^\x5d]*?\x5d\s*?\.\s*?innerHTML\s*?=/Rsi"; reference:cve,2015-2401; classtype:attempted-user; sid:2811952; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2403)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; pcre:"/^[\x22\x27]\s*content\s*=\s*[\x22\x27]\s*IE\s*=\s*8/Rsi"; content:"table"; nocase; content:"frameset"; nocase; content:"button"; nocase; content:"insertRow"; nocase; content:"insertRow"; nocase; distance:0; content:"insertRow"; nocase; distance:0; content:"insertRow"; nocase; distance:0; content:"createTextRange"; nocase; pcre:"/^\s*?\x28\s*?\x29\s*?\.\s*?pasteHTML/Rsi"; content:"H3"; nocase; content:"style"; nocase; distance:0; content:"replaceNode"; nocase; distance:0; content:"pasteHTML"; nocase; fast_pattern:only; reference:cve,2015-2403; classtype:attempted-user; sid:2811953; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2404) 1"; flow:established,from_server; file_data; content:"<style"; pcre:!"/^[^>]*?>\s*?<\/style>/Rsi"; content:"<applet|20|"; pcre:"/^\s*?codebase\s*?=\s*?[\x22\x27]{2}\s+onerror\s*?=/Rsi"; content:"for"; pcre:"/^\s*?\x28\s*?(?P<var>[^\x3d\x3b\x28\s]+)\s*?=\s*?0\s*?\x3b\s*?(?P=var)\s*?\<\s*?(?:0x)?\d{3,4}\s*?\x3b\s*?(?P=var)\+\+\s*?\x29\s*?\x7b[^\x7d]*?cssText/Rsi"; content:"CollectGarbage"; nocase; fast_pattern:only; reference:cve,2015-2404; classtype:attempted-user; sid:2811954; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2404) 2"; flow:established,from_server; file_data; content:"<style"; pcre:!"/^[^>]*?>\s*?<\/style>/Rsi"; content:"<applet|20|"; pcre:"/^\s*?onerror\s*?=[^>]+codebase\s*?=\s*?[\x22\x27]{2}/Rsi"; content:"for"; pcre:"/^\s*?\x28\s*?(?P<var>[^\x3d\x3b\x28\s]+)\s*?=\s*?0\s*?\x3b\s*?(?P=var)\s*?\<\s*?(?:0x)?\d{3,4}\s*?\x3b\s*?(?P=var)\+\+\s*?\x29\s*?\x7b[^\x7d]*?cssText/Rsi"; content:"CollectGarbage"; nocase; fast_pattern:only; reference:cve,2015-2404; classtype:attempted-user; sid:2811955; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2406)"; flow:from_server,established; file_data; content:"x-ua-compatible"; content:"IE=5"; distance:0; content:".innerHTML"; distance:0; pcre:"/^\s*=\s*[\x22\x27]\x3ctable/Rsi"; content:"insertRow"; distance:0; fast_pattern; content:"deleteRow"; distance:0; pcre:"/^\s*\(\s*0\s*\)/Rsi"; reference:cve,2015-2406; classtype:attempted-user; sid:2811956; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2408)"; flow:from_server,established; file_data; content:"DOMNodeRemoved"; fast_pattern; content:"createElement"; distance:0; pcre:"/^\s*\(\s*[\x22\x27]img[\x22\x27]\s*/Rsi"; content:"createTreeWalker"; distance:0; content:"TextRange"; distance:0; content:"execCommand"; distance:0; pcre:"/^\s*\(\s*[\x22\x27]formatblock[\x22\x27]/Rsi"; content:"lastChild"; distance:0; content:"innerHTML"; distance:0; content:"documentElement"; distance:0; pcre:"/^\s*\.\s*innerHTML/Rsi"; reference:cve,2015-2408; classtype:attempted-user; sid:2811957; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2411)"; flow:established,from_server; file_data; content:"eventPhase"; nocase; content:"CAPTURING_PHASE"; nocase; content:"currentTarget"; nocase; distance:0; content:"removeNode"; nocase; distance:0; content:"AT_TARGET"; nocase; content:"afterBegin"; nocase; distance:0; content:"swapNode"; nocase; distance:0; content:"BUBBLING_PHASE"; nocase; content:"DOMNodeRemoved"; nocase; fast_pattern:only; content:"DOMNodeInserted"; nocase; content:"insertAdjacentHTML"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]afterBegin[\x22\x27]/Rsi"; content:"insertAdjacentHTML"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27]beforeBegin[\x22\x27]/Rsi"; content:"contentEditable"; nocase; pcre:"/^\s*?=\s*?(?:1|[\x22\x27]true[\x22\x27])/Rsi"; reference:cve,2015-2411; classtype:attempted-user; sid:2811958; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT JScript9 Memory Corruption Vulnerability (CVE-2015-2419)"; flow:established,from_server; file_data; content:"JSON.stringify"; nocase; fast_pattern; pcre:"/^\s*?\x28\s*?\x7b\s*?(?:[\x22\x27][^\x22\x27]+[\x22\x27]\s*?\x3a\s*?\x7b\s*?){5}(?:[\x22\x27][^\x22\x27]+[\x22\x27]\s*?\x3a\s*?[\x22\x27][^\x22\x27]*?[\x22\x27]\s*?,\s*?){20}(?:\x7d\s*?,\s*?(?:[\x22\x27][^\x22\x27]+[\x22\x27]\s*?\x3a\s*?[\x22\x27][^\x22\x27]*?[\x22\x27]\s*?,\s*?){19}){5}/Rsi"; reference:cve,2015-2419; classtype:attempted-user; sid:2811959; rev:2;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer ASLR Bypass (CVE-2015-2421)"; flow:from_server,established; file_data; content:"createElementNS"; nocase; pcre:"/^\s*?\x28[^,]+,\s*?[\x22\x27]svg[\x22\x27]/Rsi"; content:"createElementNS"; nocase; pcre:"/^\s*?\x28[^,]+,\s*?[\x22\x27]defs[\x22\x27]/Rsi"; content:"createElementNS"; nocase; pcre:"/^\s*?\x28[^,]+,\s*?[\x22\x27]svg[\x22\x27]/Rsi"; content:"createTextRange"; nocase; content:"moveEnd"; nocase; distance:0; fast_pattern; pcre:"/^\s*?\x28\s*?[\x22\x27]sentence[\x22\x27]\s*?,\s*?[\x22\x27]-1[\x22\x27]/Rsi"; content:"replaceChild"; nocase; pcre:"/^\s*?\x28[^,]+\s*?[^\x29]*?head\s*?\x29/Rsi"; reference:cve,2015-2421; classtype:attempted-user; sid:2811960; rev:3;)

#
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2422)"; flow:established,from_server; file_data; content:"x-ua-compatible"; nocase; content:"IE=EmulateIE7"; nocase; distance:0; content:"<table"; nocase; distance:0; content:"<td"; nocase; distance:0; content:"<form"; nocase; distance:0; content:"<textarea"; nocase; distance:0; pcre:!"/<tr.*?</tr/si"; content:"<script"; nocase; pcre:"/^.*?function\s+(?P<funcName>\w+)\(\).*document.body.contentEditable\s*=\s*?s*?(?:1|[\x22\x27]true[\x22\x27]).*<body\s+onload=[\x22\x27]?(?P=funcName)/Rsi"; content:"onresize"; pcre:"/^\s*?=[\x22\x27]\s*?\w+.lastChild.disabled\s*?=\s*?(?:1|[\x22\x27]true)/Rsi"; content:"onactivate"; fast_pattern; pcre:"/^\s*?=[\x22\x27]\s*?\w+.applyElement\s*?\(\s*?document.createElement\s*?\(\s*?[\x22\x27]strong[\x22\x27]\)\s*?,\s*?[\x22\x27]inside/Rsi"; reference:cve,2015-2422; classtype:attempted-user; sid:2811961; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer JScript9 Memory Corruption Vulnerability (CVE-2015-2425)"; flow:established,from_server; file_data; content:"createElementNS"; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27][^\x22\x27]+svg[\x22\x27]/Rsi"; content:"MutationObserver"; nocase; distance:0; content:"createElementNS"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27][^\x22\x27]+svg[\x22\x27]/Rsi"; content:"MutationObserver"; nocase; distance:0; content:"observe"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[^,]+,\s*?\x7b\s*?childList\s*?\x3a\s*?(?:true|1)/Rsi"; content:"createElementNS"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27][^\x22\x27]+svg[\x22\x27]/Rsi"; content:"createElementNS"; nocase; distance:0; pcre:"/^\s*?\x28\s*?[\x22\x27][^\x22\x27]+svg[\x22\x27]/Rsi"; reference:cve,2015-2425; classtype:attempted-user; sid:2812122; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2442)"; flow:established,from_server; file_data; content:"contentEditable"; pcre:"/^\s*?\=\s*?[\x22\x27]true[\x22\x27]/Rsi"; content:"moveToElementText"; distance:0; content:"execCommand"; distance:0; content:"insertFieldset"; fast_pattern; distance:0; content:"justifyRight"; distance:0; content:"justifyRight"; distance:0; content:"CollectGarbage"; distance:0; reference:cve,2015-2442; classtype:attempted-user; sid:2812338; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2443)"; flow:from_server,established; file_data; content:"Error"; nocase; pcre:"/^\s*?\x28\s*?\x29/Rsi"; content:"throw"; nocase; distance:0; content:"catch"; nocase; distance:0; content:"Object"; pcre:"/^\s*?\.\s*?getOwnPropertyDescriptor\s*?\x28[^,]+,\s*?[\x22\x27]stack[\x22\x27]/Rsi"; content:"get"; nocase; distance:0; pcre:"/^\s*?\.\s*?call\s*?\x28\s*?0\s*?\x29/Rsi"; content:"getOwnPropertyDescriptor"; nocase; fast_pattern:only; reference:cve,2015-2443; classtype:attempted-user; sid:2812339; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2446)"; flow:established,from_server; file_data; content:"innerHTML|3d 22 22|"; content:"scrollBy"; fast_pattern; distance:0; pcre:"/^\s*?\(\s*?1,\s*?1\s*?\)/Rsi"; content:"onload="; distance:0; content:"onresize="; distance:0; content:"|3c|input type=|22|range|22 3e|"; distance:0; content:"|3c|svg|3e|"; distance:0; reference:cve,2015-2446; classtype:attempted-user; sid:2812341; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2448)"; flow:from_server,established; file_data; content:"Number.prototype.length"; nocase; fast_pattern; pcre:"/^\s*?=\s*?1[^\d]/Rsi"; content:"Array.prototype.join.call"; nocase; distance:0; pcre:"/^\s*?\x28[^\x22\x27]+\x29/Rsi"; reference:cve,2015-2448; classtype:attempted-user; sid:2812342; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2450)"; flow:from_server,established; file_data; content:"style"; nocase; content:"div"; nocase; content:"sheet"; nocase; pcre:"/^\s*?\.\s*?addImport\s*?\x28\s*?[\x22\x27][^\x22\x27]*?css[\x22\x27]/Rsi"; content:"sheet"; nocase; distance:0; pcre:"/^\s*?\.\s*?imports/Rsi"; content:"replaceNode"; nocase; distance:0; content:"appendChild"; nocase; distance:0; content:"addImport"; distance:0; nocase; pcre:"/^\s*?\x28\s*?[\x22\x27][^\x22\x27]*?css[\x22\x27]/Rsi"; content:"removeNode"; nocase; distance:0; content:"CollectGarbage"; nocase; distance:0; content:"cssRules"; nocase; distance:0; pcre:"/^\s*?\[\s*?0\s*?\]\s*?\.\s*?styleSheet\s*?\.\s*?addRule/Rsi"; content:"cssRules"; fast_pattern; nocase; distance:0; pcre:"/^\s*?\[\s*?0\s*?\]\s*?\.\s*?styleSheet\s*?\.\s*?deleteRule/Rsi"; reference:cve,2015-2450; classtype:attempted-user; sid:2812343; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Internet Explorer Memory Corruption Vulnerability (CVE-2015-2452)"; flow:established,from_server; file_data; content:"createElement"; pcre:"/^\s*?\(\s*?[\x22\x27]div[\x22\x27]/Rsi"; content:"createAttribute"; pcre:"/^\s*?\(\s*?[\x22\x27]style[\x22\x27]/Rsi"; content:"setAttributeNode"; fast_pattern; distance:0; pcre:"/^(?:NS)?\s*?\(\s*?(?P<var>[^\x29\s]+)\s*?\).*?(?P=var)\.(?:value|textContent)\s*?=\s*?[\x22\x27]\x20[\x22\x27]\s*?\x3b/Rsi"; reference:cve,2015-2452; classtype:attempted-user; sid:2812344; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress (Pens Being Tested or Possible RocketKitten)"; flow:established,to_server; urilen:>44; content:"/rpt/"; http_uri; depth:5; pcre:"/^\/rpt\/[a-f0-9]{16}\//U"; flowbits:set,ET.CoreImpact; flowbits:noalert; classtype:attempted-admin; sid:2812477; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Java Exploit In Progress (Pens Being Tested or Possible RocketKitten) M1"; flow:established,to_server; content:"/rpt/"; http_uri; depth:5; pcre:"/^\/rpt\/[a-f0-9]{16}\//U"; content:"Java/1."; http_user_agent; fast_pattern:only; classtype:attempted-admin; sid:2812478; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Java Exploit In Progress (Pens Being Tested or Possible RocketKitten) M2"; flow:established,to_server; content:"Expl"; http_uri; content:"Win"; http_uri; content:".jar"; http_uri; pcre:"/Win(?:dows)?Expl(?:oit)?\.jar$/U"; content:"Java/1."; http_user_agent; fast_pattern:only; classtype:attempted-admin; sid:2812479; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress Default Landing URI Struct (Pens Being Tested or Possible RocketKitten)"; flow:established,to_server; urilen:>44; content:"/rpt/"; http_uri; depth:5; pcre:"/^\/rpt\/[a-f0-9]{16}\/[^\x2f]{24,}\/index\.html$/U"; flowbits:set,ET.CoreImpact; classtype:attempted-admin; sid:2812480; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress PDF (Pens Being Tested or Possible RocketKitten)"; flow:established,from_server; flowbits:isset,ET.CoreImpact; file_data; content:"%PDF"; within:4; classtype:attempted-admin; sid:2812481; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress Flash M1 (Pens Being Tested or Possible RocketKitten)"; flow:established,from_server; flowbits:isset,ET.CoreImpact; file_data; content:"CWS"; within:3; classtype:attempted-admin; sid:2812482; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress Flash M2 (Pens Being Tested or Possible RocketKitten)"; flow:established,from_server; flowbits:isset,ET.CoreImpact; file_data; content:"ZWS"; within:3; classtype:attempted-admin; sid:2812483; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress Flash M3 (Pens Being Tested or Possible RocketKitten)"; flow:established,from_server; flowbits:isset,ET.CoreImpact; file_data; content:"FWS"; within:3; classtype:attempted-admin; sid:2812484; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress Silverlight (Pens Being Tested or Possible RocketKitten)"; flow:established,from_server; flowbits:isset,ET.CoreImpact; file_data; content:"AppManifest.xaml"; classtype:attempted-admin; sid:2812485; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit In Progress Silverlight"; flow:established,from_server; flowbits:isset,ET.CoreImpact; file_data; content:"AppManifest.xaml"; classtype:attempted-admin; sid:2812486; rev:2;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible CoreImpact Client Exploit Payload URI Struct M1 (Pens Being Tested or Possible RocketKitten)"; flow:established,to_server; urilen:>30; content:"/LEVEL"; http_uri; depth:6; content:".exe"; http_uri; content:!"Referer|3a|"; http_header; pcre:"/^\/LEVEL\d[^\x2f]+\/[^\x2f]+\.exe$/U"; classtype:attempted-admin; sid:2812487; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT CVE-2015-2502 IE Memory Corruption Vulnerability"; flow:established,from_server; file_data; content:"CollectGarbage"; fast_pattern:only; nocase; content:"<table"; nocase; pcre:"/^[\s>](?:(?!<\/table>).)*?<table[\s>]/Rsi"; content:"contentEditable"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]true[\x22\x27]/Rsi"; content:"contentEditable"; nocase; pcre:"/^\s*?=\s*?[\x22\x27]false[\x22\x27]/Rsi"; reference:cve,2015-2502; classtype:attempted-user; sid:2812506; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible CVE-2015-2502 IE Memory Corruption Vulnerability"; flow:established,from_server; file_data; content:"JScript.Compact"; fast_pattern:only; nocase; content:"<table"; nocase; pcre:"/^[\s>](?:(?!<\/table>).)*?<table[\s>]/Rsi"; reference:cve,2015-2502; classtype:attempted-user; sid:2812514; rev:2;)

#
#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2444)"; flow:from_server,established; file_data; content:"<style"; nocase; pcre:"/^[^>]*?>\s*?form\s*?\{\s*?-ms-behavior\s*?\x3a\s*?url/Rsi"; content:"x-ua-compatible"; nocase; pcre:"/^[\x22\x27]\s*content\s*=\s*[\x22\x27]\s*IE\s*=\s*10/Rsi"; content:"<button"; nocase; content:"<label"; nocase; distance:0; content:"<form"; nocase; distance:0; content:"<meter"; nocase; distance:0; content:"<optgroup"; nocase; distance:0; content:"<meter"; nocase; distance:0; content:"-ms-behavior"; nocase; fast_pattern:only; reference:cve,2015-2444; classtype:attempted-user; sid:2021709; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Microsoft Internet Explorer Memory Corruption (CVE-2015-2483)"; flow:established,from_server; file_data; content:"display"; nocase; content:"run-in"; nocase; distance:0; content:"position"; nocase; content:"absolute"; nocase; distance:0; content:"msGetRegionContent"; nocase; fast_pattern:only; content:"width"; nocase; pcre:"/^\s*?\x3d\s*?1\s*?\x3b/Rsi"; content:"accessKey"; nocase; pcre:"/^\s*?\x3d\s*?[\x22\x27]h[\x22\x27]\s*?\x3b/Rsi"; content:"rt"; content:"pre"; content:"style"; reference:cve,2015-2483; classtype:attempted-user; sid:2812907; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2485)"; flow:from_server,established; file_data; content:"CollectGarbage"; fast_pattern; content:"attributes"; content:"runtimeStyle"; content:"classList"; content:"style"; content:"uniqueNumber"; content:"createAttributeNS"; distance:0; content:"appendChild"; distance:0; content:"appendChild"; distance:0; reference:cve,2015-2485; classtype:attempted-user; sid:2812908; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2486)"; flow:from_server,established; file_data; content:"setAttributeNS"; nocase; content:"mergeAttributes"; nocase; fast_pattern; content:"mergeAttributes"; nocase; distance:0; content:"input"; nocase; content:"attributes"; nocase; pcre:"/^\s*?\.\s*?value.*?(?P<element>[^\s.]+?)\s*?\.\s*?mergeAttributes.*?mergeAttributes\s*?\x28\s*?(?P=element)/Rsi"; reference:cve,2015-2486; classtype:attempted-user; sid:2812909; rev:4;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2491)"; flow:from_server,established; file_data; content:"setAttribute"; content:"clearAttributes"; distance:0; pcre:"/^\s*?\(\s*?\)/Rsi"; content:"createTextRange"; distance:0; pcre:"/^\s*?\(\s*?\)\s*?\.\s*?execCommand\s*?\(\s*?[\x22\x27]InsertIFrame[\x22\x27]\s*?,\s*?false\s*?,\s*?[\x22\x27][\x22\x27]/Rsi"; content:"removeAttribute"; distance:0; pcre:"/^\s*?\(\s*?[\x22\x27]id[\x22\x27]\s*?\)/Rsi"; content:"CollectGarbage"; fast_pattern; distance:0; content:"applyElement"; distance:0; pcre:"/^\s*?\(\s*?document\s*?\.\s*?createElement\s*?\(\s*?[\x22\x27]style[\x22\x27]\s*?\)\s*?,\s*?[\x22\x27]outside[\x22\x27]\s*?\)/Rsi"; reference:cve,2015-2491; classtype:attempted-user; sid:2812910; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2490)"; flow:from_server,established; file_data; content:"table"; nocase; content:"table"; distance:0; nocase; content:"tbody"; nocase; content:"tbody"; distance:0; nocase; content:"frameset"; nocase; content:"tr"; nocase; distance:0; content:"rows"; nocase; pcre:"/^\s*?\[\s*?\d+?\s*?\]\s*?\.\s*?onpropertychange/Rsi"; content:"insertRow"; nocase; content:"insertRow"; nocase; distance:0; content:"createTextRange"; nocase; pcre:"/^\s*?\x28\s*?\x29\s*?\.\s*?pasteHTML\s*?\x28\s*?[\x22\x27]<form/Rsi"; content:"rows"; pcre:"/^\s*?\.\s*?length/Rsi"; content:"for"; pcre:"/^\s*?\([^\x3b\)]*?\x3b[^\x3b\)]+?<=?\s*(?:0x(?:(6[4-9a-f]|[7-9a-f])|\d{3,})|\d{3,})[^\)]+?\)/Rsi"; content:"pasteHTML"; nocase; fast_pattern:only; reference:cve,2015-2490; classtype:attempted-user; sid:2812911; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2499)"; flow:from_server,established; file_data; content:"JScript.Encode"; fast_pattern; content:"innerHTML"; distance:0; pcre:"/^\s*?=\s*?[\x22\x27]<table id=/Rsi"; content:"style"; distance:0; pcre:"/^\s*?\.\s*?cssText\s*?=\s*?[\x22\x27]table-layout:\s*?fixed[\x22\x27]/Rsi"; content:"getElementsByTagName"; distance:0; pcre:"/^\s*?\(\s*?[\x22\x27]col[\x22\x27]\s*?\)\s*?\[0\]\s*?\.\s*?width\s*?\x3b/Rsi"; reference:cve,2015-2499; classtype:attempted-user; sid:2812912; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2501)"; flow:from_server,established; file_data; content:"content=|22|IE=Edge|22|"; fast_pattern; content:"setTimeout"; distance:0; pcre:"/^\s*?\(\s*?function\s*?\(\s*?\)\s*?\{\s*?\window\s*?\.\s*?location\s*?\.\s*?reload\s*?\(\s*?\)\s*?\x3b\s*?\}/Rsi"; content:"<body onload="; distance:0; content:"<img id="; distance:0; threshold:type limit, track by_src, count 1, seconds 30; reference:cve,2015-2501; classtype:attempted-user; sid:2812913; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Windows Media Center Remote Code Execution (CVE-2015-2509) 1"; flow:established,from_server; file_data; content:"<application"; nocase; pcre:"/^\s*?(?:(?!\/>).)+?url\s*\x3d\s*[\x27\x22]\s*(?:https?|ftp|file)\x3a\x2f\x2f[-A-Z0-9+&@#/%?=~_|$!:,.\x3b]*?\.exe\s*?[\x27\x22]/Rsi"; content:"URL"; nocase; content:".exe"; nocase; distance:0; reference:cve,2015-2509; classtype:attempted-user; sid:2812914; rev:3;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Windows Media Center Remote Code Execution (CVE-2015-2509) 2"; flow:established,from_server; file_data; content:"<application"; nocase; pcre:"/^\s*?(?:(?!\/>).)+?run\s*\x3d\s*[\x27\x22]\s*\x5c\x5c[^\x22\x27]+\x5c[^<>:\x27\x22\\/|?*]+\.exe\s*?[\x22\x27]/Rsi"; content:"run"; nocase; content:".exe"; nocase; distance:0; reference:cve,2015-2509; classtype:attempted-user; sid:2812915; rev:3;)

#
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ETPRO WEB_CLIENT Possible Windows Media Center Remote Code Execution (CVE-2015-2509) 3"; flow:established,to_server; content:"GET"; http_method; pcre:"/\.(?:vb(?:s(?:cript)?|e)?|(?:gadge|ba)t|c(?:md|om|pl)|i(?:nx|su)|j(?:ob|se)|s(?:ct|hs)|ms[cipt]|wsf?|exe|lnk|ps1|u3p)$/Ui"; content:"Media Center"; fast_pattern; http_header; content:"MediaCenter"; http_header; content:!"Referer"; http_header; pcre:"/^User-Agent\x3a\x20[^\r\n]+?Media Center[^\r\n]+?MediaCenter/Hmi"; reference:cve,2015-2509; classtype:attempted-user; sid:2812916; rev:6;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Windows Media Center Remote Code Execution (CVE-2015-2509) 4"; flow:established,from_server; file_data; content:"<application"; nocase; pcre:"/^\s*?(?:(?!\/>).)+?run\s*\x3d\s*[\x27\x22]\s*[A-Z]\x3a\x5c[^\x27\x22]+\x5c[^<>:\x27\x22\\/|?*]+\.exe\s*?[\x22\x27]/Rsi"; content:"run"; nocase; content:".exe"; nocase; distance:0; reference:cve,2015-2509; classtype:attempted-user; sid:2812950; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Windows Media Center Remote Code Execution (CVE-2015-2509) 5"; flow:established,from_server; file_data; content:"<application"; nocase; pcre:"/^\s*?(?:(?!\/>).)+?run\s*\x3d\s*[\x22\x27]\s*(?:https?|ftp|file)\x3a\x2f\x2f[-A-Z0-9+&@#/%?=~_|$!:,.\x3b]*?\.exe\s*?[\x22\x27]/Rsi"; content:"run"; nocase; content:".exe"; nocase; distance:0; reference:cve,2015-2509; classtype:attempted-user; sid:2812951; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Possible Windows Media Center Remote Code Execution (CVE-2015-2509) 6"; flow:established,from_server; file_data; content:"<application"; nocase; pcre:"/^\s*?(?:(?!\/>).)+?run\s*\x3d\s*[\x27\x22]\s*[A-Z]\x3a\x5c[^\x27\x22]+\x5c[^<>:\x27\x22\\/|?*]+\.bat\s*?[\x22\x27]/Rsi"; content:"run"; nocase; content:".bat"; nocase; distance:0; reference:cve,2015-2509; classtype:attempted-user; sid:2812952; rev:2;)

#
#alert tcp any any -> $HOME_NET any (msg:"ET WEB_CLIENT Proxy - OWASP Zed Attack Proxy Certificate Seen"; content:"|16|"; depth:1; content:"OWASP Zed Attack Proxy Root CA"; nocase; classtype:misc-activity; sid:2021941; rev:1;)

#
#alert tcp any any -> $HOME_NET any (msg:"ET WEB_CLIENT Proxy - BurpSuite PortSwigger Proxy Certificate Seen"; content:"|16|"; depth:1; content:"PortSwigger CA"; nocase; classtype:misc-activity; sid:2021942; rev:1;)

#
#alert tcp any any -> $HOME_NET any (msg:"ET WEB_CLIENT Proxy - Fiddler Proxy Certificate Seen"; content:"|16|"; depth:1; content:"DO_NOT_TRUST_FiddlerRoot"; nocase; classtype:misc-activity; sid:2021943; rev:1;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2482)"; flow:established,from_server; file_data; content:"RegExp"; nocase; content:".replace"; fast_pattern; nocase; content:".compile"; pcre:"/\s(?:(?P<regex_id>[a-z_\$][a-z0-9_\$]*))\s*\x3d\s*new\s*RegExp\s*\(\s*[\x27\x22][^\x2c\x27\x22]*?\([^:?\x22\x27]+?\).*?[\x27\x22]\s*\x2c\s*[\x22\x27][igm]+[\x22\x27]\s*\)\s*\;.+?\.replace\s*\([^,]*?(?P=regex_id)\s*\x2c\s*function.+?(?P=regex_id)\.compile\(\)/si"; reference:cve,2015-2482; classtype:attempted-user; sid:2814342; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-2515)"; flow:from_server,established; file_data; content:"<object"; nocase; content:"0E5CBF21-D15F-11D0-8301-00AA005B4383"; nocase; distance:0; fast_pattern; reference:cve,2015-2515; classtype:attempted-user; sid:2814343; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Windows Shell Tablet Input Band UAF (CVE-2015-2548)"; flow:from_server,established; file_data; content:"<object"; pcre:"/^[^>]+?CLASSID\s*?=\s*?[\x22\x27]CLSID\x3a15D633E2-AD00-465b-9EC7-F56B7CDF8E27[\x22\x27]/Rsi"; content:"location"; pcre:"/^\s*?\.\s*?href/Rsi"; content:"CLSID|3a|15D633E2-AD00-465b-9EC7-F56B7CDF8E27"; fast_pattern; reference:cve,2015-2548; classtype:attempted-user; sid:2814344; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-6042)"; flow:from_server,established; file_data; content:"MutationObserver"; fast_pattern; pcre:"/^\s*\(\s*function\s*\(\s*\)\s*\{\s*document\s*.\s*open/Rsi"; content:"observe"; distance:0; content:"childList|3a 20|true"; distance:0; content:"addEventListener"; pcre:"/^\s*\(\s*[\x22\x27]DOMSubtreeModified[\x22\x27]/Rsi"; content:"removeChild"; distance:0; content:"setInterval"; distance:0; reference:cve,2015-6042; classtype:attempted-user; sid:2814345; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-6048)"; flow:from_server,established; file_data; content:"applyElement"; content:"removeNode"; pcre:"/^\s*\(\s*true\s*\)/Rsi"; content:"execCommand"; distance:0; pcre:"/^\s*\(\s*[\x22\x27]InsertFieldset[\x22\x27]\s*,\s*null\s*,\s*true\s*\)/Rsi"; content:"CollectGarbage"; fast_pattern; distance:0; content:"<area>"; nocase; distance:0; content:"<output>"; nocase; distance:0; content:"<table>"; nocase; distance:0; content:"<span>"; nocase; distance:0; reference:cve,2015-6048; classtype:attempted-user; sid:2814346; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-6049)"; flow:from_server,established; file_data; content:"CLSID|3a|6CF48EF8-44CD-45d2-8832-A16EA016311B"; content:"&#bd95b6ea&#cafb3d9c"; distance:0; fast_pattern; content:"window"; distance:0; pcre:"/^\s*\.\s*location\s*\.\s*href\s*=\s*[\x22\x27]\[sf\][\x22\x27]/Rsi"; reference:cve,2015-6049; classtype:attempted-user; sid:2814347; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ETPRO WEB_CLIENT Internet Explorer Memory Corruption Vulnerability (CVE-2015-6050)"; flow:from_server,established; file_data; content:"addEventListener"; pcre:"/^\s*\(\s*[\x22\x27]DOMNodeInserted[\x22\x27]/Rsi"; content:"execCommand"; distance:0; pcre:"/^\s*\(\s*[\x22\x27]Bold[\x22\x27]/Rsi"; content:"addEventListener"; pcre:"/^\s*\(\s*[\x22\x27]DOMSubtreeModified[\x22\x27]/Rsi"; content:"whiteSpace"; distance:0; content:"surroundContents"; fast_pattern; distance:0; content:"setAttribute"; pcre:"/^\s*\(\s*[\x22\x27]hidden[\x22\x27]/Rsi"; content:"execCommand"; pcre:"/^\s*\(\s*[\x22\x27]RespectVisibilityInDesign[\x22\x27]/Rsi"; reference:cve,2015-6050; classtype:attempted-user; sid:2814348; rev:2;)

#
#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ETPRO WEB_CLIENT Possible Microsoft Edge XSS Filter Bypass (CVE-2015-6058)"; flow:established,to_server; content:"|22|"; http_uri; content:"|60|"; http_uri; distance:0; content:"|60|"; http_uri; fast_pattern; distance:0; content:"|20|Edge|2f|"; http_user_agent; pcre:"/\x22(?:(?!\x22).)+\x60/U"; reference:cve,2015-6058; classtype:attempted-user; sid:2814349; rev:3;)

