[properties]
name=Agent Plugins
description=Check the integrity of the agent plugins configuration
category=alienvault,platform
strike_zone=True
profiles=Sensor:>4.0
type=command
command=for plugin in $([[ -f '/etc/ossim/agent/config.yml' ]] && grep -e '\.cfg' -e '\.cfg\.local' /etc/ossim/agent/config.yml /etc/ossim/agent/config.cfg | grep -v '\_eth' | cut -d'=' -f2 || grep -e '\.cfg' -e '\.cfg\.local' /etc/ossim/agent/config.cfg | grep -v '\_eth'| cut -d'=' -f2); do if [ ! -f $plugin ]; then echo $plugin does not exist; fi; done

# Plugin files exist for enabled plugins
[Verify the existance of plugin files for all enabled plugins]
pattern=^(\S+)\sdoes\snot\sexist
fail_if_empty=False
conditions=@string@:==""
severity=High
warning=One or more configuration files for enabled plugins does not exist
advice=Make sure you have the configuration files for all of the enabled plugins under /etc/ossim/agent/plugins/ 

