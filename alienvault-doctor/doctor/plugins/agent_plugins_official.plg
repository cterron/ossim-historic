[properties]
name=Agent Plugins
description=Check the integrity of the agent plugins configuration
category=alienvault,platform
strike_zone=True
profiles=Sensor:>4.0
type=command
command=grep \.cfg /etc/ossim/agent/config.yml /etc/ossim/agent/config.cfg | grep -v '\_eth'

# Enabled agent cfg files are among the officially alienvault-distributed ones
[Verify there are not custom plugin configuration files not labeled as 'local']
pattern=^.*(\/etc\/ossim\/agent\/plugins\/[a-zA-Z0-9\_\-]+\.cfg)
fail_if_empty=True
conditions=@set@:@issubsetof@/etc/ossim/doctor/plugins/agent_plugins.list
warning=Some plugins not found
advice=There at least one reference from configuration files to a plugin file which doesn't exist

